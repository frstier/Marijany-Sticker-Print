function Db(r,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in r)){const o=Object.getOwnPropertyDescriptor(s,i);o&&Object.defineProperty(r,i,o.get?o:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function hd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function vo(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var i=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return r[s]}})}),t}var gh={exports:{}},$l={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kp;function Fb(){if(kp)return $l;kp=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var f in i)f!=="key"&&(o[f]=i[f])}else o=i;return i=o.ref,{$$typeof:r,type:s,key:c,ref:i!==void 0?i:null,props:o}}return $l.Fragment=e,$l.jsx=t,$l.jsxs=t,$l}var Dp;function Lb(){return Dp||(Dp=1,gh.exports=Fb()),gh.exports}var g=Lb(),ph={exports:{}},Ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fp;function Ib(){if(Fp)return Ke;Fp=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function y(U){return U===null||typeof U!="object"?null:(U=_&&U[_]||U["@@iterator"],typeof U=="function"?U:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function k(U,N,P){this.props=U,this.context=N,this.refs=S,this.updater=P||E}k.prototype.isReactComponent={},k.prototype.setState=function(U,N){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,N,"setState")},k.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function M(){}M.prototype=k.prototype;function O(U,N,P){this.props=U,this.context=N,this.refs=S,this.updater=P||E}var G=O.prototype=new M;G.constructor=O,w(G,k.prototype),G.isPureReactComponent=!0;var q=Array.isArray;function K(){}var F={H:null,A:null,T:null,S:null},X=Object.prototype.hasOwnProperty;function z(U,N,P){var C=P.ref;return{$$typeof:r,type:U,key:N,ref:C!==void 0?C:null,props:P}}function ne(U,N){return z(U.type,N,U.props)}function oe(U){return typeof U=="object"&&U!==null&&U.$$typeof===r}function fe(U){var N={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(P){return N[P]})}var W=/\/+/g;function be(U,N){return typeof U=="object"&&U!==null&&U.key!=null?fe(""+U.key):N.toString(36)}function Ee(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(K,K):(U.status="pending",U.then(function(N){U.status==="pending"&&(U.status="fulfilled",U.value=N)},function(N){U.status==="pending"&&(U.status="rejected",U.reason=N)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function J(U,N,P,C,I){var Z=typeof U;(Z==="undefined"||Z==="boolean")&&(U=null);var ye=!1;if(U===null)ye=!0;else switch(Z){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(U.$$typeof){case r:case e:ye=!0;break;case x:return ye=U._init,J(ye(U._payload),N,P,C,I)}}if(ye)return I=I(U),ye=C===""?"."+be(U,0):C,q(I)?(P="",ye!=null&&(P=ye.replace(W,"$&/")+"/"),J(I,N,P,"",function(Oe){return Oe})):I!=null&&(oe(I)&&(I=ne(I,P+(I.key==null||U&&U.key===I.key?"":(""+I.key).replace(W,"$&/")+"/")+ye)),N.push(I)),1;ye=0;var De=C===""?".":C+":";if(q(U))for(var Ae=0;Ae<U.length;Ae++)C=U[Ae],Z=De+be(C,Ae),ye+=J(C,N,P,Z,I);else if(Ae=y(U),typeof Ae=="function")for(U=Ae.call(U),Ae=0;!(C=U.next()).done;)C=C.value,Z=De+be(C,Ae++),ye+=J(C,N,P,Z,I);else if(Z==="object"){if(typeof U.then=="function")return J(Ee(U),N,P,C,I);throw N=String(U),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return ye}function ve(U,N,P){if(U==null)return U;var C=[],I=0;return J(U,C,"","",function(Z){return N.call(P,Z,I++)}),C}function le(U){if(U._status===-1){var N=U._result;N=N(),N.then(function(P){(U._status===0||U._status===-1)&&(U._status=1,U._result=P)},function(P){(U._status===0||U._status===-1)&&(U._status=2,U._result=P)}),U._status===-1&&(U._status=0,U._result=N)}if(U._status===1)return U._result.default;throw U._result}var Ne=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},ce={map:ve,forEach:function(U,N,P){ve(U,function(){N.apply(this,arguments)},P)},count:function(U){var N=0;return ve(U,function(){N++}),N},toArray:function(U){return ve(U,function(N){return N})||[]},only:function(U){if(!oe(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Ke.Activity=v,Ke.Children=ce,Ke.Component=k,Ke.Fragment=t,Ke.Profiler=i,Ke.PureComponent=O,Ke.StrictMode=s,Ke.Suspense=h,Ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Ke.__COMPILER_RUNTIME={__proto__:null,c:function(U){return F.H.useMemoCache(U)}},Ke.cache=function(U){return function(){return U.apply(null,arguments)}},Ke.cacheSignal=function(){return null},Ke.cloneElement=function(U,N,P){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var C=w({},U.props),I=U.key;if(N!=null)for(Z in N.key!==void 0&&(I=""+N.key),N)!X.call(N,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&N.ref===void 0||(C[Z]=N[Z]);var Z=arguments.length-2;if(Z===1)C.children=P;else if(1<Z){for(var ye=Array(Z),De=0;De<Z;De++)ye[De]=arguments[De+2];C.children=ye}return z(U.type,I,C)},Ke.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:o,_context:U},U},Ke.createElement=function(U,N,P){var C,I={},Z=null;if(N!=null)for(C in N.key!==void 0&&(Z=""+N.key),N)X.call(N,C)&&C!=="key"&&C!=="__self"&&C!=="__source"&&(I[C]=N[C]);var ye=arguments.length-2;if(ye===1)I.children=P;else if(1<ye){for(var De=Array(ye),Ae=0;Ae<ye;Ae++)De[Ae]=arguments[Ae+2];I.children=De}if(U&&U.defaultProps)for(C in ye=U.defaultProps,ye)I[C]===void 0&&(I[C]=ye[C]);return z(U,Z,I)},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(U){return{$$typeof:f,render:U}},Ke.isValidElement=oe,Ke.lazy=function(U){return{$$typeof:x,_payload:{_status:-1,_result:U},_init:le}},Ke.memo=function(U,N){return{$$typeof:m,type:U,compare:N===void 0?null:N}},Ke.startTransition=function(U){var N=F.T,P={};F.T=P;try{var C=U(),I=F.S;I!==null&&I(P,C),typeof C=="object"&&C!==null&&typeof C.then=="function"&&C.then(K,Ne)}catch(Z){Ne(Z)}finally{N!==null&&P.types!==null&&(N.types=P.types),F.T=N}},Ke.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Ke.use=function(U){return F.H.use(U)},Ke.useActionState=function(U,N,P){return F.H.useActionState(U,N,P)},Ke.useCallback=function(U,N){return F.H.useCallback(U,N)},Ke.useContext=function(U){return F.H.useContext(U)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(U,N){return F.H.useDeferredValue(U,N)},Ke.useEffect=function(U,N){return F.H.useEffect(U,N)},Ke.useEffectEvent=function(U){return F.H.useEffectEvent(U)},Ke.useId=function(){return F.H.useId()},Ke.useImperativeHandle=function(U,N,P){return F.H.useImperativeHandle(U,N,P)},Ke.useInsertionEffect=function(U,N){return F.H.useInsertionEffect(U,N)},Ke.useLayoutEffect=function(U,N){return F.H.useLayoutEffect(U,N)},Ke.useMemo=function(U,N){return F.H.useMemo(U,N)},Ke.useOptimistic=function(U,N){return F.H.useOptimistic(U,N)},Ke.useReducer=function(U,N,P){return F.H.useReducer(U,N,P)},Ke.useRef=function(U){return F.H.useRef(U)},Ke.useState=function(U){return F.H.useState(U)},Ke.useSyncExternalStore=function(U,N,P){return F.H.useSyncExternalStore(U,N,P)},Ke.useTransition=function(){return F.H.useTransition()},Ke.version="19.2.1",Ke}var Lp;function dd(){return Lp||(Lp=1,ph.exports=Ib()),ph.exports}var pe=dd();const Hu=hd(pe);var xh={exports:{}},Gl={},vh={exports:{}},_h={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ip;function Bb(){return Ip||(Ip=1,(function(r){function e(J,ve){var le=J.length;J.push(ve);e:for(;0<le;){var Ne=le-1>>>1,ce=J[Ne];if(0<i(ce,ve))J[Ne]=ve,J[le]=ce,le=Ne;else break e}}function t(J){return J.length===0?null:J[0]}function s(J){if(J.length===0)return null;var ve=J[0],le=J.pop();if(le!==ve){J[0]=le;e:for(var Ne=0,ce=J.length,U=ce>>>1;Ne<U;){var N=2*(Ne+1)-1,P=J[N],C=N+1,I=J[C];if(0>i(P,le))C<ce&&0>i(I,P)?(J[Ne]=I,J[C]=le,Ne=C):(J[Ne]=P,J[N]=le,Ne=N);else if(C<ce&&0>i(I,le))J[Ne]=I,J[C]=le,Ne=C;else break e}}return ve}function i(J,ve){var le=J.sortIndex-ve.sortIndex;return le!==0?le:J.id-ve.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var c=Date,f=c.now();r.unstable_now=function(){return c.now()-f}}var h=[],m=[],x=1,v=null,_=3,y=!1,E=!1,w=!1,S=!1,k=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function G(J){for(var ve=t(m);ve!==null;){if(ve.callback===null)s(m);else if(ve.startTime<=J)s(m),ve.sortIndex=ve.expirationTime,e(h,ve);else break;ve=t(m)}}function q(J){if(w=!1,G(J),!E)if(t(h)!==null)E=!0,K||(K=!0,fe());else{var ve=t(m);ve!==null&&Ee(q,ve.startTime-J)}}var K=!1,F=-1,X=5,z=-1;function ne(){return S?!0:!(r.unstable_now()-z<X)}function oe(){if(S=!1,K){var J=r.unstable_now();z=J;var ve=!0;try{e:{E=!1,w&&(w=!1,M(F),F=-1),y=!0;var le=_;try{t:{for(G(J),v=t(h);v!==null&&!(v.expirationTime>J&&ne());){var Ne=v.callback;if(typeof Ne=="function"){v.callback=null,_=v.priorityLevel;var ce=Ne(v.expirationTime<=J);if(J=r.unstable_now(),typeof ce=="function"){v.callback=ce,G(J),ve=!0;break t}v===t(h)&&s(h),G(J)}else s(h);v=t(h)}if(v!==null)ve=!0;else{var U=t(m);U!==null&&Ee(q,U.startTime-J),ve=!1}}break e}finally{v=null,_=le,y=!1}ve=void 0}}finally{ve?fe():K=!1}}}var fe;if(typeof O=="function")fe=function(){O(oe)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,be=W.port2;W.port1.onmessage=oe,fe=function(){be.postMessage(null)}}else fe=function(){k(oe,0)};function Ee(J,ve){F=k(function(){J(r.unstable_now())},ve)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(J){J.callback=null},r.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<J?Math.floor(1e3/J):5},r.unstable_getCurrentPriorityLevel=function(){return _},r.unstable_next=function(J){switch(_){case 1:case 2:case 3:var ve=3;break;default:ve=_}var le=_;_=ve;try{return J()}finally{_=le}},r.unstable_requestPaint=function(){S=!0},r.unstable_runWithPriority=function(J,ve){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var le=_;_=J;try{return ve()}finally{_=le}},r.unstable_scheduleCallback=function(J,ve,le){var Ne=r.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Ne+le:Ne):le=Ne,J){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=le+ce,J={id:x++,callback:ve,priorityLevel:J,startTime:le,expirationTime:ce,sortIndex:-1},le>Ne?(J.sortIndex=le,e(m,J),t(h)===null&&J===t(m)&&(w?(M(F),F=-1):w=!0,Ee(q,le-Ne))):(J.sortIndex=ce,e(h,J),E||y||(E=!0,K||(K=!0,fe()))),J},r.unstable_shouldYield=ne,r.unstable_wrapCallback=function(J){var ve=_;return function(){var le=_;_=ve;try{return J.apply(this,arguments)}finally{_=le}}}})(_h)),_h}var Bp;function Mb(){return Bp||(Bp=1,vh.exports=Bb()),vh.exports}var yh={exports:{}},dr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mp;function Ub(){if(Mp)return dr;Mp=1;var r=dd();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)m+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(h,m,x){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:h,containerInfo:m,implementation:x}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return dr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,dr.createPortal=function(h,m){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(h,m,null,x)},dr.flushSync=function(h){var m=c.T,x=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=m,s.p=x,s.d.f()}},dr.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(h,m))},dr.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},dr.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var x=m.as,v=f(x,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,y=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;x==="style"?s.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:y}):x==="script"&&s.d.X(h,{crossOrigin:v,integrity:_,fetchPriority:y,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},dr.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var x=f(m.as,m.crossOrigin);s.d.M(h,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(h)},dr.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var x=m.as,v=f(x,m.crossOrigin);s.d.L(h,x,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},dr.preloadModule=function(h,m){if(typeof h=="string")if(m){var x=f(m.as,m.crossOrigin);s.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(h)},dr.requestFormReset=function(h){s.d.r(h)},dr.unstable_batchedUpdates=function(h,m){return h(m)},dr.useFormState=function(h,m,x){return c.H.useFormState(h,m,x)},dr.useFormStatus=function(){return c.H.useHostTransitionStatus()},dr.version="19.2.1",dr}var Up;function Pb(){if(Up)return yh.exports;Up=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),yh.exports=Ub(),yh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pp;function zb(){if(Pp)return Gl;Pp=1;var r=Mb(),e=dd(),t=Pb();function s(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function o(n){var a=n,l=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(l=a.return),n=a.return;while(n)}return a.tag===3?l:null}function c(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function f(n){if(n.tag===31){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function h(n){if(o(n)!==n)throw Error(s(188))}function m(n){var a=n.alternate;if(!a){if(a=o(n),a===null)throw Error(s(188));return a!==n?null:n}for(var l=n,u=a;;){var d=l.return;if(d===null)break;var p=d.alternate;if(p===null){if(u=d.return,u!==null){l=u;continue}break}if(d.child===p.child){for(p=d.child;p;){if(p===l)return h(d),n;if(p===u)return h(d),a;p=p.sibling}throw Error(s(188))}if(l.return!==u.return)l=d,u=p;else{for(var b=!1,A=d.child;A;){if(A===l){b=!0,l=d,u=p;break}if(A===u){b=!0,u=d,l=p;break}A=A.sibling}if(!b){for(A=p.child;A;){if(A===l){b=!0,l=p,u=d;break}if(A===u){b=!0,u=p,l=d;break}A=A.sibling}if(!b)throw Error(s(189))}}if(l.alternate!==u)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?n:a}function x(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=x(n),a!==null)return a;n=n.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),O=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),ne=Symbol.for("react.memo_cache_sentinel"),oe=Symbol.iterator;function fe(n){return n===null||typeof n!="object"?null:(n=oe&&n[oe]||n["@@iterator"],typeof n=="function"?n:null)}var W=Symbol.for("react.client.reference");function be(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===W?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case k:return"Profiler";case S:return"StrictMode";case q:return"Suspense";case K:return"SuspenseList";case z:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case E:return"Portal";case O:return n.displayName||"Context";case M:return(n._context.displayName||"Context")+".Consumer";case G:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case F:return a=n.displayName||null,a!==null?a:be(n.type)||"Memo";case X:a=n._payload,n=n._init;try{return be(n(a))}catch{}}return null}var Ee=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},Ne=[],ce=-1;function U(n){return{current:n}}function N(n){0>ce||(n.current=Ne[ce],Ne[ce]=null,ce--)}function P(n,a){ce++,Ne[ce]=n.current,n.current=a}var C=U(null),I=U(null),Z=U(null),ye=U(null);function De(n,a){switch(P(Z,a),P(I,n),P(C,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?tp(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=tp(a),n=rp(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}N(C),P(C,n)}function Ae(){N(C),N(I),N(Z)}function Oe(n){n.memoizedState!==null&&P(ye,n);var a=C.current,l=rp(a,n.type);a!==l&&(P(I,n),P(C,l))}function qe(n){I.current===n&&(N(C),N(I)),ye.current===n&&(N(ye),Ul._currentValue=le)}var we,Ve;function He(n){if(we===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);we=a&&a[1]||"",Ve=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+we+n+Ve}var It=!1;function dt(n,a){if(!n||It)return"";It=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(ue){var se=ue}Reflect.construct(n,[],xe)}else{try{xe.call()}catch(ue){se=ue}n.call(xe.prototype)}}else{try{throw Error()}catch(ue){se=ue}(xe=n())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(ue){if(ue&&se&&typeof ue.stack=="string")return[ue.stack,se.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),b=p[0],A=p[1];if(b&&A){var H=b.split(`
`),ee=A.split(`
`);for(d=u=0;u<H.length&&!H[u].includes("DetermineComponentFrameRoot");)u++;for(;d<ee.length&&!ee[d].includes("DetermineComponentFrameRoot");)d++;if(u===H.length||d===ee.length)for(u=H.length-1,d=ee.length-1;1<=u&&0<=d&&H[u]!==ee[d];)d--;for(;1<=u&&0<=d;u--,d--)if(H[u]!==ee[d]){if(u!==1||d!==1)do if(u--,d--,0>d||H[u]!==ee[d]){var de=`
`+H[u].replace(" at new "," at ");return n.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",n.displayName)),de}while(1<=u&&0<=d);break}}}finally{It=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?He(l):""}function Le(n,a){switch(n.tag){case 26:case 27:case 5:return He(n.type);case 16:return He("Lazy");case 13:return n.child!==a&&a!==null?He("Suspense Fallback"):He("Suspense");case 19:return He("SuspenseList");case 0:case 15:return dt(n.type,!1);case 11:return dt(n.type.render,!1);case 1:return dt(n.type,!0);case 31:return He("Activity");default:return""}}function Zt(n){try{var a="",l=null;do a+=Le(n,l),l=n,n=n.return;while(n);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Wt=Object.prototype.hasOwnProperty,Mr=r.unstable_scheduleCallback,Qr=r.unstable_cancelCallback,Qa=r.unstable_shouldYield,pa=r.unstable_requestPaint,vt=r.unstable_now,Un=r.unstable_getCurrentPriorityLevel,Pn=r.unstable_ImmediatePriority,zn=r.unstable_UserBlockingPriority,xr=r.unstable_NormalPriority,n0=r.unstable_LowPriority,Ji=r.unstable_IdlePriority,Oo=r.log,Co=r.unstable_setDisableYieldValue,xa=null,hr=null;function gn(n){if(typeof Oo=="function"&&Co(n),hr&&typeof hr.setStrictMode=="function")try{hr.setStrictMode(xa,n)}catch{}}var vr=Math.clz32?Math.clz32:jo,a0=Math.log,Ro=Math.LN2;function jo(n){return n>>>=0,n===0?32:31-(a0(n)/Ro|0)|0}var Za=256,Ms=262144,Us=4194304;function Zr(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ps(n,a,l){var u=n.pendingLanes;if(u===0)return 0;var d=0,p=n.suspendedLanes,b=n.pingedLanes;n=n.warmLanes;var A=u&134217727;return A!==0?(u=A&~p,u!==0?d=Zr(u):(b&=A,b!==0?d=Zr(b):l||(l=A&~n,l!==0&&(d=Zr(l))))):(A=u&~p,A!==0?d=Zr(A):b!==0?d=Zr(b):l||(l=u&~n,l!==0&&(d=Zr(l)))),d===0?0:a!==0&&a!==d&&(a&p)===0&&(p=d&-d,l=a&-a,p>=l||p===32&&(l&4194048)!==0)?a:d}function es(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function s0(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ko(){var n=Us;return Us<<=1,(Us&62914560)===0&&(Us=4194304),n}function Qi(n){for(var a=[],l=0;31>l;l++)a.push(n);return a}function ts(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function i0(n,a,l,u,d,p){var b=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var A=n.entanglements,H=n.expirationTimes,ee=n.hiddenUpdates;for(l=b&~l;0<l;){var de=31-vr(l),xe=1<<de;A[de]=0,H[de]=-1;var se=ee[de];if(se!==null)for(ee[de]=null,de=0;de<se.length;de++){var ue=se[de];ue!==null&&(ue.lane&=-536870913)}l&=~xe}u!==0&&Do(n,u,0),p!==0&&d===0&&n.tag!==0&&(n.suspendedLanes|=p&~(b&~a))}function Do(n,a,l){n.pendingLanes|=a,n.suspendedLanes&=~a;var u=31-vr(a);n.entangledLanes|=a,n.entanglements[u]=n.entanglements[u]|1073741824|l&261930}function zs(n,a){var l=n.entangledLanes|=a;for(n=n.entanglements;l;){var u=31-vr(l),d=1<<u;d&a|n[u]&a&&(n[u]|=a),l&=~d}}function Fo(n,a){var l=a&-a;return l=(l&42)!==0?1:Zi(l),(l&(n.suspendedLanes|a))!==0?0:l}function Zi(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function el(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function T(){var n=ve.p;return n!==0?n:(n=window.event,n===void 0?32:Tp(n.type))}function L(n,a){var l=ve.p;try{return ve.p=n,a()}finally{ve.p=l}}var R=Math.random().toString(36).slice(2),j="__reactFiber$"+R,D="__reactProps$"+R,B="__reactContainer$"+R,te="__reactEvents$"+R,me="__reactListeners$"+R,re="__reactHandles$"+R,ae="__reactResources$"+R,ie="__reactMarker$"+R;function Se(n){delete n[j],delete n[D],delete n[te],delete n[me],delete n[re]}function Ce(n){var a=n[j];if(a)return a;for(var l=n.parentNode;l;){if(a=l[B]||l[j]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(n=cp(n);n!==null;){if(l=n[j])return l;n=cp(n)}return a}n=l,l=n.parentNode}return null}function Fe(n){if(n=n[j]||n[B]){var a=n.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return n}return null}function Te(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(s(33))}function ke(n){var a=n[ae];return a||(a=n[ae]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Me(n){n[ie]=!0}var yt=new Set,wt={};function Nt(n,a){en(n,a),en(n+"Capture",a)}function en(n,a){for(wt[n]=a,n=0;n<a.length;n++)yt.add(a[n])}var rs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),va={},Cn={};function tl(n){return Wt.call(Cn,n)?!0:Wt.call(va,n)?!1:rs.test(n)?Cn[n]=!0:(va[n]=!0,!1)}function Tr(n,a,l){if(tl(a))if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+l)}}function Lo(n,a,l){if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+l)}}function Hn(n,a,l,u){if(u===null)n.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(a,l,""+u)}}function tn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Kd(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function A2(n,a,l){var u=Object.getOwnPropertyDescriptor(n.constructor.prototype,a);if(!n.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var d=u.get,p=u.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return d.call(this)},set:function(b){l=""+b,p.call(this,b)}}),Object.defineProperty(n,a,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(b){l=""+b},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function l0(n){if(!n._valueTracker){var a=Kd(n)?"checked":"value";n._valueTracker=A2(n,a,""+n[a])}}function Wd(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return n&&(u=Kd(n)?n.checked?"true":"false":n.value),n=u,n!==l?(a.setValue(n),!0):!1}function Io(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var N2=/[\n"\\]/g;function rn(n){return n.replace(N2,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function o0(n,a,l,u,d,p,b,A){n.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?n.type=b:n.removeAttribute("type"),a!=null?b==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+tn(a)):n.value!==""+tn(a)&&(n.value=""+tn(a)):b!=="submit"&&b!=="reset"||n.removeAttribute("value"),a!=null?c0(n,b,tn(a)):l!=null?c0(n,b,tn(l)):u!=null&&n.removeAttribute("value"),d==null&&p!=null&&(n.defaultChecked=!!p),d!=null&&(n.checked=d&&typeof d!="function"&&typeof d!="symbol"),A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?n.name=""+tn(A):n.removeAttribute("name")}function Xd(n,a,l,u,d,p,b,A){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(n.type=p),a!=null||l!=null){if(!(p!=="submit"&&p!=="reset"||a!=null)){l0(n);return}l=l!=null?""+tn(l):"",a=a!=null?""+tn(a):l,A||a===n.value||(n.value=a),n.defaultValue=a}u=u??d,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=A?n.checked:!!u,n.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.name=b),l0(n)}function c0(n,a,l){a==="number"&&Io(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function Hs(n,a,l,u){if(n=n.options,a){a={};for(var d=0;d<l.length;d++)a["$"+l[d]]=!0;for(l=0;l<n.length;l++)d=a.hasOwnProperty("$"+n[l].value),n[l].selected!==d&&(n[l].selected=d),d&&u&&(n[l].defaultSelected=!0)}else{for(l=""+tn(l),a=null,d=0;d<n.length;d++){if(n[d].value===l){n[d].selected=!0,u&&(n[d].defaultSelected=!0);return}a!==null||n[d].disabled||(a=n[d])}a!==null&&(a.selected=!0)}}function Yd(n,a,l){if(a!=null&&(a=""+tn(a),a!==n.value&&(n.value=a),l==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=l!=null?""+tn(l):""}function Jd(n,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(s(92));if(Ee(u)){if(1<u.length)throw Error(s(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=tn(a),n.defaultValue=l,u=n.textContent,u===l&&u!==""&&u!==null&&(n.value=u),l0(n)}function $s(n,a){if(a){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=a;return}}n.textContent=a}var O2=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Qd(n,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":u?n.setProperty(a,l):typeof l!="number"||l===0||O2.has(a)?a==="float"?n.cssFloat=l:n[a]=(""+l).trim():n[a]=l+"px"}function Zd(n,a,l){if(a!=null&&typeof a!="object")throw Error(s(62));if(n=n.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var d in a)u=a[d],a.hasOwnProperty(d)&&l[d]!==u&&Qd(n,d,u)}else for(var p in a)a.hasOwnProperty(p)&&Qd(n,p,a[p])}function u0(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var C2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),R2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bo(n){return R2.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function $n(){}var f0=null;function h0(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Gs=null,Vs=null;function em(n){var a=Fe(n);if(a&&(n=a.stateNode)){var l=n[D]||null;e:switch(n=a.stateNode,a.type){case"input":if(o0(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+rn(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==n&&u.form===n.form){var d=u[D]||null;if(!d)throw Error(s(90));o0(u,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===n.form&&Wd(u)}break e;case"textarea":Yd(n,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&Hs(n,!!l.multiple,a,!1)}}}var d0=!1;function tm(n,a,l){if(d0)return n(a,l);d0=!0;try{var u=n(a);return u}finally{if(d0=!1,(Gs!==null||Vs!==null)&&(Ec(),Gs&&(a=Gs,n=Vs,Vs=Gs=null,em(a),n)))for(a=0;a<n.length;a++)em(n[a])}}function rl(n,a){var l=n.stateNode;if(l===null)return null;var u=l[D]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(s(231,a,typeof l));return l}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m0=!1;if(Gn)try{var nl={};Object.defineProperty(nl,"passive",{get:function(){m0=!0}}),window.addEventListener("test",nl,nl),window.removeEventListener("test",nl,nl)}catch{m0=!1}var _a=null,g0=null,Mo=null;function rm(){if(Mo)return Mo;var n,a=g0,l=a.length,u,d="value"in _a?_a.value:_a.textContent,p=d.length;for(n=0;n<l&&a[n]===d[n];n++);var b=l-n;for(u=1;u<=b&&a[l-u]===d[p-u];u++);return Mo=d.slice(n,1<u?1-u:void 0)}function Uo(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function Po(){return!0}function nm(){return!1}function Ar(n){function a(l,u,d,p,b){this._reactName=l,this._targetInst=d,this.type=u,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var A in n)n.hasOwnProperty(A)&&(l=n[A],this[A]=l?l(p):p[A]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Po:nm,this.isPropagationStopped=nm,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Po)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Po)},persist:function(){},isPersistent:Po}),a}var ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zo=Ar(ns),al=v({},ns,{view:0,detail:0}),j2=Ar(al),p0,x0,sl,Ho=v({},al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_0,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==sl&&(sl&&n.type==="mousemove"?(p0=n.screenX-sl.screenX,x0=n.screenY-sl.screenY):x0=p0=0,sl=n),p0)},movementY:function(n){return"movementY"in n?n.movementY:x0}}),am=Ar(Ho),k2=v({},Ho,{dataTransfer:0}),D2=Ar(k2),F2=v({},al,{relatedTarget:0}),v0=Ar(F2),L2=v({},ns,{animationName:0,elapsedTime:0,pseudoElement:0}),I2=Ar(L2),B2=v({},ns,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),M2=Ar(B2),U2=v({},ns,{data:0}),sm=Ar(U2),P2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $2(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=H2[n])?!!a[n]:!1}function _0(){return $2}var G2=v({},al,{key:function(n){if(n.key){var a=P2[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Uo(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?z2[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_0,charCode:function(n){return n.type==="keypress"?Uo(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Uo(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),V2=Ar(G2),q2=v({},Ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),im=Ar(q2),K2=v({},al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_0}),W2=Ar(K2),X2=v({},ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y2=Ar(X2),J2=v({},Ho,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Q2=Ar(J2),Z2=v({},ns,{newState:0,oldState:0}),ew=Ar(Z2),tw=[9,13,27,32],y0=Gn&&"CompositionEvent"in window,il=null;Gn&&"documentMode"in document&&(il=document.documentMode);var rw=Gn&&"TextEvent"in window&&!il,lm=Gn&&(!y0||il&&8<il&&11>=il),om=" ",cm=!1;function um(n,a){switch(n){case"keyup":return tw.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fm(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var qs=!1;function nw(n,a){switch(n){case"compositionend":return fm(a);case"keypress":return a.which!==32?null:(cm=!0,om);case"textInput":return n=a.data,n===om&&cm?null:n;default:return null}}function aw(n,a){if(qs)return n==="compositionend"||!y0&&um(n,a)?(n=rm(),Mo=g0=_a=null,qs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return lm&&a.locale!=="ko"?null:a.data;default:return null}}var sw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hm(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!sw[n.type]:a==="textarea"}function dm(n,a,l,u){Gs?Vs?Vs.push(u):Vs=[u]:Gs=u,a=jc(a,"onChange"),0<a.length&&(l=new zo("onChange","change",null,l,u),n.push({event:l,listeners:a}))}var ll=null,ol=null;function iw(n){X1(n,0)}function $o(n){var a=Te(n);if(Wd(a))return n}function mm(n,a){if(n==="change")return a}var gm=!1;if(Gn){var w0;if(Gn){var b0="oninput"in document;if(!b0){var pm=document.createElement("div");pm.setAttribute("oninput","return;"),b0=typeof pm.oninput=="function"}w0=b0}else w0=!1;gm=w0&&(!document.documentMode||9<document.documentMode)}function xm(){ll&&(ll.detachEvent("onpropertychange",vm),ol=ll=null)}function vm(n){if(n.propertyName==="value"&&$o(ol)){var a=[];dm(a,ol,n,h0(n)),tm(iw,a)}}function lw(n,a,l){n==="focusin"?(xm(),ll=a,ol=l,ll.attachEvent("onpropertychange",vm)):n==="focusout"&&xm()}function ow(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return $o(ol)}function cw(n,a){if(n==="click")return $o(a)}function uw(n,a){if(n==="input"||n==="change")return $o(a)}function fw(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Ur=typeof Object.is=="function"?Object.is:fw;function cl(n,a){if(Ur(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var l=Object.keys(n),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var d=l[u];if(!Wt.call(a,d)||!Ur(n[d],a[d]))return!1}return!0}function _m(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function ym(n,a){var l=_m(n);n=0;for(var u;l;){if(l.nodeType===3){if(u=n+l.textContent.length,n<=a&&u>=a)return{node:l,offset:a-n};n=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=_m(l)}}function wm(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?wm(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function bm(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=Io(n.document);a instanceof n.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)n=a.contentWindow;else break;a=Io(n.document)}return a}function S0(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var hw=Gn&&"documentMode"in document&&11>=document.documentMode,Ks=null,E0=null,ul=null,T0=!1;function Sm(n,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;T0||Ks==null||Ks!==Io(u)||(u=Ks,"selectionStart"in u&&S0(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),ul&&cl(ul,u)||(ul=u,u=jc(E0,"onSelect"),0<u.length&&(a=new zo("onSelect","select",null,a,l),n.push({event:a,listeners:u}),a.target=Ks)))}function as(n,a){var l={};return l[n.toLowerCase()]=a.toLowerCase(),l["Webkit"+n]="webkit"+a,l["Moz"+n]="moz"+a,l}var Ws={animationend:as("Animation","AnimationEnd"),animationiteration:as("Animation","AnimationIteration"),animationstart:as("Animation","AnimationStart"),transitionrun:as("Transition","TransitionRun"),transitionstart:as("Transition","TransitionStart"),transitioncancel:as("Transition","TransitionCancel"),transitionend:as("Transition","TransitionEnd")},A0={},Em={};Gn&&(Em=document.createElement("div").style,"AnimationEvent"in window||(delete Ws.animationend.animation,delete Ws.animationiteration.animation,delete Ws.animationstart.animation),"TransitionEvent"in window||delete Ws.transitionend.transition);function ss(n){if(A0[n])return A0[n];if(!Ws[n])return n;var a=Ws[n],l;for(l in a)if(a.hasOwnProperty(l)&&l in Em)return A0[n]=a[l];return n}var Tm=ss("animationend"),Am=ss("animationiteration"),Nm=ss("animationstart"),dw=ss("transitionrun"),mw=ss("transitionstart"),gw=ss("transitioncancel"),Om=ss("transitionend"),Cm=new Map,N0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");N0.push("scrollEnd");function pn(n,a){Cm.set(n,a),Nt(a,[n])}var Go=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},nn=[],Xs=0,O0=0;function Vo(){for(var n=Xs,a=O0=Xs=0;a<n;){var l=nn[a];nn[a++]=null;var u=nn[a];nn[a++]=null;var d=nn[a];nn[a++]=null;var p=nn[a];if(nn[a++]=null,u!==null&&d!==null){var b=u.pending;b===null?d.next=d:(d.next=b.next,b.next=d),u.pending=d}p!==0&&Rm(l,d,p)}}function qo(n,a,l,u){nn[Xs++]=n,nn[Xs++]=a,nn[Xs++]=l,nn[Xs++]=u,O0|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function C0(n,a,l,u){return qo(n,a,l,u),Ko(n)}function is(n,a){return qo(n,null,null,a),Ko(n)}function Rm(n,a,l){n.lanes|=l;var u=n.alternate;u!==null&&(u.lanes|=l);for(var d=!1,p=n.return;p!==null;)p.childLanes|=l,u=p.alternate,u!==null&&(u.childLanes|=l),p.tag===22&&(n=p.stateNode,n===null||n._visibility&1||(d=!0)),n=p,p=p.return;return n.tag===3?(p=n.stateNode,d&&a!==null&&(d=31-vr(l),n=p.hiddenUpdates,u=n[d],u===null?n[d]=[a]:u.push(a),a.lane=l|536870912),p):null}function Ko(n){if(50<kl)throw kl=0,Uf=null,Error(s(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var Ys={};function pw(n,a,l,u){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pr(n,a,l,u){return new pw(n,a,l,u)}function R0(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Vn(n,a){var l=n.alternate;return l===null?(l=Pr(n.tag,a,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=a,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,a=n.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function jm(n,a){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,a=l.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function Wo(n,a,l,u,d,p){var b=0;if(u=n,typeof n=="function")R0(n)&&(b=1);else if(typeof n=="string")b=wb(n,l,C.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case z:return n=Pr(31,l,a,d),n.elementType=z,n.lanes=p,n;case w:return ls(l.children,d,p,a);case S:b=8,d|=24;break;case k:return n=Pr(12,l,a,d|2),n.elementType=k,n.lanes=p,n;case q:return n=Pr(13,l,a,d),n.elementType=q,n.lanes=p,n;case K:return n=Pr(19,l,a,d),n.elementType=K,n.lanes=p,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case O:b=10;break e;case M:b=9;break e;case G:b=11;break e;case F:b=14;break e;case X:b=16,u=null;break e}b=29,l=Error(s(130,n===null?"null":typeof n,"")),u=null}return a=Pr(b,l,a,d),a.elementType=n,a.type=u,a.lanes=p,a}function ls(n,a,l,u){return n=Pr(7,n,u,a),n.lanes=l,n}function j0(n,a,l){return n=Pr(6,n,null,a),n.lanes=l,n}function km(n){var a=Pr(18,null,null,0);return a.stateNode=n,a}function k0(n,a,l){return a=Pr(4,n.children!==null?n.children:[],n.key,a),a.lanes=l,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var Dm=new WeakMap;function an(n,a){if(typeof n=="object"&&n!==null){var l=Dm.get(n);return l!==void 0?l:(a={value:n,source:a,stack:Zt(a)},Dm.set(n,a),a)}return{value:n,source:a,stack:Zt(a)}}var Js=[],Qs=0,Xo=null,fl=0,sn=[],ln=0,ya=null,Rn=1,jn="";function qn(n,a){Js[Qs++]=fl,Js[Qs++]=Xo,Xo=n,fl=a}function Fm(n,a,l){sn[ln++]=Rn,sn[ln++]=jn,sn[ln++]=ya,ya=n;var u=Rn;n=jn;var d=32-vr(u)-1;u&=~(1<<d),l+=1;var p=32-vr(a)+d;if(30<p){var b=d-d%5;p=(u&(1<<b)-1).toString(32),u>>=b,d-=b,Rn=1<<32-vr(a)+d|l<<d|u,jn=p+n}else Rn=1<<p|l<<d|u,jn=n}function D0(n){n.return!==null&&(qn(n,1),Fm(n,1,0))}function F0(n){for(;n===Xo;)Xo=Js[--Qs],Js[Qs]=null,fl=Js[--Qs],Js[Qs]=null;for(;n===ya;)ya=sn[--ln],sn[ln]=null,jn=sn[--ln],sn[ln]=null,Rn=sn[--ln],sn[ln]=null}function Lm(n,a){sn[ln++]=Rn,sn[ln++]=jn,sn[ln++]=ya,Rn=a.id,jn=a.overflow,ya=n}var er=null,St=null,tt=!1,wa=null,on=!1,L0=Error(s(519));function ba(n){var a=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hl(an(a,n)),L0}function Im(n){var a=n.stateNode,l=n.type,u=n.memoizedProps;switch(a[j]=n,a[D]=u,l){case"dialog":Qe("cancel",a),Qe("close",a);break;case"iframe":case"object":case"embed":Qe("load",a);break;case"video":case"audio":for(l=0;l<Fl.length;l++)Qe(Fl[l],a);break;case"source":Qe("error",a);break;case"img":case"image":case"link":Qe("error",a),Qe("load",a);break;case"details":Qe("toggle",a);break;case"input":Qe("invalid",a),Xd(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Qe("invalid",a);break;case"textarea":Qe("invalid",a),Jd(a,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||Z1(a.textContent,l)?(u.popover!=null&&(Qe("beforetoggle",a),Qe("toggle",a)),u.onScroll!=null&&Qe("scroll",a),u.onScrollEnd!=null&&Qe("scrollend",a),u.onClick!=null&&(a.onclick=$n),a=!0):a=!1,a||ba(n,!0)}function Bm(n){for(er=n.return;er;)switch(er.tag){case 5:case 31:case 13:on=!1;return;case 27:case 3:on=!0;return;default:er=er.return}}function Zs(n){if(n!==er)return!1;if(!tt)return Bm(n),tt=!0,!1;var a=n.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||eh(n.type,n.memoizedProps)),l=!l),l&&St&&ba(n),Bm(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(317));St=op(n)}else if(a===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(317));St=op(n)}else a===27?(a=St,Ia(n.type)?(n=sh,sh=null,St=n):St=a):St=er?un(n.stateNode.nextSibling):null;return!0}function os(){St=er=null,tt=!1}function I0(){var n=wa;return n!==null&&(Rr===null?Rr=n:Rr.push.apply(Rr,n),wa=null),n}function hl(n){wa===null?wa=[n]:wa.push(n)}var B0=U(null),cs=null,Kn=null;function Sa(n,a,l){P(B0,a._currentValue),a._currentValue=l}function Wn(n){n._currentValue=B0.current,N(B0)}function M0(n,a,l){for(;n!==null;){var u=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),n===l)break;n=n.return}}function U0(n,a,l,u){var d=n.child;for(d!==null&&(d.return=n);d!==null;){var p=d.dependencies;if(p!==null){var b=d.child;p=p.firstContext;e:for(;p!==null;){var A=p;p=d;for(var H=0;H<a.length;H++)if(A.context===a[H]){p.lanes|=l,A=p.alternate,A!==null&&(A.lanes|=l),M0(p.return,l,n),u||(b=null);break e}p=A.next}}else if(d.tag===18){if(b=d.return,b===null)throw Error(s(341));b.lanes|=l,p=b.alternate,p!==null&&(p.lanes|=l),M0(b,l,n),b=null}else b=d.child;if(b!==null)b.return=d;else for(b=d;b!==null;){if(b===n){b=null;break}if(d=b.sibling,d!==null){d.return=b.return,b=d;break}b=b.return}d=b}}function ei(n,a,l,u){n=null;for(var d=a,p=!1;d!==null;){if(!p){if((d.flags&524288)!==0)p=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var b=d.alternate;if(b===null)throw Error(s(387));if(b=b.memoizedProps,b!==null){var A=d.type;Ur(d.pendingProps.value,b.value)||(n!==null?n.push(A):n=[A])}}else if(d===ye.current){if(b=d.alternate,b===null)throw Error(s(387));b.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(n!==null?n.push(Ul):n=[Ul])}d=d.return}n!==null&&U0(a,n,l,u),a.flags|=262144}function Yo(n){for(n=n.firstContext;n!==null;){if(!Ur(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function us(n){cs=n,Kn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function tr(n){return Mm(cs,n)}function Jo(n,a){return cs===null&&us(n),Mm(n,a)}function Mm(n,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Kn===null){if(n===null)throw Error(s(308));Kn=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else Kn=Kn.next=a;return l}var xw=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(l,u){n.push(u)}};this.abort=function(){a.aborted=!0,n.forEach(function(l){return l()})}},vw=r.unstable_scheduleCallback,_w=r.unstable_NormalPriority,Bt={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function P0(){return{controller:new xw,data:new Map,refCount:0}}function dl(n){n.refCount--,n.refCount===0&&vw(_w,function(){n.controller.abort()})}var ml=null,z0=0,ti=0,ri=null;function yw(n,a){if(ml===null){var l=ml=[];z0=0,ti=Vf(),ri={status:"pending",value:void 0,then:function(u){l.push(u)}}}return z0++,a.then(Um,Um),a}function Um(){if(--z0===0&&ml!==null){ri!==null&&(ri.status="fulfilled");var n=ml;ml=null,ti=0,ri=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function ww(n,a){var l=[],u={status:"pending",value:null,reason:null,then:function(d){l.push(d)}};return n.then(function(){u.status="fulfilled",u.value=a;for(var d=0;d<l.length;d++)(0,l[d])(a)},function(d){for(u.status="rejected",u.reason=d,d=0;d<l.length;d++)(0,l[d])(void 0)}),u}var Pm=J.S;J.S=function(n,a){S1=vt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&yw(n,a),Pm!==null&&Pm(n,a)};var fs=U(null);function H0(){var n=fs.current;return n!==null?n:_t.pooledCache}function Qo(n,a){a===null?P(fs,fs.current):P(fs,a.pool)}function zm(){var n=H0();return n===null?null:{parent:Bt._currentValue,pool:n}}var ni=Error(s(460)),$0=Error(s(474)),Zo=Error(s(542)),ec={then:function(){}};function Hm(n){return n=n.status,n==="fulfilled"||n==="rejected"}function $m(n,a,l){switch(l=n[l],l===void 0?n.push(a):l!==a&&(a.then($n,$n),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,Vm(n),n;default:if(typeof a.status=="string")a.then($n,$n);else{if(n=_t,n!==null&&100<n.shellSuspendCounter)throw Error(s(482));n=a,n.status="pending",n.then(function(u){if(a.status==="pending"){var d=a;d.status="fulfilled",d.value=u}},function(u){if(a.status==="pending"){var d=a;d.status="rejected",d.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,Vm(n),n}throw ds=a,ni}}function hs(n){try{var a=n._init;return a(n._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ds=l,ni):l}}var ds=null;function Gm(){if(ds===null)throw Error(s(459));var n=ds;return ds=null,n}function Vm(n){if(n===ni||n===Zo)throw Error(s(483))}var ai=null,gl=0;function tc(n){var a=gl;return gl+=1,ai===null&&(ai=[]),$m(ai,n,a)}function pl(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function rc(n,a){throw a.$$typeof===_?Error(s(525)):(n=Object.prototype.toString.call(a),Error(s(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function qm(n){function a(Y,V){if(n){var Q=Y.deletions;Q===null?(Y.deletions=[V],Y.flags|=16):Q.push(V)}}function l(Y,V){if(!n)return null;for(;V!==null;)a(Y,V),V=V.sibling;return null}function u(Y){for(var V=new Map;Y!==null;)Y.key!==null?V.set(Y.key,Y):V.set(Y.index,Y),Y=Y.sibling;return V}function d(Y,V){return Y=Vn(Y,V),Y.index=0,Y.sibling=null,Y}function p(Y,V,Q){return Y.index=Q,n?(Q=Y.alternate,Q!==null?(Q=Q.index,Q<V?(Y.flags|=67108866,V):Q):(Y.flags|=67108866,V)):(Y.flags|=1048576,V)}function b(Y){return n&&Y.alternate===null&&(Y.flags|=67108866),Y}function A(Y,V,Q,ge){return V===null||V.tag!==6?(V=j0(Q,Y.mode,ge),V.return=Y,V):(V=d(V,Q),V.return=Y,V)}function H(Y,V,Q,ge){var ze=Q.type;return ze===w?de(Y,V,Q.props.children,ge,Q.key):V!==null&&(V.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===X&&hs(ze)===V.type)?(V=d(V,Q.props),pl(V,Q),V.return=Y,V):(V=Wo(Q.type,Q.key,Q.props,null,Y.mode,ge),pl(V,Q),V.return=Y,V)}function ee(Y,V,Q,ge){return V===null||V.tag!==4||V.stateNode.containerInfo!==Q.containerInfo||V.stateNode.implementation!==Q.implementation?(V=k0(Q,Y.mode,ge),V.return=Y,V):(V=d(V,Q.children||[]),V.return=Y,V)}function de(Y,V,Q,ge,ze){return V===null||V.tag!==7?(V=ls(Q,Y.mode,ge,ze),V.return=Y,V):(V=d(V,Q),V.return=Y,V)}function xe(Y,V,Q){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=j0(""+V,Y.mode,Q),V.return=Y,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case y:return Q=Wo(V.type,V.key,V.props,null,Y.mode,Q),pl(Q,V),Q.return=Y,Q;case E:return V=k0(V,Y.mode,Q),V.return=Y,V;case X:return V=hs(V),xe(Y,V,Q)}if(Ee(V)||fe(V))return V=ls(V,Y.mode,Q,null),V.return=Y,V;if(typeof V.then=="function")return xe(Y,tc(V),Q);if(V.$$typeof===O)return xe(Y,Jo(Y,V),Q);rc(Y,V)}return null}function se(Y,V,Q,ge){var ze=V!==null?V.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return ze!==null?null:A(Y,V,""+Q,ge);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:return Q.key===ze?H(Y,V,Q,ge):null;case E:return Q.key===ze?ee(Y,V,Q,ge):null;case X:return Q=hs(Q),se(Y,V,Q,ge)}if(Ee(Q)||fe(Q))return ze!==null?null:de(Y,V,Q,ge,null);if(typeof Q.then=="function")return se(Y,V,tc(Q),ge);if(Q.$$typeof===O)return se(Y,V,Jo(Y,Q),ge);rc(Y,Q)}return null}function ue(Y,V,Q,ge,ze){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return Y=Y.get(Q)||null,A(V,Y,""+ge,ze);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case y:return Y=Y.get(ge.key===null?Q:ge.key)||null,H(V,Y,ge,ze);case E:return Y=Y.get(ge.key===null?Q:ge.key)||null,ee(V,Y,ge,ze);case X:return ge=hs(ge),ue(Y,V,Q,ge,ze)}if(Ee(ge)||fe(ge))return Y=Y.get(Q)||null,de(V,Y,ge,ze,null);if(typeof ge.then=="function")return ue(Y,V,Q,tc(ge),ze);if(ge.$$typeof===O)return ue(Y,V,Q,Jo(V,ge),ze);rc(V,ge)}return null}function Be(Y,V,Q,ge){for(var ze=null,rt=null,Ue=V,Xe=V=0,et=null;Ue!==null&&Xe<Q.length;Xe++){Ue.index>Xe?(et=Ue,Ue=null):et=Ue.sibling;var nt=se(Y,Ue,Q[Xe],ge);if(nt===null){Ue===null&&(Ue=et);break}n&&Ue&&nt.alternate===null&&a(Y,Ue),V=p(nt,V,Xe),rt===null?ze=nt:rt.sibling=nt,rt=nt,Ue=et}if(Xe===Q.length)return l(Y,Ue),tt&&qn(Y,Xe),ze;if(Ue===null){for(;Xe<Q.length;Xe++)Ue=xe(Y,Q[Xe],ge),Ue!==null&&(V=p(Ue,V,Xe),rt===null?ze=Ue:rt.sibling=Ue,rt=Ue);return tt&&qn(Y,Xe),ze}for(Ue=u(Ue);Xe<Q.length;Xe++)et=ue(Ue,Y,Xe,Q[Xe],ge),et!==null&&(n&&et.alternate!==null&&Ue.delete(et.key===null?Xe:et.key),V=p(et,V,Xe),rt===null?ze=et:rt.sibling=et,rt=et);return n&&Ue.forEach(function(za){return a(Y,za)}),tt&&qn(Y,Xe),ze}function $e(Y,V,Q,ge){if(Q==null)throw Error(s(151));for(var ze=null,rt=null,Ue=V,Xe=V=0,et=null,nt=Q.next();Ue!==null&&!nt.done;Xe++,nt=Q.next()){Ue.index>Xe?(et=Ue,Ue=null):et=Ue.sibling;var za=se(Y,Ue,nt.value,ge);if(za===null){Ue===null&&(Ue=et);break}n&&Ue&&za.alternate===null&&a(Y,Ue),V=p(za,V,Xe),rt===null?ze=za:rt.sibling=za,rt=za,Ue=et}if(nt.done)return l(Y,Ue),tt&&qn(Y,Xe),ze;if(Ue===null){for(;!nt.done;Xe++,nt=Q.next())nt=xe(Y,nt.value,ge),nt!==null&&(V=p(nt,V,Xe),rt===null?ze=nt:rt.sibling=nt,rt=nt);return tt&&qn(Y,Xe),ze}for(Ue=u(Ue);!nt.done;Xe++,nt=Q.next())nt=ue(Ue,Y,Xe,nt.value,ge),nt!==null&&(n&&nt.alternate!==null&&Ue.delete(nt.key===null?Xe:nt.key),V=p(nt,V,Xe),rt===null?ze=nt:rt.sibling=nt,rt=nt);return n&&Ue.forEach(function(kb){return a(Y,kb)}),tt&&qn(Y,Xe),ze}function pt(Y,V,Q,ge){if(typeof Q=="object"&&Q!==null&&Q.type===w&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:e:{for(var ze=Q.key;V!==null;){if(V.key===ze){if(ze=Q.type,ze===w){if(V.tag===7){l(Y,V.sibling),ge=d(V,Q.props.children),ge.return=Y,Y=ge;break e}}else if(V.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===X&&hs(ze)===V.type){l(Y,V.sibling),ge=d(V,Q.props),pl(ge,Q),ge.return=Y,Y=ge;break e}l(Y,V);break}else a(Y,V);V=V.sibling}Q.type===w?(ge=ls(Q.props.children,Y.mode,ge,Q.key),ge.return=Y,Y=ge):(ge=Wo(Q.type,Q.key,Q.props,null,Y.mode,ge),pl(ge,Q),ge.return=Y,Y=ge)}return b(Y);case E:e:{for(ze=Q.key;V!==null;){if(V.key===ze)if(V.tag===4&&V.stateNode.containerInfo===Q.containerInfo&&V.stateNode.implementation===Q.implementation){l(Y,V.sibling),ge=d(V,Q.children||[]),ge.return=Y,Y=ge;break e}else{l(Y,V);break}else a(Y,V);V=V.sibling}ge=k0(Q,Y.mode,ge),ge.return=Y,Y=ge}return b(Y);case X:return Q=hs(Q),pt(Y,V,Q,ge)}if(Ee(Q))return Be(Y,V,Q,ge);if(fe(Q)){if(ze=fe(Q),typeof ze!="function")throw Error(s(150));return Q=ze.call(Q),$e(Y,V,Q,ge)}if(typeof Q.then=="function")return pt(Y,V,tc(Q),ge);if(Q.$$typeof===O)return pt(Y,V,Jo(Y,Q),ge);rc(Y,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,V!==null&&V.tag===6?(l(Y,V.sibling),ge=d(V,Q),ge.return=Y,Y=ge):(l(Y,V),ge=j0(Q,Y.mode,ge),ge.return=Y,Y=ge),b(Y)):l(Y,V)}return function(Y,V,Q,ge){try{gl=0;var ze=pt(Y,V,Q,ge);return ai=null,ze}catch(Ue){if(Ue===ni||Ue===Zo)throw Ue;var rt=Pr(29,Ue,null,Y.mode);return rt.lanes=ge,rt.return=Y,rt}finally{}}}var ms=qm(!0),Km=qm(!1),Ea=!1;function G0(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function V0(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ta(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Aa(n,a,l){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(st&2)!==0){var d=u.pending;return d===null?a.next=a:(a.next=d.next,d.next=a),u.pending=a,a=Ko(n),Rm(n,null,l),a}return qo(n,u,a,l),Ko(n)}function xl(n,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=n.pendingLanes,l|=u,a.lanes=l,zs(n,l)}}function q0(n,a){var l=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var d=null,p=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};p===null?d=p=b:p=p.next=b,l=l.next}while(l!==null);p===null?d=p=a:p=p.next=a}else d=p=a;l={baseState:u.baseState,firstBaseUpdate:d,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=a:n.next=a,l.lastBaseUpdate=a}var K0=!1;function vl(){if(K0){var n=ri;if(n!==null)throw n}}function _l(n,a,l,u){K0=!1;var d=n.updateQueue;Ea=!1;var p=d.firstBaseUpdate,b=d.lastBaseUpdate,A=d.shared.pending;if(A!==null){d.shared.pending=null;var H=A,ee=H.next;H.next=null,b===null?p=ee:b.next=ee,b=H;var de=n.alternate;de!==null&&(de=de.updateQueue,A=de.lastBaseUpdate,A!==b&&(A===null?de.firstBaseUpdate=ee:A.next=ee,de.lastBaseUpdate=H))}if(p!==null){var xe=d.baseState;b=0,de=ee=H=null,A=p;do{var se=A.lane&-536870913,ue=se!==A.lane;if(ue?(Ze&se)===se:(u&se)===se){se!==0&&se===ti&&(K0=!0),de!==null&&(de=de.next={lane:0,tag:A.tag,payload:A.payload,callback:null,next:null});e:{var Be=n,$e=A;se=a;var pt=l;switch($e.tag){case 1:if(Be=$e.payload,typeof Be=="function"){xe=Be.call(pt,xe,se);break e}xe=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=$e.payload,se=typeof Be=="function"?Be.call(pt,xe,se):Be,se==null)break e;xe=v({},xe,se);break e;case 2:Ea=!0}}se=A.callback,se!==null&&(n.flags|=64,ue&&(n.flags|=8192),ue=d.callbacks,ue===null?d.callbacks=[se]:ue.push(se))}else ue={lane:se,tag:A.tag,payload:A.payload,callback:A.callback,next:null},de===null?(ee=de=ue,H=xe):de=de.next=ue,b|=se;if(A=A.next,A===null){if(A=d.shared.pending,A===null)break;ue=A,A=ue.next,ue.next=null,d.lastBaseUpdate=ue,d.shared.pending=null}}while(!0);de===null&&(H=xe),d.baseState=H,d.firstBaseUpdate=ee,d.lastBaseUpdate=de,p===null&&(d.shared.lanes=0),ja|=b,n.lanes=b,n.memoizedState=xe}}function Wm(n,a){if(typeof n!="function")throw Error(s(191,n));n.call(a)}function Xm(n,a){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)Wm(l[n],a)}var si=U(null),nc=U(0);function Ym(n,a){n=na,P(nc,n),P(si,a),na=n|a.baseLanes}function W0(){P(nc,na),P(si,si.current)}function X0(){na=nc.current,N(si),N(nc)}var zr=U(null),cn=null;function Na(n){var a=n.alternate;P(Ft,Ft.current&1),P(zr,n),cn===null&&(a===null||si.current!==null||a.memoizedState!==null)&&(cn=n)}function Y0(n){P(Ft,Ft.current),P(zr,n),cn===null&&(cn=n)}function Jm(n){n.tag===22?(P(Ft,Ft.current),P(zr,n),cn===null&&(cn=n)):Oa()}function Oa(){P(Ft,Ft.current),P(zr,zr.current)}function Hr(n){N(zr),cn===n&&(cn=null),N(Ft)}var Ft=U(0);function ac(n){for(var a=n;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||nh(l)||ah(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Xn=0,We=null,mt=null,Mt=null,sc=!1,ii=!1,gs=!1,ic=0,yl=0,li=null,bw=0;function Rt(){throw Error(s(321))}function J0(n,a){if(a===null)return!1;for(var l=0;l<a.length&&l<n.length;l++)if(!Ur(n[l],a[l]))return!1;return!0}function Q0(n,a,l,u,d,p){return Xn=p,We=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,J.H=n===null||n.memoizedState===null?Fg:mf,gs=!1,p=l(u,d),gs=!1,ii&&(p=Zm(a,l,u,d)),Qm(n),p}function Qm(n){J.H=Sl;var a=mt!==null&&mt.next!==null;if(Xn=0,Mt=mt=We=null,sc=!1,yl=0,li=null,a)throw Error(s(300));n===null||Ut||(n=n.dependencies,n!==null&&Yo(n)&&(Ut=!0))}function Zm(n,a,l,u){We=n;var d=0;do{if(ii&&(li=null),yl=0,ii=!1,25<=d)throw Error(s(301));if(d+=1,Mt=mt=null,n.updateQueue!=null){var p=n.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}J.H=Lg,p=a(l,u)}while(ii);return p}function Sw(){var n=J.H,a=n.useState()[0];return a=typeof a.then=="function"?wl(a):a,n=n.useState()[0],(mt!==null?mt.memoizedState:null)!==n&&(We.flags|=1024),a}function Z0(){var n=ic!==0;return ic=0,n}function ef(n,a,l){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~l}function tf(n){if(sc){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}sc=!1}Xn=0,Mt=mt=We=null,ii=!1,yl=ic=0,li=null}function _r(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?We.memoizedState=Mt=n:Mt=Mt.next=n,Mt}function Lt(){if(mt===null){var n=We.alternate;n=n!==null?n.memoizedState:null}else n=mt.next;var a=Mt===null?We.memoizedState:Mt.next;if(a!==null)Mt=a,mt=n;else{if(n===null)throw We.alternate===null?Error(s(467)):Error(s(310));mt=n,n={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Mt===null?We.memoizedState=Mt=n:Mt=Mt.next=n}return Mt}function lc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wl(n){var a=yl;return yl+=1,li===null&&(li=[]),n=$m(li,n,a),a=We,(Mt===null?a.memoizedState:Mt.next)===null&&(a=a.alternate,J.H=a===null||a.memoizedState===null?Fg:mf),n}function oc(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return wl(n);if(n.$$typeof===O)return tr(n)}throw Error(s(438,String(n)))}function rf(n){var a=null,l=We.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=We.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(d){return d.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=lc(),We.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(n),u=0;u<n;u++)l[u]=ne;return a.index++,l}function Yn(n,a){return typeof a=="function"?a(n):a}function cc(n){var a=Lt();return nf(a,mt,n)}function nf(n,a,l){var u=n.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=l;var d=n.baseQueue,p=u.pending;if(p!==null){if(d!==null){var b=d.next;d.next=p.next,p.next=b}a.baseQueue=d=p,u.pending=null}if(p=n.baseState,d===null)n.memoizedState=p;else{a=d.next;var A=b=null,H=null,ee=a,de=!1;do{var xe=ee.lane&-536870913;if(xe!==ee.lane?(Ze&xe)===xe:(Xn&xe)===xe){var se=ee.revertLane;if(se===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),xe===ti&&(de=!0);else if((Xn&se)===se){ee=ee.next,se===ti&&(de=!0);continue}else xe={lane:0,revertLane:ee.revertLane,gesture:null,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},H===null?(A=H=xe,b=p):H=H.next=xe,We.lanes|=se,ja|=se;xe=ee.action,gs&&l(p,xe),p=ee.hasEagerState?ee.eagerState:l(p,xe)}else se={lane:xe,revertLane:ee.revertLane,gesture:ee.gesture,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},H===null?(A=H=se,b=p):H=H.next=se,We.lanes|=xe,ja|=xe;ee=ee.next}while(ee!==null&&ee!==a);if(H===null?b=p:H.next=A,!Ur(p,n.memoizedState)&&(Ut=!0,de&&(l=ri,l!==null)))throw l;n.memoizedState=p,n.baseState=b,n.baseQueue=H,u.lastRenderedState=p}return d===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function af(n){var a=Lt(),l=a.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=n;var u=l.dispatch,d=l.pending,p=a.memoizedState;if(d!==null){l.pending=null;var b=d=d.next;do p=n(p,b.action),b=b.next;while(b!==d);Ur(p,a.memoizedState)||(Ut=!0),a.memoizedState=p,a.baseQueue===null&&(a.baseState=p),l.lastRenderedState=p}return[p,u]}function eg(n,a,l){var u=We,d=Lt(),p=tt;if(p){if(l===void 0)throw Error(s(407));l=l()}else l=a();var b=!Ur((mt||d).memoizedState,l);if(b&&(d.memoizedState=l,Ut=!0),d=d.queue,of(ng.bind(null,u,d,n),[n]),d.getSnapshot!==a||b||Mt!==null&&Mt.memoizedState.tag&1){if(u.flags|=2048,oi(9,{destroy:void 0},rg.bind(null,u,d,l,a),null),_t===null)throw Error(s(349));p||(Xn&127)!==0||tg(u,a,l)}return l}function tg(n,a,l){n.flags|=16384,n={getSnapshot:a,value:l},a=We.updateQueue,a===null?(a=lc(),We.updateQueue=a,a.stores=[n]):(l=a.stores,l===null?a.stores=[n]:l.push(n))}function rg(n,a,l,u){a.value=l,a.getSnapshot=u,ag(a)&&sg(n)}function ng(n,a,l){return l(function(){ag(a)&&sg(n)})}function ag(n){var a=n.getSnapshot;n=n.value;try{var l=a();return!Ur(n,l)}catch{return!0}}function sg(n){var a=is(n,2);a!==null&&jr(a,n,2)}function sf(n){var a=_r();if(typeof n=="function"){var l=n;if(n=l(),gs){gn(!0);try{l()}finally{gn(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:n},a}function ig(n,a,l,u){return n.baseState=l,nf(n,mt,typeof u=="function"?u:Yn)}function Ew(n,a,l,u,d){if(hc(n))throw Error(s(485));if(n=a.action,n!==null){var p={payload:d,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};J.T!==null?l(!0):p.isTransition=!1,u(p),l=a.pending,l===null?(p.next=a.pending=p,lg(a,p)):(p.next=l.next,a.pending=l.next=p)}}function lg(n,a){var l=a.action,u=a.payload,d=n.state;if(a.isTransition){var p=J.T,b={};J.T=b;try{var A=l(d,u),H=J.S;H!==null&&H(b,A),og(n,a,A)}catch(ee){lf(n,a,ee)}finally{p!==null&&b.types!==null&&(p.types=b.types),J.T=p}}else try{p=l(d,u),og(n,a,p)}catch(ee){lf(n,a,ee)}}function og(n,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){cg(n,a,u)},function(u){return lf(n,a,u)}):cg(n,a,l)}function cg(n,a,l){a.status="fulfilled",a.value=l,ug(a),n.state=l,a=n.pending,a!==null&&(l=a.next,l===a?n.pending=null:(l=l.next,a.next=l,lg(n,l)))}function lf(n,a,l){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,ug(a),a=a.next;while(a!==u)}n.action=null}function ug(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function fg(n,a){return a}function hg(n,a){if(tt){var l=_t.formState;if(l!==null){e:{var u=We;if(tt){if(St){t:{for(var d=St,p=on;d.nodeType!==8;){if(!p){d=null;break t}if(d=un(d.nextSibling),d===null){d=null;break t}}p=d.data,d=p==="F!"||p==="F"?d:null}if(d){St=un(d.nextSibling),u=d.data==="F!";break e}}ba(u)}u=!1}u&&(a=l[0])}}return l=_r(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fg,lastRenderedState:a},l.queue=u,l=jg.bind(null,We,u),u.dispatch=l,u=sf(!1),p=df.bind(null,We,!1,u.queue),u=_r(),d={state:a,dispatch:null,action:n,pending:null},u.queue=d,l=Ew.bind(null,We,d,p,l),d.dispatch=l,u.memoizedState=n,[a,l,!1]}function dg(n){var a=Lt();return mg(a,mt,n)}function mg(n,a,l){if(a=nf(n,a,fg)[0],n=cc(Yn)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=wl(a)}catch(b){throw b===ni?Zo:b}else u=a;a=Lt();var d=a.queue,p=d.dispatch;return l!==a.memoizedState&&(We.flags|=2048,oi(9,{destroy:void 0},Tw.bind(null,d,l),null)),[u,p,n]}function Tw(n,a){n.action=a}function gg(n){var a=Lt(),l=mt;if(l!==null)return mg(a,l,n);Lt(),a=a.memoizedState,l=Lt();var u=l.queue.dispatch;return l.memoizedState=n,[a,u,!1]}function oi(n,a,l,u){return n={tag:n,create:l,deps:u,inst:a,next:null},a=We.updateQueue,a===null&&(a=lc(),We.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=n.next=n:(u=l.next,l.next=n,n.next=u,a.lastEffect=n),n}function pg(){return Lt().memoizedState}function uc(n,a,l,u){var d=_r();We.flags|=n,d.memoizedState=oi(1|a,{destroy:void 0},l,u===void 0?null:u)}function fc(n,a,l,u){var d=Lt();u=u===void 0?null:u;var p=d.memoizedState.inst;mt!==null&&u!==null&&J0(u,mt.memoizedState.deps)?d.memoizedState=oi(a,p,l,u):(We.flags|=n,d.memoizedState=oi(1|a,p,l,u))}function xg(n,a){uc(8390656,8,n,a)}function of(n,a){fc(2048,8,n,a)}function Aw(n){We.flags|=4;var a=We.updateQueue;if(a===null)a=lc(),We.updateQueue=a,a.events=[n];else{var l=a.events;l===null?a.events=[n]:l.push(n)}}function vg(n){var a=Lt().memoizedState;return Aw({ref:a,nextImpl:n}),function(){if((st&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}function _g(n,a){return fc(4,2,n,a)}function yg(n,a){return fc(4,4,n,a)}function wg(n,a){if(typeof a=="function"){n=n();var l=a(n);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function bg(n,a,l){l=l!=null?l.concat([n]):null,fc(4,4,wg.bind(null,a,n),l)}function cf(){}function Sg(n,a){var l=Lt();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&J0(a,u[1])?u[0]:(l.memoizedState=[n,a],n)}function Eg(n,a){var l=Lt();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&J0(a,u[1]))return u[0];if(u=n(),gs){gn(!0);try{n()}finally{gn(!1)}}return l.memoizedState=[u,a],u}function uf(n,a,l){return l===void 0||(Xn&1073741824)!==0&&(Ze&261930)===0?n.memoizedState=a:(n.memoizedState=l,n=T1(),We.lanes|=n,ja|=n,l)}function Tg(n,a,l,u){return Ur(l,a)?l:si.current!==null?(n=uf(n,l,u),Ur(n,a)||(Ut=!0),n):(Xn&42)===0||(Xn&1073741824)!==0&&(Ze&261930)===0?(Ut=!0,n.memoizedState=l):(n=T1(),We.lanes|=n,ja|=n,a)}function Ag(n,a,l,u,d){var p=ve.p;ve.p=p!==0&&8>p?p:8;var b=J.T,A={};J.T=A,df(n,!1,a,l);try{var H=d(),ee=J.S;if(ee!==null&&ee(A,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var de=ww(H,u);bl(n,a,de,Vr(n))}else bl(n,a,u,Vr(n))}catch(xe){bl(n,a,{then:function(){},status:"rejected",reason:xe},Vr())}finally{ve.p=p,b!==null&&A.types!==null&&(b.types=A.types),J.T=b}}function Nw(){}function ff(n,a,l,u){if(n.tag!==5)throw Error(s(476));var d=Ng(n).queue;Ag(n,d,a,le,l===null?Nw:function(){return Og(n),l(u)})}function Ng(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:le},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:l},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function Og(n){var a=Ng(n);a.next===null&&(a=n.alternate.memoizedState),bl(n,a.next.queue,{},Vr())}function hf(){return tr(Ul)}function Cg(){return Lt().memoizedState}function Rg(){return Lt().memoizedState}function Ow(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var l=Vr();n=Ta(l);var u=Aa(a,n,l);u!==null&&(jr(u,a,l),xl(u,a,l)),a={cache:P0()},n.payload=a;return}a=a.return}}function Cw(n,a,l){var u=Vr();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},hc(n)?kg(a,l):(l=C0(n,a,l,u),l!==null&&(jr(l,n,u),Dg(l,a,u)))}function jg(n,a,l){var u=Vr();bl(n,a,l,u)}function bl(n,a,l,u){var d={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(hc(n))kg(a,d);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=a.lastRenderedReducer,p!==null))try{var b=a.lastRenderedState,A=p(b,l);if(d.hasEagerState=!0,d.eagerState=A,Ur(A,b))return qo(n,a,d,0),_t===null&&Vo(),!1}catch{}finally{}if(l=C0(n,a,d,u),l!==null)return jr(l,n,u),Dg(l,a,u),!0}return!1}function df(n,a,l,u){if(u={lane:2,revertLane:Vf(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},hc(n)){if(a)throw Error(s(479))}else a=C0(n,l,u,2),a!==null&&jr(a,n,2)}function hc(n){var a=n.alternate;return n===We||a!==null&&a===We}function kg(n,a){ii=sc=!0;var l=n.pending;l===null?a.next=a:(a.next=l.next,l.next=a),n.pending=a}function Dg(n,a,l){if((l&4194048)!==0){var u=a.lanes;u&=n.pendingLanes,l|=u,a.lanes=l,zs(n,l)}}var Sl={readContext:tr,use:oc,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useLayoutEffect:Rt,useInsertionEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useSyncExternalStore:Rt,useId:Rt,useHostTransitionStatus:Rt,useFormState:Rt,useActionState:Rt,useOptimistic:Rt,useMemoCache:Rt,useCacheRefresh:Rt};Sl.useEffectEvent=Rt;var Fg={readContext:tr,use:oc,useCallback:function(n,a){return _r().memoizedState=[n,a===void 0?null:a],n},useContext:tr,useEffect:xg,useImperativeHandle:function(n,a,l){l=l!=null?l.concat([n]):null,uc(4194308,4,wg.bind(null,a,n),l)},useLayoutEffect:function(n,a){return uc(4194308,4,n,a)},useInsertionEffect:function(n,a){uc(4,2,n,a)},useMemo:function(n,a){var l=_r();a=a===void 0?null:a;var u=n();if(gs){gn(!0);try{n()}finally{gn(!1)}}return l.memoizedState=[u,a],u},useReducer:function(n,a,l){var u=_r();if(l!==void 0){var d=l(a);if(gs){gn(!0);try{l(a)}finally{gn(!1)}}}else d=a;return u.memoizedState=u.baseState=d,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:d},u.queue=n,n=n.dispatch=Cw.bind(null,We,n),[u.memoizedState,n]},useRef:function(n){var a=_r();return n={current:n},a.memoizedState=n},useState:function(n){n=sf(n);var a=n.queue,l=jg.bind(null,We,a);return a.dispatch=l,[n.memoizedState,l]},useDebugValue:cf,useDeferredValue:function(n,a){var l=_r();return uf(l,n,a)},useTransition:function(){var n=sf(!1);return n=Ag.bind(null,We,n.queue,!0,!1),_r().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,l){var u=We,d=_r();if(tt){if(l===void 0)throw Error(s(407));l=l()}else{if(l=a(),_t===null)throw Error(s(349));(Ze&127)!==0||tg(u,a,l)}d.memoizedState=l;var p={value:l,getSnapshot:a};return d.queue=p,xg(ng.bind(null,u,p,n),[n]),u.flags|=2048,oi(9,{destroy:void 0},rg.bind(null,u,p,l,a),null),l},useId:function(){var n=_r(),a=_t.identifierPrefix;if(tt){var l=jn,u=Rn;l=(u&~(1<<32-vr(u)-1)).toString(32)+l,a="_"+a+"R_"+l,l=ic++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=bw++,a="_"+a+"r_"+l.toString(32)+"_";return n.memoizedState=a},useHostTransitionStatus:hf,useFormState:hg,useActionState:hg,useOptimistic:function(n){var a=_r();a.memoizedState=a.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=df.bind(null,We,!0,l),l.dispatch=a,[n,a]},useMemoCache:rf,useCacheRefresh:function(){return _r().memoizedState=Ow.bind(null,We)},useEffectEvent:function(n){var a=_r(),l={impl:n};return a.memoizedState=l,function(){if((st&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},mf={readContext:tr,use:oc,useCallback:Sg,useContext:tr,useEffect:of,useImperativeHandle:bg,useInsertionEffect:_g,useLayoutEffect:yg,useMemo:Eg,useReducer:cc,useRef:pg,useState:function(){return cc(Yn)},useDebugValue:cf,useDeferredValue:function(n,a){var l=Lt();return Tg(l,mt.memoizedState,n,a)},useTransition:function(){var n=cc(Yn)[0],a=Lt().memoizedState;return[typeof n=="boolean"?n:wl(n),a]},useSyncExternalStore:eg,useId:Cg,useHostTransitionStatus:hf,useFormState:dg,useActionState:dg,useOptimistic:function(n,a){var l=Lt();return ig(l,mt,n,a)},useMemoCache:rf,useCacheRefresh:Rg};mf.useEffectEvent=vg;var Lg={readContext:tr,use:oc,useCallback:Sg,useContext:tr,useEffect:of,useImperativeHandle:bg,useInsertionEffect:_g,useLayoutEffect:yg,useMemo:Eg,useReducer:af,useRef:pg,useState:function(){return af(Yn)},useDebugValue:cf,useDeferredValue:function(n,a){var l=Lt();return mt===null?uf(l,n,a):Tg(l,mt.memoizedState,n,a)},useTransition:function(){var n=af(Yn)[0],a=Lt().memoizedState;return[typeof n=="boolean"?n:wl(n),a]},useSyncExternalStore:eg,useId:Cg,useHostTransitionStatus:hf,useFormState:gg,useActionState:gg,useOptimistic:function(n,a){var l=Lt();return mt!==null?ig(l,mt,n,a):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:rf,useCacheRefresh:Rg};Lg.useEffectEvent=vg;function gf(n,a,l,u){a=n.memoizedState,l=l(u,a),l=l==null?a:v({},a,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var pf={enqueueSetState:function(n,a,l){n=n._reactInternals;var u=Vr(),d=Ta(u);d.payload=a,l!=null&&(d.callback=l),a=Aa(n,d,u),a!==null&&(jr(a,n,u),xl(a,n,u))},enqueueReplaceState:function(n,a,l){n=n._reactInternals;var u=Vr(),d=Ta(u);d.tag=1,d.payload=a,l!=null&&(d.callback=l),a=Aa(n,d,u),a!==null&&(jr(a,n,u),xl(a,n,u))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var l=Vr(),u=Ta(l);u.tag=2,a!=null&&(u.callback=a),a=Aa(n,u,l),a!==null&&(jr(a,n,l),xl(a,n,l))}};function Ig(n,a,l,u,d,p,b){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,p,b):a.prototype&&a.prototype.isPureReactComponent?!cl(l,u)||!cl(d,p):!0}function Bg(n,a,l,u){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==n&&pf.enqueueReplaceState(a,a.state,null)}function ps(n,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(n=n.defaultProps){l===a&&(l=v({},l));for(var d in n)l[d]===void 0&&(l[d]=n[d])}return l}function Mg(n){Go(n)}function Ug(n){console.error(n)}function Pg(n){Go(n)}function dc(n,a){try{var l=n.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function zg(n,a,l){try{var u=n.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function xf(n,a,l){return l=Ta(l),l.tag=3,l.payload={element:null},l.callback=function(){dc(n,a)},l}function Hg(n){return n=Ta(n),n.tag=3,n}function $g(n,a,l,u){var d=l.type.getDerivedStateFromError;if(typeof d=="function"){var p=u.value;n.payload=function(){return d(p)},n.callback=function(){zg(a,l,u)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(n.callback=function(){zg(a,l,u),typeof d!="function"&&(ka===null?ka=new Set([this]):ka.add(this));var A=u.stack;this.componentDidCatch(u.value,{componentStack:A!==null?A:""})})}function Rw(n,a,l,u,d){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&ei(a,l,d,!0),l=zr.current,l!==null){switch(l.tag){case 31:case 13:return cn===null?Tc():l.alternate===null&&jt===0&&(jt=3),l.flags&=-257,l.flags|=65536,l.lanes=d,u===ec?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),Hf(n,u,d)),!1;case 22:return l.flags|=65536,u===ec?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),Hf(n,u,d)),!1}throw Error(s(435,l.tag))}return Hf(n,u,d),Tc(),!1}if(tt)return a=zr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=d,u!==L0&&(n=Error(s(422),{cause:u}),hl(an(n,l)))):(u!==L0&&(a=Error(s(423),{cause:u}),hl(an(a,l))),n=n.current.alternate,n.flags|=65536,d&=-d,n.lanes|=d,u=an(u,l),d=xf(n.stateNode,u,d),q0(n,d),jt!==4&&(jt=2)),!1;var p=Error(s(520),{cause:u});if(p=an(p,l),jl===null?jl=[p]:jl.push(p),jt!==4&&(jt=2),a===null)return!0;u=an(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,n=d&-d,l.lanes|=n,n=xf(l.stateNode,u,n),q0(l,n),!1;case 1:if(a=l.type,p=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(ka===null||!ka.has(p))))return l.flags|=65536,d&=-d,l.lanes|=d,d=Hg(d),$g(d,n,l,u),q0(l,d),!1}l=l.return}while(l!==null);return!1}var vf=Error(s(461)),Ut=!1;function rr(n,a,l,u){a.child=n===null?Km(a,null,l,u):ms(a,n.child,l,u)}function Gg(n,a,l,u,d){l=l.render;var p=a.ref;if("ref"in u){var b={};for(var A in u)A!=="ref"&&(b[A]=u[A])}else b=u;return us(a),u=Q0(n,a,l,b,p,d),A=Z0(),n!==null&&!Ut?(ef(n,a,d),Jn(n,a,d)):(tt&&A&&D0(a),a.flags|=1,rr(n,a,u,d),a.child)}function Vg(n,a,l,u,d){if(n===null){var p=l.type;return typeof p=="function"&&!R0(p)&&p.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=p,qg(n,a,p,u,d)):(n=Wo(l.type,null,u,a,a.mode,d),n.ref=a.ref,n.return=a,a.child=n)}if(p=n.child,!Af(n,d)){var b=p.memoizedProps;if(l=l.compare,l=l!==null?l:cl,l(b,u)&&n.ref===a.ref)return Jn(n,a,d)}return a.flags|=1,n=Vn(p,u),n.ref=a.ref,n.return=a,a.child=n}function qg(n,a,l,u,d){if(n!==null){var p=n.memoizedProps;if(cl(p,u)&&n.ref===a.ref)if(Ut=!1,a.pendingProps=u=p,Af(n,d))(n.flags&131072)!==0&&(Ut=!0);else return a.lanes=n.lanes,Jn(n,a,d)}return _f(n,a,l,u,d)}function Kg(n,a,l,u){var d=u.children,p=n!==null?n.memoizedState:null;if(n===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((a.flags&128)!==0){if(p=p!==null?p.baseLanes|l:l,n!==null){for(u=a.child=n.child,d=0;u!==null;)d=d|u.lanes|u.childLanes,u=u.sibling;u=d&~p}else u=0,a.child=null;return Wg(n,a,p,l,u)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&Qo(a,p!==null?p.cachePool:null),p!==null?Ym(a,p):W0(),Jm(a);else return u=a.lanes=536870912,Wg(n,a,p!==null?p.baseLanes|l:l,l,u)}else p!==null?(Qo(a,p.cachePool),Ym(a,p),Oa(),a.memoizedState=null):(n!==null&&Qo(a,null),W0(),Oa());return rr(n,a,d,l),a.child}function El(n,a){return n!==null&&n.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Wg(n,a,l,u,d){var p=H0();return p=p===null?null:{parent:Bt._currentValue,pool:p},a.memoizedState={baseLanes:l,cachePool:p},n!==null&&Qo(a,null),W0(),Jm(a),n!==null&&ei(n,a,u,!0),a.childLanes=d,null}function mc(n,a){return a=pc({mode:a.mode,children:a.children},n.mode),a.ref=n.ref,n.child=a,a.return=n,a}function Xg(n,a,l){return ms(a,n.child,null,l),n=mc(a,a.pendingProps),n.flags|=2,Hr(a),a.memoizedState=null,n}function jw(n,a,l){var u=a.pendingProps,d=(a.flags&128)!==0;if(a.flags&=-129,n===null){if(tt){if(u.mode==="hidden")return n=mc(a,u),a.lanes=536870912,El(null,n);if(Y0(a),(n=St)?(n=lp(n,on),n=n!==null&&n.data==="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:ya!==null?{id:Rn,overflow:jn}:null,retryLane:536870912,hydrationErrors:null},l=km(n),l.return=a,a.child=l,er=a,St=null)):n=null,n===null)throw ba(a);return a.lanes=536870912,null}return mc(a,u)}var p=n.memoizedState;if(p!==null){var b=p.dehydrated;if(Y0(a),d)if(a.flags&256)a.flags&=-257,a=Xg(n,a,l);else if(a.memoizedState!==null)a.child=n.child,a.flags|=128,a=null;else throw Error(s(558));else if(Ut||ei(n,a,l,!1),d=(l&n.childLanes)!==0,Ut||d){if(u=_t,u!==null&&(b=Fo(u,l),b!==0&&b!==p.retryLane))throw p.retryLane=b,is(n,b),jr(u,n,b),vf;Tc(),a=Xg(n,a,l)}else n=p.treeContext,St=un(b.nextSibling),er=a,tt=!0,wa=null,on=!1,n!==null&&Lm(a,n),a=mc(a,u),a.flags|=4096;return a}return n=Vn(n.child,{mode:u.mode,children:u.children}),n.ref=a.ref,a.child=n,n.return=a,n}function gc(n,a){var l=a.ref;if(l===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(n===null||n.ref!==l)&&(a.flags|=4194816)}}function _f(n,a,l,u,d){return us(a),l=Q0(n,a,l,u,void 0,d),u=Z0(),n!==null&&!Ut?(ef(n,a,d),Jn(n,a,d)):(tt&&u&&D0(a),a.flags|=1,rr(n,a,l,d),a.child)}function Yg(n,a,l,u,d,p){return us(a),a.updateQueue=null,l=Zm(a,u,l,d),Qm(n),u=Z0(),n!==null&&!Ut?(ef(n,a,p),Jn(n,a,p)):(tt&&u&&D0(a),a.flags|=1,rr(n,a,l,p),a.child)}function Jg(n,a,l,u,d){if(us(a),a.stateNode===null){var p=Ys,b=l.contextType;typeof b=="object"&&b!==null&&(p=tr(b)),p=new l(u,p),a.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=pf,a.stateNode=p,p._reactInternals=a,p=a.stateNode,p.props=u,p.state=a.memoizedState,p.refs={},G0(a),b=l.contextType,p.context=typeof b=="object"&&b!==null?tr(b):Ys,p.state=a.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(gf(a,l,b,u),p.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&pf.enqueueReplaceState(p,p.state,null),_l(a,u,p,d),vl(),p.state=a.memoizedState),typeof p.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(n===null){p=a.stateNode;var A=a.memoizedProps,H=ps(l,A);p.props=H;var ee=p.context,de=l.contextType;b=Ys,typeof de=="object"&&de!==null&&(b=tr(de));var xe=l.getDerivedStateFromProps;de=typeof xe=="function"||typeof p.getSnapshotBeforeUpdate=="function",A=a.pendingProps!==A,de||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(A||ee!==b)&&Bg(a,p,u,b),Ea=!1;var se=a.memoizedState;p.state=se,_l(a,u,p,d),vl(),ee=a.memoizedState,A||se!==ee||Ea?(typeof xe=="function"&&(gf(a,l,xe,u),ee=a.memoizedState),(H=Ea||Ig(a,l,H,u,se,ee,b))?(de||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(a.flags|=4194308)):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=ee),p.props=u,p.state=ee,p.context=b,u=H):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{p=a.stateNode,V0(n,a),b=a.memoizedProps,de=ps(l,b),p.props=de,xe=a.pendingProps,se=p.context,ee=l.contextType,H=Ys,typeof ee=="object"&&ee!==null&&(H=tr(ee)),A=l.getDerivedStateFromProps,(ee=typeof A=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==xe||se!==H)&&Bg(a,p,u,H),Ea=!1,se=a.memoizedState,p.state=se,_l(a,u,p,d),vl();var ue=a.memoizedState;b!==xe||se!==ue||Ea||n!==null&&n.dependencies!==null&&Yo(n.dependencies)?(typeof A=="function"&&(gf(a,l,A,u),ue=a.memoizedState),(de=Ea||Ig(a,l,de,u,se,ue,H)||n!==null&&n.dependencies!==null&&Yo(n.dependencies))?(ee||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,ue,H),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,ue,H)),typeof p.componentDidUpdate=="function"&&(a.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===n.memoizedProps&&se===n.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&se===n.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=ue),p.props=u,p.state=ue,p.context=H,u=de):(typeof p.componentDidUpdate!="function"||b===n.memoizedProps&&se===n.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&se===n.memoizedState||(a.flags|=1024),u=!1)}return p=u,gc(n,a),u=(a.flags&128)!==0,p||u?(p=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:p.render(),a.flags|=1,n!==null&&u?(a.child=ms(a,n.child,null,d),a.child=ms(a,null,l,d)):rr(n,a,l,d),a.memoizedState=p.state,n=a.child):n=Jn(n,a,d),n}function Qg(n,a,l,u){return os(),a.flags|=256,rr(n,a,l,u),a.child}var yf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wf(n){return{baseLanes:n,cachePool:zm()}}function bf(n,a,l){return n=n!==null?n.childLanes&~l:0,a&&(n|=Gr),n}function Zg(n,a,l){var u=a.pendingProps,d=!1,p=(a.flags&128)!==0,b;if((b=p)||(b=n!==null&&n.memoizedState===null?!1:(Ft.current&2)!==0),b&&(d=!0,a.flags&=-129),b=(a.flags&32)!==0,a.flags&=-33,n===null){if(tt){if(d?Na(a):Oa(),(n=St)?(n=lp(n,on),n=n!==null&&n.data!=="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:ya!==null?{id:Rn,overflow:jn}:null,retryLane:536870912,hydrationErrors:null},l=km(n),l.return=a,a.child=l,er=a,St=null)):n=null,n===null)throw ba(a);return ah(n)?a.lanes=32:a.lanes=536870912,null}var A=u.children;return u=u.fallback,d?(Oa(),d=a.mode,A=pc({mode:"hidden",children:A},d),u=ls(u,d,l,null),A.return=a,u.return=a,A.sibling=u,a.child=A,u=a.child,u.memoizedState=wf(l),u.childLanes=bf(n,b,l),a.memoizedState=yf,El(null,u)):(Na(a),Sf(a,A))}var H=n.memoizedState;if(H!==null&&(A=H.dehydrated,A!==null)){if(p)a.flags&256?(Na(a),a.flags&=-257,a=Ef(n,a,l)):a.memoizedState!==null?(Oa(),a.child=n.child,a.flags|=128,a=null):(Oa(),A=u.fallback,d=a.mode,u=pc({mode:"visible",children:u.children},d),A=ls(A,d,l,null),A.flags|=2,u.return=a,A.return=a,u.sibling=A,a.child=u,ms(a,n.child,null,l),u=a.child,u.memoizedState=wf(l),u.childLanes=bf(n,b,l),a.memoizedState=yf,a=El(null,u));else if(Na(a),ah(A)){if(b=A.nextSibling&&A.nextSibling.dataset,b)var ee=b.dgst;b=ee,u=Error(s(419)),u.stack="",u.digest=b,hl({value:u,source:null,stack:null}),a=Ef(n,a,l)}else if(Ut||ei(n,a,l,!1),b=(l&n.childLanes)!==0,Ut||b){if(b=_t,b!==null&&(u=Fo(b,l),u!==0&&u!==H.retryLane))throw H.retryLane=u,is(n,u),jr(b,n,u),vf;nh(A)||Tc(),a=Ef(n,a,l)}else nh(A)?(a.flags|=192,a.child=n.child,a=null):(n=H.treeContext,St=un(A.nextSibling),er=a,tt=!0,wa=null,on=!1,n!==null&&Lm(a,n),a=Sf(a,u.children),a.flags|=4096);return a}return d?(Oa(),A=u.fallback,d=a.mode,H=n.child,ee=H.sibling,u=Vn(H,{mode:"hidden",children:u.children}),u.subtreeFlags=H.subtreeFlags&65011712,ee!==null?A=Vn(ee,A):(A=ls(A,d,l,null),A.flags|=2),A.return=a,u.return=a,u.sibling=A,a.child=u,El(null,u),u=a.child,A=n.child.memoizedState,A===null?A=wf(l):(d=A.cachePool,d!==null?(H=Bt._currentValue,d=d.parent!==H?{parent:H,pool:H}:d):d=zm(),A={baseLanes:A.baseLanes|l,cachePool:d}),u.memoizedState=A,u.childLanes=bf(n,b,l),a.memoizedState=yf,El(n.child,u)):(Na(a),l=n.child,n=l.sibling,l=Vn(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,n!==null&&(b=a.deletions,b===null?(a.deletions=[n],a.flags|=16):b.push(n)),a.child=l,a.memoizedState=null,l)}function Sf(n,a){return a=pc({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function pc(n,a){return n=Pr(22,n,null,a),n.lanes=0,n}function Ef(n,a,l){return ms(a,n.child,null,l),n=Sf(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function e1(n,a,l){n.lanes|=a;var u=n.alternate;u!==null&&(u.lanes|=a),M0(n.return,a,l)}function Tf(n,a,l,u,d,p){var b=n.memoizedState;b===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:d,treeForkCount:p}:(b.isBackwards=a,b.rendering=null,b.renderingStartTime=0,b.last=u,b.tail=l,b.tailMode=d,b.treeForkCount=p)}function t1(n,a,l){var u=a.pendingProps,d=u.revealOrder,p=u.tail;u=u.children;var b=Ft.current,A=(b&2)!==0;if(A?(b=b&1|2,a.flags|=128):b&=1,P(Ft,b),rr(n,a,u,l),u=tt?fl:0,!A&&n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&e1(n,l,a);else if(n.tag===19)e1(n,l,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(d){case"forwards":for(l=a.child,d=null;l!==null;)n=l.alternate,n!==null&&ac(n)===null&&(d=l),l=l.sibling;l=d,l===null?(d=a.child,a.child=null):(d=l.sibling,l.sibling=null),Tf(a,!1,d,l,p,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,d=a.child,a.child=null;d!==null;){if(n=d.alternate,n!==null&&ac(n)===null){a.child=d;break}n=d.sibling,d.sibling=l,l=d,d=n}Tf(a,!0,l,null,p,u);break;case"together":Tf(a,!1,null,null,void 0,u);break;default:a.memoizedState=null}return a.child}function Jn(n,a,l){if(n!==null&&(a.dependencies=n.dependencies),ja|=a.lanes,(l&a.childLanes)===0)if(n!==null){if(ei(n,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(s(153));if(a.child!==null){for(n=a.child,l=Vn(n,n.pendingProps),a.child=l,l.return=a;n.sibling!==null;)n=n.sibling,l=l.sibling=Vn(n,n.pendingProps),l.return=a;l.sibling=null}return a.child}function Af(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&Yo(n)))}function kw(n,a,l){switch(a.tag){case 3:De(a,a.stateNode.containerInfo),Sa(a,Bt,n.memoizedState.cache),os();break;case 27:case 5:Oe(a);break;case 4:De(a,a.stateNode.containerInfo);break;case 10:Sa(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Y0(a),null;break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(Na(a),a.flags|=128,null):(l&a.child.childLanes)!==0?Zg(n,a,l):(Na(a),n=Jn(n,a,l),n!==null?n.sibling:null);Na(a);break;case 19:var d=(n.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(ei(n,a,l,!1),u=(l&a.childLanes)!==0),d){if(u)return t1(n,a,l);a.flags|=128}if(d=a.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),P(Ft,Ft.current),u)break;return null;case 22:return a.lanes=0,Kg(n,a,l,a.pendingProps);case 24:Sa(a,Bt,n.memoizedState.cache)}return Jn(n,a,l)}function r1(n,a,l){if(n!==null)if(n.memoizedProps!==a.pendingProps)Ut=!0;else{if(!Af(n,l)&&(a.flags&128)===0)return Ut=!1,kw(n,a,l);Ut=(n.flags&131072)!==0}else Ut=!1,tt&&(a.flags&1048576)!==0&&Fm(a,fl,a.index);switch(a.lanes=0,a.tag){case 16:e:{var u=a.pendingProps;if(n=hs(a.elementType),a.type=n,typeof n=="function")R0(n)?(u=ps(n,u),a.tag=1,a=Jg(null,a,n,u,l)):(a.tag=0,a=_f(null,a,n,u,l));else{if(n!=null){var d=n.$$typeof;if(d===G){a.tag=11,a=Gg(null,a,n,u,l);break e}else if(d===F){a.tag=14,a=Vg(null,a,n,u,l);break e}}throw a=be(n)||n,Error(s(306,a,""))}}return a;case 0:return _f(n,a,a.type,a.pendingProps,l);case 1:return u=a.type,d=ps(u,a.pendingProps),Jg(n,a,u,d,l);case 3:e:{if(De(a,a.stateNode.containerInfo),n===null)throw Error(s(387));u=a.pendingProps;var p=a.memoizedState;d=p.element,V0(n,a),_l(a,u,null,l);var b=a.memoizedState;if(u=b.cache,Sa(a,Bt,u),u!==p.cache&&U0(a,[Bt],l,!0),vl(),u=b.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:b.cache},a.updateQueue.baseState=p,a.memoizedState=p,a.flags&256){a=Qg(n,a,u,l);break e}else if(u!==d){d=an(Error(s(424)),a),hl(d),a=Qg(n,a,u,l);break e}else{switch(n=a.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(St=un(n.firstChild),er=a,tt=!0,wa=null,on=!0,l=Km(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(os(),u===d){a=Jn(n,a,l);break e}rr(n,a,u,l)}a=a.child}return a;case 26:return gc(n,a),n===null?(l=dp(a.type,null,a.pendingProps,null))?a.memoizedState=l:tt||(l=a.type,n=a.pendingProps,u=kc(Z.current).createElement(l),u[j]=a,u[D]=n,nr(u,l,n),Me(u),a.stateNode=u):a.memoizedState=dp(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return Oe(a),n===null&&tt&&(u=a.stateNode=up(a.type,a.pendingProps,Z.current),er=a,on=!0,d=St,Ia(a.type)?(sh=d,St=un(u.firstChild)):St=d),rr(n,a,a.pendingProps.children,l),gc(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&tt&&((d=u=St)&&(u=ob(u,a.type,a.pendingProps,on),u!==null?(a.stateNode=u,er=a,St=un(u.firstChild),on=!1,d=!0):d=!1),d||ba(a)),Oe(a),d=a.type,p=a.pendingProps,b=n!==null?n.memoizedProps:null,u=p.children,eh(d,p)?u=null:b!==null&&eh(d,b)&&(a.flags|=32),a.memoizedState!==null&&(d=Q0(n,a,Sw,null,null,l),Ul._currentValue=d),gc(n,a),rr(n,a,u,l),a.child;case 6:return n===null&&tt&&((n=l=St)&&(l=cb(l,a.pendingProps,on),l!==null?(a.stateNode=l,er=a,St=null,n=!0):n=!1),n||ba(a)),null;case 13:return Zg(n,a,l);case 4:return De(a,a.stateNode.containerInfo),u=a.pendingProps,n===null?a.child=ms(a,null,u,l):rr(n,a,u,l),a.child;case 11:return Gg(n,a,a.type,a.pendingProps,l);case 7:return rr(n,a,a.pendingProps,l),a.child;case 8:return rr(n,a,a.pendingProps.children,l),a.child;case 12:return rr(n,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,Sa(a,a.type,u.value),rr(n,a,u.children,l),a.child;case 9:return d=a.type._context,u=a.pendingProps.children,us(a),d=tr(d),u=u(d),a.flags|=1,rr(n,a,u,l),a.child;case 14:return Vg(n,a,a.type,a.pendingProps,l);case 15:return qg(n,a,a.type,a.pendingProps,l);case 19:return t1(n,a,l);case 31:return jw(n,a,l);case 22:return Kg(n,a,l,a.pendingProps);case 24:return us(a),u=tr(Bt),n===null?(d=H0(),d===null&&(d=_t,p=P0(),d.pooledCache=p,p.refCount++,p!==null&&(d.pooledCacheLanes|=l),d=p),a.memoizedState={parent:u,cache:d},G0(a),Sa(a,Bt,d)):((n.lanes&l)!==0&&(V0(n,a),_l(a,null,null,l),vl()),d=n.memoizedState,p=a.memoizedState,d.parent!==u?(d={parent:u,cache:u},a.memoizedState=d,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=d),Sa(a,Bt,u)):(u=p.cache,Sa(a,Bt,u),u!==d.cache&&U0(a,[Bt],l,!0))),rr(n,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(s(156,a.tag))}function Qn(n){n.flags|=4}function Nf(n,a,l,u,d){if((a=(n.mode&32)!==0)&&(a=!1),a){if(n.flags|=16777216,(d&335544128)===d)if(n.stateNode.complete)n.flags|=8192;else if(C1())n.flags|=8192;else throw ds=ec,$0}else n.flags&=-16777217}function n1(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!vp(a))if(C1())n.flags|=8192;else throw ds=ec,$0}function xc(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?ko():536870912,n.lanes|=a,hi|=a)}function Tl(n,a){if(!tt)switch(n.tailMode){case"hidden":a=n.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function Et(n){var a=n.alternate!==null&&n.alternate.child===n.child,l=0,u=0;if(a)for(var d=n.child;d!==null;)l|=d.lanes|d.childLanes,u|=d.subtreeFlags&65011712,u|=d.flags&65011712,d.return=n,d=d.sibling;else for(d=n.child;d!==null;)l|=d.lanes|d.childLanes,u|=d.subtreeFlags,u|=d.flags,d.return=n,d=d.sibling;return n.subtreeFlags|=u,n.childLanes=l,a}function Dw(n,a,l){var u=a.pendingProps;switch(F0(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(a),null;case 1:return Et(a),null;case 3:return l=a.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Wn(Bt),Ae(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(Zs(a)?Qn(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,I0())),Et(a),null;case 26:var d=a.type,p=a.memoizedState;return n===null?(Qn(a),p!==null?(Et(a),n1(a,p)):(Et(a),Nf(a,d,null,u,l))):p?p!==n.memoizedState?(Qn(a),Et(a),n1(a,p)):(Et(a),a.flags&=-16777217):(n=n.memoizedProps,n!==u&&Qn(a),Et(a),Nf(a,d,n,u,l)),null;case 27:if(qe(a),l=Z.current,d=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==u&&Qn(a);else{if(!u){if(a.stateNode===null)throw Error(s(166));return Et(a),null}n=C.current,Zs(a)?Im(a):(n=up(d,u,l),a.stateNode=n,Qn(a))}return Et(a),null;case 5:if(qe(a),d=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==u&&Qn(a);else{if(!u){if(a.stateNode===null)throw Error(s(166));return Et(a),null}if(p=C.current,Zs(a))Im(a);else{var b=kc(Z.current);switch(p){case 1:p=b.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:p=b.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":p=b.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":p=b.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":p=b.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof u.is=="string"?b.createElement("select",{is:u.is}):b.createElement("select"),u.multiple?p.multiple=!0:u.size&&(p.size=u.size);break;default:p=typeof u.is=="string"?b.createElement(d,{is:u.is}):b.createElement(d)}}p[j]=a,p[D]=u;e:for(b=a.child;b!==null;){if(b.tag===5||b.tag===6)p.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===a)break e;for(;b.sibling===null;){if(b.return===null||b.return===a)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}a.stateNode=p;e:switch(nr(p,d,u),d){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Qn(a)}}return Et(a),Nf(a,a.type,n===null?null:n.memoizedProps,a.pendingProps,l),null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==u&&Qn(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(s(166));if(n=Z.current,Zs(a)){if(n=a.stateNode,l=a.memoizedProps,u=null,d=er,d!==null)switch(d.tag){case 27:case 5:u=d.memoizedProps}n[j]=a,n=!!(n.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||Z1(n.nodeValue,l)),n||ba(a,!0)}else n=kc(n).createTextNode(u),n[j]=a,a.stateNode=n}return Et(a),null;case 31:if(l=a.memoizedState,n===null||n.memoizedState!==null){if(u=Zs(a),l!==null){if(n===null){if(!u)throw Error(s(318));if(n=a.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(557));n[j]=a}else os(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Et(a),n=!1}else l=I0(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=l),n=!0;if(!n)return a.flags&256?(Hr(a),a):(Hr(a),null);if((a.flags&128)!==0)throw Error(s(558))}return Et(a),null;case 13:if(u=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(d=Zs(a),u!==null&&u.dehydrated!==null){if(n===null){if(!d)throw Error(s(318));if(d=a.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));d[j]=a}else os(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Et(a),d=!1}else d=I0(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=d),d=!0;if(!d)return a.flags&256?(Hr(a),a):(Hr(a),null)}return Hr(a),(a.flags&128)!==0?(a.lanes=l,a):(l=u!==null,n=n!==null&&n.memoizedState!==null,l&&(u=a.child,d=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(d=u.alternate.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==d&&(u.flags|=2048)),l!==n&&l&&(a.child.flags|=8192),xc(a,a.updateQueue),Et(a),null);case 4:return Ae(),n===null&&Xf(a.stateNode.containerInfo),Et(a),null;case 10:return Wn(a.type),Et(a),null;case 19:if(N(Ft),u=a.memoizedState,u===null)return Et(a),null;if(d=(a.flags&128)!==0,p=u.rendering,p===null)if(d)Tl(u,!1);else{if(jt!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(p=ac(n),p!==null){for(a.flags|=128,Tl(u,!1),n=p.updateQueue,a.updateQueue=n,xc(a,n),a.subtreeFlags=0,n=l,l=a.child;l!==null;)jm(l,n),l=l.sibling;return P(Ft,Ft.current&1|2),tt&&qn(a,u.treeForkCount),a.child}n=n.sibling}u.tail!==null&&vt()>bc&&(a.flags|=128,d=!0,Tl(u,!1),a.lanes=4194304)}else{if(!d)if(n=ac(p),n!==null){if(a.flags|=128,d=!0,n=n.updateQueue,a.updateQueue=n,xc(a,n),Tl(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!tt)return Et(a),null}else 2*vt()-u.renderingStartTime>bc&&l!==536870912&&(a.flags|=128,d=!0,Tl(u,!1),a.lanes=4194304);u.isBackwards?(p.sibling=a.child,a.child=p):(n=u.last,n!==null?n.sibling=p:a.child=p,u.last=p)}return u.tail!==null?(n=u.tail,u.rendering=n,u.tail=n.sibling,u.renderingStartTime=vt(),n.sibling=null,l=Ft.current,P(Ft,d?l&1|2:l&1),tt&&qn(a,u.treeForkCount),n):(Et(a),null);case 22:case 23:return Hr(a),X0(),u=a.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(Et(a),a.subtreeFlags&6&&(a.flags|=8192)):Et(a),l=a.updateQueue,l!==null&&xc(a,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),n!==null&&N(fs),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Wn(Bt),Et(a),null;case 25:return null;case 30:return null}throw Error(s(156,a.tag))}function Fw(n,a){switch(F0(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return Wn(Bt),Ae(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return qe(a),null;case 31:if(a.memoizedState!==null){if(Hr(a),a.alternate===null)throw Error(s(340));os()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 13:if(Hr(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(s(340));os()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return N(Ft),null;case 4:return Ae(),null;case 10:return Wn(a.type),null;case 22:case 23:return Hr(a),X0(),n!==null&&N(fs),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return Wn(Bt),null;case 25:return null;default:return null}}function a1(n,a){switch(F0(a),a.tag){case 3:Wn(Bt),Ae();break;case 26:case 27:case 5:qe(a);break;case 4:Ae();break;case 31:a.memoizedState!==null&&Hr(a);break;case 13:Hr(a);break;case 19:N(Ft);break;case 10:Wn(a.type);break;case 22:case 23:Hr(a),X0(),n!==null&&N(fs);break;case 24:Wn(Bt)}}function Al(n,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var d=u.next;l=d;do{if((l.tag&n)===n){u=void 0;var p=l.create,b=l.inst;u=p(),b.destroy=u}l=l.next}while(l!==d)}}catch(A){ot(a,a.return,A)}}function Ca(n,a,l){try{var u=a.updateQueue,d=u!==null?u.lastEffect:null;if(d!==null){var p=d.next;u=p;do{if((u.tag&n)===n){var b=u.inst,A=b.destroy;if(A!==void 0){b.destroy=void 0,d=a;var H=l,ee=A;try{ee()}catch(de){ot(d,H,de)}}}u=u.next}while(u!==p)}}catch(de){ot(a,a.return,de)}}function s1(n){var a=n.updateQueue;if(a!==null){var l=n.stateNode;try{Xm(a,l)}catch(u){ot(n,n.return,u)}}}function i1(n,a,l){l.props=ps(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(u){ot(n,a,u)}}function Nl(n,a){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof l=="function"?n.refCleanup=l(u):l.current=u}}catch(d){ot(n,a,d)}}function kn(n,a){var l=n.ref,u=n.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(d){ot(n,a,d)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(d){ot(n,a,d)}else l.current=null}function l1(n){var a=n.type,l=n.memoizedProps,u=n.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(d){ot(n,n.return,d)}}function Of(n,a,l){try{var u=n.stateNode;rb(u,n.type,l,a),u[D]=a}catch(d){ot(n,n.return,d)}}function o1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ia(n.type)||n.tag===4}function Cf(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||o1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ia(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Rf(n,a,l){var u=n.tag;if(u===5||u===6)n=n.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(n),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=$n));else if(u!==4&&(u===27&&Ia(n.type)&&(l=n.stateNode,a=null),n=n.child,n!==null))for(Rf(n,a,l),n=n.sibling;n!==null;)Rf(n,a,l),n=n.sibling}function vc(n,a,l){var u=n.tag;if(u===5||u===6)n=n.stateNode,a?l.insertBefore(n,a):l.appendChild(n);else if(u!==4&&(u===27&&Ia(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(vc(n,a,l),n=n.sibling;n!==null;)vc(n,a,l),n=n.sibling}function c1(n){var a=n.stateNode,l=n.memoizedProps;try{for(var u=n.type,d=a.attributes;d.length;)a.removeAttributeNode(d[0]);nr(a,u,l),a[j]=n,a[D]=l}catch(p){ot(n,n.return,p)}}var Zn=!1,Pt=!1,jf=!1,u1=typeof WeakSet=="function"?WeakSet:Set,Xt=null;function Lw(n,a){if(n=n.containerInfo,Qf=Uc,n=bm(n),S0(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var d=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{l.nodeType,p.nodeType}catch{l=null;break e}var b=0,A=-1,H=-1,ee=0,de=0,xe=n,se=null;t:for(;;){for(var ue;xe!==l||d!==0&&xe.nodeType!==3||(A=b+d),xe!==p||u!==0&&xe.nodeType!==3||(H=b+u),xe.nodeType===3&&(b+=xe.nodeValue.length),(ue=xe.firstChild)!==null;)se=xe,xe=ue;for(;;){if(xe===n)break t;if(se===l&&++ee===d&&(A=b),se===p&&++de===u&&(H=b),(ue=xe.nextSibling)!==null)break;xe=se,se=xe.parentNode}xe=ue}l=A===-1||H===-1?null:{start:A,end:H}}else l=null}l=l||{start:0,end:0}}else l=null;for(Zf={focusedElem:n,selectionRange:l},Uc=!1,Xt=a;Xt!==null;)if(a=Xt,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,Xt=n;else for(;Xt!==null;){switch(a=Xt,p=a.alternate,n=a.flags,a.tag){case 0:if((n&4)!==0&&(n=a.updateQueue,n=n!==null?n.events:null,n!==null))for(l=0;l<n.length;l++)d=n[l],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&p!==null){n=void 0,l=a,d=p.memoizedProps,p=p.memoizedState,u=l.stateNode;try{var Be=ps(l.type,d);n=u.getSnapshotBeforeUpdate(Be,p),u.__reactInternalSnapshotBeforeUpdate=n}catch($e){ot(l,l.return,$e)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,l=n.nodeType,l===9)rh(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":rh(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(s(163))}if(n=a.sibling,n!==null){n.return=a.return,Xt=n;break}Xt=a.return}}function f1(n,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:ta(n,l),u&4&&Al(5,l);break;case 1:if(ta(n,l),u&4)if(n=l.stateNode,a===null)try{n.componentDidMount()}catch(b){ot(l,l.return,b)}else{var d=ps(l.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(d,a,n.__reactInternalSnapshotBeforeUpdate)}catch(b){ot(l,l.return,b)}}u&64&&s1(l),u&512&&Nl(l,l.return);break;case 3:if(ta(n,l),u&64&&(n=l.updateQueue,n!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Xm(n,a)}catch(b){ot(l,l.return,b)}}break;case 27:a===null&&u&4&&c1(l);case 26:case 5:ta(n,l),a===null&&u&4&&l1(l),u&512&&Nl(l,l.return);break;case 12:ta(n,l);break;case 31:ta(n,l),u&4&&m1(n,l);break;case 13:ta(n,l),u&4&&g1(n,l),u&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=Gw.bind(null,l),ub(n,l))));break;case 22:if(u=l.memoizedState!==null||Zn,!u){a=a!==null&&a.memoizedState!==null||Pt,d=Zn;var p=Pt;Zn=u,(Pt=a)&&!p?ra(n,l,(l.subtreeFlags&8772)!==0):ta(n,l),Zn=d,Pt=p}break;case 30:break;default:ta(n,l)}}function h1(n){var a=n.alternate;a!==null&&(n.alternate=null,h1(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&Se(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Ot=null,Nr=!1;function ea(n,a,l){for(l=l.child;l!==null;)d1(n,a,l),l=l.sibling}function d1(n,a,l){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(xa,l)}catch{}switch(l.tag){case 26:Pt||kn(l,a),ea(n,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Pt||kn(l,a);var u=Ot,d=Nr;Ia(l.type)&&(Ot=l.stateNode,Nr=!1),ea(n,a,l),Il(l.stateNode),Ot=u,Nr=d;break;case 5:Pt||kn(l,a);case 6:if(u=Ot,d=Nr,Ot=null,ea(n,a,l),Ot=u,Nr=d,Ot!==null)if(Nr)try{(Ot.nodeType===9?Ot.body:Ot.nodeName==="HTML"?Ot.ownerDocument.body:Ot).removeChild(l.stateNode)}catch(p){ot(l,a,p)}else try{Ot.removeChild(l.stateNode)}catch(p){ot(l,a,p)}break;case 18:Ot!==null&&(Nr?(n=Ot,sp(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),yi(n)):sp(Ot,l.stateNode));break;case 4:u=Ot,d=Nr,Ot=l.stateNode.containerInfo,Nr=!0,ea(n,a,l),Ot=u,Nr=d;break;case 0:case 11:case 14:case 15:Ca(2,l,a),Pt||Ca(4,l,a),ea(n,a,l);break;case 1:Pt||(kn(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&i1(l,a,u)),ea(n,a,l);break;case 21:ea(n,a,l);break;case 22:Pt=(u=Pt)||l.memoizedState!==null,ea(n,a,l),Pt=u;break;default:ea(n,a,l)}}function m1(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{yi(n)}catch(l){ot(a,a.return,l)}}}function g1(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{yi(n)}catch(l){ot(a,a.return,l)}}function Iw(n){switch(n.tag){case 31:case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new u1),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new u1),a;default:throw Error(s(435,n.tag))}}function _c(n,a){var l=Iw(n);a.forEach(function(u){if(!l.has(u)){l.add(u);var d=Vw.bind(null,n,u);u.then(d,d)}})}function Or(n,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var d=l[u],p=n,b=a,A=b;e:for(;A!==null;){switch(A.tag){case 27:if(Ia(A.type)){Ot=A.stateNode,Nr=!1;break e}break;case 5:Ot=A.stateNode,Nr=!1;break e;case 3:case 4:Ot=A.stateNode.containerInfo,Nr=!0;break e}A=A.return}if(Ot===null)throw Error(s(160));d1(p,b,d),Ot=null,Nr=!1,p=d.alternate,p!==null&&(p.return=null),d.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)p1(a,n),a=a.sibling}var xn=null;function p1(n,a){var l=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Or(a,n),Cr(n),u&4&&(Ca(3,n,n.return),Al(3,n),Ca(5,n,n.return));break;case 1:Or(a,n),Cr(n),u&512&&(Pt||l===null||kn(l,l.return)),u&64&&Zn&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var d=xn;if(Or(a,n),Cr(n),u&512&&(Pt||l===null||kn(l,l.return)),u&4){var p=l!==null?l.memoizedState:null;if(u=n.memoizedState,l===null)if(u===null)if(n.stateNode===null){e:{u=n.type,l=n.memoizedProps,d=d.ownerDocument||d;t:switch(u){case"title":p=d.getElementsByTagName("title")[0],(!p||p[ie]||p[j]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=d.createElement(u),d.head.insertBefore(p,d.querySelector("head > title"))),nr(p,u,l),p[j]=n,Me(p),u=p;break e;case"link":var b=pp("link","href",d).get(u+(l.href||""));if(b){for(var A=0;A<b.length;A++)if(p=b[A],p.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&p.getAttribute("rel")===(l.rel==null?null:l.rel)&&p.getAttribute("title")===(l.title==null?null:l.title)&&p.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(A,1);break t}}p=d.createElement(u),nr(p,u,l),d.head.appendChild(p);break;case"meta":if(b=pp("meta","content",d).get(u+(l.content||""))){for(A=0;A<b.length;A++)if(p=b[A],p.getAttribute("content")===(l.content==null?null:""+l.content)&&p.getAttribute("name")===(l.name==null?null:l.name)&&p.getAttribute("property")===(l.property==null?null:l.property)&&p.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&p.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(A,1);break t}}p=d.createElement(u),nr(p,u,l),d.head.appendChild(p);break;default:throw Error(s(468,u))}p[j]=n,Me(p),u=p}n.stateNode=u}else xp(d,n.type,n.stateNode);else n.stateNode=gp(d,u,n.memoizedProps);else p!==u?(p===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):p.count--,u===null?xp(d,n.type,n.stateNode):gp(d,u,n.memoizedProps)):u===null&&n.stateNode!==null&&Of(n,n.memoizedProps,l.memoizedProps)}break;case 27:Or(a,n),Cr(n),u&512&&(Pt||l===null||kn(l,l.return)),l!==null&&u&4&&Of(n,n.memoizedProps,l.memoizedProps);break;case 5:if(Or(a,n),Cr(n),u&512&&(Pt||l===null||kn(l,l.return)),n.flags&32){d=n.stateNode;try{$s(d,"")}catch(Be){ot(n,n.return,Be)}}u&4&&n.stateNode!=null&&(d=n.memoizedProps,Of(n,d,l!==null?l.memoizedProps:d)),u&1024&&(jf=!0);break;case 6:if(Or(a,n),Cr(n),u&4){if(n.stateNode===null)throw Error(s(162));u=n.memoizedProps,l=n.stateNode;try{l.nodeValue=u}catch(Be){ot(n,n.return,Be)}}break;case 3:if(Lc=null,d=xn,xn=Dc(a.containerInfo),Or(a,n),xn=d,Cr(n),u&4&&l!==null&&l.memoizedState.isDehydrated)try{yi(a.containerInfo)}catch(Be){ot(n,n.return,Be)}jf&&(jf=!1,x1(n));break;case 4:u=xn,xn=Dc(n.stateNode.containerInfo),Or(a,n),Cr(n),xn=u;break;case 12:Or(a,n),Cr(n);break;case 31:Or(a,n),Cr(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,_c(n,u)));break;case 13:Or(a,n),Cr(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(wc=vt()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,_c(n,u)));break;case 22:d=n.memoizedState!==null;var H=l!==null&&l.memoizedState!==null,ee=Zn,de=Pt;if(Zn=ee||d,Pt=de||H,Or(a,n),Pt=de,Zn=ee,Cr(n),u&8192)e:for(a=n.stateNode,a._visibility=d?a._visibility&-2:a._visibility|1,d&&(l===null||H||Zn||Pt||xs(n)),l=null,a=n;;){if(a.tag===5||a.tag===26){if(l===null){H=l=a;try{if(p=H.stateNode,d)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{A=H.stateNode;var xe=H.memoizedProps.style,se=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;A.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Be){ot(H,H.return,Be)}}}else if(a.tag===6){if(l===null){H=a;try{H.stateNode.nodeValue=d?"":H.memoizedProps}catch(Be){ot(H,H.return,Be)}}}else if(a.tag===18){if(l===null){H=a;try{var ue=H.stateNode;d?ip(ue,!0):ip(H.stateNode,!1)}catch(Be){ot(H,H.return,Be)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break e;for(;a.sibling===null;){if(a.return===null||a.return===n)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=n.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,_c(n,l))));break;case 19:Or(a,n),Cr(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,_c(n,u)));break;case 30:break;case 21:break;default:Or(a,n),Cr(n)}}function Cr(n){var a=n.flags;if(a&2){try{for(var l,u=n.return;u!==null;){if(o1(u)){l=u;break}u=u.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var d=l.stateNode,p=Cf(n);vc(n,p,d);break;case 5:var b=l.stateNode;l.flags&32&&($s(b,""),l.flags&=-33);var A=Cf(n);vc(n,A,b);break;case 3:case 4:var H=l.stateNode.containerInfo,ee=Cf(n);Rf(n,ee,H);break;default:throw Error(s(161))}}catch(de){ot(n,n.return,de)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function x1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;x1(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function ta(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)f1(n,a.alternate,a),a=a.sibling}function xs(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:Ca(4,a,a.return),xs(a);break;case 1:kn(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&i1(a,a.return,l),xs(a);break;case 27:Il(a.stateNode);case 26:case 5:kn(a,a.return),xs(a);break;case 22:a.memoizedState===null&&xs(a);break;case 30:xs(a);break;default:xs(a)}n=n.sibling}}function ra(n,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,d=n,p=a,b=p.flags;switch(p.tag){case 0:case 11:case 15:ra(d,p,l),Al(4,p);break;case 1:if(ra(d,p,l),u=p,d=u.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(ee){ot(u,u.return,ee)}if(u=p,d=u.updateQueue,d!==null){var A=u.stateNode;try{var H=d.shared.hiddenCallbacks;if(H!==null)for(d.shared.hiddenCallbacks=null,d=0;d<H.length;d++)Wm(H[d],A)}catch(ee){ot(u,u.return,ee)}}l&&b&64&&s1(p),Nl(p,p.return);break;case 27:c1(p);case 26:case 5:ra(d,p,l),l&&u===null&&b&4&&l1(p),Nl(p,p.return);break;case 12:ra(d,p,l);break;case 31:ra(d,p,l),l&&b&4&&m1(d,p);break;case 13:ra(d,p,l),l&&b&4&&g1(d,p);break;case 22:p.memoizedState===null&&ra(d,p,l),Nl(p,p.return);break;case 30:break;default:ra(d,p,l)}a=a.sibling}}function kf(n,a){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&dl(l))}function Df(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&dl(n))}function vn(n,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)v1(n,a,l,u),a=a.sibling}function v1(n,a,l,u){var d=a.flags;switch(a.tag){case 0:case 11:case 15:vn(n,a,l,u),d&2048&&Al(9,a);break;case 1:vn(n,a,l,u);break;case 3:vn(n,a,l,u),d&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&dl(n)));break;case 12:if(d&2048){vn(n,a,l,u),n=a.stateNode;try{var p=a.memoizedProps,b=p.id,A=p.onPostCommit;typeof A=="function"&&A(b,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(H){ot(a,a.return,H)}}else vn(n,a,l,u);break;case 31:vn(n,a,l,u);break;case 13:vn(n,a,l,u);break;case 23:break;case 22:p=a.stateNode,b=a.alternate,a.memoizedState!==null?p._visibility&2?vn(n,a,l,u):Ol(n,a):p._visibility&2?vn(n,a,l,u):(p._visibility|=2,ci(n,a,l,u,(a.subtreeFlags&10256)!==0||!1)),d&2048&&kf(b,a);break;case 24:vn(n,a,l,u),d&2048&&Df(a.alternate,a);break;default:vn(n,a,l,u)}}function ci(n,a,l,u,d){for(d=d&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var p=n,b=a,A=l,H=u,ee=b.flags;switch(b.tag){case 0:case 11:case 15:ci(p,b,A,H,d),Al(8,b);break;case 23:break;case 22:var de=b.stateNode;b.memoizedState!==null?de._visibility&2?ci(p,b,A,H,d):Ol(p,b):(de._visibility|=2,ci(p,b,A,H,d)),d&&ee&2048&&kf(b.alternate,b);break;case 24:ci(p,b,A,H,d),d&&ee&2048&&Df(b.alternate,b);break;default:ci(p,b,A,H,d)}a=a.sibling}}function Ol(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=n,u=a,d=u.flags;switch(u.tag){case 22:Ol(l,u),d&2048&&kf(u.alternate,u);break;case 24:Ol(l,u),d&2048&&Df(u.alternate,u);break;default:Ol(l,u)}a=a.sibling}}var Cl=8192;function ui(n,a,l){if(n.subtreeFlags&Cl)for(n=n.child;n!==null;)_1(n,a,l),n=n.sibling}function _1(n,a,l){switch(n.tag){case 26:ui(n,a,l),n.flags&Cl&&n.memoizedState!==null&&bb(l,xn,n.memoizedState,n.memoizedProps);break;case 5:ui(n,a,l);break;case 3:case 4:var u=xn;xn=Dc(n.stateNode.containerInfo),ui(n,a,l),xn=u;break;case 22:n.memoizedState===null&&(u=n.alternate,u!==null&&u.memoizedState!==null?(u=Cl,Cl=16777216,ui(n,a,l),Cl=u):ui(n,a,l));break;default:ui(n,a,l)}}function y1(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function Rl(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Xt=u,b1(u,n)}y1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)w1(n),n=n.sibling}function w1(n){switch(n.tag){case 0:case 11:case 15:Rl(n),n.flags&2048&&Ca(9,n,n.return);break;case 3:Rl(n);break;case 12:Rl(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,yc(n)):Rl(n);break;default:Rl(n)}}function yc(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Xt=u,b1(u,n)}y1(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:Ca(8,a,a.return),yc(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,yc(a));break;default:yc(a)}n=n.sibling}}function b1(n,a){for(;Xt!==null;){var l=Xt;switch(l.tag){case 0:case 11:case 15:Ca(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:dl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Xt=u;else e:for(l=n;Xt!==null;){u=Xt;var d=u.sibling,p=u.return;if(h1(u),u===l){Xt=null;break e}if(d!==null){d.return=p,Xt=d;break e}Xt=p}}}var Bw={getCacheForType:function(n){var a=tr(Bt),l=a.data.get(n);return l===void 0&&(l=n(),a.data.set(n,l)),l},cacheSignal:function(){return tr(Bt).controller.signal}},Mw=typeof WeakMap=="function"?WeakMap:Map,st=0,_t=null,Je=null,Ze=0,lt=0,$r=null,Ra=!1,fi=!1,Ff=!1,na=0,jt=0,ja=0,vs=0,Lf=0,Gr=0,hi=0,jl=null,Rr=null,If=!1,wc=0,S1=0,bc=1/0,Sc=null,ka=null,qt=0,Da=null,di=null,aa=0,Bf=0,Mf=null,E1=null,kl=0,Uf=null;function Vr(){return(st&2)!==0&&Ze!==0?Ze&-Ze:J.T!==null?Vf():T()}function T1(){if(Gr===0)if((Ze&536870912)===0||tt){var n=Ms;Ms<<=1,(Ms&3932160)===0&&(Ms=262144),Gr=n}else Gr=536870912;return n=zr.current,n!==null&&(n.flags|=32),Gr}function jr(n,a,l){(n===_t&&(lt===2||lt===9)||n.cancelPendingCommit!==null)&&(mi(n,0),Fa(n,Ze,Gr,!1)),ts(n,l),((st&2)===0||n!==_t)&&(n===_t&&((st&2)===0&&(vs|=l),jt===4&&Fa(n,Ze,Gr,!1)),Dn(n))}function A1(n,a,l){if((st&6)!==0)throw Error(s(327));var u=!l&&(a&127)===0&&(a&n.expiredLanes)===0||es(n,a),d=u?zw(n,a):zf(n,a,!0),p=u;do{if(d===0){fi&&!u&&Fa(n,a,0,!1);break}else{if(l=n.current.alternate,p&&!Uw(l)){d=zf(n,a,!1),p=!1;continue}if(d===2){if(p=a,n.errorRecoveryDisabledLanes&p)var b=0;else b=n.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){a=b;e:{var A=n;d=jl;var H=A.current.memoizedState.isDehydrated;if(H&&(mi(A,b).flags|=256),b=zf(A,b,!1),b!==2){if(Ff&&!H){A.errorRecoveryDisabledLanes|=p,vs|=p,d=4;break e}p=Rr,Rr=d,p!==null&&(Rr===null?Rr=p:Rr.push.apply(Rr,p))}d=b}if(p=!1,d!==2)continue}}if(d===1){mi(n,0),Fa(n,a,0,!0);break}e:{switch(u=n,p=d,p){case 0:case 1:throw Error(s(345));case 4:if((a&4194048)!==a)break;case 6:Fa(u,a,Gr,!Ra);break e;case 2:Rr=null;break;case 3:case 5:break;default:throw Error(s(329))}if((a&62914560)===a&&(d=wc+300-vt(),10<d)){if(Fa(u,a,Gr,!Ra),Ps(u,0,!0)!==0)break e;aa=a,u.timeoutHandle=np(N1.bind(null,u,l,Rr,Sc,If,a,Gr,vs,hi,Ra,p,"Throttled",-0,0),d);break e}N1(u,l,Rr,Sc,If,a,Gr,vs,hi,Ra,p,null,-0,0)}}break}while(!0);Dn(n)}function N1(n,a,l,u,d,p,b,A,H,ee,de,xe,se,ue){if(n.timeoutHandle=-1,xe=a.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:$n},_1(a,p,xe);var Be=(p&62914560)===p?wc-vt():(p&4194048)===p?S1-vt():0;if(Be=Sb(xe,Be),Be!==null){aa=p,n.cancelPendingCommit=Be(L1.bind(null,n,a,p,l,u,d,b,A,H,de,xe,null,se,ue)),Fa(n,p,b,!ee);return}}L1(n,a,p,l,u,d,b,A,H)}function Uw(n){for(var a=n;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var d=l[u],p=d.getSnapshot;d=d.value;try{if(!Ur(p(),d))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Fa(n,a,l,u){a&=~Lf,a&=~vs,n.suspendedLanes|=a,n.pingedLanes&=~a,u&&(n.warmLanes|=a),u=n.expirationTimes;for(var d=a;0<d;){var p=31-vr(d),b=1<<p;u[p]=-1,d&=~b}l!==0&&Do(n,l,a)}function Ec(){return(st&6)===0?(Dl(0),!1):!0}function Pf(){if(Je!==null){if(lt===0)var n=Je.return;else n=Je,Kn=cs=null,tf(n),ai=null,gl=0,n=Je;for(;n!==null;)a1(n.alternate,n),n=n.return;Je=null}}function mi(n,a){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,sb(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),aa=0,Pf(),_t=n,Je=l=Vn(n.current,null),Ze=a,lt=0,$r=null,Ra=!1,fi=es(n,a),Ff=!1,hi=Gr=Lf=vs=ja=jt=0,Rr=jl=null,If=!1,(a&8)!==0&&(a|=a&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=a;0<u;){var d=31-vr(u),p=1<<d;a|=n[d],u&=~p}return na=a,Vo(),l}function O1(n,a){We=null,J.H=Sl,a===ni||a===Zo?(a=Gm(),lt=3):a===$0?(a=Gm(),lt=4):lt=a===vf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,$r=a,Je===null&&(jt=1,dc(n,an(a,n.current)))}function C1(){var n=zr.current;return n===null?!0:(Ze&4194048)===Ze?cn===null:(Ze&62914560)===Ze||(Ze&536870912)!==0?n===cn:!1}function R1(){var n=J.H;return J.H=Sl,n===null?Sl:n}function j1(){var n=J.A;return J.A=Bw,n}function Tc(){jt=4,Ra||(Ze&4194048)!==Ze&&zr.current!==null||(fi=!0),(ja&134217727)===0&&(vs&134217727)===0||_t===null||Fa(_t,Ze,Gr,!1)}function zf(n,a,l){var u=st;st|=2;var d=R1(),p=j1();(_t!==n||Ze!==a)&&(Sc=null,mi(n,a)),a=!1;var b=jt;e:do try{if(lt!==0&&Je!==null){var A=Je,H=$r;switch(lt){case 8:Pf(),b=6;break e;case 3:case 2:case 9:case 6:zr.current===null&&(a=!0);var ee=lt;if(lt=0,$r=null,gi(n,A,H,ee),l&&fi){b=0;break e}break;default:ee=lt,lt=0,$r=null,gi(n,A,H,ee)}}Pw(),b=jt;break}catch(de){O1(n,de)}while(!0);return a&&n.shellSuspendCounter++,Kn=cs=null,st=u,J.H=d,J.A=p,Je===null&&(_t=null,Ze=0,Vo()),b}function Pw(){for(;Je!==null;)k1(Je)}function zw(n,a){var l=st;st|=2;var u=R1(),d=j1();_t!==n||Ze!==a?(Sc=null,bc=vt()+500,mi(n,a)):fi=es(n,a);e:do try{if(lt!==0&&Je!==null){a=Je;var p=$r;t:switch(lt){case 1:lt=0,$r=null,gi(n,a,p,1);break;case 2:case 9:if(Hm(p)){lt=0,$r=null,D1(a);break}a=function(){lt!==2&&lt!==9||_t!==n||(lt=7),Dn(n)},p.then(a,a);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:Hm(p)?(lt=0,$r=null,D1(a)):(lt=0,$r=null,gi(n,a,p,7));break;case 5:var b=null;switch(Je.tag){case 26:b=Je.memoizedState;case 5:case 27:var A=Je;if(b?vp(b):A.stateNode.complete){lt=0,$r=null;var H=A.sibling;if(H!==null)Je=H;else{var ee=A.return;ee!==null?(Je=ee,Ac(ee)):Je=null}break t}}lt=0,$r=null,gi(n,a,p,5);break;case 6:lt=0,$r=null,gi(n,a,p,6);break;case 8:Pf(),jt=6;break e;default:throw Error(s(462))}}Hw();break}catch(de){O1(n,de)}while(!0);return Kn=cs=null,J.H=u,J.A=d,st=l,Je!==null?0:(_t=null,Ze=0,Vo(),jt)}function Hw(){for(;Je!==null&&!Qa();)k1(Je)}function k1(n){var a=r1(n.alternate,n,na);n.memoizedProps=n.pendingProps,a===null?Ac(n):Je=a}function D1(n){var a=n,l=a.alternate;switch(a.tag){case 15:case 0:a=Yg(l,a,a.pendingProps,a.type,void 0,Ze);break;case 11:a=Yg(l,a,a.pendingProps,a.type.render,a.ref,Ze);break;case 5:tf(a);default:a1(l,a),a=Je=jm(a,na),a=r1(l,a,na)}n.memoizedProps=n.pendingProps,a===null?Ac(n):Je=a}function gi(n,a,l,u){Kn=cs=null,tf(a),ai=null,gl=0;var d=a.return;try{if(Rw(n,d,a,l,Ze)){jt=1,dc(n,an(l,n.current)),Je=null;return}}catch(p){if(d!==null)throw Je=d,p;jt=1,dc(n,an(l,n.current)),Je=null;return}a.flags&32768?(tt||u===1?n=!0:fi||(Ze&536870912)!==0?n=!1:(Ra=n=!0,(u===2||u===9||u===3||u===6)&&(u=zr.current,u!==null&&u.tag===13&&(u.flags|=16384))),F1(a,n)):Ac(a)}function Ac(n){var a=n;do{if((a.flags&32768)!==0){F1(a,Ra);return}n=a.return;var l=Dw(a.alternate,a,na);if(l!==null){Je=l;return}if(a=a.sibling,a!==null){Je=a;return}Je=a=n}while(a!==null);jt===0&&(jt=5)}function F1(n,a){do{var l=Fw(n.alternate,n);if(l!==null){l.flags&=32767,Je=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(n=n.sibling,n!==null)){Je=n;return}Je=n=l}while(n!==null);jt=6,Je=null}function L1(n,a,l,u,d,p,b,A,H){n.cancelPendingCommit=null;do Nc();while(qt!==0);if((st&6)!==0)throw Error(s(327));if(a!==null){if(a===n.current)throw Error(s(177));if(p=a.lanes|a.childLanes,p|=O0,i0(n,l,p,b,A,H),n===_t&&(Je=_t=null,Ze=0),di=a,Da=n,aa=l,Bf=p,Mf=d,E1=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,qw(xr,function(){return P1(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=J.T,J.T=null,d=ve.p,ve.p=2,b=st,st|=4;try{Lw(n,a,l)}finally{st=b,ve.p=d,J.T=u}}qt=1,I1(),B1(),M1()}}function I1(){if(qt===1){qt=0;var n=Da,a=di,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=J.T,J.T=null;var u=ve.p;ve.p=2;var d=st;st|=4;try{p1(a,n);var p=Zf,b=bm(n.containerInfo),A=p.focusedElem,H=p.selectionRange;if(b!==A&&A&&A.ownerDocument&&wm(A.ownerDocument.documentElement,A)){if(H!==null&&S0(A)){var ee=H.start,de=H.end;if(de===void 0&&(de=ee),"selectionStart"in A)A.selectionStart=ee,A.selectionEnd=Math.min(de,A.value.length);else{var xe=A.ownerDocument||document,se=xe&&xe.defaultView||window;if(se.getSelection){var ue=se.getSelection(),Be=A.textContent.length,$e=Math.min(H.start,Be),pt=H.end===void 0?$e:Math.min(H.end,Be);!ue.extend&&$e>pt&&(b=pt,pt=$e,$e=b);var Y=ym(A,$e),V=ym(A,pt);if(Y&&V&&(ue.rangeCount!==1||ue.anchorNode!==Y.node||ue.anchorOffset!==Y.offset||ue.focusNode!==V.node||ue.focusOffset!==V.offset)){var Q=xe.createRange();Q.setStart(Y.node,Y.offset),ue.removeAllRanges(),$e>pt?(ue.addRange(Q),ue.extend(V.node,V.offset)):(Q.setEnd(V.node,V.offset),ue.addRange(Q))}}}}for(xe=[],ue=A;ue=ue.parentNode;)ue.nodeType===1&&xe.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<xe.length;A++){var ge=xe[A];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}Uc=!!Qf,Zf=Qf=null}finally{st=d,ve.p=u,J.T=l}}n.current=a,qt=2}}function B1(){if(qt===2){qt=0;var n=Da,a=di,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=J.T,J.T=null;var u=ve.p;ve.p=2;var d=st;st|=4;try{f1(n,a.alternate,a)}finally{st=d,ve.p=u,J.T=l}}qt=3}}function M1(){if(qt===4||qt===3){qt=0,pa();var n=Da,a=di,l=aa,u=E1;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?qt=5:(qt=0,di=Da=null,U1(n,n.pendingLanes));var d=n.pendingLanes;if(d===0&&(ka=null),el(l),a=a.stateNode,hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(xa,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=J.T,d=ve.p,ve.p=2,J.T=null;try{for(var p=n.onRecoverableError,b=0;b<u.length;b++){var A=u[b];p(A.value,{componentStack:A.stack})}}finally{J.T=a,ve.p=d}}(aa&3)!==0&&Nc(),Dn(n),d=n.pendingLanes,(l&261930)!==0&&(d&42)!==0?n===Uf?kl++:(kl=0,Uf=n):kl=0,Dl(0)}}function U1(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,dl(a)))}function Nc(){return I1(),B1(),M1(),P1()}function P1(){if(qt!==5)return!1;var n=Da,a=Bf;Bf=0;var l=el(aa),u=J.T,d=ve.p;try{ve.p=32>l?32:l,J.T=null,l=Mf,Mf=null;var p=Da,b=aa;if(qt=0,di=Da=null,aa=0,(st&6)!==0)throw Error(s(331));var A=st;if(st|=4,w1(p.current),v1(p,p.current,b,l),st=A,Dl(0,!1),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(xa,p)}catch{}return!0}finally{ve.p=d,J.T=u,U1(n,a)}}function z1(n,a,l){a=an(l,a),a=xf(n.stateNode,a,2),n=Aa(n,a,2),n!==null&&(ts(n,2),Dn(n))}function ot(n,a,l){if(n.tag===3)z1(n,n,l);else for(;a!==null;){if(a.tag===3){z1(a,n,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ka===null||!ka.has(u))){n=an(l,n),l=Hg(2),u=Aa(a,l,2),u!==null&&($g(l,u,a,n),ts(u,2),Dn(u));break}}a=a.return}}function Hf(n,a,l){var u=n.pingCache;if(u===null){u=n.pingCache=new Mw;var d=new Set;u.set(a,d)}else d=u.get(a),d===void 0&&(d=new Set,u.set(a,d));d.has(l)||(Ff=!0,d.add(l),n=$w.bind(null,n,a,l),a.then(n,n))}function $w(n,a,l){var u=n.pingCache;u!==null&&u.delete(a),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,_t===n&&(Ze&l)===l&&(jt===4||jt===3&&(Ze&62914560)===Ze&&300>vt()-wc?(st&2)===0&&mi(n,0):Lf|=l,hi===Ze&&(hi=0)),Dn(n)}function H1(n,a){a===0&&(a=ko()),n=is(n,a),n!==null&&(ts(n,a),Dn(n))}function Gw(n){var a=n.memoizedState,l=0;a!==null&&(l=a.retryLane),H1(n,l)}function Vw(n,a){var l=0;switch(n.tag){case 31:case 13:var u=n.stateNode,d=n.memoizedState;d!==null&&(l=d.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(a),H1(n,l)}function qw(n,a){return Mr(n,a)}var Oc=null,pi=null,$f=!1,Cc=!1,Gf=!1,La=0;function Dn(n){n!==pi&&n.next===null&&(pi===null?Oc=pi=n:pi=pi.next=n),Cc=!0,$f||($f=!0,Ww())}function Dl(n,a){if(!Gf&&Cc){Gf=!0;do for(var l=!1,u=Oc;u!==null;){if(n!==0){var d=u.pendingLanes;if(d===0)var p=0;else{var b=u.suspendedLanes,A=u.pingedLanes;p=(1<<31-vr(42|n)+1)-1,p&=d&~(b&~A),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(l=!0,q1(u,p))}else p=Ze,p=Ps(u,u===_t?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||es(u,p)||(l=!0,q1(u,p));u=u.next}while(l);Gf=!1}}function Kw(){$1()}function $1(){Cc=$f=!1;var n=0;La!==0&&ab()&&(n=La);for(var a=vt(),l=null,u=Oc;u!==null;){var d=u.next,p=G1(u,a);p===0?(u.next=null,l===null?Oc=d:l.next=d,d===null&&(pi=l)):(l=u,(n!==0||(p&3)!==0)&&(Cc=!0)),u=d}qt!==0&&qt!==5||Dl(n),La!==0&&(La=0)}function G1(n,a){for(var l=n.suspendedLanes,u=n.pingedLanes,d=n.expirationTimes,p=n.pendingLanes&-62914561;0<p;){var b=31-vr(p),A=1<<b,H=d[b];H===-1?((A&l)===0||(A&u)!==0)&&(d[b]=s0(A,a)):H<=a&&(n.expiredLanes|=A),p&=~A}if(a=_t,l=Ze,l=Ps(n,n===a?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,l===0||n===a&&(lt===2||lt===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&Qr(u),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||es(n,l)){if(a=l&-l,a===n.callbackPriority)return a;switch(u!==null&&Qr(u),el(l)){case 2:case 8:l=zn;break;case 32:l=xr;break;case 268435456:l=Ji;break;default:l=xr}return u=V1.bind(null,n),l=Mr(l,u),n.callbackPriority=a,n.callbackNode=l,a}return u!==null&&u!==null&&Qr(u),n.callbackPriority=2,n.callbackNode=null,2}function V1(n,a){if(qt!==0&&qt!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(Nc()&&n.callbackNode!==l)return null;var u=Ze;return u=Ps(n,n===_t?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(A1(n,u,a),G1(n,vt()),n.callbackNode!=null&&n.callbackNode===l?V1.bind(null,n):null)}function q1(n,a){if(Nc())return null;A1(n,a,!0)}function Ww(){ib(function(){(st&6)!==0?Mr(Pn,Kw):$1()})}function Vf(){if(La===0){var n=ti;n===0&&(n=Za,Za<<=1,(Za&261888)===0&&(Za=256)),La=n}return La}function K1(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Bo(""+n)}function W1(n,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,n.id&&l.setAttribute("form",n.id),a.parentNode.insertBefore(l,a),n=new FormData(n),l.parentNode.removeChild(l),n}function Xw(n,a,l,u,d){if(a==="submit"&&l&&l.stateNode===d){var p=K1((d[D]||null).action),b=u.submitter;b&&(a=(a=b[D]||null)?K1(a.formAction):b.getAttribute("formAction"),a!==null&&(p=a,b=null));var A=new zo("action","action",null,u,d);n.push({event:A,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(La!==0){var H=b?W1(d,b):new FormData(d);ff(l,{pending:!0,data:H,method:d.method,action:p},null,H)}}else typeof p=="function"&&(A.preventDefault(),H=b?W1(d,b):new FormData(d),ff(l,{pending:!0,data:H,method:d.method,action:p},p,H))},currentTarget:d}]})}}for(var qf=0;qf<N0.length;qf++){var Kf=N0[qf],Yw=Kf.toLowerCase(),Jw=Kf[0].toUpperCase()+Kf.slice(1);pn(Yw,"on"+Jw)}pn(Tm,"onAnimationEnd"),pn(Am,"onAnimationIteration"),pn(Nm,"onAnimationStart"),pn("dblclick","onDoubleClick"),pn("focusin","onFocus"),pn("focusout","onBlur"),pn(dw,"onTransitionRun"),pn(mw,"onTransitionStart"),pn(gw,"onTransitionCancel"),pn(Om,"onTransitionEnd"),en("onMouseEnter",["mouseout","mouseover"]),en("onMouseLeave",["mouseout","mouseover"]),en("onPointerEnter",["pointerout","pointerover"]),en("onPointerLeave",["pointerout","pointerover"]),Nt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Nt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Nt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Nt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Nt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Nt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fl));function X1(n,a){a=(a&4)!==0;for(var l=0;l<n.length;l++){var u=n[l],d=u.event;u=u.listeners;e:{var p=void 0;if(a)for(var b=u.length-1;0<=b;b--){var A=u[b],H=A.instance,ee=A.currentTarget;if(A=A.listener,H!==p&&d.isPropagationStopped())break e;p=A,d.currentTarget=ee;try{p(d)}catch(de){Go(de)}d.currentTarget=null,p=H}else for(b=0;b<u.length;b++){if(A=u[b],H=A.instance,ee=A.currentTarget,A=A.listener,H!==p&&d.isPropagationStopped())break e;p=A,d.currentTarget=ee;try{p(d)}catch(de){Go(de)}d.currentTarget=null,p=H}}}}function Qe(n,a){var l=a[te];l===void 0&&(l=a[te]=new Set);var u=n+"__bubble";l.has(u)||(Y1(a,n,2,!1),l.add(u))}function Wf(n,a,l){var u=0;a&&(u|=4),Y1(l,n,u,a)}var Rc="_reactListening"+Math.random().toString(36).slice(2);function Xf(n){if(!n[Rc]){n[Rc]=!0,yt.forEach(function(l){l!=="selectionchange"&&(Qw.has(l)||Wf(l,!1,n),Wf(l,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[Rc]||(a[Rc]=!0,Wf("selectionchange",!1,a))}}function Y1(n,a,l,u){switch(Tp(a)){case 2:var d=Ab;break;case 8:d=Nb;break;default:d=uh}l=d.bind(null,a,l,n),d=void 0,!m0||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(d=!0),u?d!==void 0?n.addEventListener(a,l,{capture:!0,passive:d}):n.addEventListener(a,l,!0):d!==void 0?n.addEventListener(a,l,{passive:d}):n.addEventListener(a,l,!1)}function Yf(n,a,l,u,d){var p=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var A=u.stateNode.containerInfo;if(A===d)break;if(b===4)for(b=u.return;b!==null;){var H=b.tag;if((H===3||H===4)&&b.stateNode.containerInfo===d)return;b=b.return}for(;A!==null;){if(b=Ce(A),b===null)return;if(H=b.tag,H===5||H===6||H===26||H===27){u=p=b;continue e}A=A.parentNode}}u=u.return}tm(function(){var ee=p,de=h0(l),xe=[];e:{var se=Cm.get(n);if(se!==void 0){var ue=zo,Be=n;switch(n){case"keypress":if(Uo(l)===0)break e;case"keydown":case"keyup":ue=V2;break;case"focusin":Be="focus",ue=v0;break;case"focusout":Be="blur",ue=v0;break;case"beforeblur":case"afterblur":ue=v0;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=am;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=D2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=W2;break;case Tm:case Am:case Nm:ue=I2;break;case Om:ue=Y2;break;case"scroll":case"scrollend":ue=j2;break;case"wheel":ue=Q2;break;case"copy":case"cut":case"paste":ue=M2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=im;break;case"toggle":case"beforetoggle":ue=ew}var $e=(a&4)!==0,pt=!$e&&(n==="scroll"||n==="scrollend"),Y=$e?se!==null?se+"Capture":null:se;$e=[];for(var V=ee,Q;V!==null;){var ge=V;if(Q=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||Q===null||Y===null||(ge=rl(V,Y),ge!=null&&$e.push(Ll(V,ge,Q))),pt)break;V=V.return}0<$e.length&&(se=new ue(se,Be,null,l,de),xe.push({event:se,listeners:$e}))}}if((a&7)===0){e:{if(se=n==="mouseover"||n==="pointerover",ue=n==="mouseout"||n==="pointerout",se&&l!==f0&&(Be=l.relatedTarget||l.fromElement)&&(Ce(Be)||Be[B]))break e;if((ue||se)&&(se=de.window===de?de:(se=de.ownerDocument)?se.defaultView||se.parentWindow:window,ue?(Be=l.relatedTarget||l.toElement,ue=ee,Be=Be?Ce(Be):null,Be!==null&&(pt=o(Be),$e=Be.tag,Be!==pt||$e!==5&&$e!==27&&$e!==6)&&(Be=null)):(ue=null,Be=ee),ue!==Be)){if($e=am,ge="onMouseLeave",Y="onMouseEnter",V="mouse",(n==="pointerout"||n==="pointerover")&&($e=im,ge="onPointerLeave",Y="onPointerEnter",V="pointer"),pt=ue==null?se:Te(ue),Q=Be==null?se:Te(Be),se=new $e(ge,V+"leave",ue,l,de),se.target=pt,se.relatedTarget=Q,ge=null,Ce(de)===ee&&($e=new $e(Y,V+"enter",Be,l,de),$e.target=Q,$e.relatedTarget=pt,ge=$e),pt=ge,ue&&Be)t:{for($e=Zw,Y=ue,V=Be,Q=0,ge=Y;ge;ge=$e(ge))Q++;ge=0;for(var ze=V;ze;ze=$e(ze))ge++;for(;0<Q-ge;)Y=$e(Y),Q--;for(;0<ge-Q;)V=$e(V),ge--;for(;Q--;){if(Y===V||V!==null&&Y===V.alternate){$e=Y;break t}Y=$e(Y),V=$e(V)}$e=null}else $e=null;ue!==null&&J1(xe,se,ue,$e,!1),Be!==null&&pt!==null&&J1(xe,pt,Be,$e,!0)}}e:{if(se=ee?Te(ee):window,ue=se.nodeName&&se.nodeName.toLowerCase(),ue==="select"||ue==="input"&&se.type==="file")var rt=mm;else if(hm(se))if(gm)rt=uw;else{rt=ow;var Ue=lw}else ue=se.nodeName,!ue||ue.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ee&&u0(ee.elementType)&&(rt=mm):rt=cw;if(rt&&(rt=rt(n,ee))){dm(xe,rt,l,de);break e}Ue&&Ue(n,se,ee),n==="focusout"&&ee&&se.type==="number"&&ee.memoizedProps.value!=null&&c0(se,"number",se.value)}switch(Ue=ee?Te(ee):window,n){case"focusin":(hm(Ue)||Ue.contentEditable==="true")&&(Ks=Ue,E0=ee,ul=null);break;case"focusout":ul=E0=Ks=null;break;case"mousedown":T0=!0;break;case"contextmenu":case"mouseup":case"dragend":T0=!1,Sm(xe,l,de);break;case"selectionchange":if(hw)break;case"keydown":case"keyup":Sm(xe,l,de)}var Xe;if(y0)e:{switch(n){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else qs?um(n,l)&&(et="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(et="onCompositionStart");et&&(lm&&l.locale!=="ko"&&(qs||et!=="onCompositionStart"?et==="onCompositionEnd"&&qs&&(Xe=rm()):(_a=de,g0="value"in _a?_a.value:_a.textContent,qs=!0)),Ue=jc(ee,et),0<Ue.length&&(et=new sm(et,n,null,l,de),xe.push({event:et,listeners:Ue}),Xe?et.data=Xe:(Xe=fm(l),Xe!==null&&(et.data=Xe)))),(Xe=rw?nw(n,l):aw(n,l))&&(et=jc(ee,"onBeforeInput"),0<et.length&&(Ue=new sm("onBeforeInput","beforeinput",null,l,de),xe.push({event:Ue,listeners:et}),Ue.data=Xe)),Xw(xe,n,ee,l,de)}X1(xe,a)})}function Ll(n,a,l){return{instance:n,listener:a,currentTarget:l}}function jc(n,a){for(var l=a+"Capture",u=[];n!==null;){var d=n,p=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||p===null||(d=rl(n,l),d!=null&&u.unshift(Ll(n,d,p)),d=rl(n,a),d!=null&&u.push(Ll(n,d,p))),n.tag===3)return u;n=n.return}return[]}function Zw(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function J1(n,a,l,u,d){for(var p=a._reactName,b=[];l!==null&&l!==u;){var A=l,H=A.alternate,ee=A.stateNode;if(A=A.tag,H!==null&&H===u)break;A!==5&&A!==26&&A!==27||ee===null||(H=ee,d?(ee=rl(l,p),ee!=null&&b.unshift(Ll(l,ee,H))):d||(ee=rl(l,p),ee!=null&&b.push(Ll(l,ee,H)))),l=l.return}b.length!==0&&n.push({event:a,listeners:b})}var eb=/\r\n?/g,tb=/\u0000|\uFFFD/g;function Q1(n){return(typeof n=="string"?n:""+n).replace(eb,`
`).replace(tb,"")}function Z1(n,a){return a=Q1(a),Q1(n)===a}function gt(n,a,l,u,d,p){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||$s(n,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&$s(n,""+u);break;case"className":Lo(n,"class",u);break;case"tabIndex":Lo(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Lo(n,l,u);break;case"style":Zd(n,u,p);break;case"data":if(a!=="object"){Lo(n,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){n.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(l);break}u=Bo(""+u),n.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(l==="formAction"?(a!=="input"&&gt(n,a,"name",d.name,d,null),gt(n,a,"formEncType",d.formEncType,d,null),gt(n,a,"formMethod",d.formMethod,d,null),gt(n,a,"formTarget",d.formTarget,d,null)):(gt(n,a,"encType",d.encType,d,null),gt(n,a,"method",d.method,d,null),gt(n,a,"target",d.target,d,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(l);break}u=Bo(""+u),n.setAttribute(l,u);break;case"onClick":u!=null&&(n.onclick=$n);break;case"onScroll":u!=null&&Qe("scroll",n);break;case"onScrollEnd":u!=null&&Qe("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(l=u.__html,l!=null){if(d.children!=null)throw Error(s(60));n.innerHTML=l}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}l=Bo(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,""+u):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":u===!0?n.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,u):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(l,u):n.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(l):n.setAttribute(l,u);break;case"popover":Qe("beforetoggle",n),Qe("toggle",n),Tr(n,"popover",u);break;case"xlinkActuate":Hn(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Hn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Hn(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Hn(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Hn(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Hn(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Hn(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Hn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Hn(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Tr(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=C2.get(l)||l,Tr(n,l,u))}}function Jf(n,a,l,u,d,p){switch(l){case"style":Zd(n,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(l=u.__html,l!=null){if(d.children!=null)throw Error(s(60));n.innerHTML=l}}break;case"children":typeof u=="string"?$s(n,u):(typeof u=="number"||typeof u=="bigint")&&$s(n,""+u);break;case"onScroll":u!=null&&Qe("scroll",n);break;case"onScrollEnd":u!=null&&Qe("scrollend",n);break;case"onClick":u!=null&&(n.onclick=$n);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!wt.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(d=l.endsWith("Capture"),a=l.slice(2,d?l.length-7:void 0),p=n[D]||null,p=p!=null?p[l]:null,typeof p=="function"&&n.removeEventListener(a,p,d),typeof u=="function")){typeof p!="function"&&p!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(a,u,d);break e}l in n?n[l]=u:u===!0?n.setAttribute(l,""):Tr(n,l,u)}}}function nr(n,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qe("error",n),Qe("load",n);var u=!1,d=!1,p;for(p in l)if(l.hasOwnProperty(p)){var b=l[p];if(b!=null)switch(p){case"src":u=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:gt(n,a,p,b,l,null)}}d&&gt(n,a,"srcSet",l.srcSet,l,null),u&&gt(n,a,"src",l.src,l,null);return;case"input":Qe("invalid",n);var A=p=b=d=null,H=null,ee=null;for(u in l)if(l.hasOwnProperty(u)){var de=l[u];if(de!=null)switch(u){case"name":d=de;break;case"type":b=de;break;case"checked":H=de;break;case"defaultChecked":ee=de;break;case"value":p=de;break;case"defaultValue":A=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(s(137,a));break;default:gt(n,a,u,de,l,null)}}Xd(n,p,A,H,ee,b,d,!1);return;case"select":Qe("invalid",n),u=b=p=null;for(d in l)if(l.hasOwnProperty(d)&&(A=l[d],A!=null))switch(d){case"value":p=A;break;case"defaultValue":b=A;break;case"multiple":u=A;default:gt(n,a,d,A,l,null)}a=p,l=b,n.multiple=!!u,a!=null?Hs(n,!!u,a,!1):l!=null&&Hs(n,!!u,l,!0);return;case"textarea":Qe("invalid",n),p=d=u=null;for(b in l)if(l.hasOwnProperty(b)&&(A=l[b],A!=null))switch(b){case"value":u=A;break;case"defaultValue":d=A;break;case"children":p=A;break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(s(91));break;default:gt(n,a,b,A,l,null)}Jd(n,u,d,p);return;case"option":for(H in l)if(l.hasOwnProperty(H)&&(u=l[H],u!=null))switch(H){case"selected":n.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:gt(n,a,H,u,l,null)}return;case"dialog":Qe("beforetoggle",n),Qe("toggle",n),Qe("cancel",n),Qe("close",n);break;case"iframe":case"object":Qe("load",n);break;case"video":case"audio":for(u=0;u<Fl.length;u++)Qe(Fl[u],n);break;case"image":Qe("error",n),Qe("load",n);break;case"details":Qe("toggle",n);break;case"embed":case"source":case"link":Qe("error",n),Qe("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ee in l)if(l.hasOwnProperty(ee)&&(u=l[ee],u!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:gt(n,a,ee,u,l,null)}return;default:if(u0(a)){for(de in l)l.hasOwnProperty(de)&&(u=l[de],u!==void 0&&Jf(n,a,de,u,l,void 0));return}}for(A in l)l.hasOwnProperty(A)&&(u=l[A],u!=null&&gt(n,a,A,u,l,null))}function rb(n,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,p=null,b=null,A=null,H=null,ee=null,de=null;for(ue in l){var xe=l[ue];if(l.hasOwnProperty(ue)&&xe!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":H=xe;default:u.hasOwnProperty(ue)||gt(n,a,ue,null,u,xe)}}for(var se in u){var ue=u[se];if(xe=l[se],u.hasOwnProperty(se)&&(ue!=null||xe!=null))switch(se){case"type":p=ue;break;case"name":d=ue;break;case"checked":ee=ue;break;case"defaultChecked":de=ue;break;case"value":b=ue;break;case"defaultValue":A=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,a));break;default:ue!==xe&&gt(n,a,se,ue,u,xe)}}o0(n,b,A,H,ee,de,p,d);return;case"select":ue=b=A=se=null;for(p in l)if(H=l[p],l.hasOwnProperty(p)&&H!=null)switch(p){case"value":break;case"multiple":ue=H;default:u.hasOwnProperty(p)||gt(n,a,p,null,u,H)}for(d in u)if(p=u[d],H=l[d],u.hasOwnProperty(d)&&(p!=null||H!=null))switch(d){case"value":se=p;break;case"defaultValue":A=p;break;case"multiple":b=p;default:p!==H&&gt(n,a,d,p,u,H)}a=A,l=b,u=ue,se!=null?Hs(n,!!l,se,!1):!!u!=!!l&&(a!=null?Hs(n,!!l,a,!0):Hs(n,!!l,l?[]:"",!1));return;case"textarea":ue=se=null;for(A in l)if(d=l[A],l.hasOwnProperty(A)&&d!=null&&!u.hasOwnProperty(A))switch(A){case"value":break;case"children":break;default:gt(n,a,A,null,u,d)}for(b in u)if(d=u[b],p=l[b],u.hasOwnProperty(b)&&(d!=null||p!=null))switch(b){case"value":se=d;break;case"defaultValue":ue=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(s(91));break;default:d!==p&&gt(n,a,b,d,u,p)}Yd(n,se,ue);return;case"option":for(var Be in l)if(se=l[Be],l.hasOwnProperty(Be)&&se!=null&&!u.hasOwnProperty(Be))switch(Be){case"selected":n.selected=!1;break;default:gt(n,a,Be,null,u,se)}for(H in u)if(se=u[H],ue=l[H],u.hasOwnProperty(H)&&se!==ue&&(se!=null||ue!=null))switch(H){case"selected":n.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:gt(n,a,H,se,u,ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $e in l)se=l[$e],l.hasOwnProperty($e)&&se!=null&&!u.hasOwnProperty($e)&&gt(n,a,$e,null,u,se);for(ee in u)if(se=u[ee],ue=l[ee],u.hasOwnProperty(ee)&&se!==ue&&(se!=null||ue!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,a));break;default:gt(n,a,ee,se,u,ue)}return;default:if(u0(a)){for(var pt in l)se=l[pt],l.hasOwnProperty(pt)&&se!==void 0&&!u.hasOwnProperty(pt)&&Jf(n,a,pt,void 0,u,se);for(de in u)se=u[de],ue=l[de],!u.hasOwnProperty(de)||se===ue||se===void 0&&ue===void 0||Jf(n,a,de,se,u,ue);return}}for(var Y in l)se=l[Y],l.hasOwnProperty(Y)&&se!=null&&!u.hasOwnProperty(Y)&&gt(n,a,Y,null,u,se);for(xe in u)se=u[xe],ue=l[xe],!u.hasOwnProperty(xe)||se===ue||se==null&&ue==null||gt(n,a,xe,se,u,ue)}function ep(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nb(){if(typeof performance.getEntriesByType=="function"){for(var n=0,a=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var d=l[u],p=d.transferSize,b=d.initiatorType,A=d.duration;if(p&&A&&ep(b)){for(b=0,A=d.responseEnd,u+=1;u<l.length;u++){var H=l[u],ee=H.startTime;if(ee>A)break;var de=H.transferSize,xe=H.initiatorType;de&&ep(xe)&&(H=H.responseEnd,b+=de*(H<A?1:(A-ee)/(H-ee)))}if(--u,a+=8*(p+b)/(d.duration/1e3),n++,10<n)break}}if(0<n)return a/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Qf=null,Zf=null;function kc(n){return n.nodeType===9?n:n.ownerDocument}function tp(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rp(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function eh(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var th=null;function ab(){var n=window.event;return n&&n.type==="popstate"?n===th?!1:(th=n,!0):(th=null,!1)}var np=typeof setTimeout=="function"?setTimeout:void 0,sb=typeof clearTimeout=="function"?clearTimeout:void 0,ap=typeof Promise=="function"?Promise:void 0,ib=typeof queueMicrotask=="function"?queueMicrotask:typeof ap<"u"?function(n){return ap.resolve(null).then(n).catch(lb)}:np;function lb(n){setTimeout(function(){throw n})}function Ia(n){return n==="head"}function sp(n,a){var l=a,u=0;do{var d=l.nextSibling;if(n.removeChild(l),d&&d.nodeType===8)if(l=d.data,l==="/$"||l==="/&"){if(u===0){n.removeChild(d),yi(a);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Il(n.ownerDocument.documentElement);else if(l==="head"){l=n.ownerDocument.head,Il(l);for(var p=l.firstChild;p;){var b=p.nextSibling,A=p.nodeName;p[ie]||A==="SCRIPT"||A==="STYLE"||A==="LINK"&&p.rel.toLowerCase()==="stylesheet"||l.removeChild(p),p=b}}else l==="body"&&Il(n.ownerDocument.body);l=d}while(l);yi(a)}function ip(n,a){var l=n;n=0;do{var u=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(n===0)break;n--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||n++;l=u}while(l)}function rh(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":rh(l),Se(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function ob(n,a,l,u){for(;n.nodeType===1;){var d=l;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[ie])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(p=n.getAttribute("rel"),p==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(p!==d.rel||n.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||n.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||n.getAttribute("title")!==(d.title==null?null:d.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(p=n.getAttribute("src"),(p!==(d.src==null?null:d.src)||n.getAttribute("type")!==(d.type==null?null:d.type)||n.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&p&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var p=d.name==null?null:""+d.name;if(d.type==="hidden"&&n.getAttribute("name")===p)return n}else return n;if(n=un(n.nextSibling),n===null)break}return null}function cb(n,a,l){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=un(n.nextSibling),n===null))return null;return n}function lp(n,a){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!a||(n=un(n.nextSibling),n===null))return null;return n}function nh(n){return n.data==="$?"||n.data==="$~"}function ah(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function ub(n,a){var l=n.ownerDocument;if(n.data==="$~")n._reactRetry=a;else if(n.data!=="$?"||l.readyState!=="loading")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function un(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return n}var sh=null;function op(n){n=n.nextSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"||l==="/&"){if(a===0)return un(n.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}n=n.nextSibling}return null}function cp(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return n;a--}else l!=="/$"&&l!=="/&"||a++}n=n.previousSibling}return null}function up(n,a,l){switch(a=kc(l),n){case"html":if(n=a.documentElement,!n)throw Error(s(452));return n;case"head":if(n=a.head,!n)throw Error(s(453));return n;case"body":if(n=a.body,!n)throw Error(s(454));return n;default:throw Error(s(451))}}function Il(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);Se(n)}var fn=new Map,fp=new Set;function Dc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var sa=ve.d;ve.d={f:fb,r:hb,D:db,C:mb,L:gb,m:pb,X:vb,S:xb,M:_b};function fb(){var n=sa.f(),a=Ec();return n||a}function hb(n){var a=Fe(n);a!==null&&a.tag===5&&a.type==="form"?Og(a):sa.r(n)}var xi=typeof document>"u"?null:document;function hp(n,a,l){var u=xi;if(u&&typeof a=="string"&&a){var d=rn(a);d='link[rel="'+n+'"][href="'+d+'"]',typeof l=="string"&&(d+='[crossorigin="'+l+'"]'),fp.has(d)||(fp.add(d),n={rel:n,crossOrigin:l,href:a},u.querySelector(d)===null&&(a=u.createElement("link"),nr(a,"link",n),Me(a),u.head.appendChild(a)))}}function db(n){sa.D(n),hp("dns-prefetch",n,null)}function mb(n,a){sa.C(n,a),hp("preconnect",n,a)}function gb(n,a,l){sa.L(n,a,l);var u=xi;if(u&&n&&a){var d='link[rel="preload"][as="'+rn(a)+'"]';a==="image"&&l&&l.imageSrcSet?(d+='[imagesrcset="'+rn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(d+='[imagesizes="'+rn(l.imageSizes)+'"]')):d+='[href="'+rn(n)+'"]';var p=d;switch(a){case"style":p=vi(n);break;case"script":p=_i(n)}fn.has(p)||(n=v({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:n,as:a},l),fn.set(p,n),u.querySelector(d)!==null||a==="style"&&u.querySelector(Bl(p))||a==="script"&&u.querySelector(Ml(p))||(a=u.createElement("link"),nr(a,"link",n),Me(a),u.head.appendChild(a)))}}function pb(n,a){sa.m(n,a);var l=xi;if(l&&n){var u=a&&typeof a.as=="string"?a.as:"script",d='link[rel="modulepreload"][as="'+rn(u)+'"][href="'+rn(n)+'"]',p=d;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=_i(n)}if(!fn.has(p)&&(n=v({rel:"modulepreload",href:n},a),fn.set(p,n),l.querySelector(d)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Ml(p)))return}u=l.createElement("link"),nr(u,"link",n),Me(u),l.head.appendChild(u)}}}function xb(n,a,l){sa.S(n,a,l);var u=xi;if(u&&n){var d=ke(u).hoistableStyles,p=vi(n);a=a||"default";var b=d.get(p);if(!b){var A={loading:0,preload:null};if(b=u.querySelector(Bl(p)))A.loading=5;else{n=v({rel:"stylesheet",href:n,"data-precedence":a},l),(l=fn.get(p))&&ih(n,l);var H=b=u.createElement("link");Me(H),nr(H,"link",n),H._p=new Promise(function(ee,de){H.onload=ee,H.onerror=de}),H.addEventListener("load",function(){A.loading|=1}),H.addEventListener("error",function(){A.loading|=2}),A.loading|=4,Fc(b,a,u)}b={type:"stylesheet",instance:b,count:1,state:A},d.set(p,b)}}}function vb(n,a){sa.X(n,a);var l=xi;if(l&&n){var u=ke(l).hoistableScripts,d=_i(n),p=u.get(d);p||(p=l.querySelector(Ml(d)),p||(n=v({src:n,async:!0},a),(a=fn.get(d))&&lh(n,a),p=l.createElement("script"),Me(p),nr(p,"link",n),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(d,p))}}function _b(n,a){sa.M(n,a);var l=xi;if(l&&n){var u=ke(l).hoistableScripts,d=_i(n),p=u.get(d);p||(p=l.querySelector(Ml(d)),p||(n=v({src:n,async:!0,type:"module"},a),(a=fn.get(d))&&lh(n,a),p=l.createElement("script"),Me(p),nr(p,"link",n),l.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(d,p))}}function dp(n,a,l,u){var d=(d=Z.current)?Dc(d):null;if(!d)throw Error(s(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=vi(l.href),l=ke(d).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=vi(l.href);var p=ke(d).hoistableStyles,b=p.get(n);if(b||(d=d.ownerDocument||d,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(n,b),(p=d.querySelector(Bl(n)))&&!p._p&&(b.instance=p,b.state.loading=5),fn.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},fn.set(n,l),p||yb(d,n,l,b.state))),a&&u===null)throw Error(s(528,""));return b}if(a&&u!==null)throw Error(s(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=_i(l),l=ke(d).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,n))}}function vi(n){return'href="'+rn(n)+'"'}function Bl(n){return'link[rel="stylesheet"]['+n+"]"}function mp(n){return v({},n,{"data-precedence":n.precedence,precedence:null})}function yb(n,a,l,u){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=n.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),nr(a,"link",l),Me(a),n.head.appendChild(a))}function _i(n){return'[src="'+rn(n)+'"]'}function Ml(n){return"script[async]"+n}function gp(n,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=n.querySelector('style[data-href~="'+rn(l.href)+'"]');if(u)return a.instance=u,Me(u),u;var d=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),Me(u),nr(u,"style",d),Fc(u,l.precedence,n),a.instance=u;case"stylesheet":d=vi(l.href);var p=n.querySelector(Bl(d));if(p)return a.state.loading|=4,a.instance=p,Me(p),p;u=mp(l),(d=fn.get(d))&&ih(u,d),p=(n.ownerDocument||n).createElement("link"),Me(p);var b=p;return b._p=new Promise(function(A,H){b.onload=A,b.onerror=H}),nr(p,"link",u),a.state.loading|=4,Fc(p,l.precedence,n),a.instance=p;case"script":return p=_i(l.src),(d=n.querySelector(Ml(p)))?(a.instance=d,Me(d),d):(u=l,(d=fn.get(p))&&(u=v({},l),lh(u,d)),n=n.ownerDocument||n,d=n.createElement("script"),Me(d),nr(d,"link",u),n.head.appendChild(d),a.instance=d);case"void":return null;default:throw Error(s(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,Fc(u,l.precedence,n));return a.instance}function Fc(n,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=u.length?u[u.length-1]:null,p=d,b=0;b<u.length;b++){var A=u[b];if(A.dataset.precedence===a)p=A;else if(p!==d)break}p?p.parentNode.insertBefore(n,p.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(n,a.firstChild))}function ih(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function lh(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var Lc=null;function pp(n,a,l){if(Lc===null){var u=new Map,d=Lc=new Map;d.set(l,u)}else d=Lc,u=d.get(l),u||(u=new Map,d.set(l,u));if(u.has(n))return u;for(u.set(n,null),l=l.getElementsByTagName(n),d=0;d<l.length;d++){var p=l[d];if(!(p[ie]||p[j]||n==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(a)||"";b=n+b;var A=u.get(b);A?A.push(p):u.set(b,[p])}}return u}function xp(n,a,l){n=n.ownerDocument||n,n.head.insertBefore(l,a==="title"?n.querySelector("head > title"):null)}function wb(n,a,l){if(l===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return n=a.disabled,typeof a.precedence=="string"&&n==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function vp(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function bb(n,a,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var d=vi(u.href),p=a.querySelector(Bl(d));if(p){a=p._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(n.count++,n=Ic.bind(n),a.then(n,n)),l.state.loading|=4,l.instance=p,Me(p);return}p=a.ownerDocument||a,u=mp(u),(d=fn.get(d))&&ih(u,d),p=p.createElement("link"),Me(p);var b=p;b._p=new Promise(function(A,H){b.onload=A,b.onerror=H}),nr(p,"link",u),l.instance=p}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(n.count++,l=Ic.bind(n),a.addEventListener("load",l),a.addEventListener("error",l))}}var oh=0;function Sb(n,a){return n.stylesheets&&n.count===0&&Mc(n,n.stylesheets),0<n.count||0<n.imgCount?function(l){var u=setTimeout(function(){if(n.stylesheets&&Mc(n,n.stylesheets),n.unsuspend){var p=n.unsuspend;n.unsuspend=null,p()}},6e4+a);0<n.imgBytes&&oh===0&&(oh=62500*nb());var d=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Mc(n,n.stylesheets),n.unsuspend)){var p=n.unsuspend;n.unsuspend=null,p()}},(n.imgBytes>oh?50:800)+a);return n.unsuspend=l,function(){n.unsuspend=null,clearTimeout(u),clearTimeout(d)}}:null}function Ic(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Mc(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Bc=null;function Mc(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Bc=new Map,a.forEach(Eb,n),Bc=null,Ic.call(n))}function Eb(n,a){if(!(a.state.loading&4)){var l=Bc.get(n);if(l)var u=l.get(null);else{l=new Map,Bc.set(n,l);for(var d=n.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<d.length;p++){var b=d[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),u=b)}u&&l.set(null,u)}d=a.instance,b=d.getAttribute("data-precedence"),p=l.get(b)||u,p===u&&l.set(null,d),l.set(b,d),this.count++,u=Ic.bind(this),d.addEventListener("load",u),d.addEventListener("error",u),p?p.parentNode.insertBefore(d,p.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(d,n.firstChild)),a.state.loading|=4}}var Ul={$$typeof:O,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function Tb(n,a,l,u,d,p,b,A,H){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Qi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qi(0),this.hiddenUpdates=Qi(null),this.identifierPrefix=u,this.onUncaughtError=d,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function _p(n,a,l,u,d,p,b,A,H,ee,de,xe){return n=new Tb(n,a,l,b,H,ee,de,xe,A),a=1,p===!0&&(a|=24),p=Pr(3,null,null,a),n.current=p,p.stateNode=n,a=P0(),a.refCount++,n.pooledCache=a,a.refCount++,p.memoizedState={element:u,isDehydrated:l,cache:a},G0(p),n}function yp(n){return n?(n=Ys,n):Ys}function wp(n,a,l,u,d,p){d=yp(d),u.context===null?u.context=d:u.pendingContext=d,u=Ta(a),u.payload={element:l},p=p===void 0?null:p,p!==null&&(u.callback=p),l=Aa(n,u,a),l!==null&&(jr(l,n,a),xl(l,n,a))}function bp(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<a?l:a}}function ch(n,a){bp(n,a),(n=n.alternate)&&bp(n,a)}function Sp(n){if(n.tag===13||n.tag===31){var a=is(n,67108864);a!==null&&jr(a,n,67108864),ch(n,67108864)}}function Ep(n){if(n.tag===13||n.tag===31){var a=Vr();a=Zi(a);var l=is(n,a);l!==null&&jr(l,n,a),ch(n,a)}}var Uc=!0;function Ab(n,a,l,u){var d=J.T;J.T=null;var p=ve.p;try{ve.p=2,uh(n,a,l,u)}finally{ve.p=p,J.T=d}}function Nb(n,a,l,u){var d=J.T;J.T=null;var p=ve.p;try{ve.p=8,uh(n,a,l,u)}finally{ve.p=p,J.T=d}}function uh(n,a,l,u){if(Uc){var d=fh(u);if(d===null)Yf(n,a,u,Pc,l),Ap(n,u);else if(Cb(d,n,a,l,u))u.stopPropagation();else if(Ap(n,u),a&4&&-1<Ob.indexOf(n)){for(;d!==null;){var p=Fe(d);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=Zr(p.pendingLanes);if(b!==0){var A=p;for(A.pendingLanes|=2,A.entangledLanes|=2;b;){var H=1<<31-vr(b);A.entanglements[1]|=H,b&=~H}Dn(p),(st&6)===0&&(bc=vt()+500,Dl(0))}}break;case 31:case 13:A=is(p,2),A!==null&&jr(A,p,2),Ec(),ch(p,2)}if(p=fh(u),p===null&&Yf(n,a,u,Pc,l),p===d)break;d=p}d!==null&&u.stopPropagation()}else Yf(n,a,u,null,l)}}function fh(n){return n=h0(n),hh(n)}var Pc=null;function hh(n){if(Pc=null,n=Ce(n),n!==null){var a=o(n);if(a===null)n=null;else{var l=a.tag;if(l===13){if(n=c(a),n!==null)return n;n=null}else if(l===31){if(n=f(a),n!==null)return n;n=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return Pc=n,null}function Tp(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Un()){case Pn:return 2;case zn:return 8;case xr:case n0:return 32;case Ji:return 268435456;default:return 32}default:return 32}}var dh=!1,Ba=null,Ma=null,Ua=null,Pl=new Map,zl=new Map,Pa=[],Ob="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ap(n,a){switch(n){case"focusin":case"focusout":Ba=null;break;case"dragenter":case"dragleave":Ma=null;break;case"mouseover":case"mouseout":Ua=null;break;case"pointerover":case"pointerout":Pl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":zl.delete(a.pointerId)}}function Hl(n,a,l,u,d,p){return n===null||n.nativeEvent!==p?(n={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:p,targetContainers:[d]},a!==null&&(a=Fe(a),a!==null&&Sp(a)),n):(n.eventSystemFlags|=u,a=n.targetContainers,d!==null&&a.indexOf(d)===-1&&a.push(d),n)}function Cb(n,a,l,u,d){switch(a){case"focusin":return Ba=Hl(Ba,n,a,l,u,d),!0;case"dragenter":return Ma=Hl(Ma,n,a,l,u,d),!0;case"mouseover":return Ua=Hl(Ua,n,a,l,u,d),!0;case"pointerover":var p=d.pointerId;return Pl.set(p,Hl(Pl.get(p)||null,n,a,l,u,d)),!0;case"gotpointercapture":return p=d.pointerId,zl.set(p,Hl(zl.get(p)||null,n,a,l,u,d)),!0}return!1}function Np(n){var a=Ce(n.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){n.blockedOn=a,L(n.priority,function(){Ep(l)});return}}else if(a===31){if(a=f(l),a!==null){n.blockedOn=a,L(n.priority,function(){Ep(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function zc(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var l=fh(n.nativeEvent);if(l===null){l=n.nativeEvent;var u=new l.constructor(l.type,l);f0=u,l.target.dispatchEvent(u),f0=null}else return a=Fe(l),a!==null&&Sp(a),n.blockedOn=l,!1;a.shift()}return!0}function Op(n,a,l){zc(n)&&l.delete(a)}function Rb(){dh=!1,Ba!==null&&zc(Ba)&&(Ba=null),Ma!==null&&zc(Ma)&&(Ma=null),Ua!==null&&zc(Ua)&&(Ua=null),Pl.forEach(Op),zl.forEach(Op)}function Hc(n,a){n.blockedOn===a&&(n.blockedOn=null,dh||(dh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Rb)))}var $c=null;function Cp(n){$c!==n&&($c=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){$c===n&&($c=null);for(var a=0;a<n.length;a+=3){var l=n[a],u=n[a+1],d=n[a+2];if(typeof u!="function"){if(hh(u||l)===null)continue;break}var p=Fe(l);p!==null&&(n.splice(a,3),a-=3,ff(p,{pending:!0,data:d,method:l.method,action:u},u,d))}}))}function yi(n){function a(H){return Hc(H,n)}Ba!==null&&Hc(Ba,n),Ma!==null&&Hc(Ma,n),Ua!==null&&Hc(Ua,n),Pl.forEach(a),zl.forEach(a);for(var l=0;l<Pa.length;l++){var u=Pa[l];u.blockedOn===n&&(u.blockedOn=null)}for(;0<Pa.length&&(l=Pa[0],l.blockedOn===null);)Np(l),l.blockedOn===null&&Pa.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var d=l[u],p=l[u+1],b=d[D]||null;if(typeof p=="function")b||Cp(l);else if(b){var A=null;if(p&&p.hasAttribute("formAction")){if(d=p,b=p[D]||null)A=b.formAction;else if(hh(d)!==null)continue}else A=b.action;typeof A=="function"?l[u+1]=A:(l.splice(u,3),u-=3),Cp(l)}}}function Rp(){function n(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(b){return d=b})},focusReset:"manual",scroll:"manual"})}function a(){d!==null&&(d(),d=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,d=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),d!==null&&(d(),d=null)}}}function mh(n){this._internalRoot=n}Gc.prototype.render=mh.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(s(409));var l=a.current,u=Vr();wp(l,u,n,a,null,null)},Gc.prototype.unmount=mh.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;wp(n.current,2,null,n,null,null),Ec(),a[B]=null}};function Gc(n){this._internalRoot=n}Gc.prototype.unstable_scheduleHydration=function(n){if(n){var a=T();n={blockedOn:null,target:n,priority:a};for(var l=0;l<Pa.length&&a!==0&&a<Pa[l].priority;l++);Pa.splice(l,0,n),l===0&&Np(n)}};var jp=e.version;if(jp!=="19.2.1")throw Error(s(527,jp,"19.2.1"));ve.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(s(188)):(n=Object.keys(n).join(","),Error(s(268,n)));return n=m(a),n=n!==null?x(n):null,n=n===null?null:n.stateNode,n};var jb={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vc.isDisabled&&Vc.supportsFiber)try{xa=Vc.inject(jb),hr=Vc}catch{}}return Gl.createRoot=function(n,a){if(!i(n))throw Error(s(299));var l=!1,u="",d=Mg,p=Ug,b=Pg;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(d=a.onUncaughtError),a.onCaughtError!==void 0&&(p=a.onCaughtError),a.onRecoverableError!==void 0&&(b=a.onRecoverableError)),a=_p(n,1,!1,null,null,l,u,null,d,p,b,Rp),n[B]=a.current,Xf(n),new mh(a)},Gl.hydrateRoot=function(n,a,l){if(!i(n))throw Error(s(299));var u=!1,d="",p=Mg,b=Ug,A=Pg,H=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(d=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(A=l.onRecoverableError),l.formState!==void 0&&(H=l.formState)),a=_p(n,1,!0,a,l??null,u,d,H,p,b,A,Rp),a.context=yp(null),l=a.current,u=Vr(),u=Zi(u),d=Ta(u),d.callback=null,Aa(l,d,u),l=u,a.current.lanes=l,ts(a,l),Dn(a),n[B]=a.current,Xf(n),new Gc(a)},Gl.version="19.2.1",Gl}var zp;function Hb(){if(zp)return xh.exports;zp=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),xh.exports=zb(),xh.exports}var $b=Hb();const Gb=hd($b);/*! Capacitor: https://capacitorjs.com/ - MIT License */var Pi;(function(r){r.Unimplemented="UNIMPLEMENTED",r.Unavailable="UNAVAILABLE"})(Pi||(Pi={}));class wh extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const Vb=r=>{var e,t;return r!=null&&r.androidBridge?"android":!((t=(e=r==null?void 0:r.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},qb=r=>{const e=r.CapacitorCustomPlatform||null,t=r.Capacitor||{},s=t.Plugins=t.Plugins||{},i=()=>e!==null?e.name:Vb(r),o=()=>i()!=="web",c=v=>{const _=m.get(v);return!!(_!=null&&_.platforms.has(i())||f(v))},f=v=>{var _;return(_=t.PluginHeaders)===null||_===void 0?void 0:_.find(y=>y.name===v)},h=v=>r.console.error(v),m=new Map,x=(v,_={})=>{const y=m.get(v);if(y)return console.warn(`Capacitor plugin "${v}" already registered. Cannot register plugins twice.`),y.proxy;const E=i(),w=f(v);let S;const k=async()=>(!S&&E in _?S=typeof _[E]=="function"?S=await _[E]():S=_[E]:e!==null&&!S&&"web"in _&&(S=typeof _.web=="function"?S=await _.web():S=_.web),S),M=(X,z)=>{var ne,oe;if(w){const fe=w==null?void 0:w.methods.find(W=>z===W.name);if(fe)return fe.rtype==="promise"?W=>t.nativePromise(v,z.toString(),W):(W,be)=>t.nativeCallback(v,z.toString(),W,be);if(X)return(ne=X[z])===null||ne===void 0?void 0:ne.bind(X)}else{if(X)return(oe=X[z])===null||oe===void 0?void 0:oe.bind(X);throw new wh(`"${v}" plugin is not implemented on ${E}`,Pi.Unimplemented)}},O=X=>{let z;const ne=(...oe)=>{const fe=k().then(W=>{const be=M(W,X);if(be){const Ee=be(...oe);return z=Ee==null?void 0:Ee.remove,Ee}else throw new wh(`"${v}.${X}()" is not implemented on ${E}`,Pi.Unimplemented)});return X==="addListener"&&(fe.remove=async()=>z()),fe};return ne.toString=()=>`${X.toString()}() { [capacitor code] }`,Object.defineProperty(ne,"name",{value:X,writable:!1,configurable:!1}),ne},G=O("addListener"),q=O("removeListener"),K=(X,z)=>{const ne=G({eventName:X},z),oe=async()=>{const W=await ne;q({eventName:X,callbackId:W},z)},fe=new Promise(W=>ne.then(()=>W({remove:oe})));return fe.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await oe()},fe},F=new Proxy({},{get(X,z){switch(z){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return w?K:G;case"removeListener":return q;default:return O(z)}}});return s[v]=F,m.set(v,{name:v,proxy:F,platforms:new Set([...Object.keys(_),...w?[E]:[]])}),F};return t.convertFileSrc||(t.convertFileSrc=v=>v),t.getPlatform=i,t.handleError=h,t.isNativePlatform=o,t.isPluginAvailable=c,t.registerPlugin=x,t.Exception=wh,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},Kb=r=>r.Capacitor=qb(r),Ka=Kb(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),$u=Ka.registerPlugin;class md{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(t);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),s&&this.sendRetainedArgumentsForEvent(e);const c=async()=>this.removeListener(e,t);return Promise.resolve({remove:c})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,s){const i=this.listeners[e];if(!i){if(s){let o=this.retainedEventArguments[e];o||(o=[]),o.push(t),this.retainedEventArguments[e]=o}return}i.forEach(o=>o(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:s=>{this.notifyListeners(t,s)}}}unimplemented(e="not implemented"){return new Ka.Exception(e,Pi.Unimplemented)}unavailable(e="not available"){return new Ka.Exception(e,Pi.Unavailable)}async removeListener(e,t){const s=this.listeners[e];if(!s)return;const i=s.indexOf(t);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(s=>{this.notifyListeners(e,s)}))}}const Hp=r=>encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),$p=r=>r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Wb extends md{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(s=>{if(s.length<=0)return;let[i,o]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=$p(i).trim(),o=$p(o).trim(),t[i]=o}),t}async setCookie(e){try{const t=Hp(e.key),s=Hp(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),c=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${i}; path=${o}; ${c};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}$u("CapacitorCookies",{web:()=>new Wb});const Xb=async r=>new Promise((e,t)=>{const s=new FileReader;s.onload=()=>{const i=s.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},s.onerror=i=>t(i),s.readAsDataURL(r)}),Yb=(r={})=>{const e=Object.keys(r);return Object.keys(r).map(i=>i.toLocaleLowerCase()).reduce((i,o,c)=>(i[o]=r[e[c]],i),{})},Jb=(r,e=!0)=>r?Object.entries(r).reduce((s,i)=>{const[o,c]=i;let f,h;return Array.isArray(c)?(h="",c.forEach(m=>{f=e?encodeURIComponent(m):m,h+=`${o}=${f}&`}),h.slice(0,-1)):(f=e?encodeURIComponent(c):c,h=`${o}=${f}`),`${s}&${h}`},"").substr(1):null,Qb=(r,e={})=>{const t=Object.assign({method:r.method||"GET",headers:r.headers},e),i=Yb(r.headers)["content-type"]||"";if(typeof r.data=="string")t.body=r.data;else if(i.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[c,f]of Object.entries(r.data||{}))o.set(c,f);t.body=o.toString()}else if(i.includes("multipart/form-data")||r.data instanceof FormData){const o=new FormData;if(r.data instanceof FormData)r.data.forEach((f,h)=>{o.append(h,f)});else for(const f of Object.keys(r.data))o.append(f,r.data[f]);t.body=o;const c=new Headers(t.headers);c.delete("content-type"),t.headers=c}else(i.includes("application/json")||typeof r.data=="object")&&(t.body=JSON.stringify(r.data));return t};class Zb extends md{async request(e){const t=Qb(e,e.webFetchExtra),s=Jb(e.params,e.shouldEncodeUrlParams),i=s?`${e.url}?${s}`:e.url,o=await fetch(i,t),c=o.headers.get("content-type")||"";let{responseType:f="text"}=o.ok?e:{};c.includes("application/json")&&(f="json");let h,m;switch(f){case"arraybuffer":case"blob":m=await o.blob(),h=await Xb(m);break;case"json":h=await o.json();break;case"document":case"text":default:h=await o.text()}const x={};return o.headers.forEach((v,_)=>{x[_]=v}),{data:h,headers:x,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}$u("CapacitorHttp",{web:()=>new Zb});var Gp;(function(r){r.Dark="DARK",r.Light="LIGHT",r.Default="DEFAULT"})(Gp||(Gp={}));var Vp;(function(r){r.StatusBar="StatusBar",r.NavigationBar="NavigationBar"})(Vp||(Vp={}));class eS extends md{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}$u("SystemBars",{web:()=>new eS});const tS="modulepreload",rS=function(r,e){return new URL(r,e).href},qp={},Gu=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){let c=function(x){return Promise.all(x.map(v=>Promise.resolve(v).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};const f=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),m=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));i=c(t.map(x=>{if(x=rS(x,s),x in qp)return;qp[x]=!0;const v=x.endsWith(".css"),_=v?'[rel="stylesheet"]':"";if(!!s)for(let w=f.length-1;w>=0;w--){const S=f[w];if(S.href===x&&(!v||S.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${x}"]${_}`))return;const E=document.createElement("link");if(E.rel=v?"stylesheet":tS,v||(E.as="script"),E.crossOrigin="",E.href=x,m&&E.setAttribute("nonce",m),document.head.appendChild(E),v)return new Promise((w,S)=>{E.addEventListener("load",w),E.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${x}`)))})}))}function o(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return i.then(c=>{for(const f of c||[])f.status==="rejected"&&o(f.reason);return e().catch(o)})};function nS(r){r.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(s,i){return(o,c,f)=>{const h=r.Capacitor.Plugins[t];if(h===void 0){f(new Error(`Capacitor plugin ${t} not found`));return}if(typeof h[i]!="function"){f(new Error(`Method ${i} not found in Capacitor plugin ${t}`));return}(async()=>{try{const m=await h[i](o);c(m)}catch(m){f(m)}})()}}})}})}function aS(r){r.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return r.cordova.plugins[t]}})}function sS(r=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!r?nS(window):window.cordova!==void 0&&aS(window))}var io;(function(r){r.Documents="DOCUMENTS",r.Data="DATA",r.Library="LIBRARY",r.Cache="CACHE",r.External="EXTERNAL",r.ExternalStorage="EXTERNAL_STORAGE",r.ExternalCache="EXTERNAL_CACHE",r.LibraryNoCloud="LIBRARY_NO_CLOUD",r.Temporary="TEMPORARY"})(io||(io={}));var pu;(function(r){r.UTF8="utf8",r.ASCII="ascii",r.UTF16="utf16"})(pu||(pu={}));const Hh=$u("Filesystem",{web:()=>Gu(()=>import("./web-BmcV0pYg.js"),[],import.meta.url).then(r=>new r.FilesystemWeb)});sS();const lo=[{id:"1",name:" ",name_en:"Long Fiber",sku:"LF",category:"fiber",sorts:["1","2","3","4"]},{id:"2",name:" ",name_en:"Short Fiber",sku:"SF",category:"fiber",sorts:["1","2","3","4"]},{id:"3",name:" ",name_en:"Hurds Calibrated",sku:"HC",category:"shiv",sorts:["-5.0  +1.5 ","-5.0  +0.8 ","-1.5  +1.0 ","-1.5  +0.8 ","-0.8  +0.25 ","-1.0 ","-0.8 ","-0.25 "]},{id:"4",name:" ",name_en:"Hurds uncalibrated",sku:"HU",category:"shiv",sorts:["1","2","3"]},{id:"5",name:" ",name_en:"Hurds Finelydisperced",sku:"HF",category:"dust"},{id:"6",name:" ",name_en:"Seed Bran",sku:"SB",category:"dust"},{id:"7",name:" ",name_en:"Transporting Twine",sku:"TT",category:"fiber"},{id:"8",name:" ",name_en:"Unregulated stock",sku:"US",category:"fiber"}],zi=[{id:"5",name:"",role:"operator",pin:"1111"},{id:"2",name:"",role:"lab",pin:"2222"},{id:"1",name:"",role:"accountant",pin:"3333"},{id:"3",name:"",role:"agro",pin:"4444"},{id:"4",name:"",role:"admin",pin:"7777"},{id:"99",name:"TEST Postgres",role:"postgres_user",pin:"9999"}],Vl=1,iS=`
^XA
^PW800
^LL800
^CI28
^FO10,10^GB780,780,4^FS

^FO30,30^A0N,30,30^FDDate:^FS
^FO30,70^A0N,40,40^FH^FD{date}^FS

^FO30,150^A0N,30,30^FDProduct:^FS
^FO30,185^A0N,45,45^FH^FD{productName}^FS
^FO30,230^A0N,30,30^FH^FD{productNameEn}^FS

^FO580,30{logo}^FS

^FO30,280^A0N,30,30^FDSKU:^FS
^FO130,280^A0N,30,30^FH^FD{sku}^FS

^FO30,360^A0N,40,40^FDWeight:^FS
^FO200,340^A0N,100,100^FH^FD{weight} kg^FS

^FO500,360^A0N,30,30^FH^FD{sortLabel}:^FS
^FO500,400^A0N,40,40^FH^FD{sortValue}^FS

^FO30,480^A0N,30,30^FDSerial No:^FS
^FO30,520^A0N,40,40^FH^FD#{serialNumber}^FS

^FO100,580^BY2
^BCN,100,Y,N,N
^FH^FD{barcode}^FS

^FO10,730^A0N,18,18^FB780,3,,C^FD12101, Ukraine, Zhytomyr region, Zhytomyr district, Khoroshivska territorial community, Buildings complex No. 18^FS

^PQ{quantity}
^XZ
`,lS=`
^XA
^PW800
^LL800
^CI28
^FO10,10^GB780,780,4^FS

^FO30,150^A0N,30,30^FDDate:^FS
^FO30,190^A0N,40,40^FH^FD{date}^FS

^FO30,240^A0N,30,30^FDProduct:^FS
^FO30,275^A0N,45,45^FH^FD{productName}^FS
^FO30,320^A0N,30,30^FH^FD{productNameEn}^FS

^FO580,150{logo}^FS

^FO30,370^A0N,30,30^FDSKU:^FS
^FO130,370^A0N,30,30^FH^FD{sku}^FS

^FO30,450^A0N,40,40^FDWeight:^FS
^FO200,430^A0N,100,100^FH^FD{weight} kg^FS

^FO500,450^A0N,30,30^FH^FD{sortLabel}:^FS
^FO500,490^A0N,40,40^FH^FD{sortValue}^FS

^FO30,550^A0N,30,30^FDSerial No:^FS
^FO30,590^A0N,40,40^FH^FD#{serialNumber}^FS

^FO100,630^BY2
^BCN,80,Y,N,N
^FH^FD{barcode}^FS

^FO10,755^A0N,18,18^FB780,3,,C^FD12101, Ukraine, Zhytomyr region, Zhytomyr district, Khoroshivska territorial community, Buildings complex No. 18^FS

^PQ{quantity}
^XZ
`,oS=`
^XA
^PW464
^LL240
^CI28

^FO10,10^A0N,25,25^FH^FD{productName}^FS
^FO10,35^A0N,20,20^FH^FD{productNameEn}^FS

^FO360,10{logo}^FS

^FO100,60^A0N,25,25^FH^FDDate: {date}^FS

^FO10,95^A0N,45,45^FH^FD{weight} kg^FS
^FO220,105^A0N,25,25^FH^FD{sortLabel}:{sortValue}^FS

^FO280,140^A0N,20,20^FH^FD#{serialNumber}^FS

^FO40,165^BY1
^BCN,40,Y,N,N
^FH^FD{barcode}^FS

^PQ{quantity}
^XZ
`,wv=[{id:"100x100",name:" (100x100 )",widthMm:100,heightMm:100,template:iS,cssAspectRatio:"1/1",previewStyles:{containerPadding:"p-6",titleSize:"text-xs",textSize:"text-lg",productSize:"text-2xl",weightSize:"text-5xl",weightLabelSize:"text-xl",barcodeHeight:60}},{id:"58x30",name:" (58x30 )",widthMm:58,heightMm:30,template:oS,cssAspectRatio:"58/30",previewStyles:{containerPadding:"p-2",titleSize:"text-[10px] hidden",textSize:"text-[10px]",productSize:"text-sm font-bold truncate leading-none",weightSize:"text-3xl",weightLabelSize:"text-xs",barcodeHeight:45}}],cS="zebra_db";let bh=null,Tt=null;const $h={async init(){try{if(Ka.getPlatform()==="web"){console.warn("SQLite is not available in web mode. Using fallback data.");return}if(!bh){const{CapacitorSQLite:e,SQLiteConnection:t}=await Gu(async()=>{const{CapacitorSQLite:s,SQLiteConnection:i}=await import("./index-HYAWhyjY.js");return{CapacitorSQLite:s,SQLiteConnection:i}},[],import.meta.url);bh=new t(e)}console.log("--- Initializing SQLite DB ---"),Tt=await bh.createConnection(cS,!1,"no-encryption",1,!1),await Tt.open(),console.log("--- DB Opened ---"),await Tt.execute(`
        CREATE TABLE IF NOT EXISTS users (
            id TEXT PRIMARY KEY,
            name TEXT NOT NULL,
            role TEXT NOT NULL,
            pin TEXT NOT NULL
        );
        
        CREATE TABLE IF NOT EXISTS products (
            id TEXT PRIMARY KEY,
            name TEXT NOT NULL,
            name_en TEXT,
            sku TEXT NOT NULL,
            category TEXT,
            sorts TEXT -- JSON stringified array
        );

        CREATE TABLE IF NOT EXISTS history (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            timestamp TEXT NOT NULL,
            product_name TEXT,
            sku TEXT,
            weight TEXT,
            serial_number INTEGER,
            sort_label TEXT,
            sort_value TEXT,
            status TEXT DEFAULT 'ok',
            synced INTEGER DEFAULT 0,
            UNIQUE(sku, serial_number)
        );
      `),console.log("--- Tables Verified ---"),await this.syncProducts(),await this.seedUsers();try{await Tt.execute("ALTER TABLE history ADD COLUMN status TEXT DEFAULT 'ok'")}catch{}try{await Tt.execute("CREATE UNIQUE INDEX IF NOT EXISTS idx_history_sku_serial ON history(sku, serial_number)")}catch{}}catch(r){console.error("Database Initialization Error:",r)}},async getUsers(){return zi},async getProducts(){return lo},async addToHistory(r){if(!Tt)return;const e=r.timestamp||new Date().toISOString(),{product:t,weight:s,serialNumber:i,sortLabel:o,sortValue:c,status:f}=r;t&&await Tt.run(`INSERT INTO history (timestamp, product_name, sku, weight, serial_number, sort_label, sort_value, status) 
             VALUES (?, ?, ?, ?, ?, ?, ?, ?)
             ON CONFLICT(sku, serial_number) DO UPDATE SET
                timestamp = excluded.timestamp,
                weight = excluded.weight,
                sort_label = excluded.sort_label,
                sort_value = excluded.sort_value,
                status = excluded.status`,[e,t.name,t.sku,s,i,o,c,f||"ok"])},async getHistory(){if(!Tt)return[];const r=await Tt.query("SELECT * FROM history ORDER BY id DESC");return r.values?r.values.map(e=>({date:e.timestamp,product:{name:e.product_name,sku:e.sku,id:"0"},weight:e.weight,serialNumber:e.serial_number,sortLabel:e.sort_label,sortValue:e.sort_value})):[]},async backupDatabase(){if(!Tt)throw new Error("Database not initialized");try{const e=`marijany_backup_${new Date().toISOString().replace(/[:.]/g,"-")}.json`,t=await Tt.query("SELECT * FROM users"),s=await Tt.query("SELECT * FROM products"),i=await Tt.query("SELECT * FROM history"),o={meta:{date:new Date().toISOString(),version:"1.0",appName:"Marijany Sticker Print"},tables:{users:t.values||[],products:s.values||[],history:i.values||[]}};return await Hh.writeFile({path:e,data:JSON.stringify(o,null,2),directory:io.Documents,encoding:pu.UTF8}),e}catch(r){throw console.error("Backup failed:",r),r}},async importDatabase(r){if(!Tt)throw new Error("Database not initialized");try{const e=JSON.parse(r);if(!e.meta||!e.tables||!e.tables.users||!e.tables.history)throw new Error("Invalid backup file format");await Tt.execute("BEGIN TRANSACTION"),await Tt.execute("DELETE FROM users"),await Tt.execute("DELETE FROM products"),await Tt.execute("DELETE FROM history");for(const t of e.tables.users)await Tt.run("INSERT INTO users (id, name, role, pin) VALUES (?, ?, ?, ?)",[t.id,t.name,t.role,t.pin]);if(e.tables.products&&e.tables.products.length>0)for(const t of e.tables.products)await Tt.run("INSERT INTO products (id, name, name_en, sku, category, sorts) VALUES (?, ?, ?, ?, ?, ?)",[t.id,t.name,t.name_en,t.sku,t.category,t.sorts]);for(const t of e.tables.history)await Tt.run(`INSERT INTO history (id, timestamp, product_name, sku, weight, serial_number, sort_label, sort_value, status) 
                     VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)`,[t.id,t.timestamp,t.product_name,t.sku,t.weight,t.serial_number,t.sort_label,t.sort_value,t.status||"ok"]);await Tt.execute("COMMIT"),await this.syncProducts(),console.log("--- Restore Complete ---")}catch(e){throw await Tt.execute("ROLLBACK"),console.error("Import failed:",e),e}},async getReportData(r,e){if(!Tt)return[];const t=r.toISOString(),s=e.toISOString(),i=await Tt.query("SELECT * FROM history WHERE timestamp >= ? AND timestamp <= ? ORDER BY timestamp DESC",[t,s]);return i.values?i.values.map(o=>({date:o.timestamp,product:{name:o.product_name,sku:o.sku,id:"0"},weight:o.weight,serialNumber:o.serial_number,sortLabel:o.sort_label,sortValue:o.sort_value})):[]}};var ia={},qc={},Gh=function(r,e){return Gh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])},Gh(r,e)};function bv(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Gh(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xu=function(){return xu=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++){t=arguments[s];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},xu.apply(this,arguments)};function Vi(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(t[s[i]]=r[s[i]]);return t}function Sv(r,e,t,s){var i=arguments.length,o=i<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,s);else for(var f=r.length-1;f>=0;f--)(c=r[f])&&(o=(i<3?c(o):i>3?c(e,t,o):c(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}function Ev(r,e){return function(t,s){e(t,s,r)}}function Tv(r,e,t,s,i,o){function c(k){if(k!==void 0&&typeof k!="function")throw new TypeError("Function expected");return k}for(var f=s.kind,h=f==="getter"?"get":f==="setter"?"set":"value",m=!e&&r?s.static?r:r.prototype:null,x=e||(m?Object.getOwnPropertyDescriptor(m,s.name):{}),v,_=!1,y=t.length-1;y>=0;y--){var E={};for(var w in s)E[w]=w==="access"?{}:s[w];for(var w in s.access)E.access[w]=s.access[w];E.addInitializer=function(k){if(_)throw new TypeError("Cannot add initializers after decoration has completed");o.push(c(k||null))};var S=(0,t[y])(f==="accessor"?{get:x.get,set:x.set}:x[h],E);if(f==="accessor"){if(S===void 0)continue;if(S===null||typeof S!="object")throw new TypeError("Object expected");(v=c(S.get))&&(x.get=v),(v=c(S.set))&&(x.set=v),(v=c(S.init))&&i.unshift(v)}else(v=c(S))&&(f==="field"?i.unshift(v):x[h]=v)}m&&Object.defineProperty(m,s.name,x),_=!0}function Av(r,e,t){for(var s=arguments.length>2,i=0;i<e.length;i++)t=s?e[i].call(r,t):e[i].call(r);return s?t:void 0}function Nv(r){return typeof r=="symbol"?r:"".concat(r)}function Ov(r,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function Cv(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function Ie(r,e,t,s){function i(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function f(x){try{m(s.next(x))}catch(v){c(v)}}function h(x){try{m(s.throw(x))}catch(v){c(v)}}function m(x){x.done?o(x.value):i(x.value).then(f,h)}m((s=s.apply(r,e||[])).next())})}function Rv(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,i,o,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=f(0),c.throw=f(1),c.return=f(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(m){return function(x){return h([m,x])}}function h(m){if(s)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(t=0)),t;)try{if(s=1,i&&(o=m[0]&2?i.return:m[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,m[1])).done)return o;switch(i=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,i=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){t.label=m[1];break}if(m[0]===6&&t.label<o[1]){t.label=o[1],o=m;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(m);break}o[2]&&t.ops.pop(),t.trys.pop();continue}m=e.call(r,t)}catch(x){m=[6,x],i=0}finally{s=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Vu=Object.create?(function(r,e,t,s){s===void 0&&(s=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,i)}):(function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]});function jv(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Vu(e,r,t)}function vu(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],s=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function gd(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var s=t.call(r),i,o=[],c;try{for(;(e===void 0||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(f){c={error:f}}finally{try{i&&!i.done&&(t=s.return)&&t.call(s)}finally{if(c)throw c.error}}return o}function kv(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(gd(arguments[e]));return r}function Dv(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var s=Array(r),i=0,e=0;e<t;e++)for(var o=arguments[e],c=0,f=o.length;c<f;c++,i++)s[i]=o[c];return s}function Fv(r,e,t){if(t||arguments.length===2)for(var s=0,i=e.length,o;s<i;s++)(o||!(s in e))&&(o||(o=Array.prototype.slice.call(e,0,s)),o[s]=e[s]);return r.concat(o||Array.prototype.slice.call(e))}function Hi(r){return this instanceof Hi?(this.v=r,this):new Hi(r)}function Lv(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(r,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",c),i[Symbol.asyncIterator]=function(){return this},i;function c(y){return function(E){return Promise.resolve(E).then(y,v)}}function f(y,E){s[y]&&(i[y]=function(w){return new Promise(function(S,k){o.push([y,w,S,k])>1||h(y,w)})},E&&(i[y]=E(i[y])))}function h(y,E){try{m(s[y](E))}catch(w){_(o[0][3],w)}}function m(y){y.value instanceof Hi?Promise.resolve(y.value.v).then(x,v):_(o[0][2],y)}function x(y){h("next",y)}function v(y){h("throw",y)}function _(y,E){y(E),o.shift(),o.length&&h(o[0][0],o[0][1])}}function Iv(r){var e,t;return e={},s("next"),s("throw",function(i){throw i}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(i,o){e[i]=r[i]?function(c){return(t=!t)?{value:Hi(r[i](c)),done:!1}:o?o(c):c}:o}}function Bv(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof vu=="function"?vu(r):r[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(o){t[o]=r[o]&&function(c){return new Promise(function(f,h){c=r[o](c),i(f,h,c.done,c.value)})}}function i(o,c,f,h){Promise.resolve(h).then(function(m){o({value:m,done:f})},c)}}function Mv(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}var uS=Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e},Vh=function(r){return Vh=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},Vh(r)};function Uv(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t=Vh(r),s=0;s<t.length;s++)t[s]!=="default"&&Vu(e,r,t[s]);return uS(e,r),e}function Pv(r){return r&&r.__esModule?r:{default:r}}function zv(r,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(r):s?s.value:e.get(r)}function Hv(r,e,t,s,i){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t}function $v(r,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?e===r:r.has(e)}function Gv(r,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],t&&(i=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");i&&(s=function(){try{i.call(this)}catch(o){return Promise.reject(o)}}),r.stack.push({value:e,dispose:s,async:t})}else t&&r.stack.push({async:!0});return e}var fS=typeof SuppressedError=="function"?SuppressedError:function(r,e,t){var s=new Error(t);return s.name="SuppressedError",s.error=r,s.suppressed=e,s};function Vv(r){function e(o){r.error=r.hasError?new fS(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,s=0;function i(){for(;t=r.stack.pop();)try{if(!t.async&&s===1)return s=0,r.stack.push(t),Promise.resolve().then(i);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return s|=2,Promise.resolve(o).then(i,function(c){return e(c),i()})}else s|=1}catch(c){e(c)}if(s===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return i()}function qv(r,e){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,s,i,o,c){return s?e?".jsx":".js":i&&(!o||!c)?t:i+o+"."+c.toLowerCase()+"js"}):r}const hS={__extends:bv,__assign:xu,__rest:Vi,__decorate:Sv,__param:Ev,__esDecorate:Tv,__runInitializers:Av,__propKey:Nv,__setFunctionName:Ov,__metadata:Cv,__awaiter:Ie,__generator:Rv,__createBinding:Vu,__exportStar:jv,__values:vu,__read:gd,__spread:kv,__spreadArrays:Dv,__spreadArray:Fv,__await:Hi,__asyncGenerator:Lv,__asyncDelegator:Iv,__asyncValues:Bv,__makeTemplateObject:Mv,__importStar:Uv,__importDefault:Pv,__classPrivateFieldGet:zv,__classPrivateFieldSet:Hv,__classPrivateFieldIn:$v,__addDisposableResource:Gv,__disposeResources:Vv,__rewriteRelativeImportExtension:qv},dS=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Gv,get __assign(){return xu},__asyncDelegator:Iv,__asyncGenerator:Lv,__asyncValues:Bv,__await:Hi,__awaiter:Ie,__classPrivateFieldGet:zv,__classPrivateFieldIn:$v,__classPrivateFieldSet:Hv,__createBinding:Vu,__decorate:Sv,__disposeResources:Vv,__esDecorate:Tv,__exportStar:jv,__extends:bv,__generator:Rv,__importDefault:Pv,__importStar:Uv,__makeTemplateObject:Mv,__metadata:Cv,__param:Ev,__propKey:Nv,__read:gd,__rest:Vi,__rewriteRelativeImportExtension:qv,__runInitializers:Av,__setFunctionName:Ov,__spread:kv,__spreadArray:Fv,__spreadArrays:Dv,__values:vu,default:hS},Symbol.toStringTag,{value:"Module"})),mS=r=>r?(...e)=>r(...e):(...e)=>fetch(...e);let qu=class extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}},Kv=class extends qu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}},qh=class extends qu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}},Kh=class extends qu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}};var _u;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(_u||(_u={}));class gS{constructor(e,{headers:t={},customFetch:s,region:i=_u.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=mS(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Ie(this,arguments,void 0,function*(t,s={}){var i;let o,c;try{const{headers:f,method:h,body:m,signal:x,timeout:v}=s;let _={},{region:y}=s;y||(y=this.region);const E=new URL(`${this.url}/${t}`);y&&y!=="any"&&(_["x-region"]=y,E.searchParams.set("forceFunctionRegion",y));let w;m&&(f&&!Object.prototype.hasOwnProperty.call(f,"Content-Type")||!f)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",w=m):typeof m=="string"?(_["Content-Type"]="text/plain",w=m):typeof FormData<"u"&&m instanceof FormData?w=m:(_["Content-Type"]="application/json",w=JSON.stringify(m)):w=m;let S=x;v&&(c=new AbortController,o=setTimeout(()=>c.abort(),v),x?(S=c.signal,x.addEventListener("abort",()=>c.abort())):S=c.signal);const k=yield this.fetch(E.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),f),body:w,signal:S}).catch(q=>{throw new Kv(q)}),M=k.headers.get("x-relay-error");if(M&&M==="true")throw new qh(k);if(!k.ok)throw new Kh(k);let O=((i=k.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),G;return O==="application/json"?G=yield k.json():O==="application/octet-stream"||O==="application/pdf"?G=yield k.blob():O==="text/event-stream"?G=k:O==="multipart/form-data"?G=yield k.formData():G=yield k.text(),{data:G,error:null,response:k}}catch(f){return{data:null,error:f,response:f instanceof Kh||f instanceof qh?f.context:void 0}}finally{o&&clearTimeout(o)}})}}const pS=Object.freeze(Object.defineProperty({__proto__:null,get FunctionRegion(){return _u},FunctionsClient:gS,FunctionsError:qu,FunctionsFetchError:Kv,FunctionsHttpError:Kh,FunctionsRelayError:qh},Symbol.toStringTag,{value:"Module"})),Wv=vo(pS);var mr={};const qi=vo(dS);var Kc={},Wc={},Xc={},Yc={},Jc={},Qc={},Kp;function Xv(){if(Kp)return Qc;Kp=1,Object.defineProperty(Qc,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Qc.default=r,Qc}var Wp;function Yv(){if(Wp)return Jc;Wp=1,Object.defineProperty(Jc,"__esModule",{value:!0});const e=qi.__importDefault(Xv());let t=class{constructor(i){var o,c;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(o=i.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=i.signal,this.isMaybeSingle=(c=i.isMaybeSingle)!==null&&c!==void 0?c:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=new Headers(this.headers),this.headers.set(i,o),this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let f=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var m,x,v,_;let y=null,E=null,w=null,S=h.status,k=h.statusText;if(h.ok){if(this.method!=="HEAD"){const q=await h.text();q===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?E=q:E=JSON.parse(q))}const O=(x=this.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),G=(v=h.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");O&&G&&G.length>1&&(w=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(y={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,w=null,S=406,k="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const O=await h.text();try{y=JSON.parse(O),Array.isArray(y)&&h.status===404&&(E=[],y=null,S=200,k="OK")}catch{h.status===404&&O===""?(S=204,k="No Content"):y={message:O}}if(y&&this.isMaybeSingle&&(!((_=y==null?void 0:y.details)===null||_===void 0)&&_.includes("0 rows"))&&(y=null,S=200,k="OK"),y&&this.shouldThrowOnError)throw new e.default(y)}return{error:y,data:E,count:w,status:S,statusText:k}});return this.shouldThrowOnError||(f=f.catch(h=>{var m,x,v,_,y,E;let w="";const S=h==null?void 0:h.cause;if(S){const k=(m=S==null?void 0:S.message)!==null&&m!==void 0?m:"",M=(x=S==null?void 0:S.code)!==null&&x!==void 0?x:"";w=`${(v=h==null?void 0:h.name)!==null&&v!==void 0?v:"FetchError"}: ${h==null?void 0:h.message}`,w+=`

Caused by: ${(_=S==null?void 0:S.name)!==null&&_!==void 0?_:"Error"}: ${k}`,M&&(w+=` (${M})`),S!=null&&S.stack&&(w+=`
${S.stack}`)}else w=(y=h==null?void 0:h.stack)!==null&&y!==void 0?y:"";return{error:{message:`${(E=h==null?void 0:h.name)!==null&&E!==void 0?E:"FetchError"}: ${h==null?void 0:h.message}`,details:w,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),f.then(i,o)}returns(){return this}overrideTypes(){return this}};return Jc.default=t,Jc}var Xp;function Jv(){if(Xp)return Yc;Xp=1,Object.defineProperty(Yc,"__esModule",{value:!0});const e=qi.__importDefault(Yv());let t=class extends e.default{select(i){let o=!1;const c=(i??"*").split("").map(f=>/\s/.test(f)&&!o?"":(f==='"'&&(o=!o),f)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:o=!0,nullsFirst:c,foreignTable:f,referencedTable:h=f}={}){const m=h?`${h}.order`:"order",x=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${x?`${x},`:""}${i}.${o?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:o,referencedTable:c=o}={}){const f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${i}`),this}range(i,o,{foreignTable:c,referencedTable:f=c}={}){const h=typeof f>"u"?"offset":`${f}.offset`,m=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(h,`${i}`),this.url.searchParams.set(m,`${o-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:o=!1,settings:c=!1,buffers:f=!1,wal:h=!1,format:m="text"}={}){var x;const v=[i?"analyze":null,o?"verbose":null,c?"settings":null,f?"buffers":null,h?"wal":null].filter(Boolean).join("|"),_=(x=this.headers.get("Accept"))!==null&&x!==void 0?x:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${_}"; options=${v};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};return Yc.default=t,Yc}var Yp;function pd(){if(Yp)return Xc;Yp=1,Object.defineProperty(Xc,"__esModule",{value:!0});const e=qi.__importDefault(Jv()),t=new RegExp("[,()]");let s=class extends e.default{eq(o,c){return this.url.searchParams.append(o,`eq.${c}`),this}neq(o,c){return this.url.searchParams.append(o,`neq.${c}`),this}gt(o,c){return this.url.searchParams.append(o,`gt.${c}`),this}gte(o,c){return this.url.searchParams.append(o,`gte.${c}`),this}lt(o,c){return this.url.searchParams.append(o,`lt.${c}`),this}lte(o,c){return this.url.searchParams.append(o,`lte.${c}`),this}like(o,c){return this.url.searchParams.append(o,`like.${c}`),this}likeAllOf(o,c){return this.url.searchParams.append(o,`like(all).{${c.join(",")}}`),this}likeAnyOf(o,c){return this.url.searchParams.append(o,`like(any).{${c.join(",")}}`),this}ilike(o,c){return this.url.searchParams.append(o,`ilike.${c}`),this}ilikeAllOf(o,c){return this.url.searchParams.append(o,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(o,c){return this.url.searchParams.append(o,`ilike(any).{${c.join(",")}}`),this}regexMatch(o,c){return this.url.searchParams.append(o,`match.${c}`),this}regexIMatch(o,c){return this.url.searchParams.append(o,`imatch.${c}`),this}is(o,c){return this.url.searchParams.append(o,`is.${c}`),this}isDistinct(o,c){return this.url.searchParams.append(o,`isdistinct.${c}`),this}in(o,c){const f=Array.from(new Set(c)).map(h=>typeof h=="string"&&t.test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(o,`in.(${f})`),this}contains(o,c){return typeof c=="string"?this.url.searchParams.append(o,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(o,`cs.{${c.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(c)}`),this}containedBy(o,c){return typeof c=="string"?this.url.searchParams.append(o,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(o,`cd.{${c.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(c)}`),this}rangeGt(o,c){return this.url.searchParams.append(o,`sr.${c}`),this}rangeGte(o,c){return this.url.searchParams.append(o,`nxl.${c}`),this}rangeLt(o,c){return this.url.searchParams.append(o,`sl.${c}`),this}rangeLte(o,c){return this.url.searchParams.append(o,`nxr.${c}`),this}rangeAdjacent(o,c){return this.url.searchParams.append(o,`adj.${c}`),this}overlaps(o,c){return typeof c=="string"?this.url.searchParams.append(o,`ov.${c}`):this.url.searchParams.append(o,`ov.{${c.join(",")}}`),this}textSearch(o,c,{config:f,type:h}={}){let m="";h==="plain"?m="pl":h==="phrase"?m="ph":h==="websearch"&&(m="w");const x=f===void 0?"":`(${f})`;return this.url.searchParams.append(o,`${m}fts${x}.${c}`),this}match(o){return Object.entries(o).forEach(([c,f])=>{this.url.searchParams.append(c,`eq.${f}`)}),this}not(o,c,f){return this.url.searchParams.append(o,`not.${c}.${f}`),this}or(o,{foreignTable:c,referencedTable:f=c}={}){const h=f?`${f}.or`:"or";return this.url.searchParams.append(h,`(${o})`),this}filter(o,c,f){return this.url.searchParams.append(o,`${c}.${f}`),this}};return Xc.default=s,Xc}var Jp;function Qv(){if(Jp)return Wc;Jp=1,Object.defineProperty(Wc,"__esModule",{value:!0});const e=qi.__importDefault(pd());let t=class{constructor(i,{headers:o={},schema:c,fetch:f}){this.url=i,this.headers=new Headers(o),this.schema=c,this.fetch=f}select(i,o){const{head:c=!1,count:f}=o??{},h=c?"HEAD":"GET";let m=!1;const x=(i??"*").split("").map(v=>/\s/.test(v)&&!m?"":(v==='"'&&(m=!m),v)).join("");return this.url.searchParams.set("select",x),f&&this.headers.append("Prefer",`count=${f}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:o,defaultToNull:c=!0}={}){var f;const h="POST";if(o&&this.headers.append("Prefer",`count=${o}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const m=i.reduce((x,v)=>x.concat(Object.keys(v)),[]);if(m.length>0){const x=[...new Set(m)].map(v=>`"${v}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(i,{onConflict:o,ignoreDuplicates:c=!1,count:f,defaultToNull:h=!0}={}){var m;const x="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),f&&this.headers.append("Prefer",`count=${f}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const v=i.reduce((_,y)=>_.concat(Object.keys(y)),[]);if(v.length>0){const _=[...new Set(v)].map(y=>`"${y}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(i,{count:o}={}){var c;const f="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:i}={}){var o;const c="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};return Wc.default=t,Wc}var Qp;function xS(){if(Qp)return Kc;Qp=1,Object.defineProperty(Kc,"__esModule",{value:!0});const r=qi,e=r.__importDefault(Qv()),t=r.__importDefault(pd());let s=class Zv{constructor(o,{headers:c={},schema:f,fetch:h}={}){this.url=o,this.headers=new Headers(c),this.schemaName=f,this.fetch=h}from(o){if(!o||typeof o!="string"||o.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const c=new URL(`${this.url}/${o}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new Zv(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,c={},{head:f=!1,get:h=!1,count:m}={}){var x;let v;const _=new URL(`${this.url}/rpc/${o}`);let y;f||h?(v=f?"HEAD":"GET",Object.entries(c).filter(([w,S])=>S!==void 0).map(([w,S])=>[w,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([w,S])=>{_.searchParams.append(w,S)})):(v="POST",y=c);const E=new Headers(this.headers);return m&&E.set("Prefer",`count=${m}`),new t.default({method:v,url:_,headers:E,schema:this.schemaName,body:y,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}};return Kc.default=s,Kc}var Zp;function e_(){if(Zp)return mr;Zp=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.PostgrestError=mr.PostgrestBuilder=mr.PostgrestTransformBuilder=mr.PostgrestFilterBuilder=mr.PostgrestQueryBuilder=mr.PostgrestClient=void 0;const r=qi,e=r.__importDefault(xS());mr.PostgrestClient=e.default;const t=r.__importDefault(Qv());mr.PostgrestQueryBuilder=t.default;const s=r.__importDefault(pd());mr.PostgrestFilterBuilder=s.default;const i=r.__importDefault(Jv());mr.PostgrestTransformBuilder=i.default;const o=r.__importDefault(Yv());mr.PostgrestBuilder=o.default;const c=r.__importDefault(Xv());return mr.PostgrestError=c.default,mr.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:o.default,PostgrestError:c.default},mr}class t_{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const s=t.node,i=parseInt(s.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const vS="2.87.1",_S=`realtime-js/${vS}`,r_="1.0.0",yS="2.0.0",ex=r_,Wh=1e4,wS=1e3,bS=100;var Es;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Es||(Es={}));var Ht;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Ht||(Ht={}));var Sn;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Sn||(Sn={}));var Xh;(function(r){r.websocket="websocket"})(Xh||(Xh={}));var Ts;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Ts||(Ts={}));class SS{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,s;const i=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(e){var t,s;const i=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:{},c=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(e,t,s){var i,o;const c=e.topic,f=(i=e.ref)!==null&&i!==void 0?i:"",h=(o=e.join_ref)!==null&&o!==void 0?o:"",m=e.payload.event,x=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(x).length===0?"":JSON.stringify(x);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`ref length ${f.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const _=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+f.length+c.length+m.length+v.length,y=new ArrayBuffer(this.HEADER_LENGTH+_);let E=new DataView(y),w=0;E.setUint8(w++,this.KINDS.userBroadcastPush),E.setUint8(w++,h.length),E.setUint8(w++,f.length),E.setUint8(w++,c.length),E.setUint8(w++,m.length),E.setUint8(w++,v.length),E.setUint8(w++,t),Array.from(h,k=>E.setUint8(w++,k.charCodeAt(0))),Array.from(f,k=>E.setUint8(w++,k.charCodeAt(0))),Array.from(c,k=>E.setUint8(w++,k.charCodeAt(0))),Array.from(m,k=>E.setUint8(w++,k.charCodeAt(0))),Array.from(v,k=>E.setUint8(w++,k.charCodeAt(0)));var S=new Uint8Array(y.byteLength+s.byteLength);return S.set(new Uint8Array(y),0),S.set(new Uint8Array(s),y.byteLength),S.buffer}decode(e,t){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return t(s)}if(typeof e=="string"){const s=JSON.parse(e),[i,o,c,f,h]=s;return t({join_ref:i,ref:o,topic:c,event:f,payload:h})}return t({})}_binaryDecode(e){const t=new DataView(e),s=t.getUint8(0),i=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,i)}}_decodeUserBroadcast(e,t,s){const i=t.getUint8(1),o=t.getUint8(2),c=t.getUint8(3),f=t.getUint8(4);let h=this.HEADER_LENGTH+4;const m=s.decode(e.slice(h,h+i));h=h+i;const x=s.decode(e.slice(h,h+o));h=h+o;const v=s.decode(e.slice(h,h+c));h=h+c;const _=e.slice(h,e.byteLength),y=f===this.JSON_ENCODING?JSON.parse(s.decode(_)):_,E={type:this.BROADCAST_EVENT,event:x,payload:y};return c>0&&(E.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:E}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>t.includes(s)))}}class n_{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var bt;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(bt||(bt={}));const tx=(r,e,t={})=>{var s;const i=(s=t.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((o,c)=>(o[c]=ES(c,r,e,i),o),{}):{}},ES=(r,e,t,s)=>{const i=e.find(f=>f.name===r),o=i==null?void 0:i.type,c=t[r];return o&&!s.includes(o)?a_(o,c):Yh(c)},a_=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return OS(e,t)}switch(r){case bt.bool:return TS(e);case bt.float4:case bt.float8:case bt.int2:case bt.int4:case bt.int8:case bt.numeric:case bt.oid:return AS(e);case bt.json:case bt.jsonb:return NS(e);case bt.timestamp:return CS(e);case bt.abstime:case bt.date:case bt.daterange:case bt.int4range:case bt.int8range:case bt.money:case bt.reltime:case bt.text:case bt.time:case bt.timestamptz:case bt.timetz:case bt.tsrange:case bt.tstzrange:return Yh(e);default:return Yh(e)}},Yh=r=>r,TS=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},AS=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},NS=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},OS=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let o;const c=r.slice(1,t);try{o=JSON.parse("["+c+"]")}catch{o=c?c.split(","):[]}return o.map(f=>a_(e,f))}return r},CS=r=>typeof r=="string"?r.replace(" ","T"):r,s_=r=>{const e=new URL(r);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Sh{constructor(e,t,s={},i=Wh){this.channel=e,this.event=t,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Jh;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Jh||(Jh={}));let i_=class hu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:o,onLeave:c,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hu.syncState(this.state,i,o,c),this.pendingDiffs.forEach(h=>{this.state=hu.syncDiff(this.state,h,o,c)}),this.pendingDiffs=[],f()}),this.channel._on(s.diff,{},i=>{const{onJoin:o,onLeave:c,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=hu.syncDiff(this.state,i,o,c),f())}),this.onJoin((i,o,c)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:c})}),this.onLeave((i,o,c)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,i){const o=this.cloneDeep(e),c=this.transformState(t),f={},h={};return this.map(o,(m,x)=>{c[m]||(h[m]=x)}),this.map(c,(m,x)=>{const v=o[m];if(v){const _=x.map(S=>S.presence_ref),y=v.map(S=>S.presence_ref),E=x.filter(S=>y.indexOf(S.presence_ref)<0),w=v.filter(S=>_.indexOf(S.presence_ref)<0);E.length>0&&(f[m]=E),w.length>0&&(h[m]=w)}else f[m]=x}),this.syncDiff(o,{joins:f,leaves:h},s,i)}static syncDiff(e,t,s,i){const{joins:o,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(o,(f,h)=>{var m;const x=(m=e[f])!==null&&m!==void 0?m:[];if(e[f]=this.cloneDeep(h),x.length>0){const v=e[f].map(y=>y.presence_ref),_=x.filter(y=>v.indexOf(y.presence_ref)<0);e[f].unshift(..._)}s(f,x,h)}),this.map(c,(f,h)=>{let m=e[f];if(!m)return;const x=h.map(v=>v.presence_ref);m=m.filter(v=>x.indexOf(v.presence_ref)<0),e[f]=m,i(f,m,h),m.length===0&&delete e[f]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const i=e[s];return"metas"in i?t[s]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[s]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var Qh;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Qh||(Qh={}));var Di;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Di||(Di={}));var Bn;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Bn||(Bn={}));const RS=Ht;let l_=class Yl{constructor(e,t={config:{}},s){var i,o;if(this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Ht.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Sh(this,Sn.join,this.params,this.timeout),this.rejoinTimer=new n_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ht.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ht.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ht.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Sn.reply,{},(c,f)=>{this._trigger(this._replyEventName(f),c)}),this.presence=new i_(this),this.broadcastEndpointURL=s_(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var s,i,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Ht.closed){const{config:{broadcast:c,presence:f,private:h}}=this.params,m=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(y=>y.filter))!==null&&i!==void 0?i:[],x=!!this.bindings[Di.PRESENCE]&&this.bindings[Di.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,v={},_={broadcast:c,presence:Object.assign(Object.assign({},f),{enabled:x}),postgres_changes:m,private:h};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(y=>e==null?void 0:e(Bn.CHANNEL_ERROR,y)),this._onClose(()=>e==null?void 0:e(Bn.CLOSED)),this.updateJoinPayload(Object.assign({config:_},v)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:y})=>{var E;if(this.socket._isManualToken()||this.socket.setAuth(),y===void 0){e==null||e(Bn.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,S=(E=w==null?void 0:w.length)!==null&&E!==void 0?E:0,k=[];for(let M=0;M<S;M++){const O=w[M],{filter:{event:G,schema:q,table:K,filter:F}}=O,X=y&&y[M];if(X&&X.event===G&&Yl.isFilterValueEqual(X.schema,q)&&Yl.isFilterValueEqual(X.table,K)&&Yl.isFilterValueEqual(X.filter,F))k.push(Object.assign(Object.assign({},O),{id:X.id}));else{this.unsubscribe(),this.state=Ht.errored,e==null||e(Bn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,e&&e(Bn.SUBSCRIBED);return}}).receive("error",y=>{this.state=Ht.errored,e==null||e(Bn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Bn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===Ht.joined&&e===Di.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,s)}async httpSend(e,t,s={}){var i;const o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},f=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(i=s.timeout)!==null&&i!==void 0?i:this.timeout);if(f.status===202)return{success:!0};let h=f.statusText;try{const m=await f.json();h=m.error||m.message||h}catch{}return Promise.reject(new Error(h))}async send(e,t={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:c}=e,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=m.body)===null||i===void 0?void 0:i.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var c,f,h;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(f=(c=this.params)===null||c===void 0?void 0:c.config)===null||f===void 0?void 0:f.broadcast)===null||h===void 0)&&h.ack)&&o("ok"),m.receive("ok",()=>o("ok")),m.receive("error",()=>o("error")),m.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ht.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Sn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new Sh(this,Sn.leave,{},e),s.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ht.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const i=new AbortController,o=setTimeout(()=>i.abort(),s),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(o),c}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Sh(this,e,t,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>bS){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var i,o;const c=e.toLocaleLowerCase(),{close:f,error:h,leave:m,join:x}=Sn;if(s&&[f,h,m,x].indexOf(c)>=0&&s!==this._joinRef())return;let _=this._onMessage(c,t,s);if(t&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(y=>{var E,w,S;return((E=y.filter)===null||E===void 0?void 0:E.event)==="*"||((S=(w=y.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===c}).map(y=>y.callback(_,s)):(o=this.bindings[c])===null||o===void 0||o.filter(y=>{var E,w,S,k,M,O;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in y){const G=y.id,q=(E=y.filter)===null||E===void 0?void 0:E.event;return G&&((w=t.ids)===null||w===void 0?void 0:w.includes(G))&&(q==="*"||(q==null?void 0:q.toLocaleLowerCase())===((S=t.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const G=(M=(k=y==null?void 0:y.filter)===null||k===void 0?void 0:k.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return G==="*"||G===((O=t==null?void 0:t.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===c}).map(y=>{if(typeof _=="object"&&"ids"in _){const E=_.data,{schema:w,table:S,commit_timestamp:k,type:M,errors:O}=E;_=Object.assign(Object.assign({},{schema:w,table:S,commit_timestamp:k,eventType:M,new:{},old:{},errors:O}),this._getPayloadRecords(E))}y.callback(_,s)})}_isClosed(){return this.state===Ht.closed}_isJoined(){return this.state===Ht.joined}_isJoining(){return this.state===Ht.joining}_isLeaving(){return this.state===Ht.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const i=e.toLocaleLowerCase(),o={type:i,filter:t,callback:s};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===s&&Yl.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Sn.close,{},e)}_onError(e){this._on(Sn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ht.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=tx(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=tx(e.columns,e.old_record)),t}};const Eh=()=>{},Zc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},jS=[1e3,2e3,5e3,1e4],kS=1e4,DS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;let FS=class{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Wh,this.transport=null,this.heartbeatIntervalMs=Zc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Eh,this.ref=0,this.reconnectTimer=null,this.vsn=ex,this.logger=Eh,this.conn=null,this.sendBuffer=[],this.serializer=new SS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...o)=>i(...o):(...o)=>fetch(...o),!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Xh.websocket}`,this.httpEndpoint=s_(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=t_.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Es.connecting:return Ts.Connecting;case Es.open:return Ts.Open;case Es.closing:return Ts.Closing;default:return Ts.Closed}}isConnected(){return this.connectionState()===Ts.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,i=this.getChannels().find(o=>o.topic===s);if(i)return i;{const o=new l_(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){const{topic:t,event:s,payload:i,ref:o}=e,c=()=>{this.encode(e,f=>{var h;(h=this.conn)===null||h===void 0||h.send(f)})};this.log("push",`${t} ${s} (${o})`,i),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(wS,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Zc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:i,payload:o,ref:c}=t,f=c?`(${c})`:"",h=o.status||"";this.log("receive",`${h} ${s} ${i} ${f}`.trim(),o),this.channels.filter(m=>m._isMember(s)).forEach(m=>m._trigger(i,o,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Es.open||this.conn.readyState===Es.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Sn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${s}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([DS],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,s=!1;if(e)t=e,s=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),t=this.accessTokenValue}else t=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const o={access_token:t,version:_S};t&&i.updateJoinPayload(o),i.joinedOnce&&i._isJoined()&&i._push(Sn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new n_(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Zc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,i,o,c,f,h,m,x,v,_,y;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Wh,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:Zc.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(f=e==null?void 0:e.heartbeatCallback)!==null&&f!==void 0?f:Eh,this.vsn=(h=e==null?void 0:e.vsn)!==null&&h!==void 0?h:ex,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=e==null?void 0:e.reconnectAfterMs)!==null&&m!==void 0?m:(E=>jS[E-1]||kS),this.vsn){case r_:this.encode=(x=e==null?void 0:e.encode)!==null&&x!==void 0?x:((E,w)=>w(JSON.stringify(E))),this.decode=(v=e==null?void 0:e.decode)!==null&&v!==void 0?v:((E,w)=>w(JSON.parse(E)));break;case yS:this.encode=(_=e==null?void 0:e.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(y=e==null?void 0:e.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}};const LS=Object.freeze(Object.defineProperty({__proto__:null,REALTIME_CHANNEL_STATES:RS,get REALTIME_LISTEN_TYPES(){return Di},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return Qh},get REALTIME_PRESENCE_LISTEN_EVENTS(){return Jh},get REALTIME_SUBSCRIBE_STATES(){return Bn},RealtimeChannel:l_,RealtimeClient:FS,RealtimePresence:i_,WebSocketFactory:t_},Symbol.toStringTag,{value:"Module"})),o_=vo(LS);class _o extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ct(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class c_ extends _o{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class yu extends _o{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const xd=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),IS=()=>Response,Zh=r=>{if(Array.isArray(r))return r.map(t=>Zh(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const i=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[i]=Zh(s)}),e},BS=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},MS=r=>!r||typeof r!="string"||r.length===0||r.length>100||r.trim()!==r||r.includes("/")||r.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(r),Th=r=>{var e;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(e=r.error)===null||e===void 0?void 0:e.message)||JSON.stringify(r)},US=(r,e,t)=>Ie(void 0,void 0,void 0,function*(){const s=yield IS();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(i=>{const o=r.status||500,c=(i==null?void 0:i.statusCode)||o+"";e(new c_(Th(i),o,c))}).catch(i=>{e(new yu(Th(i),i))}):e(new yu(Th(r),r))}),PS=(r,e,t,s)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||!s?i:(BS(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),t))};function yo(r,e,t,s,i,o){return Ie(this,void 0,void 0,function*(){return new Promise((c,f)=>{r(t,PS(e,s,i,o)).then(h=>{if(!h.ok)throw h;return s!=null&&s.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>US(h,f,s))})})}function oo(r,e,t,s){return Ie(this,void 0,void 0,function*(){return yo(r,"GET",e,t,s)})}function bn(r,e,t,s,i){return Ie(this,void 0,void 0,function*(){return yo(r,"POST",e,s,i,t)})}function ed(r,e,t,s,i){return Ie(this,void 0,void 0,function*(){return yo(r,"PUT",e,s,i,t)})}function zS(r,e,t,s){return Ie(this,void 0,void 0,function*(){return yo(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function vd(r,e,t,s,i){return Ie(this,void 0,void 0,function*(){return yo(r,"DELETE",e,s,i,t)})}class HS{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return Ie(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ct(e))return{data:null,error:e};throw e}})}}var u_;class $S{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[u_]="BlobDownloadBuilder",this.promise=null}asStream(){return new HS(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ie(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ct(e))return{data:null,error:e};throw e}})}}u_=Symbol.toStringTag;const GS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class VS{constructor(e,t={},s,i){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=s,this.fetch=xd(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,s,i){return Ie(this,void 0,void 0,function*(){try{let o;const c=Object.assign(Object.assign({},rx),i);let f=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&s instanceof Blob?(o=new FormData,o.append("cacheControl",c.cacheControl),h&&o.append("metadata",this.encodeMetadata(h)),o.append("",s)):typeof FormData<"u"&&s instanceof FormData?(o=s,o.has("cacheControl")||o.append("cacheControl",c.cacheControl),h&&!o.has("metadata")&&o.append("metadata",this.encodeMetadata(h))):(o=s,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType,h&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(h))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!c.duplex&&(c.duplex="half")),i!=null&&i.headers&&(f=Object.assign(Object.assign({},f),i.headers));const m=this._removeEmptyFolders(t),x=this._getFinalPath(m),v=yield(e=="PUT"?ed:bn)(this.fetch,`${this.url}/object/${x}`,o,Object.assign({headers:f},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:v.Id,fullPath:v.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}upload(e,t,s){return Ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,i){return Ie(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),c=this._getFinalPath(o),f=new URL(this.url+`/object/upload/sign/${c}`);f.searchParams.set("token",t);try{let h;const m=Object.assign({upsert:rx.upsert},i),x=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&s instanceof Blob?(h=new FormData,h.append("cacheControl",m.cacheControl),h.append("",s)):typeof FormData<"u"&&s instanceof FormData?(h=s,h.append("cacheControl",m.cacheControl)):(h=s,x["cache-control"]=`max-age=${m.cacheControl}`,x["content-type"]=m.contentType);const v=yield ed(this.fetch,f.toString(),h,{headers:x});return{data:{path:o,fullPath:v.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(Ct(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(e,t){return Ie(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const o=yield bn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),c=new URL(this.url+o.url),f=c.searchParams.get("token");if(!f)throw new _o("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:f},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}update(e,t,s){return Ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return Ie(this,void 0,void 0,function*(){try{return{data:yield bn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ct(i))return{data:null,error:i};throw i}})}copy(e,t,s){return Ie(this,void 0,void 0,function*(){try{return{data:{path:(yield bn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ct(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,s){return Ie(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),o=yield bn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const c=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${c}`)},{data:o,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ct(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,s){return Ie(this,void 0,void 0,function*(){try{const i=yield bn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${o}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ct(i))return{data:null,error:i};throw i}})}download(e,t){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),c=o?`?${o}`:"",f=this._getFinalPath(e),h=()=>oo(this.fetch,`${this.url}/${i}/${f}${c}`,{headers:this.headers,noResolveJson:!0});return new $S(h,this.shouldThrowOnError)}info(e){return Ie(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield oo(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Zh(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}exists(e){return Ie(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield zS(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s)&&s instanceof yu){const i=s.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),i=[],o=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&i.push(o);const f=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});h!==""&&i.push(h);let m=i.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${s}${m}`)}}}remove(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield vd(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}list(e,t,s){return Ie(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},GS),t),{prefix:e||""});return{data:yield bn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ct(i))return{data:null,error:i};throw i}})}listV2(e,t){return Ie(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield bn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const f_="2.87.1",h_={"X-Client-Info":`storage-js/${f_}`};class qS{constructor(e,t={},s,i){this.shouldThrowOnError=!1;const o=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},h_),t),this.fetch=xd(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Ie(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield oo(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}getBucket(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield oo(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}createBucket(e){return Ie(this,arguments,void 0,function*(t,s={public:!1}){try{return{data:yield bn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ct(i))return{data:null,error:i};throw i}})}updateBucket(e,t){return Ie(this,void 0,void 0,function*(){try{return{data:yield ed(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield bn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield vd(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}var co=class extends Error{constructor(r,e){var t;super(r),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function KS(r,e,t){const s=new URL(e,r);if(t)for(const[i,o]of Object.entries(t))o!==void 0&&s.searchParams.set(i,o);return s.toString()}async function WS(r){return!r||r.type==="none"?{}:r.type==="bearer"?{Authorization:`Bearer ${r.token}`}:r.type==="header"?{[r.name]:r.value}:r.type==="custom"?await r.getHeaders():{}}function XS(r){const e=r.fetchImpl??globalThis.fetch;return{async request({method:t,path:s,query:i,body:o,headers:c}){const f=KS(r.baseUrl,s,i),h=await WS(r.auth),m=await e(f,{method:t,headers:{...o?{"Content-Type":"application/json"}:{},...h,...c},body:o?JSON.stringify(o):void 0}),x=await m.text(),v=(m.headers.get("content-type")||"").includes("application/json"),_=v&&x?JSON.parse(x):x;if(!m.ok){const y=v?_:void 0,E=y==null?void 0:y.error;throw new co((E==null?void 0:E.message)??`Request failed with status ${m.status}`,{status:m.status,icebergType:E==null?void 0:E.type,icebergCode:E==null?void 0:E.code,details:y})}return{status:m.status,headers:m.headers,data:_}}}}function eu(r){return r.join("")}var YS=class{constructor(r,e=""){this.client=r,this.prefix=e}async listNamespaces(r){const e=r?{parent:eu(r.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(r,e){const t={namespace:r.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${eu(r.namespace)}`})}async loadNamespaceMetadata(r){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${eu(r.namespace)}`})).data.properties}}async namespaceExists(r){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${eu(r.namespace)}`}),!0}catch(e){if(e instanceof co&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(r,e){try{return await this.createNamespace(r,e)}catch(t){if(t instanceof co&&t.status===409)return;throw t}}};function wi(r){return r.join("")}var JS=class{constructor(r,e="",t){this.client=r,this.prefix=e,this.accessDelegation=t}async listTables(r){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${wi(r.namespace)}/tables`})).data.identifiers}async createTable(r,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${wi(r.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(r,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${wi(r.namespace)}/tables/${r.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(r,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${wi(r.namespace)}/tables/${r.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(r){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${wi(r.namespace)}/tables/${r.name}`,headers:e})).data.metadata}async tableExists(r){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${wi(r.namespace)}/tables/${r.name}`,headers:e}),!0}catch(t){if(t instanceof co&&t.status===404)return!1;throw t}}async createTableIfNotExists(r,e){try{return await this.createTable(r,e)}catch(t){if(t instanceof co&&t.status===409)return await this.loadTable({namespace:r.namespace,name:e.name});throw t}}},QS=class{constructor(r){var s;let e="v1";r.catalogName&&(e+=`/${r.catalogName}`);const t=r.baseUrl.endsWith("/")?r.baseUrl:`${r.baseUrl}/`;this.client=XS({baseUrl:t,auth:r.auth,fetchImpl:r.fetch}),this.accessDelegation=(s=r.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new YS(this.client,e),this.tableOps=new JS(this.client,e,this.accessDelegation)}async listNamespaces(r){return this.namespaceOps.listNamespaces(r)}async createNamespace(r,e){return this.namespaceOps.createNamespace(r,e)}async dropNamespace(r){await this.namespaceOps.dropNamespace(r)}async loadNamespaceMetadata(r){return this.namespaceOps.loadNamespaceMetadata(r)}async listTables(r){return this.tableOps.listTables(r)}async createTable(r,e){return this.tableOps.createTable(r,e)}async updateTable(r,e){return this.tableOps.updateTable(r,e)}async dropTable(r,e){await this.tableOps.dropTable(r,e)}async loadTable(r){return this.tableOps.loadTable(r)}async namespaceExists(r){return this.namespaceOps.namespaceExists(r)}async tableExists(r){return this.tableOps.tableExists(r)}async createNamespaceIfNotExists(r,e){return this.namespaceOps.createNamespaceIfNotExists(r,e)}async createTableIfNotExists(r,e){return this.tableOps.createTableIfNotExists(r,e)}};class d_{constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},h_),t),this.fetch=xd(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield bn(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}listBuckets(e){return Ie(this,void 0,void 0,function*(){try{const t=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&t.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&t.set("sortOrder",e.sortOrder),e!=null&&e.search&&t.set("search",e.search);const s=t.toString(),i=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield oo(this.fetch,i,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield vd(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}})}from(e){if(!MS(e))throw new _o("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new QS({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>Ie(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(t,{get(o,c){const f=o[c];return typeof f!="function"?f:(...h)=>Ie(this,void 0,void 0,function*(){try{return{data:yield f.apply(o,h),error:null}}catch(m){if(s)throw m;return{data:null,error:m}}})}})}}const _d={"X-Client-Info":`storage-js/${f_}`,"Content-Type":"application/json"};class yd extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Fr(r){return typeof r=="object"&&r!==null&&"__isStorageVectorsError"in r}class du extends yd{constructor(e,t,s){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class m_ extends yd{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var td;(function(r){r.InternalError="InternalError",r.S3VectorConflictException="S3VectorConflictException",r.S3VectorNotFoundException="S3VectorNotFoundException",r.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",r.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",r.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(td||(td={}));const Ku=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),ZS=()=>Response,g_=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},eE=r=>Array.from(new Float32Array(r)),tE=(r,e)=>{if(e!==void 0&&r.float32.length!==e)throw new Error(`Vector dimension mismatch: expected ${e}, got ${r.float32.length}`)},nx=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),rE=(r,e,t)=>Ie(void 0,void 0,void 0,function*(){if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!(t!=null&&t.noResolveJson)){const i=r.status||500,o=r;if(typeof o.json=="function")o.json().then(c=>{const f=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||i+"";e(new du(nx(c),i,f))}).catch(()=>{const c=i+"",f=o.statusText||`HTTP ${i} error`;e(new du(f,i,c))});else{const c=i+"",f=o.statusText||`HTTP ${i} error`;e(new du(f,i,c))}}else e(new m_(nx(r),r))}),nE=(r,e,t,s)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return s?(g_(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,Object.assign(Object.assign({},i),t)):i};function aE(r,e,t,s,i,o){return Ie(this,void 0,void 0,function*(){return new Promise((c,f)=>{r(t,nE(e,s,i,o)).then(h=>{if(!h.ok)throw h;if(s!=null&&s.noResolveJson)return h;const m=h.headers.get("content-type");return!m||!m.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>rE(h,f,s))})})}function Yr(r,e,t,s,i){return Ie(this,void 0,void 0,function*(){return aE(r,"POST",e,s,i,t)})}class p_{constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_d),t),this.fetch=Ku(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Ie(this,void 0,void 0,function*(){try{return{data:(yield Yr(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}getIndex(e,t){return Ie(this,void 0,void 0,function*(){try{return{data:yield Yr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Fr(s))return{data:null,error:s};throw s}})}listIndexes(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield Yr(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return Ie(this,void 0,void 0,function*(){try{return{data:(yield Yr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Fr(s))return{data:null,error:s};throw s}})}}class x_{constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_d),t),this.fetch=Ku(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Ie(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Yr(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}getVectors(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield Yr(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}listVectors(e){return Ie(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Yr(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}queryVectors(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield Yr(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}deleteVectors(e){return Ie(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Yr(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}}class v_{constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_d),t),this.fetch=Ku(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Ie(this,void 0,void 0,function*(){try{return{data:(yield Yr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}getBucket(e){return Ie(this,void 0,void 0,function*(){try{return{data:yield Yr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}listBuckets(){return Ie(this,arguments,void 0,function*(e={}){try{return{data:yield Yr(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ie(this,void 0,void 0,function*(){try{return{data:(yield Yr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}}class __ extends v_{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new y_(this.url,this.headers,e,this.fetch)}createBucket(e){const t=Object.create(null,{createBucket:{get:()=>super.createBucket}});return Ie(this,void 0,void 0,function*(){return t.createBucket.call(this,e)})}getBucket(e){const t=Object.create(null,{getBucket:{get:()=>super.getBucket}});return Ie(this,void 0,void 0,function*(){return t.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return Ie(this,arguments,void 0,function*(t={}){return e.listBuckets.call(this,t)})}deleteBucket(e){const t=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return Ie(this,void 0,void 0,function*(){return t.deleteBucket.call(this,e)})}}class y_ extends p_{constructor(e,t,s,i){super(e,t,i),this.vectorBucketName=s}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ie(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ie(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ie(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ie(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new w_(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class w_ extends x_{constructor(e,t,s,i,o){super(e,t,o),this.vectorBucketName=s,this.indexName=i}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ie(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ie(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ie(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ie(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ie(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class sE extends qS{constructor(e,t={},s,i){super(e,t,s,i)}from(e){return new VS(this.url,this.headers,e,this.fetch)}get vectors(){return new __(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new d_(this.url+"/iceberg",this.headers,this.fetch)}}const iE=Object.freeze(Object.defineProperty({__proto__:null,StorageAnalyticsClient:d_,StorageApiError:c_,StorageClient:sE,StorageError:_o,StorageUnknownError:yu,StorageVectorsApiError:du,StorageVectorsClient:__,StorageVectorsError:yd,get StorageVectorsErrorCode(){return td},StorageVectorsUnknownError:m_,VectorBucketApi:v_,VectorBucketScope:y_,VectorDataApi:x_,VectorIndexApi:p_,VectorIndexScope:w_,isPlainObject:g_,isStorageError:Ct,isStorageVectorsError:Fr,normalizeToFloat32:eE,resolveFetch:Ku,resolveResponse:ZS,validateVectorDimension:tE},Symbol.toStringTag,{value:"Module"})),lE=vo(iE);var Ah={},ql={},ax;function oE(){return ax||(ax=1,Object.defineProperty(ql,"__esModule",{value:!0}),ql.version=void 0,ql.version="2.87.1"),ql}var sx;function cE(){return sx||(sx=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_REALTIME_OPTIONS=r.DEFAULT_AUTH_OPTIONS=r.DEFAULT_DB_OPTIONS=r.DEFAULT_GLOBAL_OPTIONS=r.DEFAULT_HEADERS=void 0;const e=oE();let t="";typeof Deno<"u"?t="deno":typeof document<"u"?t="web":typeof navigator<"u"&&navigator.product==="ReactNative"?t="react-native":t="node",r.DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${t}/${e.version}`},r.DEFAULT_GLOBAL_OPTIONS={headers:r.DEFAULT_HEADERS},r.DEFAULT_DB_OPTIONS={schema:"public"},r.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},r.DEFAULT_REALTIME_OPTIONS={}})(Ah)),Ah}var Nh={},ix;function uE(){return ix||(ix=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.fetchWithAuth=r.resolveHeadersConstructor=r.resolveFetch=void 0;const e=i=>i?(...o)=>i(...o):(...o)=>fetch(...o);r.resolveFetch=e;const t=()=>Headers;r.resolveHeadersConstructor=t;const s=(i,o,c)=>{const f=(0,r.resolveFetch)(c),h=(0,r.resolveHeadersConstructor)();return async(m,x)=>{var v;const _=(v=await o())!==null&&v!==void 0?v:i;let y=new h(x==null?void 0:x.headers);return y.has("apikey")||y.set("apikey",i),y.has("Authorization")||y.set("Authorization",`Bearer ${_}`),f(m,Object.assign(Object.assign({},x),{headers:y}))}};r.fetchWithAuth=s})(Nh)),Nh}var la={},lx;function fE(){if(lx)return la;lx=1,Object.defineProperty(la,"__esModule",{value:!0}),la.isBrowser=void 0,la.uuid=r,la.ensureTrailingSlash=e,la.applySettingDefaults=s,la.validateSupabaseUrl=i;function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var c=Math.random()*16|0,f=o=="x"?c:c&3|8;return f.toString(16)})}function e(o){return o.endsWith("/")?o:o+"/"}const t=()=>typeof window<"u";la.isBrowser=t;function s(o,c){var f,h;const{db:m,auth:x,realtime:v,global:_}=o,{db:y,auth:E,realtime:w,global:S}=c,k={db:Object.assign(Object.assign({},y),m),auth:Object.assign(Object.assign({},E),x),realtime:Object.assign(Object.assign({},w),v),storage:{},global:Object.assign(Object.assign(Object.assign({},S),_),{headers:Object.assign(Object.assign({},(f=S==null?void 0:S.headers)!==null&&f!==void 0?f:{}),(h=_==null?void 0:_.headers)!==null&&h!==void 0?h:{})}),accessToken:async()=>""};return o.accessToken?k.accessToken=o.accessToken:delete k.accessToken,k}function i(o){const c=o==null?void 0:o.trim();if(!c)throw new Error("supabaseUrl is required.");if(!c.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(e(c))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}return la}var Kl={};const b_="2.87.1",Oi=30*1e3,rd=3,Oh=rd*Oi,hE="http://localhost:9999",dE="supabase.auth.token",mE={"X-Client-Info":`gotrue-js/${b_}`},nd="X-Supabase-Api-Version",S_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},gE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,pE=600*1e3;let $i=class extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}};function Pe(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}let E_=class extends $i{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}};function T_(r){return Pe(r)&&r.name==="AuthApiError"}let $a=class extends $i{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}},ma=class extends $i{constructor(e,t,s,i){super(e,s,i),this.name=t,this.status=s}},kr=class extends ma{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function A_(r){return Pe(r)&&r.name==="AuthSessionMissingError"}let ws=class extends ma{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},Jl=class extends ma{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}},Ql=class extends ma{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function N_(r){return Pe(r)&&r.name==="AuthImplicitGrantRedirectError"}let ad=class extends ma{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},wu=class extends ma{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}};function mu(r){return Pe(r)&&r.name==="AuthRetryableFetchError"}let sd=class extends ma{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}};function xE(r){return Pe(r)&&r.name==="AuthWeakPasswordError"}let bu=class extends ma{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}};const Su="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ox=` 	
\r=`.split(""),vE=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<ox.length;e+=1)r[ox[e].charCodeAt(0)]=-2;for(let e=0;e<Su.length;e+=1)r[Su[e].charCodeAt(0)]=e;return r})();function cx(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Su[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Su[s]),e.queuedBits-=6}}function O_(r,e,t){const s=vE[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function ux(r){const e=[],t=c=>{e.push(String.fromCodePoint(c))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},o=c=>{wE(c,s,t)};for(let c=0;c<r.length;c+=1)O_(r.charCodeAt(c),i,o);return e.join("")}function _E(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function yE(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}_E(s,e)}}function wE(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if((r>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Fi(r){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};for(let i=0;i<r.length;i+=1)O_(r.charCodeAt(i),t,s);return new Uint8Array(e)}function bE(r){const e=[];return yE(r,t=>e.push(t)),new Uint8Array(e)}function Ns(r){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};return r.forEach(i=>cx(i,t,s)),cx(null,t,s),e.join("")}function SE(r){return Math.round(Date.now()/1e3)+r}function EE(){return Symbol("auth-callback")}const sr=()=>typeof window<"u"&&typeof document<"u",_s={tested:!1,writable:!1},C_=()=>{if(!sr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_s.tested)return _s.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),_s.tested=!0,_s.writable=!0}catch{_s.tested=!0,_s.writable=!1}return _s.writable};function TE(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,o)=>{e[o]=i})}catch{}return t.searchParams.forEach((s,i)=>{e[i]=s}),e}const R_=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),AE=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Ci=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},ys=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ar=async(r,e)=>{await r.removeItem(e)};class Wu{constructor(){this.promise=new Wu.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Wu.promiseConstructor=Promise;function Ch(r){const e=r.split(".");if(e.length!==3)throw new bu("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!gE.test(e[s]))throw new bu("JWT not in base64url format");return{header:JSON.parse(ux(e[0])),payload:JSON.parse(ux(e[1])),signature:Fi(e[2]),raw:{header:e[0],payload:e[1]}}}async function NE(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function OE(r,e){return new Promise((s,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const c=await r(o);if(!e(o,null,c)){s(c);return}}catch(c){if(!e(o,c)){i(c);return}}})()})}function CE(r){return("0"+r.toString(16)).substr(-2)}function RE(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let i="";for(let o=0;o<56;o++)i+=t.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,CE).join("")}async function jE(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(s);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}async function kE(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await jE(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function bi(r,e,t=!1){const s=RE();let i=s;t&&(i+="/PASSWORD_RECOVERY"),await Ci(r,`${e}-code-verifier`,i);const o=await kE(s);return[o,s===o?"plain":"s256"]}const DE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function FE(r){const e=r.headers.get(nd);if(!e||!e.match(DE))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function LE(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function IE(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const BE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Si(r){if(!BE.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Rh(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ME(r,e){return new Proxy(r,{get:(t,s,i)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const o=s.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,s,i)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,s,i)}})}function fx(r){return JSON.parse(JSON.stringify(r))}const bs=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),UE=[502,503,504];async function hx(r){var e;if(!AE(r))throw new wu(bs(r),0);if(UE.includes(r.status))throw new wu(bs(r),r.status);let t;try{t=await r.json()}catch(o){throw new $a(bs(o),o)}let s;const i=FE(r);if(i&&i.getTime()>=S_["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new sd(bs(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new kr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,c)=>o&&typeof c=="string",!0))throw new sd(bs(t),r.status,t.weak_password.reasons);throw new E_(bs(t),r.status||500,s)}const PE=(r,e,t,s)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),t))};async function Ge(r,e,t,s){var i;const o=Object.assign({},s==null?void 0:s.headers);o[nd]||(o[nd]=S_["2024-01-01"].name),s!=null&&s.jwt&&(o.Authorization=`Bearer ${s.jwt}`);const c=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(c.redirect_to=s.redirectTo);const f=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await zE(r,e,t+f,{headers:o,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(h):{data:Object.assign({},h),error:null}}async function zE(r,e,t,s,i,o){const c=PE(e,s,i,o);let f;try{f=await r(t,Object.assign({},c))}catch(h){throw console.error(h),new wu(bs(h),0)}if(f.ok||await hx(f),s!=null&&s.noResolveJson)return f;try{return await f.json()}catch(h){await hx(h)}}function wn(r){var e;let t=null;GE(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=SE(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function dx(r){const e=wn(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Ga(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function HE(r){return{data:r,error:null}}function $E(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:o}=r,c=Vi(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:o},h=Object.assign({},c);return{data:{properties:f,user:h},error:null}}function mx(r){return r}function GE(r){return r.access_token&&r.refresh_token&&r.expires_in}const gu=["global","local","others"];let wd=class{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=R_(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=gu[0]){if(gu.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${gu.join(", ")}`);try{return await Ge(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await Ge(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ga})}catch(s){if(Pe(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Vi(e,["options"]),i=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await Ge(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:$E,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Pe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ge(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ga})}catch(t){if(Pe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,i,o,c,f,h;try{const m={nextPage:null,lastPage:0,total:0},x=await Ge(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(o=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:mx});if(x.error)throw x.error;const v=await x.json(),_=(c=x.headers.get("x-total-count"))!==null&&c!==void 0?c:0,y=(h=(f=x.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(E=>{const w=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(E.split(";")[1].split("=")[1]);m[`${S}Page`]=w}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},v),m),error:null}}catch(m){if(Pe(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){Si(e);try{return await Ge(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ga})}catch(t){if(Pe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Si(e);try{return await Ge(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ga})}catch(s){if(Pe(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Si(e);try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ga})}catch(s){if(Pe(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Si(e.userId);try{const{data:t,error:s}=await Ge(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:s}}catch(t){if(Pe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Si(e.userId),Si(e.id);try{return{data:await Ge(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Pe(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,s,i,o,c,f,h;try{const m={nextPage:null,lastPage:0,total:0},x=await Ge(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(o=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:mx});if(x.error)throw x.error;const v=await x.json(),_=(c=x.headers.get("x-total-count"))!==null&&c!==void 0?c:0,y=(h=(f=x.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(E=>{const w=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(E.split(";")[1].split("=")[1]);m[`${S}Page`]=w}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},v),m),error:null}}catch(m){if(Pe(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(e){try{return await Ge(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Pe(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Ge(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Pe(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Ge(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await Ge(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Pe(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Ge(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Pe(t))return{data:null,error:t};throw t}}};function gx(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}const Ss={debug:!!(globalThis&&C_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class bd extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}let j_=class extends bd{};class VE extends bd{}async function k_(r,e,t){Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw Ss.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new j_(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Ss.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}const px={};async function qE(r,e,t){var s;const i=(s=px[r])!==null&&s!==void 0?s:Promise.resolve(),o=Promise.race([i.catch(()=>null),e>=0?new Promise((c,f)=>{setTimeout(()=>{f(new VE(`Acquring process lock with name "${r}" timed out`))},e)}):null].filter(c=>c)).catch(c=>{if(c&&c.isAcquireTimeout)throw c;return null}).then(async()=>await t());return px[r]=o.catch(async c=>{if(c&&c.isAcquireTimeout)return await i,null;throw c}),await o}function KE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function D_(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function WE(r){return parseInt(r,16)}function XE(r){const e=new TextEncoder().encode(r);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function YE(r){var e;const{chainId:t,domain:s,expirationTime:i,issuedAt:o=new Date,nonce:c,notBefore:f,requestId:h,resources:m,scheme:x,uri:v,version:_}=r;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((e=r.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const y=D_(r.address),E=x?`${x}://${s}`:s,w=r.statement?`${r.statement}
`:"",S=`${E} wants you to sign in with your Ethereum account:
${y}

${w}`;let k=`URI: ${v}
Version: ${_}
Chain ID: ${t}${c?`
Nonce: ${c}`:""}
Issued At: ${o.toISOString()}`;if(i&&(k+=`
Expiration Time: ${i.toISOString()}`),f&&(k+=`
Not Before: ${f.toISOString()}`),h&&(k+=`
Request ID: ${h}`),m){let M=`
Resources:`;for(const O of m){if(!O||typeof O!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${O}`);M+=`
- ${O}`}k+=M}return`${S}
${k}`}class $t extends Error{constructor({message:e,code:t,cause:s,name:i}){var o;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(o=i??(s instanceof Error?s.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=t}}class Eu extends $t{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function JE({error:r,options:e}){var t,s,i;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new $t({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((t=o.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new $t({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(e.mediation==="conditional"&&((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new $t({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((i=o.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new $t({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new $t({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new $t({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return o.pubKeyCredParams.filter(f=>f.type==="public-key").length===0?new $t({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new $t({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const c=window.location.hostname;if(F_(c)){if(o.rp.id!==c)return new $t({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new $t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new $t({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new $t({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new $t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function QE({error:r,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new $t({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new $t({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const s=window.location.hostname;if(F_(s)){if(t.rpId!==s)return new $t({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new $t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new $t({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new $t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class ZE{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const eT=new ZE;function tT(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:e,user:t,excludeCredentials:s}=r,i=Vi(r,["challenge","user","excludeCredentials"]),o=Fi(e).buffer,c=Object.assign(Object.assign({},t),{id:Fi(t.id).buffer}),f=Object.assign(Object.assign({},i),{challenge:o,user:c});if(s&&s.length>0){f.excludeCredentials=new Array(s.length);for(let h=0;h<s.length;h++){const m=s[h];f.excludeCredentials[h]=Object.assign(Object.assign({},m),{id:Fi(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return f}function rT(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:e,allowCredentials:t}=r,s=Vi(r,["challenge","allowCredentials"]),i=Fi(e).buffer,o=Object.assign(Object.assign({},s),{challenge:i});if(t&&t.length>0){o.allowCredentials=new Array(t.length);for(let c=0;c<t.length;c++){const f=t[c];o.allowCredentials[c]=Object.assign(Object.assign({},f),{id:Fi(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return o}function nT(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r;return{id:r.id,rawId:r.id,response:{attestationObject:Ns(new Uint8Array(r.response.attestationObject)),clientDataJSON:Ns(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function aT(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r,s=r.getClientExtensionResults(),i=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:Ns(new Uint8Array(i.authenticatorData)),clientDataJSON:Ns(new Uint8Array(i.clientDataJSON)),signature:Ns(new Uint8Array(i.signature)),userHandle:i.userHandle?Ns(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function F_(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function xx(){var r,e;return!!(sr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function sT(r){try{const e=await navigator.credentials.create(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Eu("Browser returned unexpected credential type",e)}:{data:null,error:new Eu("Empty credential response",e)}}catch(e){return{data:null,error:JE({error:e,options:r})}}}async function iT(r){try{const e=await navigator.credentials.get(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Eu("Browser returned unexpected credential type",e)}:{data:null,error:new Eu("Empty credential response",e)}}catch(e){return{data:null,error:QE({error:e,options:r})}}}const lT={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},oT={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Tu(...r){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),t=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),s={};for(const i of r)if(i)for(const o in i){const c=i[o];if(c!==void 0)if(Array.isArray(c))s[o]=c;else if(t(c))s[o]=c;else if(e(c)){const f=s[o];e(f)?s[o]=Tu(f,c):s[o]=Tu(c)}else s[o]=c}return s}function cT(r,e){return Tu(lT,r,e||{})}function uT(r,e){return Tu(oT,r,e||{})}class fT{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:s,signal:i},o){try{const{data:c,error:f}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:f};const h=i??eT.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${s}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=cT(c.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:x,error:v}=await sT({publicKey:m,signal:h});return x?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:x}},error:null}:{data:null,error:v}}case"request":{const m=uT(c.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:x,error:v}=await iT(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:h}));return x?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:x}},error:null}:{data:null,error:v}}}}catch(c){return Pe(c)?{data:null,error:c}:{data:null,error:new $a("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:s}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},o){if(!t)return{data:null,error:new $i("rpId is required for WebAuthn authentication")};try{if(!xx())return{data:null,error:new $a("Browser does not support WebAuthn",null)};const{data:c,error:f}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:s},signal:i},{request:o});if(!c)return{data:null,error:f};const{webauthn:h}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:h.type,rpId:t,rpOrigins:s,credential_response:h.credential_response}})}catch(c){return Pe(c)?{data:null,error:c}:{data:null,error:new $a("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},o){if(!t)return{data:null,error:new $i("rpId is required for WebAuthn registration")};try{if(!xx())return{data:null,error:new $a("Browser does not support WebAuthn",null)};const{data:c,error:f}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(x=>{var v;return(v=x.data)===null||v===void 0?void 0:v.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===e&&_.status!=="unverified")}).then(x=>x?this.client.mfa.unenroll({factorId:x==null?void 0:x.id}):void 0),{data:null,error:f};const{data:h,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:t,rpOrigins:s},signal:i},{create:o});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:t,rpOrigins:s,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:m}}catch(c){return Pe(c)?{data:null,error:c}:{data:null,error:new $a("Unexpected error in register",c)}}}}KE();const hT={url:hE,storageKey:dE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function vx(r,e,t){return await t()}const Ei={};let Sd=class id{get jwks(){var e,t;return(t=(e=Ei[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Ei[this.storageKey]=Object.assign(Object.assign({},Ei[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Ei[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ei[this.storageKey]=Object.assign(Object.assign({},Ei[this.storageKey]),{cachedAt:e})}constructor(e){var t,s,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},hT),e);if(this.storageKey=o.storageKey,this.instanceID=(t=id.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,id.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&sr()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new wd({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=R_(o.fetch),this.lock=o.lock||vx,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,o.lock?this.lock=o.lock:this.persistSession&&sr()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=k_:this.lock=vx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new fT(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:C_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=gx(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=gx(this.memoryStorage)),sr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${b_}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},s="none";if(sr()&&(t=TE(window.location.href),this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce")),sr()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:o}=await this._getSessionFromURL(t,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),N_(o)){const h=(e=o.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:c,redirectType:f}=i;return this._debug("#_initialize()","detected session in URL",c,"redirect type",f),await this._saveSession(c),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Pe(t)?this._returnResult({error:t}):this._returnResult({error:new $a("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,i;try{const o=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:wn}),{data:c,error:f}=o;if(f||!c)return this._returnResult({data:{user:null,session:null},error:f});const h=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(o){if(Pe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var t,s,i;try{let o;if("email"in e){const{email:x,password:v,options:_}=e;let y=null,E=null;this.flowType==="pkce"&&([y,E]=await bi(this.storage,this.storageKey)),o=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:x,password:v,data:(t=_==null?void 0:_.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:y,code_challenge_method:E},xform:wn})}else if("phone"in e){const{phone:x,password:v,options:_}=e;o=await Ge(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:v,data:(s=_==null?void 0:_.data)!==null&&s!==void 0?s:{},channel:(i=_==null?void 0:_.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:wn})}else throw new Jl("You must provide either an email or phone number and a password");const{data:c,error:f}=o;if(f||!c)return await ar(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:f});const h=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(o){if(await ar(this.storage,`${this.storageKey}-code-verifier`),Pe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:c,options:f}=e;t=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:c,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:dx})}else if("phone"in e){const{phone:o,password:c,options:f}=e;t=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:c,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:dx})}else throw new Jl("You must provide either an email or phone number and a password");const{data:s,error:i}=t;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!s||!s.session||!s.user){const o=new ws;return this._returnResult({data:{user:null,session:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(t){if(Pe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,s,i,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,s,i,o,c,f,h,m,x,v,_;let y,E;if("message"in e)y=e.message,E=e.signature;else{const{chain:w,wallet:S,statement:k,options:M}=e;let O;if(sr())if(typeof S=="object")O=S;else{const z=window;if("ethereum"in z&&typeof z.ethereum=="object"&&"request"in z.ethereum&&typeof z.ethereum.request=="function")O=z.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(M!=null&&M.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=S}const G=new URL((t=M==null?void 0:M.url)!==null&&t!==void 0?t:window.location.href),q=await O.request({method:"eth_requestAccounts"}).then(z=>z).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!q||q.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const K=D_(q[0]);let F=(s=M==null?void 0:M.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!F){const z=await O.request({method:"eth_chainId"});F=WE(z)}const X={domain:G.host,address:K,statement:k,uri:G.href,version:"1",chainId:F,nonce:(i=M==null?void 0:M.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(c=(o=M==null?void 0:M.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(f=M==null?void 0:M.signInWithEthereum)===null||f===void 0?void 0:f.expirationTime,notBefore:(h=M==null?void 0:M.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(m=M==null?void 0:M.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(x=M==null?void 0:M.signInWithEthereum)===null||x===void 0?void 0:x.resources};y=YE(X),E=await O.request({method:"personal_sign",params:[XE(y),K]})}try{const{data:w,error:S}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:E},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:wn});if(S)throw S;if(!w||!w.session||!w.user){const k=new ws;return this._returnResult({data:{user:null,session:null},error:k})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:S})}catch(w){if(Pe(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var t,s,i,o,c,f,h,m,x,v,_,y;let E,w;if("message"in e)E=e.message,w=e.signature;else{const{chain:S,wallet:k,statement:M,options:O}=e;let G;if(sr())if(typeof k=="object")G=k;else{const K=window;if("solana"in K&&typeof K.solana=="object"&&("signIn"in K.solana&&typeof K.solana.signIn=="function"||"signMessage"in K.solana&&typeof K.solana.signMessage=="function"))G=K.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(O!=null&&O.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=k}const q=new URL((t=O==null?void 0:O.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in G&&G.signIn){const K=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O==null?void 0:O.signInWithSolana),{version:"1",domain:q.host,uri:q.href}),M?{statement:M}:null));let F;if(Array.isArray(K)&&K[0]&&typeof K[0]=="object")F=K[0];else if(K&&typeof K=="object"&&"signedMessage"in K&&"signature"in K)F=K;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)E=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),w=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${q.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${q.href}`,`Issued At: ${(i=(s=O==null?void 0:O.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((o=O==null?void 0:O.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((c=O==null?void 0:O.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((f=O==null?void 0:O.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((h=O==null?void 0:O.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((m=O==null?void 0:O.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((v=(x=O==null?void 0:O.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||v===void 0)&&v.length?["Resources",...O.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const K=await G.signMessage(new TextEncoder().encode(E),"utf8");if(!K||!(K instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=K}}try{const{data:S,error:k}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:Ns(w)},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:wn});if(k)throw k;if(!S||!S.session||!S.user){const M=new ws;return this._returnResult({data:{user:null,session:null},error:M})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:k})}catch(S){if(Pe(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(e){const t=await ys(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(t??"").split("/");try{const{data:o,error:c}=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:wn});if(await ar(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!o||!o.session||!o.user){const f=new ws;return this._returnResult({data:{user:null,session:null,redirectType:null},error:f})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:c})}catch(o){if(await ar(this.storage,`${this.storageKey}-code-verifier`),Pe(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:t,provider:s,token:i,access_token:o,nonce:c}=e,f=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:o,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:wn}),{data:h,error:m}=f;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!h||!h.session||!h.user){const x=new ws;return this._returnResult({data:{user:null,session:null},error:x})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:m})}catch(t){if(Pe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,s,i,o,c;try{if("email"in e){const{email:f,options:h}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await bi(this.storage,this.storageKey));const{error:v}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},create_user:(s=h==null?void 0:h.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:x},redirectTo:h==null?void 0:h.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:f,options:h}=e,{data:m,error:x}=await Ge(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(i=h==null?void 0:h.data)!==null&&i!==void 0?i:{},create_user:(o=h==null?void 0:h.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(c=h==null?void 0:h.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:x})}throw new Jl("You must provide either an email or phone number.")}catch(f){if(await ar(this.storage,`${this.storageKey}-code-verifier`),Pe(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async verifyOtp(e){var t,s;try{let i,o;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:c,error:f}=await Ge(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:wn});if(f)throw f;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,m=c.user;return h!=null&&h.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(i){if(Pe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var t,s,i,o,c;try{let f=null,h=null;this.flowType==="pkce"&&([f,h]=await bi(this.storage,this.storageKey));const m=await Ge(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:f,code_challenge_method:h}),headers:this.headers,xform:HE});return!((o=m.data)===null||o===void 0)&&o.url&&sr()&&!(!((c=e.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(f){if(await ar(this.storage,`${this.storageKey}-code-verifier`),Pe(f))return this._returnResult({data:null,error:f});throw f}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new kr;const{error:i}=await Ge(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(Pe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:o}=e,{error:c}=await Ge(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:s,type:i,options:o}=e,{data:c,error:f}=await Ge(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f})}throw new Jl("You must provide either an email or phone number and a type")}catch(t){if(Pe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ys(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Oh:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const c=await ys(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=Rh()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=ME(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(-1,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ga}):await this._useSession(async t=>{var s,i,o;const{data:c,error:f}=t;if(f)throw f;return!(!((s=c.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kr}:await Ge(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:Ga})})}catch(t){if(Pe(t))return A_(t)&&(await this._removeSession(),await ar(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:i,error:o}=s;if(o)throw o;if(!i.session)throw new kr;const c=i.session;let f=null,h=null;this.flowType==="pkce"&&e.email!=null&&([f,h]=await bi(this.storage,this.storageKey));const{data:m,error:x}=await Ge(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:h}),jwt:c.access_token,xform:Ga});if(x)throw x;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(s){if(await ar(this.storage,`${this.storageKey}-code-verifier`),Pe(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new kr;const t=Date.now()/1e3;let s=t,i=!0,o=null;const{payload:c}=Ch(e.access_token);if(c.exp&&(s=c.exp,i=s<=t),i){const{data:f,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!f)return{data:{user:null,session:null},error:null};o=f}else{const{data:f,error:h}=await this._getUser(e.access_token);if(h)throw h;o={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(t){if(Pe(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:c,error:f}=t;if(f)throw f;e=(s=c.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new kr;const{data:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Pe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!sr())throw new Ql("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ql(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new ad("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ql("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ad("No code detected.");const{data:M,error:O}=await this._exchangeCodeForSession(e.code);if(O)throw O;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:o,refresh_token:c,expires_in:f,expires_at:h,token_type:m}=e;if(!o||!f||!c||!m)throw new Ql("No session defined in URL");const x=Math.round(Date.now()/1e3),v=parseInt(f);let _=x+v;h&&(_=parseInt(h));const y=_-x;y*1e3<=Oi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${v}s`);const E=_-v;x-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,_,x):x-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,_,x);const{data:w,error:S}=await this._getUser(o);if(S)throw S;const k={provider_token:s,provider_refresh_token:i,access_token:o,expires_in:v,expires_at:_,refresh_token:c,token_type:m,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:e.type},error:null})}catch(s){if(Pe(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ys(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:i,error:o}=t;if(o)return this._returnResult({error:o});const c=(s=i.session)===null||s===void 0?void 0:s.access_token;if(c){const{error:f}=await this.admin.signOut(c,e);if(f&&!(T_(f)&&(f.status===404||f.status===401||f.status===403)))return this._returnResult({error:f})}return e!=="others"&&(await this._removeSession(),await ar(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=EE(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,i;try{const{data:{session:o},error:c}=t;if(c)throw c;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await bi(this.storage,this.storageKey,!0));try{return await Ge(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(await ar(this.storage,`${this.storageKey}-code-verifier`),Pe(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:i}=await this._useSession(async o=>{var c,f,h,m,x;const{data:v,error:_}=o;if(_)throw _;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(f=e.options)===null||f===void 0?void 0:f.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Ge(this.fetch,"GET",y,{headers:this.headers,jwt:(x=(m=v.session)===null||m===void 0?void 0:m.access_token)!==null&&x!==void 0?x:void 0})});if(i)throw i;return sr()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Pe(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var s;try{const{error:i,data:{session:o}}=t;if(i)throw i;const{options:c,provider:f,token:h,access_token:m,nonce:x}=e,v=await Ge(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=o==null?void 0:o.access_token)!==null&&s!==void 0?s:void 0,body:{provider:f,id_token:h,access_token:m,nonce:x,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:wn}),{data:_,error:y}=v;return y?this._returnResult({data:{user:null,session:null},error:y}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new ws}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:y}))}catch(i){if(await ar(this.storage,`${this.storageKey}-code-verifier`),Pe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,i;const{data:o,error:c}=t;if(c)throw c;return await Ge(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await OE(async i=>(i>0&&await NE(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await Ge(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:wn})),(i,o)=>{const c=200*Math.pow(2,i);return o&&mu(o)&&Date.now()+c-s<Oi})}catch(s){if(this._debug(t,"error",s),Pe(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),sr()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await ys(this.storage,this.storageKey);if(i&&this.userStorage){let c=await ys(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:i.user},await Ci(this.userStorage,this.storageKey+"-user",c)),i.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:Rh()}else if(i&&!i.user&&!i.user){const c=await ys(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(i.user=c.user,await ar(this.storage,this.storageKey+"-user"),await Ci(this.storage,this.storageKey,i)):i.user=Rh()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const o=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Oh;if(this._debug(s,`session has${o?"":" not"} expired with margin of ${Oh}s`),o){if(this.autoRefreshToken&&i.refresh_token){const{error:c}=await this._callRefreshToken(i.refresh_token);c&&(console.error(c),mu(c)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:f}=await this._getUser(i.access_token);!f&&(c!=null&&c.user)?(i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(s,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new kr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Wu;const{data:o,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!o.session)throw new kr;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const f={data:o.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(o){if(this._debug(i,"error",o),Pe(o)){const c={data:null,error:o};return mu(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],c=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(e,t)}catch(h){o.push(h)}});if(await Promise.all(c),o.length>0){for(let f=0;f<o.length;f+=1)console.error(o[f]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ar(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await Ci(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const o=fx(i);await Ci(this.storage,this.storageKey,o)}else{const i=fx(t);await Ci(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ar(this.storage,this.storageKey),await ar(this.storage,this.storageKey+"-code-verifier"),await ar(this.storage,this.storageKey+"-user"),this.userStorage&&await ar(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&sr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Oi);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/Oi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Oi}ms, refresh threshold is ${rd} ticks`),i<=rd&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof bd)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!sr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const i=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[o,c]=await bi(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(c)}`});i.push(f.toString())}if(s!=null&&s.queryParams){const o=new URLSearchParams(s.queryParams);i.push(o.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:i,error:o}=t;return o?this._returnResult({data:null,error:o}):await Ge(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,i;const{data:o,error:c}=t;if(c)return this._returnResult({data:null,error:c});const f=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:m}=await Ge(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(s=o==null?void 0:o.session)===null||s===void 0?void 0:s.access_token});return m?this._returnResult({data:null,error:m}):(e.factorType==="totp"&&h.type==="totp"&&(!((i=h==null?void 0:h.totp)===null||i===void 0)&&i.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?nT(e.webauthn.credential_response):aT(e.webauthn.credential_response)})}:{code:e.code}),{data:f,error:h}=await Ge(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),this._returnResult({data:f,error:h}))})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const c=await Ge(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});if(c.error)return c;const{data:f}=c;if(f.type!=="webauthn")return{data:f,error:null};switch(f.webauthn.type){case"create":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:tT(f.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:rT(f.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const i={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])i.all.push(o),o.status==="verified"&&i[o.factor_type].push(o);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:s},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ch(s.access_token);let c=null;o.aal&&(c=o.aal);let f=c;((t=(e=s.user.factors)===null||e===void 0?void 0:e.filter(x=>x.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(f="aal2");const m=o.amr||[];return{data:{currentLevel:c,nextLevel:f,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:s},error:i}=t;return i?this._returnResult({data:null,error:i}):s?await Ge(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new kr})})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:i},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!i)return this._returnResult({data:null,error:new kr});const c=await Ge(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:f=>({data:f,error:null})});return c.data&&c.data.redirect_url&&sr()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Pe(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:i},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!i)return this._returnResult({data:null,error:new kr});const c=await Ge(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:f=>({data:f,error:null})});return c.data&&c.data.redirect_url&&sr()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Pe(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;return s?this._returnResult({data:null,error:s}):t?await Ge(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new kr})})}catch(e){if(Pe(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:s},error:i}=t;return i?this._returnResult({data:null,error:i}):s?(await Ge(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new kr})})}catch(t){if(Pe(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(f=>f.kid===e);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(f=>f.kid===e),s&&this.jwks_cached_at+pE>i)return s;const{data:o,error:c}=await Ge(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=i,s=o.keys.find(f=>f.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:y,error:E}=await this.getSession();if(E||!y.session)return this._returnResult({data:null,error:E});s=y.session.access_token}const{header:i,payload:o,signature:c,raw:{header:f,payload:h}}=Ch(s);t!=null&&t.allowExpired||LE(o.exp);const m=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!m){const{error:y}=await this.getUser(s);if(y)throw y;return{data:{claims:o,header:i,signature:c},error:null}}const x=IE(i.alg),v=await crypto.subtle.importKey("jwk",m,x,!0,["verify"]);if(!await crypto.subtle.verify(x,v,c,bE(`${f}.${h}`)))throw new bu("Invalid JWT signature");return{data:{claims:o,header:i,signature:c},error:null}}catch(s){if(Pe(s))return this._returnResult({data:null,error:s});throw s}}};Sd.nextInstanceID={};const dT=wd,mT=Sd,gT=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:dT,AuthApiError:E_,AuthClient:mT,AuthError:$i,AuthImplicitGrantRedirectError:Ql,AuthInvalidCredentialsError:Jl,AuthInvalidJwtError:bu,AuthInvalidTokenResponseError:ws,AuthPKCEGrantCodeExchangeError:ad,AuthRetryableFetchError:wu,AuthSessionMissingError:kr,AuthUnknownError:$a,AuthWeakPasswordError:sd,CustomAuthError:ma,GoTrueAdminApi:wd,GoTrueClient:Sd,NavigatorLockAcquireTimeoutError:j_,SIGN_OUT_SCOPES:gu,isAuthApiError:T_,isAuthError:Pe,isAuthImplicitGrantRedirectError:N_,isAuthRetryableFetchError:mu,isAuthSessionMissingError:A_,isAuthWeakPasswordError:xE,lockInternals:Ss,navigatorLock:k_,processLock:qE},Symbol.toStringTag,{value:"Module"})),L_=vo(gT);var _x;function pT(){if(_x)return Kl;_x=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.SupabaseAuthClient=void 0;const r=L_;let e=class extends r.AuthClient{constructor(s){super(s)}};return Kl.SupabaseAuthClient=e,Kl}var yx;function wx(){if(yx)return qc;yx=1,Object.defineProperty(qc,"__esModule",{value:!0});const r=Wv,e=e_(),t=o_,s=lE,i=cE(),o=uE(),c=fE(),f=pT();class h{constructor(x,v,_){var y,E,w;this.supabaseUrl=x,this.supabaseKey=v;const S=(0,c.validateSupabaseUrl)(x);if(!v)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",S),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",S),this.storageUrl=new URL("storage/v1",S),this.functionsUrl=new URL("functions/v1",S);const k=`sb-${S.hostname.split(".")[0]}-auth-token`,M={db:i.DEFAULT_DB_OPTIONS,realtime:i.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},i.DEFAULT_AUTH_OPTIONS),{storageKey:k}),global:i.DEFAULT_GLOBAL_OPTIONS},O=(0,c.applySettingDefaults)(_??{},M);this.storageKey=(y=O.auth.storageKey)!==null&&y!==void 0?y:"",this.headers=(E=O.global.headers)!==null&&E!==void 0?E:{},O.accessToken?(this.accessToken=O.accessToken,this.auth=new Proxy({},{get:(G,q)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(q)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((w=O.auth)!==null&&w!==void 0?w:{},this.headers,O.global.fetch),this.fetch=(0,o.fetchWithAuth)(v,this._getAccessToken.bind(this),O.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},O.realtime)),this.accessToken&&this.accessToken().then(G=>this.realtime.setAuth(G)).catch(G=>console.warn("Failed to set initial Realtime auth token:",G)),this.rest=new e.PostgrestClient(new URL("rest/v1",S).href,{headers:this.headers,schema:O.db.schema,fetch:this.fetch}),this.storage=new s.StorageClient(this.storageUrl.href,this.headers,this.fetch,_==null?void 0:_.storage),O.accessToken||this._listenForAuthEvents()}get functions(){return new r.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(x){return this.rest.from(x)}schema(x){return this.rest.schema(x)}rpc(x,v={},_={head:!1,get:!1,count:void 0}){return this.rest.rpc(x,v,_)}channel(x,v={config:{}}){return this.realtime.channel(x,v)}getChannels(){return this.realtime.getChannels()}removeChannel(x){return this.realtime.removeChannel(x)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var x,v;if(this.accessToken)return await this.accessToken();const{data:_}=await this.auth.getSession();return(v=(x=_.session)===null||x===void 0?void 0:x.access_token)!==null&&v!==void 0?v:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:x,persistSession:v,detectSessionInUrl:_,storage:y,userStorage:E,storageKey:w,flowType:S,lock:k,debug:M,throwOnError:O},G,q){const K={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new f.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},K),G),storageKey:w,autoRefreshToken:x,persistSession:v,detectSessionInUrl:_,storage:y,userStorage:E,flowType:S,lock:k,debug:M,throwOnError:O,fetch:q,hasCustomAuthorizationHeader:Object.keys(this.headers).some(F=>F.toLowerCase()==="authorization")})}_initRealtimeClient(x){return new t.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},x),{params:Object.assign({apikey:this.supabaseKey},x==null?void 0:x.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((v,_)=>{this._handleTokenChanged(v,"CLIENT",_==null?void 0:_.access_token)})}_handleTokenChanged(x,v,_){(x==="TOKEN_REFRESHED"||x==="SIGNED_IN")&&this.changedAccessToken!==_?(this.changedAccessToken=_,this.realtime.setAuth(_)):x==="SIGNED_OUT"&&(this.realtime.setAuth(),v=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}return qc.default=h,qc}var bx;function xT(){return bx||(bx=1,(function(r){var e=ia&&ia.__createBinding||(Object.create?(function(x,v,_,y){y===void 0&&(y=_);var E=Object.getOwnPropertyDescriptor(v,_);(!E||("get"in E?!v.__esModule:E.writable||E.configurable))&&(E={enumerable:!0,get:function(){return v[_]}}),Object.defineProperty(x,y,E)}):(function(x,v,_,y){y===void 0&&(y=_),x[y]=v[_]})),t=ia&&ia.__exportStar||function(x,v){for(var _ in x)_!=="default"&&!Object.prototype.hasOwnProperty.call(v,_)&&e(v,x,_)},s=ia&&ia.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(r,"__esModule",{value:!0}),r.createClient=r.SupabaseClient=r.FunctionRegion=r.FunctionsError=r.FunctionsRelayError=r.FunctionsFetchError=r.FunctionsHttpError=r.PostgrestError=void 0;const i=s(wx());t(L_,r);var o=e_();Object.defineProperty(r,"PostgrestError",{enumerable:!0,get:function(){return o.PostgrestError}});var c=Wv;Object.defineProperty(r,"FunctionsHttpError",{enumerable:!0,get:function(){return c.FunctionsHttpError}}),Object.defineProperty(r,"FunctionsFetchError",{enumerable:!0,get:function(){return c.FunctionsFetchError}}),Object.defineProperty(r,"FunctionsRelayError",{enumerable:!0,get:function(){return c.FunctionsRelayError}}),Object.defineProperty(r,"FunctionsError",{enumerable:!0,get:function(){return c.FunctionsError}}),Object.defineProperty(r,"FunctionRegion",{enumerable:!0,get:function(){return c.FunctionRegion}}),t(o_,r);var f=wx();Object.defineProperty(r,"SupabaseClient",{enumerable:!0,get:function(){return s(f).default}});const h=(x,v,_)=>new i.default(x,v,_);r.createClient=h;function m(){if(typeof window<"u"||typeof process>"u")return!1;const x=process.version;if(x==null)return!1;const v=x.match(/^v(\d+)\./);return v?parseInt(v[1],10)<=18:!1}m()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")})(ia)),ia}var I_=xT();const B_=hd(I_),vT=Db({__proto__:null,default:B_},[I_]),{PostgrestError:dj,FunctionsHttpError:mj,FunctionsFetchError:gj,FunctionsRelayError:pj,FunctionsError:xj,FunctionRegion:vj,SupabaseClient:_j,createClient:ld,GoTrueAdminApi:yj,GoTrueClient:wj,AuthAdminApi:bj,AuthClient:Sj,navigatorLock:Ej,NavigatorLockAcquireTimeoutError:Tj,lockInternals:Aj,processLock:Nj,SIGN_OUT_SCOPES:Oj,AuthError:Cj,AuthApiError:Rj,AuthUnknownError:jj,CustomAuthError:kj,AuthSessionMissingError:Dj,AuthInvalidTokenResponseError:Fj,AuthInvalidCredentialsError:Lj,AuthImplicitGrantRedirectError:Ij,AuthPKCEGrantCodeExchangeError:Bj,AuthRetryableFetchError:Mj,AuthWeakPasswordError:Uj,AuthInvalidJwtError:Pj,isAuthError:zj,isAuthApiError:Hj,isAuthSessionMissingError:$j,isAuthImplicitGrantRedirectError:Gj,isAuthRetryableFetchError:Vj,isAuthWeakPasswordError:qj,RealtimePresence:Kj,RealtimeChannel:Wj,RealtimeClient:Xj,REALTIME_LISTEN_TYPES:Yj,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:Jj,REALTIME_PRESENCE_LISTEN_EVENTS:Qj,REALTIME_SUBSCRIBE_STATES:Zj,REALTIME_CHANNEL_STATES:e5}=B_||vT,M_="zebra_supabase_url",U_="zebra_supabase_key";let yr=null;const P_=()=>{const r=localStorage.getItem(M_),e=localStorage.getItem(U_);return{url:r||""||"",key:e||""||""}},{url:Sx,key:Ex}=P_();Sx&&Ex&&(yr=ld(Sx,Ex));const z_={async init(){const{url:r,key:e}=P_();r&&e&&!yr&&(yr=ld(r,e)),yr?console.log("Supabase Service Initialized"):console.warn("Supabase credentials missing. Service inactive.")},updateCredentials(r,e){localStorage.setItem(M_,r),localStorage.setItem(U_,e),r&&e&&(yr=ld(r,e),window.location.reload())},async getUsers(){if(!yr)return[];const{data:r,error:e}=await yr.from("users").select("*");return e?(console.error("Supabase Users Error:",e),[]):r},async getProducts(){if(!yr)return[];const{data:r,error:e}=await yr.from("products").select("*");return e?(console.error("Supabase Products Error:",e),[]):r.map(t=>({...t,sorts:typeof t.sorts=="string"?JSON.parse(t.sorts):t.sorts}))},async getHistory(){if(!yr)return[];const{data:r,error:e}=await yr.from("history").select("*").order("created_at",{ascending:!1}).limit(100);return e?(console.error("Supabase History Error:",e),[]):r.map(t=>({date:t.created_at,product:{name:t.product_name,sku:t.sku,id:"0"},weight:t.weight,serialNumber:t.serial_number,sortLabel:t.sort_label,sortValue:t.sort_value}))},async addToHistory(r){var s,i;if(!yr)return;const e={product_name:(s=r.product)==null?void 0:s.name,sku:(i=r.product)==null?void 0:i.sku,weight:r.weight,serial_number:r.serialNumber,sort_label:r.sortLabel,sort_value:r.sortValue,status:r.status||"ok",created_at:r.timestamp||new Date().toISOString()},{error:t}=await yr.from("history").upsert([e],{onConflict:"sku, serial_number"});t&&console.error("Supabase Save Error:",t)},async getReportData(r,e){if(!yr)return[];const{data:t,error:s}=await yr.from("history").select("*").gte("created_at",r.toISOString()).lte("created_at",e.toISOString()).order("created_at",{ascending:!1});return s?(console.error("Supabase Report Error:",s),[]):t.map(i=>({date:i.created_at,product:{name:i.product_name,sku:i.sku,id:"0"},weight:i.weight,serialNumber:i.serial_number,sortLabel:i.sort_label,sortValue:i.sort_value}))}},Tx="zebra_api_url",_T="http://localhost:3000",yT={async init(){console.log("PostgresApiService initialized");const r=this.getApiUrl();try{await fetch(`${r}/api/health`)}catch(e){console.error("API Health Check Failed",e)}},getApiUrl(){return localStorage.getItem(Tx)||_T},setApiUrl(r){localStorage.setItem(Tx,r)},async getUsers(){return zi},async getProducts(){return lo},async getHistory(){const r=this.getApiUrl();try{const e=await fetch(`${r}/api/items`);if(!e.ok)throw new Error("Failed to fetch items");return(await e.json()).map(s=>({product:lo.find(i=>i.sku===s.product_sku||i.name===s.product_name)||{name:s.product_name,name_en:s.product_name_en,id:"0",sku:"UNK",category:"unknown"},weight:s.weight,serialNumber:s.serial_number,date:new Date(s.created_at).toLocaleDateString(),...s}))}catch(e){return console.error("getHistory error",e),[]}},async addToHistory(r){var s,i;const e=this.getApiUrl(),t={id:r.barcode||crypto.randomUUID(),barcode:r.barcode,date:r.date,productName:(s=r.product)==null?void 0:s.name,productNameEn:(i=r.product)==null?void 0:i.name_en,serialNumber:r.serialNumber,weight:r.weight,status:"printed"};try{if(!(await fetch(`${e}/api/items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("Failed to save item")}catch(o){console.error("addToHistory error",o)}},async getReportData(r,e){return(await this.getHistory()).filter(s=>{const i=new Date(s.date);return i>=r&&i<=e})}},jh="zebra_data_source",Tn={getService(){let r=localStorage.getItem(jh);return r||(r="sqlite"),r==="supabase"?(console.log("--- Using Supabase Data Source ---"),z_):r==="postgres"?(console.log("--- Using Postgres API Data Source ---"),yT):$h},async init(){await this.getService().init()},setDataSource(r){localStorage.setItem(jh,r),window.location.reload()},getDataSource(){const r=localStorage.getItem(jh);if(r==="sqlite"||r==="supabase"||r==="postgres")return r;const e="sqlite";return e==="sqlite"||e==="supabase"||e==="postgres"?e:"sqlite"}};function H_(){const[r,e]=pe.useState(lo),[t,s]=pe.useState(zi),[i,o]=pe.useState(!0);return pe.useEffect(()=>{(async()=>{if(Ka.getPlatform()!=="web")try{const f=Tn.getService();await f.init();const h=await f.getProducts();h.length>0&&e(h);const m=await f.getUsers();m.length>0&&s(m)}catch(f){console.error("Failed to load data from DB:",f)}o(!1)})()},[]),{products:r,users:t,isLoading:i}}const tu="zebra_auth_user_v1",$_=pe.createContext(void 0);function wT({children:r}){const[e,t]=pe.useState(null),{users:s}=H_();console.log("AuthProvider mounted",{currentUser:e,usersCount:s.length}),pe.useEffect(()=>{const h=sessionStorage.getItem(tu);if(h)try{t(JSON.parse(h))}catch{sessionStorage.removeItem(tu)}},[]);const i=h=>{t(h),sessionStorage.setItem(tu,JSON.stringify(h))},o=()=>{t(null),sessionStorage.removeItem(tu)},c=(e==null?void 0:e.role)==="admin",f={currentUser:e,login:i,logout:o,isAdmin:c,users:s};return g.jsx($_.Provider,{value:f,children:r})}function wo(){const r=pe.useContext($_);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r}const bT=""+new URL("../logo.png",import.meta.url).href,Os=()=>g.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),Au=()=>g.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Ed=()=>g.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Ax=()=>g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),ST=()=>g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),ET=()=>g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),TT=()=>g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),AT=()=>g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),NT=()=>g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),OT=()=>g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),CT=`# Marijany Sticker Print -  

      "Marijany Sticker Print".          Zebra   .

![Logo](public/logo.png)

##  

            PIN-.

|  | PIN- |  |
| :--- | :--- | :--- |
| **** | \`1111\` |   ( ) |
| **** | \`2222\` | ,  ,  |
| **** | \`3333\` | ,  ,  |
| **** | \`4444\` |  |
| **** | \`7777\` |  ,  |

---

##    

1.  ** **:      (, " ").
2.  ** ** ( ):    (//)     .
3.  ** **:   .
4.  ** **:    .
    *   *      ,    .*
5.  ** ""**:     .
    *   *   2 .*

---

##    ("Print Later")

        (,        ).

1.     (, ).
2.    **" "** (   ).
    *   *   ',    .*
3.    ,  ** **    ( ).
    *          .
4.      :
    *      .
    *     .
    *   **" "**        .

> **:**    ,   .

---

##   

###     " "
    **" "**    **100x100 **:
*    ****      1.25 .
*      ,           .
*       .

###  Email 
     :
1.   **** ().
2.   email    **"Email  "**.
3.   **""**   " ",        .

###     ( )
     :
*   **Local (SQLite)**:  ,    .
*   **Cloud (Supabase)**:    ( ).
*   *     .*

---

##   

**   /  :**
1.  ,   **Zebra Browser Print**   '.
2.  ,      USB .
3.      **** ()   .
4.    ,          "  ".

** SSL:**
*       ,    ->   ->   **" SSL"**.      .
`,RT=({isOpen:r,onClose:e})=>{if(!r)return null;const t=s=>s.split(`
`).map((i,o)=>i.startsWith("## ")?g.jsx("h2",{className:"text-xl font-bold mt-4 mb-2 text-slate-800 border-b pb-1",children:i.replace("## ","")},o):i.startsWith("# ")?g.jsx("h1",{className:"text-2xl font-bold mb-4 text-[#115740]",children:i.replace("# ","")},o):i.startsWith("### ")?g.jsx("h3",{className:"text-lg font-semibold mt-3 mb-1 text-slate-700",children:i.replace("### ","")},o):i.trim().startsWith("* ")||i.trim().startsWith("- ")?g.jsx("li",{className:"ml-5 list-disc text-slate-600 my-0.5",children:i.replace(/^[\*\-] /,"")},o):i.trim().match(/^\d+\. /)?g.jsx("li",{className:"ml-5 list-decimal text-slate-600 my-0.5",children:i.replace(/^\d+\. /,"")},o):i.includes("|")?g.jsx("pre",{className:"bg-slate-50 p-1 text-xs md:text-sm font-mono whitespace-pre-wrap text-slate-700 overflow-x-auto my-1",children:i},o):i.includes("---")?g.jsx("hr",{className:"my-4 border-slate-200"},o):i.includes("![Logo]")?g.jsx("div",{className:"flex justify-center my-4 opacity-50",children:g.jsx("span",{className:"text-xs italic",children:"Logotype"})},o):i.trim()===""?g.jsx("div",{className:"h-2"},o):g.jsx("p",{className:"text-slate-600 text-sm md:text-base leading-relaxed",children:i},o));return g.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-fade-in",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl overflow-hidden max-h-[90vh] flex flex-col",children:[g.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-slate-50",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:" "}),g.jsx("button",{onClick:e,className:"p-2 text-slate-400 hover:bg-slate-100 rounded-full transition-colors",children:g.jsx(Ed,{})})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-white custom-scrollbar",children:t(CT)}),g.jsx("div",{className:"p-4 border-t bg-slate-50 flex justify-end",children:g.jsx("button",{onClick:e,className:"px-6 py-2 bg-slate-800 text-white font-bold rounded-lg hover:bg-slate-900 transition-colors",children:""})})]})})},jT=({onLogin:r,users:e=zi})=>{const[t,s]=pe.useState(()=>!e||e.length===0?{id:"error",name:"Error",role:"operator",pin:""}:e.find(O=>O.role==="operator")||e[0]);if(!e||e.length===0)return g.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-red-100 text-red-600 p-8 text-center font-bold text-xl",children:[":   .",g.jsx("br",{})," constants.ts   ."]});const[i,o]=pe.useState(""),[c,f]=pe.useState(""),[h,m]=pe.useState(!1),[x,v]=pe.useState("pin"),[_,y]=pe.useState(""),E=O=>{x==="pin"&&i.length<4&&(o(G=>G+O),f(""))},w=()=>{x==="pin"&&(o(O=>O.slice(0,-1)),f(""))},S=()=>{i===t.pin?t.role==="admin"?(v("2fa"),f("")):r(t):(f(" PIN-"),o(""))},k=O=>{O==null||O.preventDefault();const G=K=>K.trim().toLowerCase();["liverpool",""].includes(G(_))?r(t):f(" ")};pe.useEffect(()=>{i.length===4&&x==="pin"&&S()},[i]);const M=["1","2","3","4","5","6","7","8","9","empty","0","back"];return g.jsxs("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4 relative",children:[g.jsx("button",{onClick:()=>m(!0),className:"absolute top-4 right-4 md:top-8 md:right-8 bg-white p-2 md:p-3 rounded-full shadow-lg text-slate-500 hover:text-[#115740] hover:scale-110 transition-all z-10",title:"",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),g.jsx(RT,{isOpen:h,onClose:()=>m(!1)}),g.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-xl overflow-hidden relative z-0",children:[g.jsxs("div",{className:"bg-[#115740] p-4 md:p-6 text-center",children:[g.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-white rounded-2xl flex items-center justify-center mx-auto mb-3 md:mb-4 shadow-lg p-3",children:g.jsx("img",{src:bT,alt:"Logo",className:"w-full h-full object-contain"})}),g.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white",children:""}),g.jsx("p",{className:"text-emerald-100 text-sm mt-1 mb-1",children:"HeMP v1.0"})]}),g.jsx("div",{className:"p-6",children:x==="pin"?g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"mb-6",children:[g.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2",children:" "}),g.jsxs("div",{className:"relative",children:[g.jsx("select",{value:t.id,onChange:O=>{const G=e.find(q=>q.id===O.target.value);G&&(s(G),o(""),f(""))},className:"w-full appearance-none bg-slate-50 border border-slate-200 text-slate-700 py-3 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:bg-white focus:border-[#115740] font-bold",children:e.map(O=>g.jsx("option",{value:O.id,children:O.name},O.id))}),g.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-700",children:g.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:g.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]}),g.jsxs("div",{className:"mb-6",children:[g.jsx("div",{className:"flex justify-center gap-4 mb-2",children:[0,1,2,3].map(O=>g.jsx("div",{className:`w-4 h-4 rounded-full border-2 transition-colors ${O<i.length?"bg-[#115740] border-[#115740]":"border-slate-300 bg-transparent"}`},O))}),g.jsx("div",{className:"h-6 text-center",children:c&&g.jsx("span",{className:"text-red-500 text-sm font-medium animate-pulse",children:c})})]}),g.jsx("div",{className:"grid grid-cols-3 gap-2 md:gap-3",children:M.map(O=>O==="empty"?g.jsx("div",{},O):O==="back"?g.jsx("button",{onClick:w,className:"h-12 md:h-14 flex items-center justify-center text-slate-500 hover:bg-slate-100 rounded-lg transition-colors font-bold",children:""},O):g.jsx("button",{onClick:()=>E(O),className:"h-12 md:h-14 bg-slate-50 hover:bg-slate-100 text-slate-800 font-bold text-xl rounded-lg border-b-2 border-slate-200 active:border-b-0 active:translate-y-[2px] transition-all",children:O},O))})]}):g.jsxs("form",{onSubmit:k,className:"animate-fade-in",children:[g.jsx("button",{type:"button",onClick:()=>{v("pin"),o(""),f("")},className:"mb-4 text-sm text-slate-500 hover:text-[#115740] flex items-center gap-1",children:" "}),g.jsxs("div",{className:"mb-6 text-center",children:[g.jsx("div",{className:"mb-2 text-4xl",children:""}),g.jsx("label",{className:"block font-bold text-slate-700 mb-2",children:"    ?"}),g.jsx("input",{type:"text",value:_,onChange:O=>{y(O.target.value),f("")},className:"w-full px-4 py-3 rounded-lg border-2 border-slate-200 focus:border-[#115740] focus:outline-none text-center font-bold text-lg",placeholder:"...",autoFocus:!0}),g.jsx("div",{className:"h-6 text-center mt-2",children:c&&g.jsx("span",{className:"text-red-500 text-sm font-medium animate-pulse",children:c})})]}),g.jsx("button",{type:"submit",disabled:!_,className:"w-full py-4 bg-[#115740] hover:bg-[#0d4532] text-white font-bold rounded-xl shadow-lg shadow-emerald-900/20 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})})]})]})};class kT{constructor(){this.isNative=Ka.isNativePlatform(),this.ZEBRA_SERVICE_UUID="000018f0-0000-1000-8000-00805f9b34fb"}async requestBluetoothDevice(){if(!navigator.bluetooth)throw new Error("Web Bluetooth API is not available (Require HTTPS & Chrome).");try{const e=await navigator.bluetooth.requestDevice({filters:[{namePrefix:"Zebra"},{namePrefix:"XX"},{namePrefix:"Printer"}],optionalServices:["generic_access",6384]});if(!e||!e.gatt)throw new Error("Bluetooth Device selected but no GATT server found.");const t=await e.gatt.connect();return{uid:e.id,name:e.name||"Bluetooth Printer",connection:"bluetooth_direct",deviceType:"printer",manufacturer:"Zebra",provider:"WebBluetooth",version:"1.0",gattServer:t}}catch(e){throw console.error("Bluetooth pairing failed",e),new Error(e.message||"Pairing Cancelled")}}async printViaWebBluetooth(e,t){try{if(!e.gattServer||!e.gattServer.connected)if(e.gattServer&&e.gattServer.device&&e.gattServer.device.gatt)e.gattServer=await e.gattServer.device.gatt.connect();else throw new Error("Bluetooth Disconnected. Please pair again.");const i=await e.gattServer.getPrimaryServices();let o=null;for(const m of i){const x=await m.getCharacteristics();for(const v of x)if(v.properties.write||v.properties.writeWithoutResponse){o=v;break}if(o)break}if(!o)throw new Error("No writable characteristic found on this printer.");const f=new TextEncoder().encode(t),h=100;for(let m=0;m<f.length;m+=h){const x=f.slice(m,m+h);await o.writeValue(x)}return!0}catch(s){return console.error("Bluetooth print failed",s),!1}}async waitForSdk(e=3e3){if(this.isNative||typeof window<"u"&&window.BrowserPrint)return!0;console.log("Waiting for Zebra SDK to initialize...");const t=Date.now();return new Promise(s=>{const i=setInterval(()=>{window.BrowserPrint?(console.log("Zebra SDK detected!"),clearInterval(i),s(!0)):Date.now()-t>e&&(console.error("Zebra SDK wait timeout. BrowserPrint is undefined."),clearInterval(i),s(!1))},100)})}async getDefaultPrinter(){if(this.isNative)throw new Error("  .  ,     .");if(!await this.waitForSdk())throw new Error(" Zebra SDK  .  .");return new Promise((t,s)=>{try{window.BrowserPrint.getDefaultDevice("printer",i=>{i&&i.name?(console.log("Default Printer found:",i.name),t(i)):s(new Error("    "))},i=>{console.error("SDK getDefaultDevice Error:",i),s(new Error("Zebra Browser Print  ."))})}catch(i){console.error("SDK Exception:",i),s(new Error(i.message||"Unknown SDK Error"))}})}async getDevicesByType(e){return new Promise(t=>{try{window.BrowserPrint.getLocalDevices(s=>{t(s||[])},s=>{console.warn(`SDK getLocalDevices Error [${e}]:`,s),t([])},e)}catch(s){console.warn(`Exception calling getLocalDevices [${e}]:`,s),t([])}})}async getAllPrinters(){if(this.isNative)return console.log("Native Discovery: Scanning Bluetooth..."),new Promise(o=>{if(!window.bluetoothSerial){console.error("bluetoothSerial plugin missing!"),o([]);return}window.bluetoothSerial.list(c=>{const f=c.map(h=>({uid:h.address,name:h.name,connection:"bluetooth_classic",deviceType:"printer",manufacturer:"Zebra",provider:"NativeBluetooth",version:"1.0"}));o(f)},c=>{console.error("Native Bluetooth List Failed:",c),o([])})});if(!await this.waitForSdk())throw new Error(" Zebra SDK  .");console.log("Scanning for all printer types...");const t=["printer","usb","net","bt"],s=new Set,i=[];for(const o of t){const c=await this.getDevicesByType(o);for(const f of c)s.has(f.uid)||(s.add(f.uid),f.connection||(f.connection=o),i.push(f))}return i}async print(e,t){if(this.isNative)try{console.log("Printing Native to:",e.uid);const{CapacitorZebraPrinter:i}=await Gu(async()=>{const{CapacitorZebraPrinter:c}=await import("./index-WOIRnm5K.js");return{CapacitorZebraPrinter:c}},[],import.meta.url);if(e.connection==="bluetooth_classic")return new Promise(c=>{if(!window.bluetoothSerial){c(!1);return}window.bluetoothSerial.isConnected(()=>{window.bluetoothSerial.write(t,()=>c(!0),()=>c(!1))},()=>{window.bluetoothSerial.connect(e.uid,()=>window.bluetoothSerial.write(t,()=>c(!0),()=>c(!1)),()=>c(!1))})});if(e.connection==="net"||e.provider==="Manual")return console.log("Direct LAN Print to:",e.uid),await i.print({ip:e.uid,port:9100,zpl:t}),!0;const o=await i.print({value:t,zpl:t,address:e.uid,ip:e.uid,port:9100});return console.log("Native Print Result:",o),!0}catch(i){return console.error("Native Print Error:",i),!1}return e.connection==="bluetooth_direct"&&e.gattServer?this.printViaWebBluetooth(e,t):e.connection==="virtual"?(console.log(`[VIRTUAL PRINTER] Printing: ${t.substring(0,50)}...`),await new Promise(i=>setTimeout(i,500)),!0):!await this.waitForSdk()||!e?!1:new Promise(i=>{try{let o=e;if((!e.send||typeof e.send!="function")&&window.BrowserPrint&&(o=new window.BrowserPrint.Device(e)),!o.send){console.error("Device object missing send method"),i(!1);return}o.send(t,c=>{console.log("Print sent successfully"),i(!0)},c=>{console.error("Print failed:",c),i(!1)})}catch(o){console.error("Print exception:",o),i(!1)}})}async convertImageToZPL(e,t){return new Promise((s,i)=>{const o=new Image;o.crossOrigin="Anonymous",o.onload=()=>{const c=document.createElement("canvas"),f=c.getContext("2d");if(!f){i(new Error("Canvas 2D context not supported"));return}c.width=t.width,c.height=t.height,f.drawImage(o,0,0,t.width,t.height);const m=f.getImageData(0,0,t.width,t.height).data;let x="";const v=t.threshold||128;for(let S=0;S<m.length;S+=4){const k=m[S],M=m[S+1],O=m[S+2],G=(k+M+O)/3;x+=G<v?"1":"0"}const _=Math.ceil(t.width/8);let y="",E=0;for(let S=0;S<t.height;S++)for(let k=0;k<_;k++){let M=0;for(let O=0;O<8;O++){const G=S*t.width+k*8+O;G<(S+1)*t.width&&x[G]==="1"&&(M|=1<<7-O)}y+=M.toString(16).padStart(2,"0").toUpperCase(),E++}const w=`^GFA,${E},${E},${_},${y}`;s(w)},o.onerror=c=>i(c),o.src=e})}toZplHex(e){if(!e)return"";const s=new TextEncoder().encode(e);let i="";for(let o=0;o<s.length;o++)i+="_"+s[o].toString(16).toUpperCase().padStart(2,"0");return i}formatBarcode(e,t){let s=e||"{date}-{sku}-{serialNumber}-{weight}";return s=s.split("{date}").join(t.date),s=s.split("{sku}").join(t.sku),s=s.split("{serialNumber}").join(t.serialNumber),s=s.split("{weight}").join(t.weight),s=s.split("{productName}").join(t.productName),s}generateZPL(e,t){let s=e;const i=t.barcodePattern||"{date}-{sku}-{serialNumber}-{weight}",o=this.formatBarcode(i,{date:t.date,sku:t.sku,serialNumber:t.serialNumber,weight:t.weight,productName:t.productName}),c=this.toZplHex(t.date),f=this.toZplHex(t.productName),h=this.toZplHex(t.productNameEn||""),m=this.toZplHex(t.sku),x=this.toZplHex(t.weight),v=this.toZplHex(t.serialNumber),_=this.toZplHex(t.sortLabel||"Sort"),y=this.toZplHex(t.sortValue||""),E=this.toZplHex(o);return s=s.split("{date}").join(c),s=s.split("{productName}").join(f),s=s.split("{productNameEn}").join(h),s=s.split("{sku}").join(m),s=s.split("{weight}").join(x),s=s.split("{serialNumber}").join(v),s=s.split("{barcode}").join(E),s=s.split("{sortLabel}").join(_),s=s.split("{sortValue}").join(y),s=s.split("{quantity}").join(t.quantity?t.quantity.toString():"1"),s=s.split("{logo}").join(t.logoZpl||""),s}}const oa=new kT,G_=({onKeyPress:r,onClear:e,onBackspace:t})=>{const s=["7","8","9","4","5","6","1","2","3",".","0"];return g.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[s.map(i=>g.jsx("button",{onClick:()=>r(i),className:"bg-[#CB8E00] hover:bg-[#b07b00] border border-[#a67400] text-white font-bold py-3 md:py-4 rounded-lg shadow-sm active:scale-95 transition-all text-lg md:text-xl",children:i},i)),g.jsx("button",{onClick:t,className:"bg-[#d9a21b] hover:bg-[#b07b00] border border-[#a67400] text-white font-bold py-3 md:py-4 rounded-lg shadow-sm active:scale-95 transition-all",children:""}),g.jsx("button",{onClick:e,className:"col-span-3 bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-2 md:py-3 rounded-lg border border-slate-300 active:scale-95 transition-all uppercase text-xs md:text-sm tracking-wider",children:""})]})},DT=()=>g.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),Nx=()=>g.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),FT=()=>g.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),LT=()=>g.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),Ox=({category:r})=>{switch(r){case"fiber":return g.jsx(Nx,{});case"shiv":return g.jsx(FT,{});case"dust":return g.jsx(LT,{});default:return g.jsx(Nx,{})}},Cx=r=>{switch(r){case"fiber":return"bg-emerald-100 text-emerald-700";case"shiv":return"bg-amber-100 text-amber-700";case"dust":return"bg-slate-200 text-slate-600";default:return"bg-slate-100 text-slate-500"}},IT=({products:r,selectedProduct:e,onSelect:t})=>{const[s,i]=pe.useState(!1),o=pe.useRef(null);pe.useEffect(()=>{const f=h=>{o.current&&!o.current.contains(h.target)&&i(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const c=f=>{t(f),i(!1)};return g.jsxs("div",{className:"relative",ref:o,children:[g.jsxs("button",{onClick:()=>i(!s),className:`w-full bg-slate-50 border transition-all text-left flex items-center justify-between p-3 md:p-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#115740] ${s?"border-[#115740] ring-1 ring-[#115740]":"border-slate-300"}`,children:[e?g.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[g.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center shrink-0 ${Cx(e.category)}`,children:g.jsx(Ox,{category:e.category})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:"font-bold text-slate-900 truncate",children:e.name}),g.jsxs("div",{className:"text-xs text-slate-500 font-mono",children:["SKU: ",e.sku]})]})]}):g.jsx("span",{className:"text-slate-500 text-lg",children:"--   --"}),g.jsx("div",{className:`transition-transform duration-200 ${s?"rotate-180":""}`,children:g.jsx(DT,{})})]}),s&&g.jsx("div",{className:"absolute top-full left-0 w-full mt-2 bg-white rounded-xl shadow-2xl border border-slate-200 overflow-hidden z-[100] max-h-80 overflow-y-auto animate-fade-in-down",children:r.map(f=>g.jsxs("div",{onClick:()=>c(f),className:`flex items-center gap-3 p-3 cursor-pointer transition-colors border-b border-slate-100 last:border-0 ${(e==null?void 0:e.id)===f.id?"bg-green-50":"hover:bg-slate-50"}`,children:[g.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center shrink-0 ${Cx(f.category)}`,children:g.jsx(Ox,{category:f.category})}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("div",{className:`font-bold truncate ${(e==null?void 0:e.id)===f.id?"text-[#115740]":"text-slate-800"}`,children:f.name}),g.jsxs("div",{className:"text-xs text-slate-500 font-mono",children:["SKU: ",f.sku]})]}),(e==null?void 0:e.id)===f.id&&g.jsx("div",{className:"text-[#115740]",children:g.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},f.id))})]})},BT=()=>g.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),MT=({sorts:r,selectedSort:e,onSelect:t,label:s=""})=>{const[i,o]=pe.useState(!1),c=pe.useRef(null);pe.useEffect(()=>{const h=m=>{c.current&&!c.current.contains(m.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const f=h=>{t(h),o(!1)};return g.jsxs("div",{className:"mt-4 border-slate-100 animate-fade-in",ref:c,children:[g.jsx("label",{className:"block mb-2 text-sm font-medium text-slate-700 uppercase tracking-wide",children:s}),g.jsxs("div",{className:"relative",children:[g.jsxs("button",{onClick:()=>o(!i),className:`w-full bg-slate-50 border transition-all text-left flex items-center justify-between p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#115740] ${i?"border-[#115740] ring-1 ring-[#115740]":"border-slate-300"}`,children:[g.jsx("span",{className:`font-bold ${e?"text-slate-900":"text-slate-500"}`,children:e||"  "}),g.jsx("div",{className:`transition-transform duration-200 ${i?"rotate-180":""}`,children:g.jsx(BT,{})})]}),i&&g.jsx("div",{className:"absolute top-full left-0 w-full mt-2 bg-white rounded-xl shadow-2xl border border-slate-200 overflow-hidden z-[100] max-h-60 overflow-y-auto animate-fade-in-down",children:r.map(h=>g.jsx("div",{onClick:()=>f(h),className:`p-3 cursor-pointer transition-colors border-b border-slate-100 last:border-0 font-bold ${e===h?"bg-emerald-50 text-[#115740]":"text-slate-700 hover:bg-slate-50"}`,children:h},h))})]})]})};var En=(r=>(r.DISCONNECTED="DISCONNECTED",r.CONNECTING="CONNECTING",r.CONNECTED="CONNECTED",r.ERROR="ERROR",r))(En||{});const UT=({currentUser:r,onLogout:e,onSettingsClick:t,onQueueClick:s,printerData:i})=>{const[o,c]=Hu.useState(!1),f=()=>{o?e():(c(!0),setTimeout(()=>c(!1),3e3))},h=(i==null?void 0:i.printerStatus)||En.DISCONNECTED;return g.jsx("header",{className:"bg-[#115740] border-b border-[#0f4433] sticky top-0 z-30 shadow-md",style:{paddingTop:"var(--safe-area-top, 0px)"},children:g.jsxs("div",{className:"max-w-7xl mx-auto px-3 h-14 md:h-16 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 bg-white rounded-xl shadow-sm flex items-center justify-center p-2",children:g.jsx("img",{src:"/logo.png",alt:"Logo",className:"w-full h-full object-contain"})}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-lg md:text-xl font-bold text-white leading-none tracking-tight",children:"HeMP"}),g.jsx("p",{className:"text-[10px] text-emerald-200 font-medium tracking-widest opacity-80 leading-none mt-0.5",children:"HEIGHT MAIN PROGRAM"}),g.jsx("div",{className:"flex items-center gap-1",children:typeof window<"u"&&window.self!==window.top&&g.jsxs("a",{href:window.location.href,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-white font-bold bg-white/20 px-1 rounded flex items-center gap-0.5 hover:bg-white/30",title:"   ",children:[g.jsx(NT,{})," New Window"]})})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("button",{onClick:f,className:`text-xs font-medium transition-all px-3 py-1 rounded-lg ${o?"bg-red-500 text-white animate-pulse font-bold":"text-white/60 hover:text-white"}`,children:o?"?":""}),g.jsx("div",{className:`w-3 h-3 md:w-4 md:h-4 rounded-full shadow-lg transition-colors duration-300 border-2 border-white/20 ${h===En.CONNECTED?"bg-emerald-400 shadow-emerald-900":h===En.CONNECTING?"bg-yellow-400 animate-pulse":"bg-red-500 shadow-red-900"}`,title:h===En.CONNECTED?"":" '"}),s&&g.jsx("button",{onClick:s,className:"p-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-all active:scale-95 border border-white/10 relative",title:" ",children:g.jsx(OT,{})}),g.jsx("button",{onClick:t,className:"p-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-all active:scale-95 border border-white/10",title:"",children:g.jsx(Au,{})})]})]})})},PT=({isOpen:r,onClose:e,printerData:t,selectedLabelSize:s,onLabelSizeChange:i,onReprint:o})=>{const{printer:c}=t||{};return r?g.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-fade-in",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden flex flex-col max-h-[90vh]",children:[g.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-white shrink-0",children:[g.jsxs("div",{className:"text-xl font-bold text-slate-800 flex items-center gap-2 select-none",children:[g.jsx(Au,{}),""]}),g.jsx("button",{onClick:e,className:"p-2 text-slate-400 hover:bg-slate-100 rounded-full transition-colors",children:g.jsx(Ed,{})})]}),g.jsxs("div",{className:"p-4 overflow-y-auto flex-1 bg-white space-y-6",children:[g.jsxs("section",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[g.jsxs("h4",{className:"font-semibold text-slate-700 mb-2 text-sm uppercase tracking-wider flex items-center gap-2",children:[g.jsx(Os,{}),"  "]}),c?g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500 animate-pulse"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-bold text-slate-800",children:c.name}),g.jsx("div",{className:"text-xs text-slate-500",children:c.uid})]})]}):g.jsxs("div",{className:"flex items-center gap-3 text-slate-400",children:[g.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),g.jsx("span",{className:"font-medium",children:" "})]}),g.jsx("div",{className:"mt-3 text-[10px] text-slate-400 leading-tight",children:"     ."})]}),g.jsxs("section",{children:[g.jsx("h4",{className:"font-semibold text-slate-700 mb-3 text-sm uppercase tracking-wider",children:" "}),g.jsx("div",{className:"space-y-3",children:wv.map(f=>g.jsxs("label",{className:`flex items-center p-3 border rounded-xl cursor-pointer transition-all ${s.id===f.id?"border-[#115740] bg-green-50 ring-1 ring-[#115740]":"border-slate-200 hover:border-green-300 hover:bg-slate-50"}`,children:[g.jsx("input",{type:"radio",name:"labelSize",value:f.id,checked:s.id===f.id,onChange:()=>i(f),className:"w-4 h-4 text-[#115740] focus:ring-[#115740] border-gray-300"}),g.jsxs("div",{className:"ml-3",children:[g.jsx("span",{className:"block text-slate-900 font-bold text-sm",children:f.name}),g.jsxs("span",{className:"block text-slate-500 text-xs",children:[f.widthMm," x ",f.heightMm," "]})]})]},f.id))})]})]}),g.jsx("div",{className:"p-4 border-t bg-slate-50 text-right shrink-0",children:g.jsx("button",{onClick:e,className:"w-full px-6 py-3 bg-[#115740] text-white font-bold rounded-xl hover:bg-[#0d4633] transition-colors",children:""})})]})}):null},zT=({isOpen:r,onClose:e,queue:t,onRemove:s,onClear:i,onClearForce:o,onPrintItem:c,printerName:f})=>{const[h,m]=pe.useState(null);if(!r)return null;const x=async(_,y)=>{m(_);const E=await c(y,1);m(null),E&&s(_)},v=async()=>{if(window.confirm(` ? (${t.length} .)`)){for(let _=0;_<t.length;_++)if(m(_),!await c(t[_],1)){alert(`    ${_+1}. .`),m(null);return}m(null),m(null),o?o():i()}};return g.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden max-h-[90vh] flex flex-col",children:[g.jsxs("div",{className:"flex justify-between items-center p-4 border-b bg-slate-50",children:[g.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[g.jsx("span",{className:"bg-orange-100 text-orange-600 p-1.5 rounded-lg",children:g.jsx(Os,{})})," ",g.jsx("span",{className:"bg-slate-200 text-slate-600 text-sm px-2 py-0.5 rounded-full",children:t.length})]}),g.jsx("button",{onClick:e,className:"p-2 text-slate-400 hover:bg-slate-100 rounded-full",children:g.jsx(Ed,{})})]}),g.jsxs("div",{className:"p-2 bg-blue-50 border-b border-blue-100 text-xs text-blue-700 text-center",children:[": ",g.jsx("b",{children:f||" "})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 bg-slate-50",children:t.length===0?g.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-slate-400 opacity-50",children:[g.jsx(Os,{}),g.jsx("p",{className:"mt-2 font-medium",children:" "})]}):t.map((_,y)=>{var E,w;return g.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm flex items-center justify-between group hover:border-blue-300 transition-colors",children:[g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"font-bold text-slate-800",children:(E=_.product)==null?void 0:E.name}),g.jsx("span",{className:"text-xs bg-slate-100 px-1.5 rounded text-slate-500",children:(w=_.product)==null?void 0:w.sku})]}),g.jsxs("div",{className:"text-sm text-slate-500 mt-1 flex gap-3",children:[g.jsxs("span",{children:[": ",g.jsx("b",{children:_.weight})," "]}),g.jsxs("span",{children:["S/N: ",g.jsx("b",{children:_.serialNumber})]}),g.jsx("span",{children:_.date})]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:()=>x(y,_),disabled:h!==null,className:"p-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 border border-green-200 disabled:opacity-50",title:" ",children:h===y?g.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-green-600 border-t-transparent rounded-full"}):g.jsx(Os,{})}),g.jsx("button",{onClick:()=>s(y),disabled:h!==null,className:"p-2 text-red-400 hover:bg-red-50 rounded-lg hover:text-red-600 disabled:opacity-50",title:"",children:g.jsx(ST,{})})]})]},y)})}),g.jsxs("div",{className:"p-4 border-t bg-white flex flex-col-reverse sm:flex-row justify-between items-center gap-4",children:[g.jsx("button",{onClick:i,disabled:t.length===0||h!==null,className:"text-red-500 text-sm font-medium hover:underline disabled:opacity-50 w-full sm:w-auto text-center",children:" "}),g.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-2 w-full sm:w-auto",children:[g.jsx("button",{onClick:e,className:"px-4 py-3 sm:py-2 text-slate-500 font-medium hover:bg-slate-100 rounded-lg w-full sm:w-auto",children:""}),g.jsxs("button",{onClick:v,disabled:t.length===0||h!==null,className:"px-6 py-3 sm:py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-md disabled:bg-slate-300 disabled:shadow-none flex items-center justify-center gap-2 w-full sm:w-auto",children:[g.jsx(Os,{})," "]})]})]})]})})},ru="zebra_printer_config_v1",Rx="zebra_agent_ip";function Td(){const[r,e]=pe.useState(En.DISCONNECTED),[t,s]=pe.useState(null),[i,o]=pe.useState([]),[c,f]=pe.useState(!1),[h,m]=pe.useState("127.0.0.1");pe.useEffect(()=>{const w=localStorage.getItem(Rx);w&&m(w)},[]),pe.useEffect(()=>{v()},[]);const x=()=>{localStorage.setItem(Rx,h),window.confirm("   IP-,   .  ?")&&window.location.reload()},v=async()=>{e(En.CONNECTING),s(null);const w=localStorage.getItem(ru);if(w)try{const S=JSON.parse(w);console.log("Restored printer config:",S.name),s(S),e(En.CONNECTED);return}catch(S){console.error("Error parsing saved printer config",S),localStorage.removeItem(ru)}try{const S=await oa.getDefaultPrinter();s(S),e(En.CONNECTED),localStorage.setItem(ru,JSON.stringify(S))}catch{e(En.ERROR)}},_=async()=>{f(!0),o([]);let w=[];try{w=await oa.getAllPrinters()}catch(S){console.warn("Real printer search failed (likely SDK missing), continuing with Virtual.",S)}w.push({uid:"virtual_printer_001",name:"Virtual Test Printer",connection:"virtual",deviceType:"printer",manufacturer:"Zebra (Sim)",provider:"Virtual",version:"1.0"}),o(w),w.length===0&&alert("  .")},y=()=>{const w=`https://${h}:9101/ssl_support`;window.open(w,"_blank")},E=w=>{s(w),e(En.CONNECTED),localStorage.setItem(ru,JSON.stringify(w)),o([])};return{printer:t,printerStatus:r,discoveredPrinters:i,isSearchingPrinters:c,agentIp:h,setAgentIp:m,saveAgentIp:x,searchPrinters:_,selectPrinter:E,fixSsl:y,autoConnectPrinter:v,connectBluetooth:async()=>{try{const w=await oa.requestBluetoothDevice();E(w)}catch(w){alert("Bluetooth Error: "+w.message)}}}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Nu={};Nu.version="0.18.5";var V_=1252,HT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],q_=function(r){HT.indexOf(r)!=-1&&(V_=r)};function $T(){q_(1252)}var uo=function(r){q_(r)};function GT(){uo(1200),$T()}var nu=function(e){return String.fromCharCode(e)},jx=function(e){return String.fromCharCode(e)},Ou,Va="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function fo(r){for(var e="",t=0,s=0,i=0,o=0,c=0,f=0,h=0,m=0;m<r.length;)t=r.charCodeAt(m++),o=t>>2,s=r.charCodeAt(m++),c=(t&3)<<4|s>>4,i=r.charCodeAt(m++),f=(s&15)<<2|i>>6,h=i&63,isNaN(s)?f=h=64:isNaN(i)&&(h=64),e+=Va.charAt(o)+Va.charAt(c)+Va.charAt(f)+Va.charAt(h);return e}function ha(r){var e="",t=0,s=0,i=0,o=0,c=0,f=0,h=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<r.length;)o=Va.indexOf(r.charAt(m++)),c=Va.indexOf(r.charAt(m++)),t=o<<2|c>>4,e+=String.fromCharCode(t),f=Va.indexOf(r.charAt(m++)),s=(c&15)<<4|f>>2,f!==64&&(e+=String.fromCharCode(s)),h=Va.indexOf(r.charAt(m++)),i=(f&3)<<6|h,h!==64&&(e+=String.fromCharCode(i));return e}var it=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ga=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Rs(r){return it?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function kx(r){return it?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var An=function(e){return it?ga(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Xu(r){if(typeof ArrayBuffer>"u")return An(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),s=0;s!=r.length;++s)t[s]=r.charCodeAt(s)&255;return e}function bo(r){if(Array.isArray(r))return r.map(function(s){return String.fromCharCode(s)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function VT(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var or=it?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:ga(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var s=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)s.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";s.set(new Uint8Array(r[e]),t)}return s}return[].concat.apply([],r.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function qT(r){for(var e=[],t=0,s=r.length+250,i=Rs(r.length+255),o=0;o<r.length;++o){var c=r.charCodeAt(o);if(c<128)i[t++]=c;else if(c<2048)i[t++]=192|c>>6&31,i[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var f=r.charCodeAt(++o)&1023;i[t++]=240|c>>8&7,i[t++]=128|c>>2&63,i[t++]=128|f>>6&15|(c&3)<<4,i[t++]=128|f&63}else i[t++]=224|c>>12&15,i[t++]=128|c>>6&63,i[t++]=128|c&63;t>s&&(e.push(i.slice(0,t)),t=0,i=Rs(65535),s=65530)}return e.push(i.slice(0,t)),or(e)}var eo=/\u0000/g,au=/[\u0001-\u0006]/g;function Li(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Nn(r,e){var t=""+r;return t.length>=e?t:kt("0",e-t.length)+t}function Ad(r,e){var t=""+r;return t.length>=e?t:kt(" ",e-t.length)+t}function Cu(r,e){var t=""+r;return t.length>=e?t:t+kt(" ",e-t.length)}function KT(r,e){var t=""+Math.round(r);return t.length>=e?t:kt("0",e-t.length)+t}function WT(r,e){var t=""+r;return t.length>=e?t:kt("0",e-t.length)+t}var Dx=Math.pow(2,32);function Ti(r,e){if(r>Dx||r<-Dx)return KT(r,e);var t=Math.round(r);return WT(t,e)}function Ru(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Fx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],kh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function XT(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var Dt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Lx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},YT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ju(r,e,t){for(var s=r<0?-1:1,i=r*s,o=0,c=1,f=0,h=1,m=0,x=0,v=Math.floor(i);m<e&&(v=Math.floor(i),f=v*c+o,x=v*m+h,!(i-v<5e-8));)i=1/(i-v),o=c,c=f,h=m,m=x;if(x>e&&(m>e?(x=h,f=o):(x=m,f=c)),!t)return[0,s*f,x];var _=Math.floor(s*f/x);return[_,s*f-_*x,x]}function su(r,e,t){if(r>2958465||r<0)return null;var s=r|0,i=Math.floor(86400*(r-s)),o=0,c=[],f={D:s,T:i,u:86400*(r-s)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),e&&e.date1904&&(s+=1462),f.u>.9999&&(f.u=0,++i==86400&&(f.T=i=0,++s,++f.D)),s===60)c=t?[1317,10,29]:[1900,2,29],o=3;else if(s===0)c=t?[1317,8,29]:[1900,1,0],o=6;else{s>60&&--s;var h=new Date(1900,0,1);h.setDate(h.getDate()+s-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),s<60&&(o=(o+6)%7),t&&(o=n4(h,c))}return f.y=c[0],f.m=c[1],f.d=c[2],f.S=i%60,i=Math.floor(i/60),f.M=i%60,i=Math.floor(i/60),f.H=i,f.q=o,f}var K_=new Date(1899,11,31,0,0,0),JT=K_.getTime(),QT=new Date(1900,2,1,0,0,0);function W_(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=QT&&(t+=1440*60*1e3),(t-(JT+(r.getTimezoneOffset()-K_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Nd(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ZT(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function e4(r){var e=r<0?12:11,t=Nd(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function t4(r){var e=Nd(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function r4(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=e4(r):e===10?t=r.toFixed(10).substr(0,12):t=t4(r),Nd(ZT(t.toUpperCase()))}function od(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):r4(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Wa(14,W_(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function n4(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function a4(r,e,t,s){var i="",o=0,c=0,f=t.y,h,m=0;switch(r){case 98:f=t.y+543;case 121:switch(e.length){case 1:case 2:h=f%100,m=2;break;default:h=f%1e4,m=4;break}break;case 109:switch(e.length){case 1:case 2:h=t.m,m=e.length;break;case 3:return kh[t.m-1][1];case 5:return kh[t.m-1][0];default:return kh[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=t.d,m=e.length;break;case 3:return Fx[t.q][0];default:return Fx[t.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(t.H+11)%12,m=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=t.H,m=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=t.M,m=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Nn(t.S,e.length):(s>=2?c=s===3?1e3:100:c=s===1?10:1,o=Math.round(c*(t.S+t.u)),o>=60*c&&(o=0),e==="s"?o===0?"0":""+o/c:(i=Nn(o,2+s),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=t.D*24+t.H;break;case"[m]":case"[mm]":h=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":h=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}m=e.length===3?1:2;break;case 101:h=f,m=1;break}var x=m>0?Nn(h,m):"";return x}function qa(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,s=r.substr(0,t);t!=r.length;t+=e)s+=(s.length>0?",":"")+r.substr(t,e);return s}var X_=/%/g;function s4(r,e,t){var s=e.replace(X_,""),i=e.length-s.length;return ca(r,s,t*Math.pow(10,2*i))+kt("%",i)}function i4(r,e,t){for(var s=e.length-1;e.charCodeAt(s-1)===44;)--s;return ca(r,e.substr(0,s),t/Math.pow(10,3*(e.length-s)))}function Y_(r,e){var t,s=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Y_(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(e/Math.pow(10,o)).toPrecision(s+1+(i+o)%i),t.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+o):t+="E+"+(c-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,h,m,x){return h+m+x.substr(0,(i+o)%i)+"."+x.substr(o)+"E"})}else t=e.toExponential(s);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var J_=/# (\?+)( ?)\/( ?)(\d+)/;function l4(r,e,t){var s=parseInt(r[4],10),i=Math.round(e*s),o=Math.floor(i/s),c=i-o*s,f=s;return t+(o===0?"":""+o)+" "+(c===0?kt(" ",r[1].length+1+r[4].length):Ad(c,r[1].length)+r[2]+"/"+r[3]+Nn(f,r[4].length))}function o4(r,e,t){return t+(e===0?"":""+e)+kt(" ",r[1].length+2+r[4].length)}var Q_=/^#*0*\.([0#]+)/,Z_=/\).*[0#]/,ey=/\(###\) ###\\?-####/;function wr(r){for(var e="",t,s=0;s!=r.length;++s)switch(t=r.charCodeAt(s)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Ix(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Bx(r,e){var t=r-Math.floor(r),s=Math.pow(10,e);return e<(""+Math.round(t*s)).length?0:Math.round(t*s)}function c4(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function u4(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function hn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Z_)){var s=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?hn("n",s,t):"("+hn("n",s,-t)+")"}if(e.charCodeAt(e.length-1)===44)return i4(r,e,t);if(e.indexOf("%")!==-1)return s4(r,e,t);if(e.indexOf("E")!==-1)return Y_(e,t);if(e.charCodeAt(0)===36)return"$"+hn(r,e.substr(e.charAt(1)==" "?2:1),t);var i,o,c,f,h=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+Ti(h,e.length);if(e.match(/^[#?]+$/))return i=Ti(t,0),i==="0"&&(i=""),i.length>e.length?i:wr(e.substr(0,e.length-i.length))+i;if(o=e.match(J_))return l4(o,h,m);if(e.match(/^#+0+$/))return m+Ti(h,e.length-e.indexOf("0"));if(o=e.match(Q_))return i=Ix(t,o[1].length).replace(/^([^\.]+)$/,"$1."+wr(o[1])).replace(/\.$/,"."+wr(o[1])).replace(/\.(\d*)$/,function(E,w){return"."+w+kt("0",wr(o[1]).length-w.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+Ix(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+qa(Ti(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+hn(r,e,-t):qa(""+(Math.floor(t)+c4(t,o[1].length)))+"."+Nn(Bx(t,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return hn(r,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Li(hn(r,e.replace(/[\\-]/g,""),t)),c=0,Li(Li(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return c<i.length?i.charAt(c++):E==="0"?"0":""}));if(e.match(ey))return i=hn(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var x="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),f=ju(h,Math.pow(10,c)-1,!1),i=""+m,x=ca("n",o[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),i+=x+o[2]+"/"+o[3],x=Cu(f[2],c),x.length<o[4].length&&(x=wr(o[4].substr(o[4].length-x.length))+x),i+=x,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),f=ju(h,Math.pow(10,c)-1,!0),m+(f[0]||(f[1]?"":"0"))+" "+(f[1]?Ad(f[1],c)+o[2]+"/"+o[3]+Cu(f[2],c):kt(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=Ti(t,0),e.length<=i.length?i:wr(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var v=e.indexOf(".")-c,_=e.length-i.length-v;return wr(e.substr(0,v)+i+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return c=Bx(t,o[1].length),t<0?"-"+hn(r,e,-t):qa(u4(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Nn(0,3-E.length):"")+E})+"."+Nn(c,o[1].length);switch(e){case"###,##0.00":return hn(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=qa(Ti(h,0));return y!=="0"?m+y:"";case"###,###.00":return hn(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return hn(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function f4(r,e,t){for(var s=e.length-1;e.charCodeAt(s-1)===44;)--s;return ca(r,e.substr(0,s),t/Math.pow(10,3*(e.length-s)))}function h4(r,e,t){var s=e.replace(X_,""),i=e.length-s.length;return ca(r,s,t*Math.pow(10,2*i))+kt("%",i)}function ty(r,e){var t,s=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ty(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(e/Math.pow(10,o)).toPrecision(s+1+(i+o)%i),!t.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+o):t+="E+"+(c-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,h,m,x){return h+m+x.substr(0,(i+o)%i)+"."+x.substr(o)+"E"})}else t=e.toExponential(s);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Fn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(Z_)){var s=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Fn("n",s,t):"("+Fn("n",s,-t)+")"}if(e.charCodeAt(e.length-1)===44)return f4(r,e,t);if(e.indexOf("%")!==-1)return h4(r,e,t);if(e.indexOf("E")!==-1)return ty(e,t);if(e.charCodeAt(0)===36)return"$"+Fn(r,e.substr(e.charAt(1)==" "?2:1),t);var i,o,c,f,h=Math.abs(t),m=t<0?"-":"";if(e.match(/^00+$/))return m+Nn(h,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:wr(e.substr(0,e.length-i.length))+i;if(o=e.match(J_))return o4(o,h,m);if(e.match(/^#+0+$/))return m+Nn(h,e.length-e.indexOf("0"));if(o=e.match(Q_))return i=(""+t).replace(/^([^\.]+)$/,"$1."+wr(o[1])).replace(/\.$/,"."+wr(o[1])),i=i.replace(/\.(\d*)$/,function(E,w){return"."+w+kt("0",wr(o[1]).length-w.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+qa(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Fn(r,e,-t):qa(""+t)+"."+kt("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Fn(r,e.replace(/^#,#*,/,""),t);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Li(Fn(r,e.replace(/[\\-]/g,""),t)),c=0,Li(Li(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return c<i.length?i.charAt(c++):E==="0"?"0":""}));if(e.match(ey))return i=Fn(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var x="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),f=ju(h,Math.pow(10,c)-1,!1),i=""+m,x=ca("n",o[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),i+=x+o[2]+"/"+o[3],x=Cu(f[2],c),x.length<o[4].length&&(x=wr(o[4].substr(o[4].length-x.length))+x),i+=x,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),f=ju(h,Math.pow(10,c)-1,!0),m+(f[0]||(f[1]?"":"0"))+" "+(f[1]?Ad(f[1],c)+o[2]+"/"+o[3]+Cu(f[2],c):kt(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:wr(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var v=e.indexOf(".")-c,_=e.length-i.length-v;return wr(e.substr(0,v)+i+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Fn(r,e,-t):qa(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Nn(0,3-E.length):"")+E})+"."+Nn(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=qa(""+h);return y!=="0"?m+y:"";default:if(e.match(/\.[0#?]*$/))return Fn(r,e.slice(0,e.lastIndexOf(".")),t)+wr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ca(r,e,t){return(t|0)===t?Fn(r,e,t):hn(r,e,t)}function d4(r){for(var e=[],t=!1,s=0,i=0;s<r.length;++s)switch(r.charCodeAt(s)){case 34:t=!t;break;case 95:case 42:case 92:++s;break;case 59:e[e.length]=r.substr(i,s-i),i=s+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var ry=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ny(r){for(var e=0,t="",s="";e<r.length;)switch(t=r.charAt(e)){case"G":Ru(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(s=t;r.charAt(e++)!=="]"&&e<r.length;)s+=r.charAt(e);if(s.match(ry))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function m4(r,e,t,s){for(var i=[],o="",c=0,f="",h="t",m,x,v,_="H";c<r.length;)switch(f=r.charAt(c)){case"G":if(!Ru(r,c))throw new Error("unrecognized character "+f+" in "+r);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(v=r.charCodeAt(++c))!==34&&c<r.length;)o+=String.fromCharCode(v);i[i.length]={t:"t",v:o},++c;break;case"\\":var y=r.charAt(++c),E=y==="("||y===")"?y:"t";i[i.length]={t:E,v:y},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:e},++c;break;case"B":case"b":if(r.charAt(c+1)==="1"||r.charAt(c+1)==="2"){if(m==null&&(m=su(e,t,r.charAt(c+1)==="2"),m==null))return"";i[i.length]={t:"X",v:r.substr(c,2)},h=f,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||m==null&&(m=su(e,t),m==null))return"";for(o=f;++c<r.length&&r.charAt(c).toLowerCase()===f;)o+=f;f==="m"&&h.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=_),i[i.length]={t:f,v:o},h=f;break;case"A":case"a":case"":var w={t:f,v:f};if(m==null&&(m=su(e,t)),r.substr(c,3).toUpperCase()==="A/P"?(m!=null&&(w.v=m.H>=12?"P":"A"),w.t="T",_="h",c+=3):r.substr(c,5).toUpperCase()==="AM/PM"?(m!=null&&(w.v=m.H>=12?"PM":"AM"),w.t="T",c+=5,_="h"):r.substr(c,5).toUpperCase()==="/"?(m!=null&&(w.v=m.H>=12?"":""),w.t="T",c+=5,_="h"):(w.t="t",++c),m==null&&w.t==="T")return"";i[i.length]=w,h=f;break;case"[":for(o=f;r.charAt(c++)!=="]"&&c<r.length;)o+=r.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(ry)){if(m==null&&(m=su(e,t),m==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",ny(r)||(i[i.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=f;++c<r.length&&(f=r.charAt(c))==="0";)o+=f;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=f;++c<r.length&&"0#?.,E+-%".indexOf(f=r.charAt(c))>-1;)o+=f;i[i.length]={t:"n",v:o};break;case"?":for(o=f;r.charAt(++c)===f;)o+=f;i[i.length]={t:f,v:o},h=f;break;case"*":++c,(r.charAt(c)==" "||r.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:s===1?"t":f,v:f},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=f;c<r.length&&"0123456789".indexOf(r.charAt(++c))>-1;)o+=r.charAt(c);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:f,v:f},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+r);i[i.length]={t:"t",v:f},++c;break}var S=0,k=0,M;for(c=i.length-1,h="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=_,h="h",S<1&&(S=1);break;case"s":(M=i[c].v.match(/\.0+$/))&&(k=Math.max(k,M[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=i[c].t;break;case"m":h==="s"&&(i[c].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[c].v.match(/[Hh]/)&&(S=1),S<2&&i[c].v.match(/[Mm]/)&&(S=2),S<3&&i[c].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var O="",G;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=a4(i[c].t.charCodeAt(0),i[c].v,m,k),i[c].t="t";break;case"n":case"?":for(G=c+1;i[G]!=null&&((f=i[G].t)==="?"||f==="D"||(f===" "||f==="t")&&i[G+1]!=null&&(i[G+1].t==="?"||i[G+1].t==="t"&&i[G+1].v==="/")||i[c].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(i[G].v==="/"||i[G].v===" "&&i[G+1]!=null&&i[G+1].t=="?"));)i[c].v+=i[G].v,i[G]={v:"",t:";"},++G;O+=i[c].v,c=G-1;break;case"G":i[c].t="t",i[c].v=od(e,t);break}var q="",K,F;if(O.length>0){O.charCodeAt(0)==40?(K=e<0&&O.charCodeAt(0)===45?-e:e,F=ca("n",O,K)):(K=e<0&&s>1?-e:e,F=ca("n",O,K),K<0&&i[0]&&i[0].t=="t"&&(F=F.substr(1),i[0].v="-"+i[0].v)),G=F.length-1;var X=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){X=c;break}var z=i.length;if(X===i.length&&F.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(G>=i[c].v.length-1?(G-=i[c].v.length,i[c].v=F.substr(G+1,i[c].v.length)):G<0?i[c].v="":(i[c].v=F.substr(0,G+1),G=-1),i[c].t="t",z=c);G>=0&&z<i.length&&(i[z].v=F.substr(0,G+1)+i[z].v)}else if(X!==i.length&&F.indexOf("E")===-1){for(G=F.indexOf(".")-1,c=X;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(x=i[c].v.indexOf(".")>-1&&c===X?i[c].v.indexOf(".")-1:i[c].v.length-1,q=i[c].v.substr(x+1);x>=0;--x)G>=0&&(i[c].v.charAt(x)==="0"||i[c].v.charAt(x)==="#")&&(q=F.charAt(G--)+q);i[c].v=q,i[c].t="t",z=c}for(G>=0&&z<i.length&&(i[z].v=F.substr(0,G+1)+i[z].v),G=F.indexOf(".")+1,c=X;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==X)){for(x=i[c].v.indexOf(".")>-1&&c===X?i[c].v.indexOf(".")+1:0,q=i[c].v.substr(0,x);x<i[c].v.length;++x)G<F.length&&(q+=F.charAt(G++));i[c].v=q,i[c].t="t",z=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(K=s>1&&e<0&&c>0&&i[c-1].v==="-"?-e:e,i[c].v=ca(i[c].t,i[c].v,K),i[c].t="t");var ne="";for(c=0;c!==i.length;++c)i[c]!=null&&(ne+=i[c].v);return ne}var Mx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ux(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function g4(r,e){var t=d4(r),s=t.length,i=t[s-1].indexOf("@");if(s<4&&i>-1&&--s,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[s,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(Mx),f=t[1].match(Mx);return Ux(e,c)?[s,t[0]]:Ux(e,f)?[s,t[1]]:[s,t[c!=null&&f!=null?2:1]]}return[s,o]}function Wa(r,e,t){t==null&&(t={});var s="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?s=t.dateNF:s=r;break;case"number":r==14&&t.dateNF?s=t.dateNF:s=(t.table!=null?t.table:Dt)[r],s==null&&(s=t.table&&t.table[Lx[r]]||Dt[Lx[r]]),s==null&&(s=YT[r]||"General");break}if(Ru(s,0))return od(e,t);e instanceof Date&&(e=W_(e,t.date1904));var i=g4(s,e);if(Ru(i[1]))return od(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return m4(i[1],e,t,i[0])}function ay(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Dt[t]==null){e<0&&(e=t);continue}if(Dt[t]==r){e=t;break}}e<0&&(e=391)}return Dt[e]=r,e}function Yu(r){for(var e=0;e!=392;++e)r[e]!==void 0&&ay(r[e],e)}function Ju(){Dt=XT()}var sy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function p4(r){var e=typeof r=="number"?Dt[r]:r;return e=e.replace(sy,"(\\d+)"),new RegExp("^"+e+"$")}function x4(r,e,t){var s=-1,i=-1,o=-1,c=-1,f=-1,h=-1;(e.match(sy)||[]).forEach(function(v,_){var y=parseInt(t[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":s=y;break;case"d":o=y;break;case"h":c=y;break;case"s":h=y;break;case"m":c>=0?f=y:i=y;break}}),h>=0&&f==-1&&i>=0&&(f=i,i=-1);var m=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var x=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&f==-1&&h==-1?m:s==-1&&i==-1&&o==-1?x:m+"T"+x}var v4=(function(){var r={};r.version="1.2.0";function e(){for(var F=0,X=new Array(256),z=0;z!=256;++z)F=z,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,X[z]=F;return typeof Int32Array<"u"?new Int32Array(X):X}var t=e();function s(F){var X=0,z=0,ne=0,oe=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)oe[ne]=F[ne];for(ne=0;ne!=256;++ne)for(z=F[ne],X=256+ne;X<4096;X+=256)z=oe[X]=z>>>8^F[z&255];var fe=[];for(ne=1;ne!=16;++ne)fe[ne-1]=typeof Int32Array<"u"?oe.subarray(ne*256,ne*256+256):oe.slice(ne*256,ne*256+256);return fe}var i=s(t),o=i[0],c=i[1],f=i[2],h=i[3],m=i[4],x=i[5],v=i[6],_=i[7],y=i[8],E=i[9],w=i[10],S=i[11],k=i[12],M=i[13],O=i[14];function G(F,X){for(var z=X^-1,ne=0,oe=F.length;ne<oe;)z=z>>>8^t[(z^F.charCodeAt(ne++))&255];return~z}function q(F,X){for(var z=X^-1,ne=F.length-15,oe=0;oe<ne;)z=O[F[oe++]^z&255]^M[F[oe++]^z>>8&255]^k[F[oe++]^z>>16&255]^S[F[oe++]^z>>>24]^w[F[oe++]]^E[F[oe++]]^y[F[oe++]]^_[F[oe++]]^v[F[oe++]]^x[F[oe++]]^m[F[oe++]]^h[F[oe++]]^f[F[oe++]]^c[F[oe++]]^o[F[oe++]]^t[F[oe++]];for(ne+=15;oe<ne;)z=z>>>8^t[(z^F[oe++])&255];return~z}function K(F,X){for(var z=X^-1,ne=0,oe=F.length,fe=0,W=0;ne<oe;)fe=F.charCodeAt(ne++),fe<128?z=z>>>8^t[(z^fe)&255]:fe<2048?(z=z>>>8^t[(z^(192|fe>>6&31))&255],z=z>>>8^t[(z^(128|fe&63))&255]):fe>=55296&&fe<57344?(fe=(fe&1023)+64,W=F.charCodeAt(ne++)&1023,z=z>>>8^t[(z^(240|fe>>8&7))&255],z=z>>>8^t[(z^(128|fe>>2&63))&255],z=z>>>8^t[(z^(128|W>>6&15|(fe&3)<<4))&255],z=z>>>8^t[(z^(128|W&63))&255]):(z=z>>>8^t[(z^(224|fe>>12&15))&255],z=z>>>8^t[(z^(128|fe>>6&63))&255],z=z>>>8^t[(z^(128|fe&63))&255]);return~z}return r.table=t,r.bstr=G,r.buf=q,r.str=K,r})(),xt=(function(){var e={};e.version="1.2.1";function t(T,L){for(var R=T.split("/"),j=L.split("/"),D=0,B=0,te=Math.min(R.length,j.length);D<te;++D){if(B=R[D].length-j[D].length)return B;if(R[D]!=j[D])return R[D]<j[D]?-1:1}return R.length-j.length}function s(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:s(T.slice(0,-1));var L=T.lastIndexOf("/");return L===-1?T:T.slice(0,L+1)}function i(T){if(T.charAt(T.length-1)=="/")return i(T.slice(0,-1));var L=T.lastIndexOf("/");return L===-1?T:T.slice(L+1)}function o(T,L){typeof L=="string"&&(L=new Date(L));var R=L.getHours();R=R<<6|L.getMinutes(),R=R<<5|L.getSeconds()>>>1,T.write_shift(2,R);var j=L.getFullYear()-1980;j=j<<4|L.getMonth()+1,j=j<<5|L.getDate(),T.write_shift(2,j)}function c(T){var L=T.read_shift(2)&65535,R=T.read_shift(2)&65535,j=new Date,D=R&31;R>>>=5;var B=R&15;R>>>=4,j.setMilliseconds(0),j.setFullYear(R+1980),j.setMonth(B-1),j.setDate(D);var te=L&31;L>>>=5;var me=L&63;return L>>>=6,j.setHours(L),j.setMinutes(me),j.setSeconds(te<<1),j}function f(T){Kr(T,0);for(var L={},R=0;T.l<=T.length-4;){var j=T.read_shift(2),D=T.read_shift(2),B=T.l+D,te={};switch(j){case 21589:R=T.read_shift(1),R&1&&(te.mtime=T.read_shift(4)),D>5&&(R&2&&(te.atime=T.read_shift(4)),R&4&&(te.ctime=T.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}T.l=B,L[j]=te}return L}var h;function m(){return h||(h={})}function x(T,L){if(T[0]==80&&T[1]==75)return Za(T,L);if((T[0]|32)==109&&(T[1]|32)==105)return ts(T,L);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var R=3,j=512,D=0,B=0,te=0,me=0,re=0,ae=[],ie=T.slice(0,512);Kr(ie,0);var Se=v(ie);switch(R=Se[0],R){case 3:j=512;break;case 4:j=4096;break;case 0:if(Se[1]==0)return Za(T,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}j!==512&&(ie=T.slice(0,j),Kr(ie,28));var Ce=T.slice(0,j);_(ie,R);var Fe=ie.read_shift(4,"i");if(R===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);ie.l+=4,te=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),me=ie.read_shift(4,"i"),D=ie.read_shift(4,"i"),re=ie.read_shift(4,"i"),B=ie.read_shift(4,"i");for(var Te=-1,ke=0;ke<109&&(Te=ie.read_shift(4,"i"),!(Te<0));++ke)ae[ke]=Te;var Me=y(T,j);S(re,B,Me,j,ae);var yt=M(Me,te,ae,j);yt[te].name="!Directory",D>0&&me!==W&&(yt[me].name="!MiniFAT"),yt[ae[0]].name="!FAT",yt.fat_addrs=ae,yt.ssz=j;var wt={},Nt=[],en=[],rs=[];O(te,yt,Me,Nt,D,wt,en,me),E(en,rs,Nt),Nt.shift();var va={FileIndex:en,FullPaths:rs};return L&&L.raw&&(va.raw={header:Ce,sectors:Me}),va}function v(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(be,"Header Signature: "),T.l+=16;var L=T.read_shift(2,"u");return[T.read_shift(2,"u"),L]}function _(T,L){var R=9;switch(T.l+=2,R=T.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function y(T,L){for(var R=Math.ceil(T.length/L)-1,j=[],D=1;D<R;++D)j[D-1]=T.slice(D*L,(D+1)*L);return j[R-1]=T.slice(R*L),j}function E(T,L,R){for(var j=0,D=0,B=0,te=0,me=0,re=R.length,ae=[],ie=[];j<re;++j)ae[j]=ie[j]=j,L[j]=R[j];for(;me<ie.length;++me)j=ie[me],D=T[j].L,B=T[j].R,te=T[j].C,ae[j]===j&&(D!==-1&&ae[D]!==D&&(ae[j]=ae[D]),B!==-1&&ae[B]!==B&&(ae[j]=ae[B])),te!==-1&&(ae[te]=j),D!==-1&&j!=ae[j]&&(ae[D]=ae[j],ie.lastIndexOf(D)<me&&ie.push(D)),B!==-1&&j!=ae[j]&&(ae[B]=ae[j],ie.lastIndexOf(B)<me&&ie.push(B));for(j=1;j<re;++j)ae[j]===j&&(B!==-1&&ae[B]!==B?ae[j]=ae[B]:D!==-1&&ae[D]!==D&&(ae[j]=ae[D]));for(j=1;j<re;++j)if(T[j].type!==0){if(me=j,me!=ae[me])do me=ae[me],L[j]=L[me]+"/"+L[j];while(me!==0&&ae[me]!==-1&&me!=ae[me]);ae[j]=-1}for(L[0]+="/",j=1;j<re;++j)T[j].type!==2&&(L[j]+="/")}function w(T,L,R){for(var j=T.start,D=T.size,B=[],te=j;R&&D>0&&te>=0;)B.push(L.slice(te*fe,te*fe+fe)),D-=fe,te=As(R,te*4);return B.length===0?he(0):or(B).slice(0,T.size)}function S(T,L,R,j,D){var B=W;if(T===W){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var te=R[T],me=(j>>>2)-1;if(!te)return;for(var re=0;re<me&&(B=As(te,re*4))!==W;++re)D.push(B);S(As(te,j-4),L-1,R,j,D)}}function k(T,L,R,j,D){var B=[],te=[];D||(D=[]);var me=j-1,re=0,ae=0;for(re=L;re>=0;){D[re]=!0,B[B.length]=re,te.push(T[re]);var ie=R[Math.floor(re*4/j)];if(ae=re*4&me,j<4+ae)throw new Error("FAT boundary crossed: "+re+" 4 "+j);if(!T[ie])break;re=As(T[ie],ae)}return{nodes:B,data:Kx([te])}}function M(T,L,R,j){var D=T.length,B=[],te=[],me=[],re=[],ae=j-1,ie=0,Se=0,Ce=0,Fe=0;for(ie=0;ie<D;++ie)if(me=[],Ce=ie+L,Ce>=D&&(Ce-=D),!te[Ce]){re=[];var Te=[];for(Se=Ce;Se>=0;){Te[Se]=!0,te[Se]=!0,me[me.length]=Se,re.push(T[Se]);var ke=R[Math.floor(Se*4/j)];if(Fe=Se*4&ae,j<4+Fe)throw new Error("FAT boundary crossed: "+Se+" 4 "+j);if(!T[ke]||(Se=As(T[ke],Fe),Te[Se]))break}B[Ce]={nodes:me,data:Kx([re])}}return B}function O(T,L,R,j,D,B,te,me){for(var re=0,ae=j.length?2:0,ie=L[T].data,Se=0,Ce=0,Fe;Se<ie.length;Se+=128){var Te=ie.slice(Se,Se+128);Kr(Te,64),Ce=Te.read_shift(2),Fe=kd(Te,0,Ce-ae),j.push(Fe);var ke={name:Fe,type:Te.read_shift(1),color:Te.read_shift(1),L:Te.read_shift(4,"i"),R:Te.read_shift(4,"i"),C:Te.read_shift(4,"i"),clsid:Te.read_shift(16),state:Te.read_shift(4,"i"),start:0,size:0},Me=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);Me!==0&&(ke.ct=G(Te,Te.l-8));var yt=Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2)+Te.read_shift(2);yt!==0&&(ke.mt=G(Te,Te.l-8)),ke.start=Te.read_shift(4,"i"),ke.size=Te.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=W,ke.name=""),ke.type===5?(re=ke.start,D>0&&re!==W&&(L[re].name="!StreamData")):ke.size>=4096?(ke.storage="fat",L[ke.start]===void 0&&(L[ke.start]=k(R,ke.start,L.fat_addrs,L.ssz)),L[ke.start].name=ke.name,ke.content=L[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:re!==W&&ke.start!==W&&L[re]&&(ke.content=w(ke,L[re].data,(L[me]||{}).data))),ke.content&&Kr(ke.content,0),B[Fe]=ke,te.push(ke)}}function G(T,L){return new Date((Xr(T,L+4)/1e7*Math.pow(2,32)+Xr(T,L)/1e7-11644473600)*1e3)}function q(T,L){return m(),x(h.readFileSync(T),L)}function K(T,L){var R=L&&L.type;switch(R||it&&Buffer.isBuffer(T)&&(R="buffer"),R||"base64"){case"file":return q(T,L);case"base64":return x(An(ha(T)),L);case"binary":return x(An(T),L)}return x(T,L)}function F(T,L){var R=L||{},j=R.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=j+"/",T.FileIndex[0]={name:j,type:5}),R.CLSID&&(T.FileIndex[0].clsid=R.CLSID),X(T)}function X(T){var L="Sh33tJ5";if(!xt.find(T,"/"+L)){var R=he(4);R[0]=55,R[1]=R[3]=50,R[2]=54,T.FileIndex.push({name:L,type:2,content:R,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+L),z(T)}}function z(T,L){F(T);for(var R=!1,j=!1,D=T.FullPaths.length-1;D>=0;--D){var B=T.FileIndex[D];switch(B.type){case 0:j?R=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(B.R*B.L*B.C)&&(R=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!L)){var te=new Date(1987,1,19),me=0,re=Object.create?Object.create(null):{},ae=[];for(D=0;D<T.FullPaths.length;++D)re[T.FullPaths[D]]=!0,T.FileIndex[D].type!==0&&ae.push([T.FullPaths[D],T.FileIndex[D]]);for(D=0;D<ae.length;++D){var ie=s(ae[D][0]);j=re[ie],j||(ae.push([ie,{name:i(ie).replace("/",""),type:1,clsid:J,ct:te,mt:te,content:null}]),re[ie]=!0)}for(ae.sort(function(Fe,Te){return t(Fe[0],Te[0])}),T.FullPaths=[],T.FileIndex=[],D=0;D<ae.length;++D)T.FullPaths[D]=ae[D][0],T.FileIndex[D]=ae[D][1];for(D=0;D<ae.length;++D){var Se=T.FileIndex[D],Ce=T.FullPaths[D];if(Se.name=i(Ce).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||J,D===0)Se.C=ae.length>1?1:-1,Se.size=0,Se.type=5;else if(Ce.slice(-1)=="/"){for(me=D+1;me<ae.length&&s(T.FullPaths[me])!=Ce;++me);for(Se.C=me>=ae.length?-1:me,me=D+1;me<ae.length&&s(T.FullPaths[me])!=s(Ce);++me);Se.R=me>=ae.length?-1:me,Se.type=1}else s(T.FullPaths[D+1]||"")==s(Ce)&&(Se.R=D+1),Se.type=2}}}function ne(T,L){var R=L||{};if(R.fileType=="mad")return i0(T,R);switch(z(T),R.fileType){case"zip":return Us(T,R)}var j=(function(Fe){for(var Te=0,ke=0,Me=0;Me<Fe.FileIndex.length;++Me){var yt=Fe.FileIndex[Me];if(yt.content){var wt=yt.content.length;wt>0&&(wt<4096?Te+=wt+63>>6:ke+=wt+511>>9)}}for(var Nt=Fe.FullPaths.length+3>>2,en=Te+7>>3,rs=Te+127>>7,va=en+ke+Nt+rs,Cn=va+127>>7,tl=Cn<=109?0:Math.ceil((Cn-109)/127);va+Cn+tl+127>>7>Cn;)tl=++Cn<=109?0:Math.ceil((Cn-109)/127);var Tr=[1,tl,Cn,rs,Nt,ke,Te,0];return Fe.FileIndex[0].size=Te<<6,Tr[7]=(Fe.FileIndex[0].start=Tr[0]+Tr[1]+Tr[2]+Tr[3]+Tr[4]+Tr[5])+(Tr[6]+7>>3),Tr})(T),D=he(j[7]<<9),B=0,te=0;{for(B=0;B<8;++B)D.write_shift(1,Ee[B]);for(B=0;B<8;++B)D.write_shift(2,0);for(D.write_shift(2,62),D.write_shift(2,3),D.write_shift(2,65534),D.write_shift(2,9),D.write_shift(2,6),B=0;B<3;++B)D.write_shift(2,0);for(D.write_shift(4,0),D.write_shift(4,j[2]),D.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),D.write_shift(4,0),D.write_shift(4,4096),D.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:W),D.write_shift(4,j[3]),D.write_shift(-4,j[1]?j[0]-1:W),D.write_shift(4,j[1]),B=0;B<109;++B)D.write_shift(-4,B<j[2]?j[1]+B:-1)}if(j[1])for(te=0;te<j[1];++te){for(;B<236+te*127;++B)D.write_shift(-4,B<j[2]?j[1]+B:-1);D.write_shift(-4,te===j[1]-1?W:te+1)}var me=function(Fe){for(te+=Fe;B<te-1;++B)D.write_shift(-4,B+1);Fe&&(++B,D.write_shift(-4,W))};for(te=B=0,te+=j[1];B<te;++B)D.write_shift(-4,ve.DIFSECT);for(te+=j[2];B<te;++B)D.write_shift(-4,ve.FATSECT);me(j[3]),me(j[4]);for(var re=0,ae=0,ie=T.FileIndex[0];re<T.FileIndex.length;++re)ie=T.FileIndex[re],ie.content&&(ae=ie.content.length,!(ae<4096)&&(ie.start=te,me(ae+511>>9)));for(me(j[6]+7>>3);D.l&511;)D.write_shift(-4,ve.ENDOFCHAIN);for(te=B=0,re=0;re<T.FileIndex.length;++re)ie=T.FileIndex[re],ie.content&&(ae=ie.content.length,!(!ae||ae>=4096)&&(ie.start=te,me(ae+63>>6)));for(;D.l&511;)D.write_shift(-4,ve.ENDOFCHAIN);for(B=0;B<j[4]<<2;++B){var Se=T.FullPaths[B];if(!Se||Se.length===0){for(re=0;re<17;++re)D.write_shift(4,0);for(re=0;re<3;++re)D.write_shift(4,-1);for(re=0;re<12;++re)D.write_shift(4,0);continue}ie=T.FileIndex[B],B===0&&(ie.start=ie.size?ie.start-1:W);var Ce=B===0&&R.root||ie.name;if(ae=2*(Ce.length+1),D.write_shift(64,Ce,"utf16le"),D.write_shift(2,ae),D.write_shift(1,ie.type),D.write_shift(1,ie.color),D.write_shift(-4,ie.L),D.write_shift(-4,ie.R),D.write_shift(-4,ie.C),ie.clsid)D.write_shift(16,ie.clsid,"hex");else for(re=0;re<4;++re)D.write_shift(4,0);D.write_shift(4,ie.state||0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,ie.start),D.write_shift(4,ie.size),D.write_shift(4,0)}for(B=1;B<T.FileIndex.length;++B)if(ie=T.FileIndex[B],ie.size>=4096)if(D.l=ie.start+1<<9,it&&Buffer.isBuffer(ie.content))ie.content.copy(D,D.l,0,ie.size),D.l+=ie.size+511&-512;else{for(re=0;re<ie.size;++re)D.write_shift(1,ie.content[re]);for(;re&511;++re)D.write_shift(1,0)}for(B=1;B<T.FileIndex.length;++B)if(ie=T.FileIndex[B],ie.size>0&&ie.size<4096)if(it&&Buffer.isBuffer(ie.content))ie.content.copy(D,D.l,0,ie.size),D.l+=ie.size+63&-64;else{for(re=0;re<ie.size;++re)D.write_shift(1,ie.content[re]);for(;re&63;++re)D.write_shift(1,0)}if(it)D.l=D.length;else for(;D.l<D.length;)D.write_shift(1,0);return D}function oe(T,L){var R=T.FullPaths.map(function(re){return re.toUpperCase()}),j=R.map(function(re){var ae=re.split("/");return ae[ae.length-(re.slice(-1)=="/"?2:1)]}),D=!1;L.charCodeAt(0)===47?(D=!0,L=R[0].slice(0,-1)+L):D=L.indexOf("/")!==-1;var B=L.toUpperCase(),te=D===!0?R.indexOf(B):j.indexOf(B);if(te!==-1)return T.FileIndex[te];var me=!B.match(au);for(B=B.replace(eo,""),me&&(B=B.replace(au,"!")),te=0;te<R.length;++te)if((me?R[te].replace(au,"!"):R[te]).replace(eo,"")==B||(me?j[te].replace(au,"!"):j[te]).replace(eo,"")==B)return T.FileIndex[te];return null}var fe=64,W=-2,be="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",ve={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(T,L,R){m();var j=ne(T,R);h.writeFileSync(L,j)}function Ne(T){for(var L=new Array(T.length),R=0;R<T.length;++R)L[R]=String.fromCharCode(T[R]);return L.join("")}function ce(T,L){var R=ne(T,L);switch(L&&L.type||"buffer"){case"file":return m(),h.writeFileSync(L.filename,R),R;case"binary":return typeof R=="string"?R:Ne(R);case"base64":return fo(typeof R=="string"?R:Ne(R));case"buffer":if(it)return Buffer.isBuffer(R)?R:ga(R);case"array":return typeof R=="string"?An(R):R}return R}var U;function N(T){try{var L=T.InflateRaw,R=new L;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)U=T;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function P(T,L){if(!U)return Ro(T,L);var R=U.InflateRaw,j=new R,D=j._processChunk(T.slice(T.l),j._finishFlushFlag);return T.l+=j.bytesRead,D}function C(T){return U?U.deflateRawSync(T):Ji(T)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function De(T){var L=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(L>>16|L>>8|L)&255}for(var Ae=typeof Uint8Array<"u",Oe=Ae?new Uint8Array(256):[],qe=0;qe<256;++qe)Oe[qe]=De(qe);function we(T,L){var R=Oe[T&255];return L<=8?R>>>8-L:(R=R<<8|Oe[T>>8&255],L<=16?R>>>16-L:(R=R<<8|Oe[T>>16&255],R>>>24-L))}function Ve(T,L){var R=L&7,j=L>>>3;return(T[j]|(R<=6?0:T[j+1]<<8))>>>R&3}function He(T,L){var R=L&7,j=L>>>3;return(T[j]|(R<=5?0:T[j+1]<<8))>>>R&7}function It(T,L){var R=L&7,j=L>>>3;return(T[j]|(R<=4?0:T[j+1]<<8))>>>R&15}function dt(T,L){var R=L&7,j=L>>>3;return(T[j]|(R<=3?0:T[j+1]<<8))>>>R&31}function Le(T,L){var R=L&7,j=L>>>3;return(T[j]|(R<=1?0:T[j+1]<<8))>>>R&127}function Zt(T,L,R){var j=L&7,D=L>>>3,B=(1<<R)-1,te=T[D]>>>j;return R<8-j||(te|=T[D+1]<<8-j,R<16-j)||(te|=T[D+2]<<16-j,R<24-j)||(te|=T[D+3]<<24-j),te&B}function Wt(T,L,R){var j=L&7,D=L>>>3;return j<=5?T[D]|=(R&7)<<j:(T[D]|=R<<j&255,T[D+1]=(R&7)>>8-j),L+3}function Mr(T,L,R){var j=L&7,D=L>>>3;return R=(R&1)<<j,T[D]|=R,L+1}function Qr(T,L,R){var j=L&7,D=L>>>3;return R<<=j,T[D]|=R&255,R>>>=8,T[D+1]=R,L+8}function Qa(T,L,R){var j=L&7,D=L>>>3;return R<<=j,T[D]|=R&255,R>>>=8,T[D+1]=R&255,T[D+2]=R>>>8,L+16}function pa(T,L){var R=T.length,j=2*R>L?2*R:L+5,D=0;if(R>=L)return T;if(it){var B=kx(j);if(T.copy)T.copy(B);else for(;D<T.length;++D)B[D]=T[D];return B}else if(Ae){var te=new Uint8Array(j);if(te.set)te.set(T);else for(;D<R;++D)te[D]=T[D];return te}return T.length=j,T}function vt(T){for(var L=new Array(T),R=0;R<T;++R)L[R]=0;return L}function Un(T,L,R){var j=1,D=0,B=0,te=0,me=0,re=T.length,ae=Ae?new Uint16Array(32):vt(32);for(B=0;B<32;++B)ae[B]=0;for(B=re;B<R;++B)T[B]=0;re=T.length;var ie=Ae?new Uint16Array(re):vt(re);for(B=0;B<re;++B)ae[D=T[B]]++,j<D&&(j=D),ie[B]=0;for(ae[0]=0,B=1;B<=j;++B)ae[B+16]=me=me+ae[B-1]<<1;for(B=0;B<re;++B)me=T[B],me!=0&&(ie[B]=ae[me+16]++);var Se=0;for(B=0;B<re;++B)if(Se=T[B],Se!=0)for(me=we(ie[B],j)>>j-Se,te=(1<<j+4-Se)-1;te>=0;--te)L[me|te<<Se]=Se&15|B<<4;return j}var Pn=Ae?new Uint16Array(512):vt(512),zn=Ae?new Uint16Array(32):vt(32);if(!Ae){for(var xr=0;xr<512;++xr)Pn[xr]=0;for(xr=0;xr<32;++xr)zn[xr]=0}(function(){for(var T=[],L=0;L<32;L++)T.push(5);Un(T,zn,32);var R=[];for(L=0;L<=143;L++)R.push(8);for(;L<=255;L++)R.push(9);for(;L<=279;L++)R.push(7);for(;L<=287;L++)R.push(8);Un(R,Pn,288)})();var n0=(function(){for(var L=Ae?new Uint8Array(32768):[],R=0,j=0;R<ye.length-1;++R)for(;j<ye[R+1];++j)L[j]=R;for(;j<32768;++j)L[j]=29;var D=Ae?new Uint8Array(259):[];for(R=0,j=0;R<Z.length-1;++R)for(;j<Z[R+1];++j)D[j]=R;function B(me,re){for(var ae=0;ae<me.length;){var ie=Math.min(65535,me.length-ae),Se=ae+ie==me.length;for(re.write_shift(1,+Se),re.write_shift(2,ie),re.write_shift(2,~ie&65535);ie-- >0;)re[re.l++]=me[ae++]}return re.l}function te(me,re){for(var ae=0,ie=0,Se=Ae?new Uint16Array(32768):[];ie<me.length;){var Ce=Math.min(65535,me.length-ie);if(Ce<10){for(ae=Wt(re,ae,+(ie+Ce==me.length)),ae&7&&(ae+=8-(ae&7)),re.l=ae/8|0,re.write_shift(2,Ce),re.write_shift(2,~Ce&65535);Ce-- >0;)re[re.l++]=me[ie++];ae=re.l*8;continue}ae=Wt(re,ae,+(ie+Ce==me.length)+2);for(var Fe=0;Ce-- >0;){var Te=me[ie];Fe=(Fe<<5^Te)&32767;var ke=-1,Me=0;if((ke=Se[Fe])&&(ke|=ie&-32768,ke>ie&&(ke-=32768),ke<ie))for(;me[ke+Me]==me[ie+Me]&&Me<250;)++Me;if(Me>2){Te=D[Me],Te<=22?ae=Qr(re,ae,Oe[Te+1]>>1)-1:(Qr(re,ae,3),ae+=5,Qr(re,ae,Oe[Te-23]>>5),ae+=3);var yt=Te<8?0:Te-4>>2;yt>0&&(Qa(re,ae,Me-Z[Te]),ae+=yt),Te=L[ie-ke],ae=Qr(re,ae,Oe[Te]>>3),ae-=3;var wt=Te<4?0:Te-2>>1;wt>0&&(Qa(re,ae,ie-ke-ye[Te]),ae+=wt);for(var Nt=0;Nt<Me;++Nt)Se[Fe]=ie&32767,Fe=(Fe<<5^me[ie])&32767,++ie;Ce-=Me-1}else Te<=143?Te=Te+48:ae=Mr(re,ae,1),ae=Qr(re,ae,Oe[Te]),Se[Fe]=ie&32767,++ie}ae=Qr(re,ae,0)-1}return re.l=(ae+7)/8|0,re.l}return function(re,ae){return re.length<8?B(re,ae):te(re,ae)}})();function Ji(T){var L=he(50+Math.floor(T.length*1.1)),R=n0(T,L);return L.slice(0,R)}var Oo=Ae?new Uint16Array(32768):vt(32768),Co=Ae?new Uint16Array(32768):vt(32768),xa=Ae?new Uint16Array(128):vt(128),hr=1,gn=1;function vr(T,L){var R=dt(T,L)+257;L+=5;var j=dt(T,L)+1;L+=5;var D=It(T,L)+4;L+=4;for(var B=0,te=Ae?new Uint8Array(19):vt(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,ae=Ae?new Uint8Array(8):vt(8),ie=Ae?new Uint8Array(8):vt(8),Se=te.length,Ce=0;Ce<D;++Ce)te[I[Ce]]=B=He(T,L),re<B&&(re=B),ae[B]++,L+=3;var Fe=0;for(ae[0]=0,Ce=1;Ce<=re;++Ce)ie[Ce]=Fe=Fe+ae[Ce-1]<<1;for(Ce=0;Ce<Se;++Ce)(Fe=te[Ce])!=0&&(me[Ce]=ie[Fe]++);var Te=0;for(Ce=0;Ce<Se;++Ce)if(Te=te[Ce],Te!=0){Fe=Oe[me[Ce]]>>8-Te;for(var ke=(1<<7-Te)-1;ke>=0;--ke)xa[Fe|ke<<Te]=Te&7|Ce<<3}var Me=[];for(re=1;Me.length<R+j;)switch(Fe=xa[Le(T,L)],L+=Fe&7,Fe>>>=3){case 16:for(B=3+Ve(T,L),L+=2,Fe=Me[Me.length-1];B-- >0;)Me.push(Fe);break;case 17:for(B=3+He(T,L),L+=3;B-- >0;)Me.push(0);break;case 18:for(B=11+Le(T,L),L+=7;B-- >0;)Me.push(0);break;default:Me.push(Fe),re<Fe&&(re=Fe);break}var yt=Me.slice(0,R),wt=Me.slice(R);for(Ce=R;Ce<286;++Ce)yt[Ce]=0;for(Ce=j;Ce<30;++Ce)wt[Ce]=0;return hr=Un(yt,Oo,286),gn=Un(wt,Co,30),L}function a0(T,L){if(T[0]==3&&!(T[1]&3))return[Rs(L),2];for(var R=0,j=0,D=kx(L||1<<18),B=0,te=D.length>>>0,me=0,re=0;(j&1)==0;){if(j=He(T,R),R+=3,j>>>1)j>>1==1?(me=9,re=5):(R=vr(T,R),me=hr,re=gn);else{R&7&&(R+=8-(R&7));var ae=T[R>>>3]|T[(R>>>3)+1]<<8;if(R+=32,ae>0)for(!L&&te<B+ae&&(D=pa(D,B+ae),te=D.length);ae-- >0;)D[B++]=T[R>>>3],R+=8;continue}for(;;){!L&&te<B+32767&&(D=pa(D,B+32767),te=D.length);var ie=Zt(T,R,me),Se=j>>>1==1?Pn[ie]:Oo[ie];if(R+=Se&15,Se>>>=4,(Se>>>8&255)===0)D[B++]=Se;else{if(Se==256)break;Se-=257;var Ce=Se<8?0:Se-4>>2;Ce>5&&(Ce=0);var Fe=B+Z[Se];Ce>0&&(Fe+=Zt(T,R,Ce),R+=Ce),ie=Zt(T,R,re),Se=j>>>1==1?zn[ie]:Co[ie],R+=Se&15,Se>>>=4;var Te=Se<4?0:Se-2>>1,ke=ye[Se];for(Te>0&&(ke+=Zt(T,R,Te),R+=Te),!L&&te<Fe&&(D=pa(D,Fe+100),te=D.length);B<Fe;)D[B]=D[B-ke],++B}}}return L?[D,R+7>>>3]:[D.slice(0,B),R+7>>>3]}function Ro(T,L){var R=T.slice(T.l||0),j=a0(R,L);return T.l+=j[1],j[0]}function jo(T,L){if(T)typeof console<"u"&&console.error(L);else throw new Error(L)}function Za(T,L){var R=T;Kr(R,0);var j=[],D=[],B={FileIndex:j,FullPaths:D};F(B,{root:L.root});for(var te=R.length-4;(R[te]!=80||R[te+1]!=75||R[te+2]!=5||R[te+3]!=6)&&te>=0;)--te;R.l=te+4,R.l+=4;var me=R.read_shift(2);R.l+=6;var re=R.read_shift(4);for(R.l=re,te=0;te<me;++te){R.l+=20;var ae=R.read_shift(4),ie=R.read_shift(4),Se=R.read_shift(2),Ce=R.read_shift(2),Fe=R.read_shift(2);R.l+=8;var Te=R.read_shift(4),ke=f(R.slice(R.l+Se,R.l+Se+Ce));R.l+=Se+Ce+Fe;var Me=R.l;R.l=Te+4,Ms(R,ae,ie,B,ke),R.l=Me}return B}function Ms(T,L,R,j,D){T.l+=2;var B=T.read_shift(2),te=T.read_shift(2),me=c(T);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var re=T.read_shift(4),ae=T.read_shift(4),ie=T.read_shift(4),Se=T.read_shift(2),Ce=T.read_shift(2),Fe="",Te=0;Te<Se;++Te)Fe+=String.fromCharCode(T[T.l++]);if(Ce){var ke=f(T.slice(T.l,T.l+Ce));(ke[21589]||{}).mt&&(me=ke[21589].mt),((D||{})[21589]||{}).mt&&(me=D[21589].mt)}T.l+=Ce;var Me=T.slice(T.l,T.l+ae);switch(te){case 8:Me=P(T,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var yt=!1;B&8&&(re=T.read_shift(4),re==134695760&&(re=T.read_shift(4),yt=!0),ae=T.read_shift(4),ie=T.read_shift(4)),ae!=L&&jo(yt,"Bad compressed size: "+L+" != "+ae),ie!=R&&jo(yt,"Bad uncompressed size: "+R+" != "+ie),zs(j,Fe,Me,{unsafe:!0,mt:me})}function Us(T,L){var R=L||{},j=[],D=[],B=he(1),te=R.compression?8:0,me=0,re=0,ae=0,ie=0,Se=0,Ce=T.FullPaths[0],Fe=Ce,Te=T.FileIndex[0],ke=[],Me=0;for(re=1;re<T.FullPaths.length;++re)if(Fe=T.FullPaths[re].slice(Ce.length),Te=T.FileIndex[re],!(!Te.size||!Te.content||Fe=="Sh33tJ5")){var yt=ie,wt=he(Fe.length);for(ae=0;ae<Fe.length;++ae)wt.write_shift(1,Fe.charCodeAt(ae)&127);wt=wt.slice(0,wt.l),ke[Se]=v4.buf(Te.content,0);var Nt=Te.content;te==8&&(Nt=C(Nt)),B=he(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,me),B.write_shift(2,te),Te.mt?o(B,Te.mt):B.write_shift(4,0),B.write_shift(-4,ke[Se]),B.write_shift(4,Nt.length),B.write_shift(4,Te.content.length),B.write_shift(2,wt.length),B.write_shift(2,0),ie+=B.length,j.push(B),ie+=wt.length,j.push(wt),ie+=Nt.length,j.push(Nt),B=he(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,me),B.write_shift(2,te),B.write_shift(4,0),B.write_shift(-4,ke[Se]),B.write_shift(4,Nt.length),B.write_shift(4,Te.content.length),B.write_shift(2,wt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,yt),Me+=B.l,D.push(B),Me+=wt.length,D.push(wt),++Se}return B=he(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,Se),B.write_shift(2,Se),B.write_shift(4,Me),B.write_shift(4,ie),B.write_shift(2,0),or([or(j),or(D),B])}var Zr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ps(T,L){if(T.ctype)return T.ctype;var R=T.name||"",j=R.match(/\.([^\.]+)$/);return j&&Zr[j[1]]||L&&(j=(R=L).match(/[\.\\]([^\.\\])+$/),j&&Zr[j[1]])?Zr[j[1]]:"application/octet-stream"}function es(T){for(var L=fo(T),R=[],j=0;j<L.length;j+=76)R.push(L.slice(j,j+76));return R.join(`\r
`)+`\r
`}function s0(T){var L=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var ie=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],j=L.split(`\r
`),D=0;D<j.length;++D){var B=j[D];if(B.length==0){R.push("");continue}for(var te=0;te<B.length;){var me=76,re=B.slice(te,te+me);re.charAt(me-1)=="="?me--:re.charAt(me-2)=="="?me-=2:re.charAt(me-3)=="="&&(me-=3),re=B.slice(te,te+me),te+=me,te<B.length&&(re+="="),R.push(re)}}return R.join(`\r
`)}function ko(T){for(var L=[],R=0;R<T.length;++R){for(var j=T[R];R<=T.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+T[++R];L.push(j)}for(var D=0;D<L.length;++D)L[D]=L[D].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return An(L.join(`\r
`))}function Qi(T,L,R){for(var j="",D="",B="",te,me=0;me<10;++me){var re=L[me];if(!re||re.match(/^\s*$/))break;var ae=re.match(/^(.*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":j=ae[2].trim();break;case"content-type":B=ae[2].trim();break;case"content-transfer-encoding":D=ae[2].trim();break}}switch(++me,D.toLowerCase()){case"base64":te=An(ha(L.slice(me).join("")));break;case"quoted-printable":te=ko(L.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+D)}var ie=zs(T,j.slice(R.length),te,{unsafe:!0});B&&(ie.ctype=B)}function ts(T,L){if(Ne(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=L&&L.root||"",j=(it&&Buffer.isBuffer(T)?T.toString("binary"):Ne(T)).split(`\r
`),D=0,B="";for(D=0;D<j.length;++D)if(B=j[D],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),R||(R=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),B.slice(0,R.length)!=R););var te=(j[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var me="--"+(te[1]||""),re=[],ae=[],ie={FileIndex:re,FullPaths:ae};F(ie);var Se,Ce=0;for(D=0;D<j.length;++D){var Fe=j[D];Fe!==me&&Fe!==me+"--"||(Ce++&&Qi(ie,j.slice(Se,D),R),Se=D)}return ie}function i0(T,L){var R=L||{},j=R.boundary||"SheetJS";j="------="+j;for(var D=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],B=T.FullPaths[0],te=B,me=T.FileIndex[0],re=1;re<T.FullPaths.length;++re)if(te=T.FullPaths[re].slice(B.length),me=T.FileIndex[re],!(!me.size||!me.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var ae=me.content,ie=it&&Buffer.isBuffer(ae)?ae.toString("binary"):Ne(ae),Se=0,Ce=Math.min(1024,ie.length),Fe=0,Te=0;Te<=Ce;++Te)(Fe=ie.charCodeAt(Te))>=32&&Fe<128&&++Se;var ke=Se>=Ce*4/5;D.push(j),D.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+te),D.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),D.push("Content-Type: "+Ps(me,te)),D.push(""),D.push(ke?s0(ie):es(ie))}return D.push(j+`--\r
`),D.join(`\r
`)}function Do(T){var L={};return F(L,T),L}function zs(T,L,R,j){var D=j&&j.unsafe;D||F(T);var B=!D&&xt.find(T,L);if(!B){var te=T.FullPaths[0];L.slice(0,te.length)==te?te=L:(te.slice(-1)!="/"&&(te+="/"),te=(te+L).replace("//","/")),B={name:i(L),type:2},T.FileIndex.push(B),T.FullPaths.push(te),D||xt.utils.cfb_gc(T)}return B.content=R,B.size=R?R.length:0,j&&(j.CLSID&&(B.clsid=j.CLSID),j.mt&&(B.mt=j.mt),j.ct&&(B.ct=j.ct)),B}function Fo(T,L){F(T);var R=xt.find(T,L);if(R){for(var j=0;j<T.FileIndex.length;++j)if(T.FileIndex[j]==R)return T.FileIndex.splice(j,1),T.FullPaths.splice(j,1),!0}return!1}function Zi(T,L,R){F(T);var j=xt.find(T,L);if(j){for(var D=0;D<T.FileIndex.length;++D)if(T.FileIndex[D]==j)return T.FileIndex[D].name=i(R),T.FullPaths[D]=R,!0}return!1}function el(T){z(T,!0)}return e.find=oe,e.read=K,e.parse=x,e.write=ce,e.writeFile=le,e.utils={cfb_new:Do,cfb_add:zs,cfb_del:Fo,cfb_mov:Zi,cfb_gc:el,ReadShift:ro,CheckField:Sy,prep_blob:Kr,bconcat:or,use_zlib:N,_deflateRaw:Ji,_inflateRaw:Ro,consts:ve},e})();function _4(r){return typeof r=="string"?Xu(r):Array.isArray(r)?VT(r):r}function So(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Xu(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var s=t=="utf8"?mo(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,r);if(typeof Blob<"u"){var i=new Blob([_4(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:r,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=r,c.href=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(r);return f.open("w"),f.encoding="binary",Array.isArray(e)&&(e=bo(e)),f.write(e),f.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+r)}function fr(r){for(var e=Object.keys(r),t=[],s=0;s<e.length;++s)Object.prototype.hasOwnProperty.call(r,e[s])&&t.push(e[s]);return t}function Px(r,e){for(var t=[],s=fr(r),i=0;i!==s.length;++i)t[r[s[i]][e]]==null&&(t[r[s[i]][e]]=s[i]);return t}function Od(r){for(var e=[],t=fr(r),s=0;s!==t.length;++s)e[r[t[s]]]=t[s];return e}function Qu(r){for(var e=[],t=fr(r),s=0;s!==t.length;++s)e[r[t[s]]]=parseInt(t[s],10);return e}function y4(r){for(var e=[],t=fr(r),s=0;s!==t.length;++s)e[r[t[s]]]==null&&(e[r[t[s]]]=[]),e[r[t[s]]].push(t[s]);return e}var ku=new Date(1899,11,30,0,0,0);function Ir(r,e){var t=r.getTime(),s=ku.getTime()+(r.getTimezoneOffset()-ku.getTimezoneOffset())*6e4;return(t-s)/(1440*60*1e3)}var iy=new Date,w4=ku.getTime()+(iy.getTimezoneOffset()-ku.getTimezoneOffset())*6e4,zx=iy.getTimezoneOffset();function ly(r){var e=new Date;return e.setTime(r*24*60*60*1e3+w4),e.getTimezoneOffset()!==zx&&e.setTime(e.getTime()+(e.getTimezoneOffset()-zx)*6e4),e}var Hx=new Date("2017-02-19T19:06:09.000Z"),oy=isNaN(Hx.getFullYear())?new Date("2/19/17"):Hx,b4=oy.getFullYear()==2017;function Er(r,e){var t=new Date(r);if(b4)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(oy.getFullYear()==1917&&!isNaN(t.getFullYear())){var s=t.getFullYear();return r.indexOf(""+s)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Zu(r,e){if(it&&Buffer.isBuffer(r))return r.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var s=[],i=0;i!=r.length;++i)s.push(String.fromCharCode(r[i]));return s.join("")}function Br(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Br(r[t]));return e}function kt(r,e){for(var t="";t.length<e;)t+=r;return t}function ua(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,s=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(s))||(s=s.replace(/[(](.*)[)]/,function(i,o){return t=-t,o}),!isNaN(e=Number(s)))?e/t:e}var S4=["january","february","march","april","may","june","july","august","september","october","november","december"];function ho(r){var e=new Date(r),t=new Date(NaN),s=e.getYear(),i=e.getMonth(),o=e.getDate();if(isNaN(o))return t;var c=r.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&S4.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return s<0||s>8099?t:(i>0||o>1)&&s!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}function Ye(r,e,t){if(r.FullPaths){if(typeof t=="string"){var s;return it?s=ga(t):s=qT(t),xt.utils.cfb_add(r,e,s)}xt.utils.cfb_add(r,e,t)}else r.file(e,t)}function Cd(){return xt.utils.cfb_new()}var Vt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,E4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Rd=Od(E4),jd=/[&<>'"]/g,T4=/[\u0000-\u0008\u000b-\u001f]/g;function ft(r){var e=r+"";return e.replace(jd,function(t){return Rd[t]}).replace(T4,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $x(r){return ft(r).replace(/ /g,"_x0020_")}var cy=/[\u0000-\u001f]/g;function A4(r){var e=r+"";return e.replace(jd,function(t){return Rd[t]}).replace(/\n/g,"<br/>").replace(cy,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function N4(r){var e=r+"";return e.replace(jd,function(t){return Rd[t]}).replace(cy,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function O4(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function C4(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Dh(r){for(var e="",t=0,s=0,i=0,o=0,c=0,f=0;t<r.length;){if(s=r.charCodeAt(t++),s<128){e+=String.fromCharCode(s);continue}if(i=r.charCodeAt(t++),s>191&&s<224){c=(s&31)<<6,c|=i&63,e+=String.fromCharCode(c);continue}if(o=r.charCodeAt(t++),s<240){e+=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63);continue}c=r.charCodeAt(t++),f=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(f>>>10&1023)),e+=String.fromCharCode(56320+(f&1023))}return e}function Gx(r){var e=Rs(2*r.length),t,s,i=1,o=0,c=0,f;for(s=0;s<r.length;s+=i)i=1,(f=r.charCodeAt(s))<128?t=f:f<224?(t=(f&31)*64+(r.charCodeAt(s+1)&63),i=2):f<240?(t=(f&15)*4096+(r.charCodeAt(s+1)&63)*64+(r.charCodeAt(s+2)&63),i=3):(i=4,t=(f&7)*262144+(r.charCodeAt(s+1)&63)*4096+(r.charCodeAt(s+2)&63)*64+(r.charCodeAt(s+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(e[o++]=c&255,e[o++]=c>>>8,c=0),e[o++]=t%256,e[o++]=t>>>8;return e.slice(0,o).toString("ucs2")}function Vx(r){return ga(r,"binary").toString("utf8")}var iu="foo bar baz",to=it&&(Vx(iu)==Dh(iu)&&Vx||Gx(iu)==Dh(iu)&&Gx)||Dh,mo=it?function(r){return ga(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,s=0,i=0;t<r.length;)switch(s=r.charCodeAt(t++),!0){case s<128:e.push(String.fromCharCode(s));break;case s<2048:e.push(String.fromCharCode(192+(s>>6))),e.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,i=r.charCodeAt(t++)-56320+(s<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(s>>12))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)))}return e.join("")},R4=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var s=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)s=s.replace(r[i][0],r[i][1]);return s}})(),uy=/(^\s|\s$|\n)/;function cr(r,e){return"<"+r+(e.match(uy)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function go(r){return fr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function Re(r,e,t){return"<"+r+(t!=null?go(t):"")+(e!=null?(e.match(uy)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function cd(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function j4(r,e){switch(typeof r){case"string":var t=Re("vt:lpwstr",ft(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Re((r|0)==r?"vt:i4":"vt:r8",ft(String(r)));case"boolean":return Re("vt:bool",r?"true":"false")}if(r instanceof Date)return Re("vt:filetime",cd(r));throw new Error("Unable to serialize "+r)}var Yt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ki=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Wr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function k4(r,e){for(var t=1-2*(r[e+7]>>>7),s=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,o=5;o>=0;--o)i=i*256+r[e+o];return s==2047?i==0?t*(1/0):NaN:(s==0?s=-1022:(s-=1023,i+=Math.pow(2,52)),t*Math.pow(2,s-52)*i)}function D4(r,e,t){var s=(e<0||1/e==-1/0?1:0)<<7,i=0,o=0,c=s?-e:e;isFinite(c)?c==0?i=o=0:(i=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(e)?26985:0);for(var f=0;f<=5;++f,o/=256)r[t+f]=o&255;r[t+6]=(i&15)<<4|o&15,r[t+7]=i>>4|s}var qx=function(r){for(var e=[],t=10240,s=0;s<r[0].length;++s)if(r[0][s])for(var i=0,o=r[0][s].length;i<o;i+=t)e.push.apply(e,r[0][s].slice(i,i+t));return e},Kx=it?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:ga(e)})):qx(r)}:qx,Wx=function(r,e,t){for(var s=[],i=e;i<t;i+=2)s.push(String.fromCharCode(Zl(r,i)));return s.join("").replace(eo,"")},kd=it?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(eo,""):Wx(r,e,t)}:Wx,Xx=function(r,e,t){for(var s=[],i=e;i<e+t;++i)s.push(("0"+r[i].toString(16)).slice(-2));return s.join("")},fy=it?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):Xx(r,e,t)}:Xx,Yx=function(r,e,t){for(var s=[],i=e;i<t;i++)s.push(String.fromCharCode(Ri(r,i)));return s.join("")},Eo=it?function(e,t,s){return Buffer.isBuffer(e)?e.toString("utf8",t,s):Yx(e,t,s)}:Yx,hy=function(r,e){var t=Xr(r,e);return t>0?Eo(r,e+4,e+4+t-1):""},dy=hy,my=function(r,e){var t=Xr(r,e);return t>0?Eo(r,e+4,e+4+t-1):""},gy=my,py=function(r,e){var t=2*Xr(r,e);return t>0?Eo(r,e+4,e+4+t-1):""},xy=py,vy=function(e,t){var s=Xr(e,t);return s>0?kd(e,t+4,t+4+s):""},_y=vy,yy=function(r,e){var t=Xr(r,e);return t>0?Eo(r,e+4,e+4+t):""},wy=yy,by=function(r,e){return k4(r,e)},Du=by,Dd=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};it&&(dy=function(e,t){if(!Buffer.isBuffer(e))return hy(e,t);var s=e.readUInt32LE(t);return s>0?e.toString("utf8",t+4,t+4+s-1):""},gy=function(e,t){if(!Buffer.isBuffer(e))return my(e,t);var s=e.readUInt32LE(t);return s>0?e.toString("utf8",t+4,t+4+s-1):""},xy=function(e,t){if(!Buffer.isBuffer(e))return py(e,t);var s=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+s-1)},_y=function(e,t){if(!Buffer.isBuffer(e))return vy(e,t);var s=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+s)},wy=function(e,t){if(!Buffer.isBuffer(e))return yy(e,t);var s=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+s)},Du=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):by(e,t)},Dd=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ri=function(r,e){return r[e]},Zl=function(r,e){return r[e+1]*256+r[e]},F4=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},Xr=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},As=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},L4=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function ro(r,e){var t="",s,i,o=[],c,f,h,m;switch(e){case"dbcs":if(m=this.l,it&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(h=0;h<r;++h)t+=String.fromCharCode(Zl(this,m)),m+=2;r*=2;break;case"utf8":t=Eo(this,this.l,this.l+r);break;case"utf16le":r*=2,t=kd(this,this.l,this.l+r);break;case"wstr":return ro.call(this,r,"dbcs");case"lpstr-ansi":t=dy(this,this.l),r=4+Xr(this,this.l);break;case"lpstr-cp":t=gy(this,this.l),r=4+Xr(this,this.l);break;case"lpwstr":t=xy(this,this.l),r=4+2*Xr(this,this.l);break;case"lpp4":r=4+Xr(this,this.l),t=_y(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+Xr(this,this.l),t=wy(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(c=Ri(this,this.l+r++))!==0;)o.push(nu(c));t=o.join("");break;case"_wstr":for(r=0,t="";(c=Zl(this,this.l+r))!==0;)o.push(nu(c)),r+=2;r+=2,t=o.join("");break;case"dbcs-cont":for(t="",m=this.l,h=0;h<r;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return c=Ri(this,m),this.l=m+1,f=ro.call(this,r-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+f;o.push(nu(Zl(this,m))),m+=2}t=o.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",m=this.l,h=0;h!=r;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return c=Ri(this,m),this.l=m+1,f=ro.call(this,r-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+f;o.push(nu(Ri(this,m))),m+=1}t=o.join("");break;default:switch(r){case 1:return s=Ri(this,this.l),this.l++,s;case 2:return s=(e==="i"?F4:Zl)(this,this.l),this.l+=2,s;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(s=(r>0?As:L4)(this,this.l),this.l+=4,s):(i=Xr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=Du(this,this.l):i=Du([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=fy(this,this.l,r);break}}return this.l+=r,t}var I4=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},B4=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},M4=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function U4(r,e,t){var s=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)M4(this,e.charCodeAt(i),this.l+2*i);s=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;s=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var c=e.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(r){case 1:s=1,this[this.l]=e&255;break;case 2:s=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:s=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:s=4,I4(this,e,this.l);break;case 8:if(s=8,t==="f"){D4(this,e,this.l);break}case 16:break;case-4:s=4,B4(this,e,this.l);break}return this.l+=s,this}function Sy(r,e){var t=fy(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function Kr(r,e){r.l=e,r.read_shift=ro,r.chk=Sy,r.write_shift=U4}function Mn(r,e){r.l+=e}function he(r){var e=Rs(r);return Kr(e,0),e}function Lr(){var r=[],e=it?256:2048,t=function(m){var x=he(m);return Kr(x,0),x},s=t(e),i=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&r.push(s),s=null)},o=function(m){return s&&m<s.length-s.l?s:(i(),s=t(Math.max(m+1,e)))},c=function(){return i(),or(r)},f=function(m){i(),s=m,s.l==null&&(s.l=s.length),o(e)};return{next:o,push:f,end:c,_bufs:r}}function _e(r,e,t,s){var i=+e,o;if(!isNaN(i)){s||(s=kR[i].p||(t||[]).length||0),o=1+(i>=128?1:0)+1,s>=128&&++o,s>=16384&&++o,s>=2097152&&++o;var c=r.next(o);i<=127?c.write_shift(1,i):(c.write_shift(1,(i&127)+128),c.write_shift(1,i>>7));for(var f=0;f!=4;++f)if(s>=128)c.write_shift(1,(s&127)+128),s>>=7;else{c.write_shift(1,s);break}s>0&&Dd(t)&&r.push(t)}}function no(r,e,t){var s=Br(r);if(e.s?(s.cRel&&(s.c+=e.s.c),s.rRel&&(s.r+=e.s.r)):(s.cRel&&(s.c+=e.c),s.rRel&&(s.r+=e.r)),!t||t.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Jx(r,e,t){var s=Br(r);return s.s=no(s.s,e.s,t),s.e=no(s.e,e.s,t),s}function ao(r,e){if(r.cRel&&r.c<0)for(r=Br(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Br(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=ht(r);return!r.cRel&&r.cRel!=null&&(t=H4(t)),!r.rRel&&r.rRel!=null&&(t=P4(t)),t}function Fh(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+gr(r.s.c)+":"+(r.e.cRel?"":"$")+gr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+ur(r.s.r)+":"+(r.e.rRel?"":"$")+ur(r.e.r):ao(r.s,e.biff)+":"+ao(r.e,e.biff)}function Fd(r){return parseInt(z4(r),10)-1}function ur(r){return""+(r+1)}function P4(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function z4(r){return r.replace(/\$(\d+)$/,"$1")}function Ld(r){for(var e=$4(r),t=0,s=0;s!==e.length;++s)t=26*t+e.charCodeAt(s)-64;return t-1}function gr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function H4(r){return r.replace(/^([A-Z])/,"$$$1")}function $4(r){return r.replace(/^\$([A-Z])/,"$1")}function G4(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Jt(r){for(var e=0,t=0,s=0;s<r.length;++s){var i=r.charCodeAt(s);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function ht(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function Jr(r){var e=r.indexOf(":");return e==-1?{s:Jt(r),e:Jt(r)}:{s:Jt(r.slice(0,e)),e:Jt(r.slice(e+1))}}function Gt(r,e){return typeof e>"u"||typeof e=="number"?Gt(r.s,r.e):(typeof r!="string"&&(r=ht(r)),typeof e!="string"&&(e=ht(e)),r==e?r:r+":"+e)}function At(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,s=0,i=0,o=r.length;for(t=0;s<o&&!((i=r.charCodeAt(s)-64)<1||i>26);++s)t=26*t+i;for(e.s.c=--t,t=0;s<o&&!((i=r.charCodeAt(s)-48)<0||i>9);++s)t=10*t+i;if(e.s.r=--t,s===o||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++s,t=0;s!=o&&!((i=r.charCodeAt(s)-64)<1||i>26);++s)t=26*t+i;for(e.e.c=--t,t=0;s!=o&&!((i=r.charCodeAt(s)-48)<0||i>9);++s)t=10*t+i;return e.e.r=--t,e}function Qx(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Wa(r.z,t?Ir(e):e)}catch{}try{return r.w=Wa((r.XF||{}).numFmtId||(t?14:0),t?Ir(e):e)}catch{return""+e}}function da(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?To[r.v]||r.v:e==null?Qx(r,r.v):Qx(r,e))}function Ds(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",s={};return s[t]=r,{SheetNames:[t],Sheets:s}}function Ey(r,e,t){var s=t||{},i=r?Array.isArray(r):s.dense,o=r||(i?[]:{}),c=0,f=0;if(o&&s.origin!=null){if(typeof s.origin=="number")c=s.origin;else{var h=typeof s.origin=="string"?Jt(s.origin):s.origin;c=h.r,f=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var x=At(o["!ref"]);m.s.c=x.s.c,m.s.r=x.s.r,m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),c==-1&&(m.e.r=c=x.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var y={v:e[v][_]},E=c+v,w=f+_;if(m.s.r>E&&(m.s.r=E),m.s.c>w&&(m.s.c=w),m.e.r<E&&(m.e.r=E),m.e.c<w&&(m.e.c=w),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))y=e[v][_];else if(Array.isArray(y.v)&&(y.f=e[v][_][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(s.nullError)y.t="e",y.v=0;else if(s.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=s.dateNF||Dt[14],s.cellDates?(y.t="d",y.w=Wa(y.z,Ir(y.v))):(y.t="n",y.v=Ir(y.v),y.w=Wa(y.z,y.v))):y.t="s";if(i)o[E]||(o[E]=[]),o[E][w]&&o[E][w].z&&(y.z=o[E][w].z),o[E][w]=y;else{var S=ht({c:w,r:E});o[S]&&o[S].z&&(y.z=o[S].z),o[S]=y}}}return m.s.c<1e7&&(o["!ref"]=Gt(m)),o}function Wi(r,e){return Ey(null,r,e)}function V4(r){return r.read_shift(4,"i")}function On(r,e){return e||(e=he(4)),e.write_shift(4,r),e}function pr(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function Qt(r,e){var t=!1;return e==null&&(t=!0,e=he(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function q4(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function K4(r,e){return e||(e=he(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Id(r,e){var t=r.l,s=r.read_shift(1),i=pr(r),o=[],c={t:i,h:i};if((s&1)!==0){for(var f=r.read_shift(4),h=0;h!=f;++h)o.push(q4(r));c.r=o}else c.r=[{ich:0,ifnt:0}];return r.l=t+e,c}function W4(r,e){var t=!1;return e==null&&(t=!0,e=he(15+4*r.t.length)),e.write_shift(1,0),Qt(r.t,e),t?e.slice(0,e.l):e}var X4=Id;function Y4(r,e){var t=!1;return e==null&&(t=!0,e=he(23+4*r.t.length)),e.write_shift(1,1),Qt(r.t,e),e.write_shift(4,1),K4({},e),t?e.slice(0,e.l):e}function mn(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Fs(r,e){return e==null&&(e=he(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function Ls(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Is(r,e){return e==null&&(e=he(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var J4=pr,Ty=Qt;function Bd(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function Fu(r,e){var t=!1;return e==null&&(t=!0,e=he(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var Q4=pr,ud=Bd,Md=Fu;function Ay(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,s=e[0]&2;r.l+=4;var i=s===0?Du([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):As(e,0)>>2;return t?i/100:i}function Ny(r,e){e==null&&(e=he(4));var t=0,s=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?s=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(s=1,t=1),s)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function Oy(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function Z4(r,e){return e||(e=he(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Bs=Oy,Xi=Z4;function Yi(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function js(r,e){return(e||he(8)).write_shift(8,r,"f")}function eA(r){var e={},t=r.read_shift(1),s=t>>>1,i=r.read_shift(1),o=r.read_shift(2,"i"),c=r.read_shift(1),f=r.read_shift(1),h=r.read_shift(1);switch(r.l++,s){case 0:e.auto=1;break;case 1:e.index=i;var m=cA[i];m&&(e.rgb=cv(m));break;case 2:e.rgb=cv([c,f,h]);break;case 3:e.theme=i;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function Lu(r,e){if(e||(e=he(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var s=r.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),e.write_shift(1,parseInt(s.slice(0,2),16)),e.write_shift(1,parseInt(s.slice(2,4),16)),e.write_shift(1,parseInt(s.slice(4,6),16)),e.write_shift(1,255)}return e}function tA(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function rA(r,e){e||(e=he(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var Cy=2,qr=3,lu=11,Iu=19,ou=64,nA=65,aA=71,sA=4108,iA=4126,lr=80,Zx={1:{n:"CodePage",t:Cy},2:{n:"Category",t:lr},3:{n:"PresentationFormat",t:lr},4:{n:"ByteCount",t:qr},5:{n:"LineCount",t:qr},6:{n:"ParagraphCount",t:qr},7:{n:"SlideCount",t:qr},8:{n:"NoteCount",t:qr},9:{n:"HiddenCount",t:qr},10:{n:"MultimediaClipCount",t:qr},11:{n:"ScaleCrop",t:lu},12:{n:"HeadingPairs",t:sA},13:{n:"TitlesOfParts",t:iA},14:{n:"Manager",t:lr},15:{n:"Company",t:lr},16:{n:"LinksUpToDate",t:lu},17:{n:"CharacterCount",t:qr},19:{n:"SharedDoc",t:lu},22:{n:"HyperlinksChanged",t:lu},23:{n:"AppVersion",t:qr,p:"version"},24:{n:"DigSig",t:nA},26:{n:"ContentType",t:lr},27:{n:"ContentStatus",t:lr},28:{n:"Language",t:lr},29:{n:"Version",t:lr},255:{},2147483648:{n:"Locale",t:Iu},2147483651:{n:"Behavior",t:Iu},1919054434:{}},ev={1:{n:"CodePage",t:Cy},2:{n:"Title",t:lr},3:{n:"Subject",t:lr},4:{n:"Author",t:lr},5:{n:"Keywords",t:lr},6:{n:"Comments",t:lr},7:{n:"Template",t:lr},8:{n:"LastAuthor",t:lr},9:{n:"RevNumber",t:lr},10:{n:"EditTime",t:ou},11:{n:"LastPrinted",t:ou},12:{n:"CreatedDate",t:ou},13:{n:"ModifiedDate",t:ou},14:{n:"PageCount",t:qr},15:{n:"WordCount",t:qr},16:{n:"CharCount",t:qr},17:{n:"Thumbnail",t:aA},18:{n:"Application",t:lr},19:{n:"DocSecurity",t:qr},255:{},2147483648:{n:"Locale",t:Iu},2147483651:{n:"Behavior",t:Iu},1919054434:{}};function lA(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var oA=lA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),cA=Br(oA),To={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},uA={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},cu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ry(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function jy(r,e){var t=y4(uA),s=[],i;s[s.length]=Vt,s[s.length]=Re("Types",null,{xmlns:Yt.CT,"xmlns:xsd":Yt.xsd,"xmlns:xsi":Yt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Re("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){r[h]&&r[h].length>0&&(i=r[h][0],s[s.length]=Re("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:cu[h][e.bookType]||cu[h].xlsx}))},c=function(h){(r[h]||[]).forEach(function(m){s[s.length]=Re("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:cu[h][e.bookType]||cu[h].xlsx})})},f=function(h){(r[h]||[]).forEach(function(m){s[s.length]=Re("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:t[h][0]})})};return o("workbooks"),c("sheets"),c("charts"),f("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),c("metadata"),f("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var at={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ky(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Ii(r){var e=[Vt,Re("Relationships",null,{xmlns:Yt.RELS})];return fr(r["!id"]).forEach(function(t){e[e.length]=Re("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ut(r,e,t,s,i,o){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=s,i.Target=t,[at.HLINK,at.XPATH,at.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}function fA(r){var e=[Vt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function tv(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function hA(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function dA(r){var e=[Vt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(tv(r[t][0],r[t][1])),e.push(hA("",r[t][0]));return e.push(tv("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Dy(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Nu.version+"</meta:generator></office:meta></office:document-meta>"}var Cs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Lh(r,e,t,s,i){i[r]!=null||e==null||e===""||(i[r]=e,e=ft(e),s[s.length]=t?Re(r,e,t):cr(r,e))}function Fy(r,e){var t=e||{},s=[Vt,Re("cp:coreProperties",null,{"xmlns:cp":Yt.CORE_PROPS,"xmlns:dc":Yt.dc,"xmlns:dcterms":Yt.dcterms,"xmlns:dcmitype":Yt.dcmitype,"xmlns:xsi":Yt.xsi})],i={};if(!r&&!t.Props)return s.join("");r&&(r.CreatedDate!=null&&Lh("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:cd(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i),r.ModifiedDate!=null&&Lh("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:cd(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,i));for(var o=0;o!=Cs.length;++o){var c=Cs[o],f=t.Props&&t.Props[c[1]]!=null?t.Props[c[1]]:r?r[c[1]]:null;f===!0?f="1":f===!1?f="0":typeof f=="number"&&(f=String(f)),f!=null&&Lh(c[0],f,null,s,i)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Bi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ly=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Iy(r){var e=[],t=Re;return r||(r={}),r.Application="SheetJS",e[e.length]=Vt,e[e.length]=Re("Properties",null,{xmlns:Yt.EXT_PROPS,"xmlns:vt":Yt.vt}),Bi.forEach(function(s){if(r[s[1]]!==void 0){var i;switch(s[2]){case"string":i=ft(String(r[s[1]]));break;case"bool":i=r[s[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(s[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(s){return"<vt:lpstr>"+ft(s)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function By(r){var e=[Vt,Re("Properties",null,{xmlns:Yt.CUST_PROPS,"xmlns:vt":Yt.vt})];if(!r)return e.join("");var t=1;return fr(r).forEach(function(i){++t,e[e.length]=Re("property",j4(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:ft(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var rv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function mA(r,e){var t=[];return fr(rv).map(function(s){for(var i=0;i<Cs.length;++i)if(Cs[i][1]==s)return Cs[i];for(i=0;i<Bi.length;++i)if(Bi[i][1]==s)return Bi[i];throw s}).forEach(function(s){if(r[s[1]]!=null){var i=e&&e.Props&&e.Props[s[1]]!=null?e.Props[s[1]]:r[s[1]];switch(s[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(cr(rv[s[1]]||s[1],i))}}),Re("DocumentProperties",t.join(""),{xmlns:Wr.o})}function gA(r,e){var t=["Worksheets","SheetNames"],s="CustomDocumentProperties",i=[];return r&&fr(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)){for(var c=0;c<Cs.length;++c)if(o==Cs[c][1])return;for(c=0;c<Bi.length;++c)if(o==Bi[c][1])return;for(c=0;c<t.length;++c)if(o==t[c])return;var f=r[o],h="string";typeof f=="number"?(h="float",f=String(f)):f===!0||f===!1?(h="boolean",f=f?"1":"0"):f=String(f),i.push(Re($x(o),f,{"dt:dt":h}))}}),e&&fr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(r&&Object.prototype.hasOwnProperty.call(r,o))){var c=e[o],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c instanceof Date?(f="dateTime.tz",c=c.toISOString()):c=String(c),i.push(Re($x(o),c,{"dt:dt":f}))}}),"<"+s+' xmlns="'+Wr.o+'">'+i.join("")+"</"+s+">"}function pA(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,s=t%Math.pow(2,32),i=(t-s)/Math.pow(2,32);s*=1e7,i*=1e7;var o=s/Math.pow(2,32)|0;o>0&&(s=s%Math.pow(2,32),i+=o);var c=he(8);return c.write_shift(4,s),c.write_shift(4,i),c}function nv(r,e){var t=he(4),s=he(4);switch(t.write_shift(4,r==80?31:r),r){case 3:s.write_shift(-4,e);break;case 5:s=he(8),s.write_shift(8,e,"f");break;case 11:s.write_shift(4,e?1:0);break;case 64:s=pA(e);break;case 31:case 80:for(s=he(4+2*(e.length+1)+(e.length%2?0:2)),s.write_shift(4,e.length+1),s.write_shift(0,e,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return or([t,s])}var My=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function xA(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function av(r,e,t){var s=he(8),i=[],o=[],c=8,f=0,h=he(8),m=he(8);if(h.write_shift(4,2),h.write_shift(4,1200),m.write_shift(4,1),o.push(h),i.push(m),c+=8+h.length,!e){m=he(8),m.write_shift(4,0),i.unshift(m);var x=[he(4)];for(x[0].write_shift(4,r.length),f=0;f<r.length;++f){var v=r[f][0];for(h=he(8+2*(v.length+1)+(v.length%2?0:2)),h.write_shift(4,f+2),h.write_shift(4,v.length+1),h.write_shift(0,v,"dbcs");h.l!=h.length;)h.write_shift(1,0);x.push(h)}h=or(x),o.unshift(h),c+=8+h.length}for(f=0;f<r.length;++f)if(!(e&&!e[r[f][0]])&&!(My.indexOf(r[f][0])>-1||Ly.indexOf(r[f][0])>-1)&&r[f][1]!=null){var _=r[f][1],y=0;if(e){y=+e[r[f][0]];var E=t[y];if(E.p=="version"&&typeof _=="string"){var w=_.split(".");_=(+w[0]<<16)+(+w[1]||0)}h=nv(E.t,_)}else{var S=xA(_);S==-1&&(S=31,_=String(_)),h=nv(S,_)}o.push(h),m=he(8),m.write_shift(4,e?y:2+f),i.push(m),c+=8+h.length}var k=8*(o.length+1);for(f=0;f<o.length;++f)i[f].write_shift(4,k),k+=o[f].length;return s.write_shift(4,c),s.write_shift(4,o.length),or([s].concat(i).concat(o))}function sv(r,e,t,s,i,o){var c=he(i?68:48),f=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,xt.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,i?2:1),c.write_shift(16,e,"hex"),c.write_shift(4,i?68:48);var h=av(r,t,s);if(f.push(h),i){var m=av(i,null,null);c.write_shift(16,o,"hex"),c.write_shift(4,68+h.length),f.push(m)}return or(f)}function vA(r,e){e||(e=he(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function _A(r,e){return r.read_shift(e)===1}function br(r,e){return e||(e=he(2)),e.write_shift(2,+!!r),e}function Uy(r){return r.read_shift(2,"u")}function dn(r,e){return e||(e=he(2)),e.write_shift(2,r),e}function Py(r,e,t){return t||(t=he(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function zy(r,e,t){var s=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=r.read_shift(1);o&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var c=s?r.read_shift(s,i):"";return c}function yA(r){var e=r.t||"",t=he(3);t.write_shift(2,e.length),t.write_shift(1,1);var s=he(2*e.length);s.write_shift(2*e.length,e,"utf16le");var i=[t,s];return or(i)}function wA(r,e,t){var s;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?s=r.read_shift(e,"sbcs-cont"):s=r.read_shift(e,"dbcs-cont"),s}function bA(r,e,t){var s=r.read_shift(t&&t.biff==2?1:2);return s===0?(r.l++,""):wA(r,s,t)}function SA(r,e,t){if(t.biff>5)return bA(r,e,t);var s=r.read_shift(1);return s===0?(r.l++,""):r.read_shift(s,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function Hy(r,e,t){return t||(t=he(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function iv(r,e){e||(e=he(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function EA(r){var e=he(512),t=0,s=r.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var i=s.indexOf("#"),o=i>-1?31:23;switch(s.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var c=[8,6815827,6619237,4849780,83];for(t=0;t<c.length;++t)e.write_shift(4,c[t]);if(o==28)s=s.slice(1),iv(s,e);else if(o&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<c.length;++t)e.write_shift(1,parseInt(c[t],16));var f=i>-1?s.slice(0,i):s;for(e.write_shift(4,2*(f.length+1)),t=0;t<f.length;++t)e.write_shift(2,f.charCodeAt(t));e.write_shift(2,0),o&8&&iv(i>-1?s.slice(i+1):"",e)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<c.length;++t)e.write_shift(1,parseInt(c[t],16));for(var h=0;s.slice(h*3,h*3+3)=="../"||s.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,s.length-3*h+1),t=0;t<s.length-3*h;++t)e.write_shift(1,s.charCodeAt(t+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function ks(r,e,t,s){return s||(s=he(6)),s.write_shift(2,r),s.write_shift(2,e),s.write_shift(2,t||0),s}function TA(r,e,t){var s=t.biff>8?4:2,i=r.read_shift(s),o=r.read_shift(s,"i"),c=r.read_shift(s,"i");return[i,o,c]}function AA(r){var e=r.read_shift(2),t=r.read_shift(2),s=r.read_shift(2),i=r.read_shift(2);return{s:{c:s,r:e},e:{c:i,r:t}}}function $y(r,e){return e||(e=he(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function Ud(r,e,t){var s=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":s=1280,i=8;break;case"biff4":s=4,i=6;break;case"biff3":s=3,i=6;break;case"biff2":s=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=he(i);return o.write_shift(2,s),o.write_shift(2,e),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function NA(r,e){var t=!e||e.biff==8,s=he(t?112:54);for(s.write_shift(e.biff==8?2:1,7),t&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(t?0:536870912));s.l<s.length;)s.write_shift(1,t?0:32);return s}function OA(r,e){var t=!e||e.biff>=8?2:1,s=he(8+t*r.name.length);s.write_shift(4,r.pos),s.write_shift(1,r.hs||0),s.write_shift(1,r.dt),s.write_shift(1,r.name.length),e.biff>=8&&s.write_shift(1,1),s.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=s.slice(0,s.l);return i.l=s.l,i}function CA(r,e){var t=he(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var s=[],i=0;i<r.length;++i)s[i]=yA(r[i]);var o=or([t].concat(s));return o.parts=[t.length].concat(s.map(function(c){return c.length})),o}function RA(){var r=he(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function jA(r){var e=he(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function kA(r,e){var t=r.name||"Arial",s=e&&e.biff==5,i=s?15+t.length:16+2*t.length,o=he(i);return o.write_shift(2,r.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),s||o.write_shift(1,1),o.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le"),o}function DA(r,e,t,s){var i=he(10);return ks(r,e,s,i),i.write_shift(4,t),i}function FA(r,e,t,s,i){var o=!i||i.biff==8,c=he(8+ +o+(1+o)*t.length);return ks(r,e,s,c),c.write_shift(2,t.length),o&&c.write_shift(1,1),c.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),c}function LA(r,e,t,s){var i=t&&t.biff==5;s||(s=he(i?3+e.length:5+2*e.length)),s.write_shift(2,r),s.write_shift(i?1:2,e.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var o=s.length>s.l?s.slice(0,s.l):s;return o.l==null&&(o.l=o.length),o}function IA(r,e){var t=e.biff==8||!e.biff?4:2,s=he(2*t+6);return s.write_shift(t,r.s.r),s.write_shift(t,r.e.r+1),s.write_shift(2,r.s.c),s.write_shift(2,r.e.c+1),s.write_shift(2,0),s}function lv(r,e,t,s){var i=t&&t.biff==5;s||(s=he(i?16:20)),s.write_shift(2,0),r.style?(s.write_shift(2,r.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,r.numFmtId||0),s.write_shift(2,e<<4));var o=0;return r.numFmtId>0&&i&&(o|=1024),s.write_shift(4,o),s.write_shift(4,0),i||s.write_shift(4,0),s.write_shift(2,0),s}function BA(r){var e=he(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function MA(r,e,t,s,i,o){var c=he(8);return ks(r,e,s,c),Py(t,o,c),c}function UA(r,e,t,s){var i=he(14);return ks(r,e,s,i),js(t,i),i}function PA(r,e,t){if(t.biff<8)return zA(r,e,t);for(var s=[],i=r.l+e,o=r.read_shift(t.biff>8?4:2);o--!==0;)s.push(TA(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return s}function zA(r,e,t){r[r.l+1]==3&&r[r.l]++;var s=zy(r,e,t);return s.charCodeAt(0)==3?s.slice(1):s}function HA(r){var e=he(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)$y(r[t],e);return e}function $A(r){var e=he(24),t=Jt(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(s[i],16));return or([e,EA(r[1])])}function GA(r){var e=r[1].Tooltip,t=he(10+2*(e.length+1));t.write_shift(2,2048);var s=Jt(r[0]);t.write_shift(2,s.r),t.write_shift(2,s.r),t.write_shift(2,s.c),t.write_shift(2,s.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function VA(r){return r||(r=he(4)),r.write_shift(2,1),r.write_shift(2,1),r}function qA(r,e,t){if(!t.cellStyles)return Mn(r,e);var s=t&&t.biff>=12?4:2,i=r.read_shift(s),o=r.read_shift(s),c=r.read_shift(s),f=r.read_shift(s),h=r.read_shift(2);s==2&&(r.l+=2);var m={s:i,e:o,w:c,ixfe:f,flags:h};return(t.biff>=5||!t.biff)&&(m.level=h>>8&7),m}function KA(r,e){var t=he(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var s=0;return r.hidden&&(s|=1),t.write_shift(1,s),s=r.level||0,t.write_shift(1,s),t.write_shift(2,0),t}function WA(r){for(var e=he(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}function XA(r,e,t){var s=he(15);return No(s,r,e),s.write_shift(8,t,"f"),s}function YA(r,e,t){var s=he(9);return No(s,r,e),s.write_shift(2,t),s}var JA=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Od({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(f,h){var m=[],x=Rs(1);switch(h.type){case"base64":x=An(ha(f));break;case"binary":x=An(f);break;case"buffer":case"array":x=f;break}Kr(x,0);var v=x.read_shift(1),_=!!(v&136),y=!1,E=!1;switch(v){case 2:break;case 3:break;case 48:y=!0,_=!0;break;case 49:y=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,S=521;v==2&&(w=x.read_shift(2)),x.l+=3,v!=2&&(w=x.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(S=x.read_shift(2));var k=x.read_shift(2),M=h.codepage||1252;v!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(M=r[x[x.l]]),x.l+=1,x.l+=2),E&&(x.l+=36);for(var O=[],G={},q=Math.min(x.length,v==2?521:S-10-(y?264:0)),K=E?32:11;x.l<q&&x[x.l]!=13;)switch(G={},G.name=Ou.utils.decode(M,x.slice(x.l,x.l+K)).replace(/[\u0000\r\n].*$/g,""),x.l+=K,G.type=String.fromCharCode(x.read_shift(1)),v!=2&&!E&&(G.offset=x.read_shift(4)),G.len=x.read_shift(1),v==2&&(G.offset=x.read_shift(2)),G.dec=x.read_shift(1),G.name.length&&O.push(G),v!=2&&(x.l+=E?13:14),G.type){case"B":(!y||G.len!=8)&&h.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+G.type)}if(x[x.l]!==13&&(x.l=S-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=S;var F=0,X=0;for(m[0]=[],X=0;X!=O.length;++X)m[0][X]=O[X].name;for(;w-- >0;){if(x[x.l]===42){x.l+=k;continue}for(++x.l,m[++F]=[],X=0,X=0;X!=O.length;++X){var z=x.slice(x.l,x.l+O[X].len);x.l+=O[X].len,Kr(z,0);var ne=Ou.utils.decode(M,z);switch(O[X].type){case"C":ne.trim().length&&(m[F][X]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?m[F][X]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):m[F][X]=ne;break;case"F":m[F][X]=parseFloat(ne.trim());break;case"+":case"I":m[F][X]=E?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":m[F][X]=!0;break;case"N":case"F":m[F][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[F][X]="##MEMO##"+(E?parseInt(ne.trim(),10):z.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(m[F][X]=+ne||0);break;case"@":m[F][X]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":m[F][X]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":m[F][X]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[F][X]=-z.read_shift(-8,"f");break;case"B":if(y&&O[X].len==8){m[F][X]=z.read_shift(8,"f");break}case"G":case"P":z.l+=O[X].len;break;case"0":if(O[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[X].type)}}}if(v!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),h.DBF=O,m}function s(f,h){var m=h||{};m.dateNF||(m.dateNF="yyyymmdd");var x=Wi(t(f,m),m);return x["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,x}function i(f,h){try{return Ds(s(f,h),h)}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(f,h){var m=h||{};if(+m.codepage>=0&&uo(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var x=Lr(),v=zu(f,{header:1,raw:!0,cellDates:!0}),_=v[0],y=v.slice(1),E=f["!cols"]||[],w=0,S=0,k=0,M=1;for(w=0;w<_.length;++w){if(((E[w]||{}).DBF||{}).name){_[w]=E[w].DBF.name,++k;continue}if(_[w]!=null){if(++k,typeof _[w]=="number"&&(_[w]=_[w].toString(10)),typeof _[w]!="string")throw new Error("DBF Invalid column name "+_[w]+" |"+typeof _[w]+"|");if(_.indexOf(_[w])!==w){for(S=0;S<1024;++S)if(_.indexOf(_[w]+"_"+S)==-1){_[w]+="_"+S;break}}}}var O=At(f["!ref"]),G=[],q=[],K=[];for(w=0;w<=O.e.c-O.s.c;++w){var F="",X="",z=0,ne=[];for(S=0;S<y.length;++S)y[S][w]!=null&&ne.push(y[S][w]);if(ne.length==0||_[w]==null){G[w]="?";continue}for(S=0;S<ne.length;++S){switch(typeof ne[S]){case"number":X="B";break;case"string":X="C";break;case"boolean":X="L";break;case"object":X=ne[S]instanceof Date?"D":"C";break;default:X="C"}z=Math.max(z,String(ne[S]).length),F=F&&F!=X?"C":X}z>250&&(z=250),X=((E[w]||{}).DBF||{}).type,X=="C"&&E[w].DBF.len>z&&(z=E[w].DBF.len),F=="B"&&X=="N"&&(F="N",K[w]=E[w].DBF.dec,z=E[w].DBF.len),q[w]=F=="C"||X=="N"?z:o[F]||0,M+=q[w],G[w]=F}var oe=x.next(32);for(oe.write_shift(4,318902576),oe.write_shift(4,y.length),oe.write_shift(2,296+32*k),oe.write_shift(2,M),w=0;w<4;++w)oe.write_shift(4,0);for(oe.write_shift(4,0|(+e[V_]||3)<<8),w=0,S=0;w<_.length;++w)if(_[w]!=null){var fe=x.next(32),W=(_[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);fe.write_shift(1,W,"sbcs"),fe.write_shift(1,G[w]=="?"?"C":G[w],"sbcs"),fe.write_shift(4,S),fe.write_shift(1,q[w]||o[G[w]]||0),fe.write_shift(1,K[w]||0),fe.write_shift(1,2),fe.write_shift(4,0),fe.write_shift(1,0),fe.write_shift(4,0),fe.write_shift(4,0),S+=q[w]||o[G[w]]||0}var be=x.next(264);for(be.write_shift(4,13),w=0;w<65;++w)be.write_shift(4,0);for(w=0;w<y.length;++w){var Ee=x.next(M);for(Ee.write_shift(1,0),S=0;S<_.length;++S)if(_[S]!=null)switch(G[S]){case"L":Ee.write_shift(1,y[w][S]==null?63:y[w][S]?84:70);break;case"B":Ee.write_shift(8,y[w][S]||0,"f");break;case"N":var J="0";for(typeof y[w][S]=="number"&&(J=y[w][S].toFixed(K[S]||0)),k=0;k<q[S]-J.length;++k)Ee.write_shift(1,32);Ee.write_shift(1,J,"sbcs");break;case"D":y[w][S]?(Ee.write_shift(4,("0000"+y[w][S].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(y[w][S].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+y[w][S].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var ve=String(y[w][S]!=null?y[w][S]:"").slice(0,q[S]);for(Ee.write_shift(1,ve,"sbcs"),k=0;k<q[S]-ve.length;++k)Ee.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:i,to_sheet:s,from_sheet:c}})(),QA=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(_,y){var E=r[y];return typeof E=="number"?jx(E):E},s=function(_,y,E){var w=y.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return w==59?_:jx(w)};r["|"]=254;function i(_,y){switch(y.type){case"base64":return o(ha(_),y);case"binary":return o(_,y);case"buffer":return o(it&&Buffer.isBuffer(_)?_.toString("binary"):bo(_),y);case"array":return o(Zu(_),y)}throw new Error("Unrecognized type "+y.type)}function o(_,y){var E=_.split(/[\n\r]+/),w=-1,S=-1,k=0,M=0,O=[],G=[],q=null,K={},F=[],X=[],z=[],ne=0,oe;for(+y.codepage>=0&&uo(+y.codepage);k!==E.length;++k){ne=0;var fe=E[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(e,t),W=fe.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),be=W[0],Ee;if(fe.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&G.push(fe.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,ve=!1,le=!1,Ne=!1,ce=-1,U=-1;for(M=1;M<W.length;++M)switch(W[M].charAt(0)){case"A":break;case"X":S=parseInt(W[M].slice(1))-1,ve=!0;break;case"Y":for(w=parseInt(W[M].slice(1))-1,ve||(S=0),oe=O.length;oe<=w;++oe)O[oe]=[];break;case"K":Ee=W[M].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(ua(Ee))?isNaN(ho(Ee).getDate())||(Ee=Er(Ee)):(Ee=ua(Ee),q!==null&&ny(q)&&(Ee=ly(Ee))),J=!0;break;case"E":Ne=!0;var N=Y3(W[M].slice(1),{r:w,c:S});O[w][S]=[O[w][S],N];break;case"S":le=!0,O[w][S]=[O[w][S],"S5S"];break;case"G":break;case"R":ce=parseInt(W[M].slice(1))-1;break;case"C":U=parseInt(W[M].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+fe)}if(J&&(O[w][S]&&O[w][S].length==2?O[w][S][0]=Ee:O[w][S]=Ee,q=null),le){if(Ne)throw new Error("SYLK shared formula cannot have own formula");var P=ce>-1&&O[ce][U];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");O[w][S][1]=J3(P[1],{r:w-ce,c:S-U})}break;case"F":var C=0;for(M=1;M<W.length;++M)switch(W[M].charAt(0)){case"X":S=parseInt(W[M].slice(1))-1,++C;break;case"Y":for(w=parseInt(W[M].slice(1))-1,oe=O.length;oe<=w;++oe)O[oe]=[];break;case"M":ne=parseInt(W[M].slice(1))/20;break;case"F":break;case"G":break;case"P":q=G[parseInt(W[M].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=W[M].slice(1).split(" "),oe=parseInt(z[0],10);oe<=parseInt(z[1],10);++oe)ne=parseInt(z[2],10),X[oe-1]=ne===0?{hidden:!0}:{wch:ne},Pd(X[oe-1]);break;case"C":S=parseInt(W[M].slice(1))-1,X[S]||(X[S]={});break;case"R":w=parseInt(W[M].slice(1))-1,F[w]||(F[w]={}),ne>0?(F[w].hpt=ne,F[w].hpx=Wy(ne)):ne===0&&(F[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+fe)}C<1&&(q=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+fe)}}return F.length>0&&(K["!rows"]=F),X.length>0&&(K["!cols"]=X),y&&y.sheetRows&&(O=O.slice(0,y.sheetRows)),[O,K]}function c(_,y){var E=i(_,y),w=E[0],S=E[1],k=Wi(w,y);return fr(S).forEach(function(M){k[M]=S[M]}),k}function f(_,y){return Ds(c(_,y),y)}function h(_,y,E,w){var S="C;Y"+(E+1)+";X"+(w+1)+";K";switch(_.t){case"n":S+=_.v||0,_.f&&!_.F&&(S+=";E"+Hd(_.f,{r:E,c:w}));break;case"b":S+=_.v?"TRUE":"FALSE";break;case"e":S+=_.w||_.v;break;case"d":S+='"'+(_.w||_.v)+'"';break;case"s":S+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function m(_,y){y.forEach(function(E,w){var S="F;W"+(w+1)+" "+(w+1)+" ";E.hidden?S+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Bu(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Mu(E.wpx)),typeof E.wch=="number"&&(S+=Math.round(E.wch))),S.charAt(S.length-1)!=" "&&_.push(S)})}function x(_,y){y.forEach(function(E,w){var S="F;";E.hidden?S+="M0;":E.hpt?S+="M"+20*E.hpt+";":E.hpx&&(S+="M"+20*Uu(E.hpx)+";"),S.length>2&&_.push(S+"R"+(w+1))})}function v(_,y){var E=["ID;PWXL;N;E"],w=[],S=At(_["!ref"]),k,M=Array.isArray(_),O=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&m(E,_["!cols"]),_["!rows"]&&x(E,_["!rows"]),E.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var G=S.s.r;G<=S.e.r;++G)for(var q=S.s.c;q<=S.e.c;++q){var K=ht({r:G,c:q});k=M?(_[G]||[])[q]:_[K],!(!k||k.v==null&&(!k.f||k.F))&&w.push(h(k,_,G,q))}return E.join(O)+O+w.join(O)+O+"E"+O}return{to_workbook:f,to_sheet:c,from_sheet:v}})(),ZA=(function(){function r(o,c){switch(c.type){case"base64":return e(ha(o),c);case"binary":return e(o,c);case"buffer":return e(it&&Buffer.isBuffer(o)?o.toString("binary"):bo(o),c);case"array":return e(Zu(o),c)}throw new Error("Unrecognized type "+c.type)}function e(o,c){for(var f=o.split(`
`),h=-1,m=-1,x=0,v=[];x!==f.length;++x){if(f[x].trim()==="BOT"){v[++h]=[],m=0;continue}if(!(h<0)){var _=f[x].trim().split(","),y=_[0],E=_[1];++x;for(var w=f[x]||"";(w.match(/["]/g)||[]).length&1&&x<f.length-1;)w+=`
`+f[++x];switch(w=w.trim(),+y){case-1:if(w==="BOT"){v[++h]=[],m=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[h][m]=!0:w==="FALSE"?v[h][m]=!1:isNaN(ua(E))?isNaN(ho(E).getDate())?v[h][m]=E:v[h][m]=Er(E):v[h][m]=ua(E),++m;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[h][m++]=w!==""?w:null;break}if(w==="EOD")break}}return c&&c.sheetRows&&(v=v.slice(0,c.sheetRows)),v}function t(o,c){return Wi(r(o,c),c)}function s(o,c){return Ds(t(o,c),c)}var i=(function(){var o=function(h,m,x,v,_){h.push(m),h.push(x+","+v),h.push('"'+_.replace(/"/g,'""')+'"')},c=function(h,m,x,v){h.push(m+","+x),h.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var m=[],x=At(h["!ref"]),v,_=Array.isArray(h);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,x.e.r-x.s.r+1,""),o(m,"TUPLES",0,x.e.c-x.s.c+1,""),o(m,"DATA",0,0,"");for(var y=x.s.r;y<=x.e.r;++y){c(m,-1,0,"BOT");for(var E=x.s.c;E<=x.e.c;++E){var w=ht({r:y,c:E});if(v=_?(h[y]||[])[E]:h[w],!v){c(m,1,0,"");continue}switch(v.t){case"n":var S=v.w;!S&&v.v!=null&&(S=v.v),S==null?v.f&&!v.F?c(m,1,0,"="+v.f):c(m,1,0,""):c(m,0,S,"V");break;case"b":c(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":c(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Wa(v.z||Dt[14],Ir(Er(v.v)))),c(m,0,v.w,"V");break;default:c(m,1,0,"")}}}c(m,-1,0,"EOD");var k=`\r
`,M=m.join(k);return M}})();return{to_workbook:s,to_sheet:t,from_sheet:i}})(),Gy=(function(){function r(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,_){for(var y=v.split(`
`),E=-1,w=-1,S=0,k=[];S!==y.length;++S){var M=y[S].trim().split(":");if(M[0]==="cell"){var O=Jt(M[1]);if(k.length<=O.r)for(E=k.length;E<=O.r;++E)k[E]||(k[E]=[]);switch(E=O.r,w=O.c,M[2]){case"t":k[E][w]=r(M[3]);break;case"v":k[E][w]=+M[3];break;case"vtf":var G=M[M.length-1];case"vtc":switch(M[3]){case"nl":k[E][w]=!!+M[4];break;default:k[E][w]=+M[4];break}M[2]=="vtf"&&(k[E][w]=[k[E][w],G])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function s(v,_){return Wi(t(v,_),_)}function i(v,_){return Ds(s(v,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var _=[],y=[],E,w="",S=Jr(v["!ref"]),k=Array.isArray(v),M=S.s.r;M<=S.e.r;++M)for(var O=S.s.c;O<=S.e.c;++O)if(w=ht({r:M,c:O}),E=k?(v[M]||[])[O]:v[w],!(!E||E.v==null||E.t==="z")){switch(y=["cell",w,"t"],E.t){case"s":case"str":y.push(e(E.v));break;case"n":E.f?(y[2]="vtf",y[3]="n",y[4]=E.v,y[5]=e(E.f)):(y[2]="v",y[3]=E.v);break;case"b":y[2]="vt"+(E.f?"f":"c"),y[3]="nl",y[4]=E.v?"1":"0",y[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var G=Ir(Er(E.v));y[2]="vtc",y[3]="nd",y[4]=""+G,y[5]=E.w||Wa(E.z||Dt[14],G);break;case"e":continue}_.push(y.join(":"))}return _.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function x(v){return[o,c,f,c,m(v),h].join(`
`)}return{to_workbook:i,to_sheet:s,from_sheet:x}})(),e3=(function(){function r(x,v,_,y,E){E.raw?v[_][y]=x:x===""||(x==="TRUE"?v[_][y]=!0:x==="FALSE"?v[_][y]=!1:isNaN(ua(x))?isNaN(ho(x).getDate())?v[_][y]=x:v[_][y]=Er(x):v[_][y]=ua(x))}function e(x,v){var _=v||{},y=[];if(!x||x.length===0)return y;for(var E=x.split(/[\r\n]/),w=E.length-1;w>=0&&E[w].length===0;)--w;for(var S=10,k=0,M=0;M<=w;++M)k=E[M].indexOf(" "),k==-1?k=E[M].length:k++,S=Math.max(S,k);for(M=0;M<=w;++M){y[M]=[];var O=0;for(r(E[M].slice(0,S).trim(),y,M,O,_),O=1;O<=(E[M].length-S)/10+1;++O)r(E[M].slice(S+(O-1)*10,S+O*10).trim(),y,M,O,_)}return _.sheetRows&&(y=y.slice(0,_.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function i(x){for(var v={},_=!1,y=0,E=0;y<x.length;++y)(E=x.charCodeAt(y))==34?_=!_:!_&&E in t&&(v[E]=(v[E]||0)+1);E=[];for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&E.push([v[y],y]);if(!E.length){v=s;for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&E.push([v[y],y])}return E.sort(function(w,S){return w[0]-S[0]||s[w[1]]-s[S[1]]}),t[E.pop()[1]]||44}function o(x,v){var _=v||{},y="",E=_.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(y=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(y=x.charAt(4),x=x.slice(6)):y=i(x.slice(0,1024)):_&&_.FS?y=_.FS:y=i(x.slice(0,1024));var S=0,k=0,M=0,O=0,G=0,q=y.charCodeAt(0),K=!1,F=0,X=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var z=_.dateNF!=null?p4(_.dateNF):null;function ne(){var oe=x.slice(O,G),fe={};if(oe.charAt(0)=='"'&&oe.charAt(oe.length-1)=='"'&&(oe=oe.slice(1,-1).replace(/""/g,'"')),oe.length===0)fe.t="z";else if(_.raw)fe.t="s",fe.v=oe;else if(oe.trim().length===0)fe.t="s",fe.v=oe;else if(oe.charCodeAt(0)==61)oe.charCodeAt(1)==34&&oe.charCodeAt(oe.length-1)==34?(fe.t="s",fe.v=oe.slice(2,-1).replace(/""/g,'"')):Q3(oe)?(fe.t="n",fe.f=oe.slice(1)):(fe.t="s",fe.v=oe);else if(oe=="TRUE")fe.t="b",fe.v=!0;else if(oe=="FALSE")fe.t="b",fe.v=!1;else if(!isNaN(M=ua(oe)))fe.t="n",_.cellText!==!1&&(fe.w=oe),fe.v=M;else if(!isNaN(ho(oe).getDate())||z&&oe.match(z)){fe.z=_.dateNF||Dt[14];var W=0;z&&oe.match(z)&&(oe=x4(oe,_.dateNF,oe.match(z)||[]),W=1),_.cellDates?(fe.t="d",fe.v=Er(oe,W)):(fe.t="n",fe.v=Ir(Er(oe,W))),_.cellText!==!1&&(fe.w=Wa(fe.z,fe.v instanceof Date?Ir(fe.v):fe.v)),_.cellNF||delete fe.z}else fe.t="s",fe.v=oe;if(fe.t=="z"||(_.dense?(E[S]||(E[S]=[]),E[S][k]=fe):E[ht({c:k,r:S})]=fe),O=G+1,X=x.charCodeAt(O),w.e.c<k&&(w.e.c=k),w.e.r<S&&(w.e.r=S),F==q)++k;else if(k=0,++S,_.sheetRows&&_.sheetRows<=S)return!0}e:for(;G<x.length;++G)switch(F=x.charCodeAt(G)){case 34:X===34&&(K=!K);break;case q:case 10:case 13:if(!K&&ne())break e;break}return G-O>0&&ne(),E["!ref"]=Gt(w),E}function c(x,v){return!(v&&v.PRN)||v.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?o(x,v):Wi(e(x,v),v)}function f(x,v){var _="",y=v.type=="string"?[0,0,0,0]:h6(x,v);switch(v.type){case"base64":_=ha(x);break;case"binary":_=x;break;case"buffer":v.codepage==65001?_=x.toString("utf8"):v.codepage&&typeof Ou<"u"||(_=it&&Buffer.isBuffer(x)?x.toString("binary"):bo(x));break;case"array":_=Zu(x);break;case"string":_=x;break;default:throw new Error("Unrecognized type "+v.type)}return y[0]==239&&y[1]==187&&y[2]==191?_=to(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=to(_):v.type=="binary"&&typeof Ou<"u",_.slice(0,19)=="socialcalc:version:"?Gy.to_sheet(v.type=="string"?_:to(_),v):c(_,v)}function h(x,v){return Ds(f(x,v),v)}function m(x){for(var v=[],_=At(x["!ref"]),y,E=Array.isArray(x),w=_.s.r;w<=_.e.r;++w){for(var S=[],k=_.s.c;k<=_.e.c;++k){var M=ht({r:w,c:k});if(y=E?(x[w]||[])[k]:x[M],!y||y.v==null){S.push("          ");continue}for(var O=(y.w||(da(y),y.w)||"").slice(0,10);O.length<10;)O+=" ";S.push(O+(k===0?" ":""))}v.push(S.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:f,from_sheet:m}})(),ov=(function(){function r(N,P,C){if(N){Kr(N,N.l||0);for(var I=C.Enum||ce;N.l<N.length;){var Z=N.read_shift(2),ye=I[Z]||I[65535],De=N.read_shift(2),Ae=N.l+De,Oe=ye.f&&ye.f(N,De,C);if(N.l=Ae,P(Oe,ye,Z))return}}}function e(N,P){switch(P.type){case"base64":return t(An(ha(N)),P);case"binary":return t(An(N),P);case"buffer":case"array":return t(N,P)}throw"Unsupported type "+P.type}function t(N,P){if(!N)return N;var C=P||{},I=C.dense?[]:{},Z="Sheet1",ye="",De=0,Ae={},Oe=[],qe=[],we={s:{r:0,c:0},e:{r:0,c:0}},Ve=C.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)C.Enum=ce,r(N,function(Le,Zt,Wt){switch(Wt){case 0:C.vers=Le,Le>=4096&&(C.qpro=!0);break;case 6:we=Le;break;case 204:Le&&(ye=Le);break;case 222:ye=Le;break;case 15:case 51:C.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:Wt==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=C.dateNF||Dt[14],C.cellDates&&(Le[1].t="d",Le[1].v=ly(Le[1].v))),C.qpro&&Le[3]>De&&(I["!ref"]=Gt(we),Ae[Z]=I,Oe.push(Z),I=C.dense?[]:{},we={s:{r:0,c:0},e:{r:0,c:0}},De=Le[3],Z=ye||"Sheet"+(De+1),ye="");var Mr=C.dense?(I[Le[0].r]||[])[Le[0].c]:I[ht(Le[0])];if(Mr){Mr.t=Le[1].t,Mr.v=Le[1].v,Le[1].z!=null&&(Mr.z=Le[1].z),Le[1].f!=null&&(Mr.f=Le[1].f);break}C.dense?(I[Le[0].r]||(I[Le[0].r]=[]),I[Le[0].r][Le[0].c]=Le[1]):I[ht(Le[0])]=Le[1];break}},C);else if(N[2]==26||N[2]==14)C.Enum=U,N[2]==14&&(C.qpro=!0,N.l=0),r(N,function(Le,Zt,Wt){switch(Wt){case 204:Z=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>De&&(I["!ref"]=Gt(we),Ae[Z]=I,Oe.push(Z),I=C.dense?[]:{},we={s:{r:0,c:0},e:{r:0,c:0}},De=Le[3],Z="Sheet"+(De+1)),Ve>0&&Le[0].r>=Ve)break;C.dense?(I[Le[0].r]||(I[Le[0].r]=[]),I[Le[0].r][Le[0].c]=Le[1]):I[ht(Le[0])]=Le[1],we.e.c<Le[0].c&&(we.e.c=Le[0].c),we.e.r<Le[0].r&&(we.e.r=Le[0].r);break;case 27:Le[14e3]&&(qe[Le[14e3][0]]=Le[14e3][1]);break;case 1537:qe[Le[0]]=Le[1],Le[0]==De&&(Z=Le[1]);break}},C);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(I["!ref"]=Gt(we),Ae[ye||Z]=I,Oe.push(ye||Z),!qe.length)return{SheetNames:Oe,Sheets:Ae};for(var He={},It=[],dt=0;dt<qe.length;++dt)Ae[Oe[dt]]?(It.push(qe[dt]||Oe[dt]),He[qe[dt]]=Ae[qe[dt]]||Ae[Oe[dt]]):(It.push(qe[dt]),He[qe[dt]]={"!ref":"A1"});return{SheetNames:It,Sheets:He}}function s(N,P){var C=P||{};if(+C.codepage>=0&&uo(+C.codepage),C.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Lr(),Z=At(N["!ref"]),ye=Array.isArray(N),De=[];je(I,0,o(1030)),je(I,6,h(Z));for(var Ae=Math.min(Z.e.r,8191),Oe=Z.s.r;Oe<=Ae;++Oe)for(var qe=ur(Oe),we=Z.s.c;we<=Z.e.c;++we){Oe===Z.s.r&&(De[we]=gr(we));var Ve=De[we]+qe,He=ye?(N[Oe]||[])[we]:N[Ve];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?je(I,13,y(Oe,we,He.v)):je(I,14,w(Oe,we,He.v));else{var It=da(He);je(I,15,v(Oe,we,It.slice(0,239)))}}return je(I,1),I.end()}function i(N,P){var C=P||{};if(+C.codepage>=0&&uo(+C.codepage),C.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Lr();je(I,0,c(N));for(var Z=0,ye=0;Z<N.SheetNames.length;++Z)(N.Sheets[N.SheetNames[Z]]||{})["!ref"]&&je(I,27,Ne(N.SheetNames[Z],ye++));var De=0;for(Z=0;Z<N.SheetNames.length;++Z){var Ae=N.Sheets[N.SheetNames[Z]];if(!(!Ae||!Ae["!ref"])){for(var Oe=At(Ae["!ref"]),qe=Array.isArray(Ae),we=[],Ve=Math.min(Oe.e.r,8191),He=Oe.s.r;He<=Ve;++He)for(var It=ur(He),dt=Oe.s.c;dt<=Oe.e.c;++dt){He===Oe.s.r&&(we[dt]=gr(dt));var Le=we[dt]+It,Zt=qe?(Ae[He]||[])[dt]:Ae[Le];if(!(!Zt||Zt.t=="z"))if(Zt.t=="n")je(I,23,ne(He,dt,De,Zt.v));else{var Wt=da(Zt);je(I,22,F(He,dt,De,Wt.slice(0,239)))}}++De}}return je(I,1),I.end()}function o(N){var P=he(2);return P.write_shift(2,N),P}function c(N){var P=he(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var C=0,I=0,Z=0,ye=0;ye<N.SheetNames.length;++ye){var De=N.SheetNames[ye],Ae=N.Sheets[De];if(!(!Ae||!Ae["!ref"])){++Z;var Oe=Jr(Ae["!ref"]);C<Oe.e.r&&(C=Oe.e.r),I<Oe.e.c&&(I=Oe.e.c)}}return C>8191&&(C=8191),P.write_shift(2,C),P.write_shift(1,Z),P.write_shift(1,I),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function f(N,P,C){var I={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&C.qpro?(I.s.c=N.read_shift(1),N.l++,I.s.r=N.read_shift(2),I.e.c=N.read_shift(1),N.l++,I.e.r=N.read_shift(2),I):(I.s.c=N.read_shift(2),I.s.r=N.read_shift(2),P==12&&C.qpro&&(N.l+=2),I.e.c=N.read_shift(2),I.e.r=N.read_shift(2),P==12&&C.qpro&&(N.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function h(N){var P=he(8);return P.write_shift(2,N.s.c),P.write_shift(2,N.s.r),P.write_shift(2,N.e.c),P.write_shift(2,N.e.r),P}function m(N,P,C){var I=[{c:0,r:0},{t:"n",v:0},0,0];return C.qpro&&C.vers!=20768?(I[0].c=N.read_shift(1),I[3]=N.read_shift(1),I[0].r=N.read_shift(2),N.l+=2):(I[2]=N.read_shift(1),I[0].c=N.read_shift(2),I[0].r=N.read_shift(2)),I}function x(N,P,C){var I=N.l+P,Z=m(N,P,C);if(Z[1].t="s",C.vers==20768){N.l++;var ye=N.read_shift(1);return Z[1].v=N.read_shift(ye,"utf8"),Z}return C.qpro&&N.l++,Z[1].v=N.read_shift(I-N.l,"cstr"),Z}function v(N,P,C){var I=he(7+C.length);I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,N),I.write_shift(1,39);for(var Z=0;Z<I.length;++Z){var ye=C.charCodeAt(Z);I.write_shift(1,ye>=128?95:ye)}return I.write_shift(1,0),I}function _(N,P,C){var I=m(N,P,C);return I[1].v=N.read_shift(2,"i"),I}function y(N,P,C){var I=he(7);return I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,N),I.write_shift(2,C,"i"),I}function E(N,P,C){var I=m(N,P,C);return I[1].v=N.read_shift(8,"f"),I}function w(N,P,C){var I=he(13);return I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,N),I.write_shift(8,C,"f"),I}function S(N,P,C){var I=N.l+P,Z=m(N,P,C);if(Z[1].v=N.read_shift(8,"f"),C.qpro)N.l=I;else{var ye=N.read_shift(2);G(N.slice(N.l,N.l+ye),Z),N.l+=ye}return Z}function k(N,P,C){var I=P&32768;return P&=-32769,P=(I?N:0)+(P>=8192?P-16384:P),(I?"":"$")+(C?gr(P):ur(P))}var M={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},O=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function G(N,P){Kr(N,0);for(var C=[],I=0,Z="",ye="",De="",Ae="";N.l<N.length;){var Oe=N[N.l++];switch(Oe){case 0:C.push(N.read_shift(8,"f"));break;case 1:ye=k(P[0].c,N.read_shift(2),!0),Z=k(P[0].r,N.read_shift(2),!1),C.push(ye+Z);break;case 2:{var qe=k(P[0].c,N.read_shift(2),!0),we=k(P[0].r,N.read_shift(2),!1);ye=k(P[0].c,N.read_shift(2),!0),Z=k(P[0].r,N.read_shift(2),!1),C.push(qe+we+":"+ye+Z)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:C.push("("+C.pop()+")");break;case 5:C.push(N.read_shift(2));break;case 6:{for(var Ve="";Oe=N[N.l++];)Ve+=String.fromCharCode(Oe);C.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:C.push("-"+C.pop());break;case 23:C.push("+"+C.pop());break;case 22:C.push("NOT("+C.pop()+")");break;case 20:case 21:Ae=C.pop(),De=C.pop(),C.push(["AND","OR"][Oe-20]+"("+De+","+Ae+")");break;default:if(Oe<32&&O[Oe])Ae=C.pop(),De=C.pop(),C.push(De+O[Oe]+Ae);else if(M[Oe]){if(I=M[Oe][1],I==69&&(I=N[N.l++]),I>C.length){console.error("WK1 bad formula parse 0x"+Oe.toString(16)+":|"+C.join("|")+"|");return}var He=C.slice(-I);C.length-=I,C.push(M[Oe][0]+"("+He.join(",")+")")}else return Oe<=7?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=24?console.error("WK1 unsupported op "+Oe.toString(16)):Oe<=30?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=115?console.error("WK1 unsupported function opcode "+Oe.toString(16)):console.error("WK1 unrecognized opcode "+Oe.toString(16))}}C.length==1?P[1].f=""+C[0]:console.error("WK1 bad formula parse |"+C.join("|")+"|")}function q(N){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=N.read_shift(2),P[3]=N[N.l++],P[0].c=N[N.l++],P}function K(N,P){var C=q(N);return C[1].t="s",C[1].v=N.read_shift(P-4,"cstr"),C}function F(N,P,C,I){var Z=he(6+I.length);Z.write_shift(2,N),Z.write_shift(1,C),Z.write_shift(1,P),Z.write_shift(1,39);for(var ye=0;ye<I.length;++ye){var De=I.charCodeAt(ye);Z.write_shift(1,De>=128?95:De)}return Z.write_shift(1,0),Z}function X(N,P){var C=q(N);C[1].v=N.read_shift(2);var I=C[1].v>>1;if(C[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return C[1].v=I,C}function z(N,P){var C=q(N),I=N.read_shift(4),Z=N.read_shift(4),ye=N.read_shift(2);if(ye==65535)return I===0&&Z===3221225472?(C[1].t="e",C[1].v=15):I===0&&Z===3489660928?(C[1].t="e",C[1].v=42):C[1].v=0,C;var De=ye&32768;return ye=(ye&32767)-16446,C[1].v=(1-De*2)*(Z*Math.pow(2,ye+32)+I*Math.pow(2,ye)),C}function ne(N,P,C,I){var Z=he(14);if(Z.write_shift(2,N),Z.write_shift(1,C),Z.write_shift(1,P),I==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var ye=0,De=0,Ae=0,Oe=0;return I<0&&(ye=1,I=-I),De=Math.log2(I)|0,I/=Math.pow(2,De-31),Oe=I>>>0,(Oe&2147483648)==0&&(I/=2,++De,Oe=I>>>0),I-=Oe,Oe|=2147483648,Oe>>>=0,I*=Math.pow(2,32),Ae=I>>>0,Z.write_shift(4,Ae),Z.write_shift(4,Oe),De+=16383+(ye?32768:0),Z.write_shift(2,De),Z}function oe(N,P){var C=z(N);return N.l+=P-14,C}function fe(N,P){var C=q(N),I=N.read_shift(4);return C[1].v=I>>6,C}function W(N,P){var C=q(N),I=N.read_shift(8,"f");return C[1].v=I,C}function be(N,P){var C=W(N);return N.l+=P-10,C}function Ee(N,P){return N[N.l+P-1]==0?N.read_shift(P,"cstr"):""}function J(N,P){var C=N[N.l++];C>P-1&&(C=P-1);for(var I="";I.length<C;)I+=String.fromCharCode(N[N.l++]);return I}function ve(N,P,C){if(!(!C.qpro||P<21)){var I=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var Z=N.read_shift(P-21,"cstr");return[I,Z]}}function le(N,P){for(var C={},I=N.l+P;N.l<I;){var Z=N.read_shift(2);if(Z==14e3){for(C[Z]=[0,""],C[Z][0]=N.read_shift(2);N[N.l];)C[Z][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return C}function Ne(N,P){var C=he(5+N.length);C.write_shift(2,14e3),C.write_shift(2,P);for(var I=0;I<N.length;++I){var Z=N.charCodeAt(I);C[C.l++]=Z>127?95:Z}return C[C.l++]=0,C}var ce={0:{n:"BOF",f:Uy},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:K},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:X},25:{n:"FORMULA19",f:oe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:fe},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ve},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:i,to_workbook:e}})(),t3=/^\s|\s$|[\t\n\r]/;function Vy(r,e){if(!e.bookSST)return"";var t=[Vt];t[t.length]=Re("sst",null,{xmlns:Ki[0],count:r.Count,uniqueCount:r.Unique});for(var s=0;s!=r.length;++s)if(r[s]!=null){var i=r[s],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(t3)&&(o+=' xml:space="preserve"'),o+=">"+ft(i.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function r3(r){return[r.read_shift(4),r.read_shift(4)]}function n3(r,e){return e||(e=he(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var a3=W4;function s3(r){var e=Lr();_e(e,159,n3(r));for(var t=0;t<r.length;++t)_e(e,19,a3(r[t]));return _e(e,160),e.end()}function i3(r){for(var e=[],t=r.split(""),s=0;s<t.length;++s)e[s]=t[s].charCodeAt(0);return e}function qy(r){var e=0,t,s=i3(r),i=s.length+1,o,c,f,h,m;for(t=Rs(i),t[0]=s.length,o=1;o!=i;++o)t[o]=s[o-1];for(o=i-1;o>=0;--o)c=t[o],f=(e&16384)===0?0:1,h=e<<1&32767,m=f|h,e=m^c;return e^52811}var l3=(function(){function r(i,o){switch(o.type){case"base64":return e(ha(i),o);case"binary":return e(i,o);case"buffer":return e(it&&Buffer.isBuffer(i)?i.toString("binary"):bo(i),o);case"array":return e(Zu(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){var c=o||{},f=c.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(x,v){Array.isArray(f)&&(f[v]=[]);for(var _=/\\\w+\b/g,y=0,E,w=-1;E=_.exec(x);){switch(E[0]){case"\\cell":var S=x.slice(y,_.lastIndex-E[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var k={v:S,t:"s"};Array.isArray(f)?f[v][w]=k:f[ht({r:v,c:w})]=k}break}y=_.lastIndex}w>m.e.c&&(m.e.c=w)}),f["!ref"]=Gt(m),f}function t(i,o){return Ds(r(i,o),o)}function s(i){for(var o=["{\\rtf1\\ansi"],c=At(i["!ref"]),f,h=Array.isArray(i),m=c.s.r;m<=c.e.r;++m){o.push("\\trowd\\trautofit1");for(var x=c.s.c;x<=c.e.c;++x)o.push("\\cellx"+(x+1));for(o.push("\\pard\\intbl"),x=c.s.c;x<=c.e.c;++x){var v=ht({r:m,c:x});f=h?(i[m]||[])[x]:i[v],!(!f||f.v==null&&(!f.f||f.F))&&(o.push(" "+(f.w||(da(f),f.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:s}})();function cv(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}var o3=6,fa=o3;function Bu(r){return Math.floor((r+Math.round(128/fa)/256)*fa)}function Mu(r){return Math.floor((r-5)/fa*100+.5)/100}function fd(r){return Math.round((r*fa+5)/fa*256)/256}function Pd(r){r.width?(r.wpx=Bu(r.width),r.wch=Mu(r.wpx),r.MDW=fa):r.wpx?(r.wch=Mu(r.wpx),r.width=fd(r.wch),r.MDW=fa):typeof r.wch=="number"&&(r.width=fd(r.wch),r.wpx=Bu(r.width),r.MDW=fa),r.customWidth&&delete r.customWidth}var c3=96,Ky=c3;function Uu(r){return r*96/Ky}function Wy(r){return r*Ky/96}function u3(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var s=t[0];s<=t[1];++s)r[s]!=null&&(e[e.length]=Re("numFmt",null,{numFmtId:s,formatCode:ft(r[s])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Re("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function f3(r){var e=[];return e[e.length]=Re("cellXfs",null),r.forEach(function(t){e[e.length]=Re("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Re("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Xy(r,e){var t=[Vt,Re("styleSheet",null,{xmlns:Ki[0],"xmlns:vt":Yt.vt})],s;return r.SSF&&(s=u3(r.SSF))!=null&&(t[t.length]=s),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=f3(e.cellXfs))&&(t[t.length]=s),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function h3(r,e){var t=r.read_shift(2),s=pr(r);return[t,s]}function d3(r,e,t){t||(t=he(6+4*e.length)),t.write_shift(2,r),Qt(e,t);var s=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),s}function m3(r,e,t){var s={};s.sz=r.read_shift(2)/20;var i=tA(r);i.fItalic&&(s.italic=1),i.fCondense&&(s.condense=1),i.fExtend&&(s.extend=1),i.fShadow&&(s.shadow=1),i.fOutline&&(s.outline=1),i.fStrikeout&&(s.strike=1);var o=r.read_shift(2);switch(o===700&&(s.bold=1),r.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var c=r.read_shift(1);c!=0&&(s.underline=c);var f=r.read_shift(1);f>0&&(s.family=f);var h=r.read_shift(1);switch(h>0&&(s.charset=h),r.l++,s.color=eA(r),r.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=pr(r),s}function g3(r,e){e||(e=he(153)),e.write_shift(2,r.sz*20),rA(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),Lu(r.color,e);var s=0;return s=2,e.write_shift(1,s),Qt(r.name,e),e.length>e.l?e.slice(0,e.l):e}var p3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ih,x3=Mn;function uv(r,e){e||(e=he(84)),Ih||(Ih=Od(p3));var t=Ih[r.patternType];t==null&&(t=40),e.write_shift(4,t);var s=0;if(t!=40)for(Lu({auto:1},e),Lu({auto:1},e);s<12;++s)e.write_shift(4,0);else{for(;s<4;++s)e.write_shift(4,0);for(;s<12;++s)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function v3(r,e){var t=r.l+e,s=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:s,numFmtId:i}}function Yy(r,e,t){t||(t=he(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var s=0;return t.write_shift(1,s),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Wl(r,e){return e||(e=he(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var _3=Mn;function y3(r,e){return e||(e=he(51)),e.write_shift(1,0),Wl(null,e),Wl(null,e),Wl(null,e),Wl(null,e),Wl(null,e),e.length>e.l?e.slice(0,e.l):e}function w3(r,e){return e||(e=he(52)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Fu(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function b3(r,e,t){var s=he(2052);return s.write_shift(4,r),Fu(e,s),Fu(t,s),s.length>s.l?s.slice(0,s.l):s}function S3(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)e[i]!=null&&++t}),t!=0&&(_e(r,615,On(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)e[i]!=null&&_e(r,44,d3(i,e[i]))}),_e(r,616))}}function E3(r){var e=1;_e(r,611,On(e)),_e(r,43,g3({sz:12,color:{theme:1},name:"Calibri",family:2})),_e(r,612)}function T3(r){var e=2;_e(r,603,On(e)),_e(r,45,uv({patternType:"none"})),_e(r,45,uv({patternType:"gray125"})),_e(r,604)}function A3(r){var e=1;_e(r,613,On(e)),_e(r,46,y3()),_e(r,614)}function N3(r){var e=1;_e(r,626,On(e)),_e(r,47,Yy({numFmtId:0},65535)),_e(r,627)}function O3(r,e){_e(r,617,On(e.length)),e.forEach(function(t){_e(r,47,Yy(t,0))}),_e(r,618)}function C3(r){var e=1;_e(r,619,On(e)),_e(r,48,w3({xfId:0,name:"Normal"})),_e(r,620)}function R3(r){var e=0;_e(r,505,On(e)),_e(r,506)}function j3(r){var e=0;_e(r,508,b3(e,"TableStyleMedium9","PivotStyleMedium4")),_e(r,509)}function k3(r,e){var t=Lr();return _e(t,278),S3(t,r.SSF),E3(t),T3(t),A3(t),N3(t),O3(t,e.cellXfs),C3(t),R3(t),j3(t),_e(t,279),t.end()}function Jy(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Vt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function D3(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:pr(r)}}function F3(r){var e=he(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),Qt(r.name,e),e.slice(0,e.l)}function L3(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function I3(r){var e=he(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function B3(r,e){var t=he(8+2*e.length);return t.write_shift(4,r),Qt(e,t),t.slice(0,t.l)}function M3(r){return r.l+=4,r.read_shift(4)!=0}function U3(r,e){var t=he(8);return t.write_shift(4,r),t.write_shift(4,1),t}function P3(){var r=Lr();return _e(r,332),_e(r,334,On(1)),_e(r,335,F3({name:"XLDAPR",version:12e4,flags:3496657072})),_e(r,336),_e(r,339,B3(1,"XLDAPR")),_e(r,52),_e(r,35,On(514)),_e(r,4096,On(0)),_e(r,4097,dn(1)),_e(r,36),_e(r,53),_e(r,340),_e(r,337,U3(1)),_e(r,51,I3([[1,0]])),_e(r,338),_e(r,333),r.end()}function Qy(){var r=[Vt];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function z3(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=ht(t);var s=r.read_shift(1);return s&2&&(e.l="1"),s&8&&(e.a="1"),e}var ki=1024;function Zy(r,e){for(var t=[21600,21600],s=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[Re("xml",null,{"xmlns:v":Wr.v,"xmlns:o":Wr.o,"xmlns:x":Wr.x,"xmlns:mv":Wr.mv}).replace(/\/>/,">"),Re("o:shapelayout",Re("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Re("v:shapetype",[Re("v:stroke",null,{joinstyle:"miter"}),Re("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:s})];ki<r*1e3;)ki+=1e3;return e.forEach(function(o){var c=Jt(o[0]),f={color2:"#BEFF82",type:"gradient"};f.type=="gradient"&&(f.angle="-180");var h=f.type=="gradient"?Re("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=Re("v:fill",h,f),x={on:"t",obscured:"t"};++ki,i=i.concat(["<v:shape"+go({id:"_x0000_s"+ki,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,Re("v:shadow",null,x),Re("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cr("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),cr("x:AutoFill","False"),cr("x:Row",String(c.r)),cr("x:Column",String(c.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function e2(r){var e=[Vt,Re("comments",null,{xmlns:Ki[0]})],t=[];return e.push("<authors>"),r.forEach(function(s){s[1].forEach(function(i){var o=ft(i.a);t.indexOf(o)==-1&&(t.push(o),e.push("<author>"+o+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(s){var i=0,o=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?i=t.indexOf("tc="+s[1][0].ID):s[1].forEach(function(h){h.a&&(i=t.indexOf(ft(h.a))),o.push(h.t||"")}),e.push('<comment ref="'+s[0]+'" authorId="'+i+'"><text>'),o.length<=1)e.push(cr("t",ft(o[0]||"")));else{for(var c=`Comment:
    `+o[0]+`
`,f=1;f<o.length;++f)c+=`Reply:
    `+o[f]+`
`;e.push(cr("t",ft(c)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function H3(r,e,t){var s=[Vt,Re("ThreadedComments",null,{xmlns:Yt.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var o="";(i[1]||[]).forEach(function(c,f){if(!c.T){delete c.ID;return}c.a&&e.indexOf(c.a)==-1&&e.push(c.a);var h={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};f==0?o=h.id:h.parentId=o,c.ID=h.id,c.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(c.a)).slice(-12)+"}"),s.push(Re("threadedComment",cr("text",c.t||""),h))})}),s.push("</ThreadedComments>"),s.join("")}function $3(r){var e=[Vt,Re("personList",null,{xmlns:Yt.TCMNT,"xmlns:x":Ki[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,s){e.push(Re("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function G3(r){var e={};e.iauthor=r.read_shift(4);var t=Bs(r);return e.rfx=t.s,e.ref=ht(t.s),r.l+=16,e}function V3(r,e){return e==null&&(e=he(36)),e.write_shift(4,r[1].iauthor),Xi(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var q3=pr;function K3(r){return Qt(r.slice(0,54))}function W3(r){var e=Lr(),t=[];return _e(e,628),_e(e,630),r.forEach(function(s){s[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),_e(e,632,K3(i.a)))})}),_e(e,631),_e(e,633),r.forEach(function(s){s[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var o={s:Jt(s[0]),e:Jt(s[0])};_e(e,635,V3([o,i])),i.t&&i.t.length>0&&_e(e,637,Y4(i)),_e(e,636),delete i.iauthor})}),_e(e,634),_e(e,629),e.end()}function X3(r,e){e.FullPaths.forEach(function(t,s){if(s!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&xt.utils.cfb_add(r,i,e.FileIndex[s].content)}})}var t2=["xlsb","xlsm","xlam","biff8","xla"],Y3=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(s,i,o,c){var f=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),c.length==0?f=!0:c.charAt(0)=="["&&(f=!0,c=c.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,x=c.length>0?parseInt(c,10)|0:0;return f?x+=e.c:--x,h?m+=e.r:--m,i+(f?"":"$")+gr(x)+(h?"":"$")+ur(m)}return function(i,o){return e=o,i.replace(r,t)}})(),zd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hd=(function(){return function(e,t){return e.replace(zd,function(s,i,o,c,f,h){var m=Ld(c)-(o?0:t.c),x=Fd(h)-(f?0:t.r),v=x==0?"":f?x+1:"["+x+"]",_=m==0?"":o?m+1:"["+m+"]";return i+"R"+v+"C"+_})}})();function J3(r,e){return r.replace(zd,function(t,s,i,o,c,f){return s+(i=="$"?i+o:gr(Ld(o)+e.c))+(c=="$"?c+f:ur(Fd(f)+e.r))})}function Q3(r){return r.length!=1}function zt(r){r.l+=1}function Xa(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function r2(r,e,t){var s=2;if(t){if(t.biff>=2&&t.biff<=5)return n2(r);t.biff==12&&(s=4)}var i=r.read_shift(s),o=r.read_shift(s),c=Xa(r),f=Xa(r);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:f[0],cRel:f[1],rRel:f[2]}}}function n2(r){var e=Xa(r),t=Xa(r),s=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:s,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Z3(r,e,t){if(t.biff<8)return n2(r);var s=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),o=Xa(r),c=Xa(r);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function a2(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return eN(r);var s=r.read_shift(t&&t.biff==12?4:2),i=Xa(r);return{r:s,c:i[0],cRel:i[1],rRel:i[2]}}function eN(r){var e=Xa(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function tN(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function rN(r,e,t){var s=t&&t.biff?t.biff:8;if(s>=2&&s<=5)return nN(r);var i=r.read_shift(s>=12?4:2),o=r.read_shift(2),c=(o&16384)>>14,f=(o&32768)>>15;if(o&=16383,f==1)for(;i>524287;)i-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:c,rRel:f}}function nN(r){var e=r.read_shift(2),t=r.read_shift(1),s=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,s==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:s}}function aN(r,e,t){var s=(r[r.l++]&96)>>5,i=r2(r,t.biff>=2&&t.biff<=5?6:8,t);return[s,i]}function sN(r,e,t){var s=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:r.l+=12,o=6;break;case 12:o=12;break}var c=r2(r,o,t);return[s,i,c]}function iN(r,e,t){var s=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[s]}function lN(r,e,t){var s=(r[r.l++]&96)>>5,i=r.read_shift(2),o=8;if(t)switch(t.biff){case 5:r.l+=12,o=6;break;case 12:o=12;break}return r.l+=o,[s,i]}function oN(r,e,t){var s=(r[r.l++]&96)>>5,i=Z3(r,e-1,t);return[s,i]}function cN(r,e,t){var s=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[s]}function fv(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function uN(r,e,t){r.l+=2;for(var s=r.read_shift(t&&t.biff==2?1:2),i=[],o=0;o<=s;++o)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function fN(r,e,t){var s=r[r.l+1]&255?1:0;return r.l+=2,[s,r.read_shift(t&&t.biff==2?1:2)]}function hN(r,e,t){var s=r[r.l+1]&255?1:0;return r.l+=2,[s,r.read_shift(t&&t.biff==2?1:2)]}function dN(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function mN(r,e,t){var s=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[s]}function s2(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function gN(r){return r.read_shift(2),s2(r)}function pN(r){return r.read_shift(2),s2(r)}function xN(r,e,t){var s=(r[r.l]&96)>>5;r.l+=1;var i=a2(r,0,t);return[s,i]}function vN(r,e,t){var s=(r[r.l]&96)>>5;r.l+=1;var i=rN(r,0,t);return[s,i]}function _N(r,e,t){var s=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var o=a2(r,0,t);return[s,i,o]}function yN(r,e,t){var s=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[yO[i],o2[i],s]}function wN(r,e,t){var s=r[r.l++],i=r.read_shift(1),o=t&&t.biff<=3?[s==88?-1:0,r.read_shift(1)]:bN(r);return[i,(o[0]===0?o2:_O)[o[1]]]}function bN(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function SN(r,e,t){r.l+=t&&t.biff==2?3:4}function EN(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var s=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[s,i]}function TN(r){return r.l++,To[r.read_shift(1)]}function AN(r){return r.l++,r.read_shift(2)}function NN(r){return r.l++,r.read_shift(1)!==0}function ON(r){return r.l++,Yi(r)}function CN(r,e,t){return r.l++,zy(r,e-1,t)}function RN(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=_A(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=To[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Yi(r);break;case 2:t[1]=SA(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function jN(r,e,t){for(var s=r.read_shift(t.biff==12?4:2),i=[],o=0;o!=s;++o)i.push((t.biff==12?Bs:AA)(r));return i}function kN(r,e,t){var s=0,i=0;t.biff==12?(s=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),s=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--s,--i==0&&(i=256));for(var o=0,c=[];o!=s&&(c[o]=[]);++o)for(var f=0;f!=i;++f)c[o][f]=RN(r,t.biff);return c}function DN(r,e,t){var s=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,o=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[s,0,o]}function FN(r,e,t){if(t.biff==5)return LN(r);var s=r.read_shift(1)>>>5&3,i=r.read_shift(2),o=r.read_shift(4);return[s,i,o]}function LN(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var s=r.read_shift(2);return r.l+=12,[e,t,s]}function IN(r,e,t){var s=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[s,i]}function BN(r,e,t){var s=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[s,i]}function MN(r,e,t){var s=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[s]}function UN(r,e,t){var s=(r[r.l++]&96)>>5,i=r.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return r.l+=o,[s,i]}var PN=Mn,zN=Mn,HN=Mn;function Ao(r,e,t){return r.l+=2,[tN(r)]}function $d(r){return r.l+=6,[]}var $N=Ao,GN=$d,VN=$d,qN=Ao;function i2(r){return r.l+=2,[Uy(r),r.read_shift(2)&1]}var KN=Ao,WN=i2,XN=$d,YN=Ao,JN=Ao,QN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ZN(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),s=r.read_shift(4),i=r.read_shift(2),o=r.read_shift(2),c=QN[t>>2&31];return{ixti:e,coltype:t&3,rt:c,idx:s,c:i,C:o}}function eO(r){return r.l+=2,[r.read_shift(4)]}function tO(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function rO(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function nO(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function aO(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function sO(r){return r.l+=4,[0,0]}var hv={1:{n:"PtgExp",f:EN},2:{n:"PtgTbl",f:HN},3:{n:"PtgAdd",f:zt},4:{n:"PtgSub",f:zt},5:{n:"PtgMul",f:zt},6:{n:"PtgDiv",f:zt},7:{n:"PtgPower",f:zt},8:{n:"PtgConcat",f:zt},9:{n:"PtgLt",f:zt},10:{n:"PtgLe",f:zt},11:{n:"PtgEq",f:zt},12:{n:"PtgGe",f:zt},13:{n:"PtgGt",f:zt},14:{n:"PtgNe",f:zt},15:{n:"PtgIsect",f:zt},16:{n:"PtgUnion",f:zt},17:{n:"PtgRange",f:zt},18:{n:"PtgUplus",f:zt},19:{n:"PtgUminus",f:zt},20:{n:"PtgPercent",f:zt},21:{n:"PtgParen",f:zt},22:{n:"PtgMissArg",f:zt},23:{n:"PtgStr",f:CN},26:{n:"PtgSheet",f:tO},27:{n:"PtgEndSheet",f:rO},28:{n:"PtgErr",f:TN},29:{n:"PtgBool",f:NN},30:{n:"PtgInt",f:AN},31:{n:"PtgNum",f:ON},32:{n:"PtgArray",f:cN},33:{n:"PtgFunc",f:yN},34:{n:"PtgFuncVar",f:wN},35:{n:"PtgName",f:DN},36:{n:"PtgRef",f:xN},37:{n:"PtgArea",f:aN},38:{n:"PtgMemArea",f:IN},39:{n:"PtgMemErr",f:PN},40:{n:"PtgMemNoMem",f:zN},41:{n:"PtgMemFunc",f:BN},42:{n:"PtgRefErr",f:MN},43:{n:"PtgAreaErr",f:iN},44:{n:"PtgRefN",f:vN},45:{n:"PtgAreaN",f:oN},46:{n:"PtgMemAreaN",f:nO},47:{n:"PtgMemNoMemN",f:aO},57:{n:"PtgNameX",f:FN},58:{n:"PtgRef3d",f:_N},59:{n:"PtgArea3d",f:sN},60:{n:"PtgRefErr3d",f:UN},61:{n:"PtgAreaErr3d",f:lN},255:{}},iO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lO={1:{n:"PtgElfLel",f:i2},2:{n:"PtgElfRw",f:YN},3:{n:"PtgElfCol",f:$N},6:{n:"PtgElfRwV",f:JN},7:{n:"PtgElfColV",f:qN},10:{n:"PtgElfRadical",f:KN},11:{n:"PtgElfRadicalS",f:XN},13:{n:"PtgElfColS",f:GN},15:{n:"PtgElfColSV",f:VN},16:{n:"PtgElfRadicalLel",f:WN},25:{n:"PtgList",f:ZN},29:{n:"PtgSxName",f:eO},255:{}},oO={0:{n:"PtgAttrNoop",f:sO},1:{n:"PtgAttrSemi",f:mN},2:{n:"PtgAttrIf",f:hN},4:{n:"PtgAttrChoose",f:uN},8:{n:"PtgAttrGoto",f:fN},16:{n:"PtgAttrSum",f:SN},32:{n:"PtgAttrBaxcel",f:fv},33:{n:"PtgAttrBaxcel",f:fv},64:{n:"PtgAttrSpace",f:gN},65:{n:"PtgAttrSpaceSemi",f:pN},128:{n:"PtgAttrIfError",f:dN},255:{}};function cO(r,e,t,s){if(s.biff<8)return Mn(r,e);for(var i=r.l+e,o=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=kN(r,0,s),o.push(t[c][1]);break;case"PtgMemArea":t[c][2]=jN(r,t[c][1],s),o.push(t[c][2]);break;case"PtgExp":s&&s.biff==12&&(t[c][1][1]=r.read_shift(4),o.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return e=i-r.l,e!==0&&o.push(Mn(r,e)),o}function uO(r,e,t){for(var s=r.l+e,i,o,c=[];s!=r.l;)e=s-r.l,o=r[r.l],i=hv[o]||hv[iO[o]],(o===24||o===25)&&(i=(o===24?lO:oO)[r[r.l+1]]),!i||!i.f?Mn(r,e):c.push([i.n,i.f(r,e,t)]);return c}function fO(r){for(var e=[],t=0;t<r.length;++t){for(var s=r[t],i=[],o=0;o<s.length;++o){var c=s[o];if(c)switch(c[0]){case 2:i.push('"'+c[1].replace(/"/g,'""')+'"');break;default:i.push(c[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var hO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dO(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function l2(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var s=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!s)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[s[0]][0]){case 357:return i=s[1]==-1?"#REF":r.SheetNames[s[1]],s[1]==s[2]?i:i+":"+r.SheetNames[s[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[s[0]][0];case 355:default:return"SH33TJSSRC"+r[s[0]][0]}switch(r[s[0]][0][0]){case 1025:return i=s[1]==-1?"#REF":r.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?i:i+":"+r.SheetNames[s[2]];case 14849:return r[s[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return r[s[0]][0][3]?(i=s[1]==-1?"#REF":r[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?i:i+":"+r[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function dv(r,e,t){var s=l2(r,e,t);return s=="#REF"?s:dO(s,t)}function Gi(r,e,t,s,i){var o=i&&i.biff||8,c={s:{c:0,r:0}},f=[],h,m,x,v=0,_=0,y,E="";if(!r[0]||!r[0][0])return"";for(var w=-1,S="",k=0,M=r[0].length;k<M;++k){var O=r[0][k];switch(O[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=f.pop(),m=f.pop(),w>=0){switch(r[0][w][1][0]){case 0:S=kt(" ",r[0][w][1][1]);break;case 1:S=kt("\r",r[0][w][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][w][1][0])}m=m+S,w=-1}f.push(m+hO[O[0]]+h);break;case"PtgIsect":h=f.pop(),m=f.pop(),f.push(m+" "+h);break;case"PtgUnion":h=f.pop(),m=f.pop(),f.push(m+","+h);break;case"PtgRange":h=f.pop(),m=f.pop(),f.push(m+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=no(O[1][1],c,i),f.push(ao(x,o));break;case"PtgRefN":x=t?no(O[1][1],t,i):O[1][1],f.push(ao(x,o));break;case"PtgRef3d":v=O[1][1],x=no(O[1][2],c,i),E=dv(s,v,i),f.push(E+"!"+ao(x,o));break;case"PtgFunc":case"PtgFuncVar":var G=O[1][0],q=O[1][1];G||(G=0),G&=127;var K=G==0?[]:f.slice(-G);f.length-=G,q==="User"&&(q=K.shift()),f.push(q+"("+K.join(",")+")");break;case"PtgBool":f.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(O[1]);break;case"PtgNum":f.push(String(O[1]));break;case"PtgStr":f.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(O[1]);break;case"PtgAreaN":y=Jx(O[1][1],t?{s:t}:c,i),f.push(Fh(y,i));break;case"PtgArea":y=Jx(O[1][1],c,i),f.push(Fh(y,i));break;case"PtgArea3d":v=O[1][1],y=O[1][2],E=dv(s,v,i),f.push(E+"!"+Fh(y,i));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=O[1][2];var F=(s.names||[])[_-1]||(s[0]||[])[_],X=F?F.Name:"SH33TJSNAME"+String(_);X&&X.slice(0,6)=="_xlfn."&&!i.xlfn&&(X=X.slice(6)),f.push(X);break;case"PtgNameX":var z=O[1][1];_=O[1][2];var ne;if(i.biff<=5)z<0&&(z=-z),s[z]&&(ne=s[z][_]);else{var oe="";if(((s[z]||[])[0]||[])[0]==14849||(((s[z]||[])[0]||[])[0]==1025?s[z][_]&&s[z][_].itab>0&&(oe=s.SheetNames[s[z][_].itab-1]+"!"):oe=s.SheetNames[_-1]+"!"),s[z]&&s[z][_])oe+=s[z][_].Name;else if(s[0]&&s[0][_])oe+=s[0][_].Name;else{var fe=(l2(s,z,i)||"").split(";;");fe[_-1]?oe=fe[_-1]:oe+="SH33TJSERRX"}f.push(oe);break}ne||(ne={Name:"SH33TJSERRY"}),f.push(ne.Name);break;case"PtgParen":var W="(",be=")";if(w>=0){switch(S="",r[0][w][1][0]){case 2:W=kt(" ",r[0][w][1][1])+W;break;case 3:W=kt("\r",r[0][w][1][1])+W;break;case 4:be=kt(" ",r[0][w][1][1])+be;break;case 5:be=kt("\r",r[0][w][1][1])+be;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][w][1][0])}w=-1}f.push(W+f.pop()+be);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":x={c:O[1][1],r:O[1][0]};var Ee={c:t.c,r:t.r};if(s.sharedf[ht(x)]){var J=s.sharedf[ht(x)];f.push(Gi(J,c,Ee,s,i))}else{var ve=!1;for(h=0;h!=s.arrayf.length;++h)if(m=s.arrayf[h],!(x.c<m[0].s.c||x.c>m[0].e.c)&&!(x.r<m[0].s.r||x.r>m[0].e.r)){f.push(Gi(m[1],c,Ee,s,i)),ve=!0;break}ve||f.push(O[1])}break;case"PtgArray":f.push("{"+fO(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&w>=0&&le.indexOf(r[0][k][0])==-1){O=r[0][w];var Ne=!0;switch(O[1][0]){case 4:Ne=!1;case 0:S=kt(" ",O[1][1]);break;case 5:Ne=!1;case 1:S=kt("\r",O[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}f.push((Ne?S:"")+f.pop()+(Ne?"":S)),w=-1}}if(f.length>1&&i.WTF)throw new Error("bad formula stack");return f[0]}function mO(r){if(r==null){var e=he(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return js(r);return js(0)}function gO(r,e,t,s,i){var o=ks(e,t,i),c=mO(r.v),f=he(6),h=33;f.write_shift(2,h),f.write_shift(4,0);for(var m=he(r.bf.length),x=0;x<r.bf.length;++x)m[x]=r.bf[x];var v=or([o,c,f,m]);return v}function e0(r,e,t){var s=r.read_shift(4),i=uO(r,s,t),o=r.read_shift(4),c=o>0?cO(r,o,i,t):null;return[i,c]}var pO=e0,t0=e0,xO=e0,vO=e0,_O={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},o2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},yO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wO(r){var e="of:="+r.replace(zd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function bO(r){return r.replace(/\./,"!")}var so=typeof Map<"u";function Gd(r,e,t){var s=0,i=r.length;if(t){if(so?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var o=so?t.get(e):t[e];s<o.length;++s)if(r[o[s]].t===e)return r.Count++,o[s]}}else for(;s<i;++s)if(r[s].t===e)return r.Count++,s;return r[i]={t:e},r.Count++,r.Unique++,t&&(so?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function r0(r,e){var t={min:r+1,max:r+1},s=-1;return e.MDW&&(fa=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?s=Mu(e.wpx):e.wch!=null&&(s=e.wch),s>-1?(t.width=fd(s),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function c2(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function Ja(r,e,t){var s=t.revssf[e.z!=null?e.z:"General"],i=60,o=r.length;if(s==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){ay(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=s=i;break}}for(i=0;i!=o;++i)if(r[i].numFmtId===s)return i;return r[o]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function SO(r,e,t){if(r&&r["!ref"]){var s=At(r["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function EO(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+Gt(r[t])+'"/>';return e+"</mergeCells>"}function TO(r,e,t,s,i){var o=!1,c={},f=null;if(s.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[t];try{e.Workbook&&(h=e.Workbook.Sheets[t].CodeName||h)}catch{}o=!0,c.codeName=mo(ft(h))}if(r&&r["!outline"]){var m={summaryBelow:1,summaryRight:1};r["!outline"].above&&(m.summaryBelow=0),r["!outline"].left&&(m.summaryRight=0),f=(f||"")+Re("outlinePr",null,m)}!o&&!f||(i[i.length]=Re("sheetPr",f,c))}var AO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],NO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function OO(r){var e={sheet:1};return AO.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),NO.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=qy(r.password).toString(16).toUpperCase()),Re("sheetProtection",null,e)}function CO(r){return c2(r),Re("pageMargins",null,r)}function RO(r,e){for(var t=["<cols>"],s,i=0;i!=e.length;++i)(s=e[i])&&(t[t.length]=Re("col",null,r0(i,s)));return t[t.length]="</cols>",t.join("")}function jO(r,e,t,s){var i=typeof r.ref=="string"?r.ref:Gt(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,c=Jr(i);c.s.r==c.e.r&&(c.e.r=Jr(e["!ref"]).e.r,i=Gt(c));for(var f=0;f<o.length;++f){var h=o[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==s){h.Ref="'"+t.SheetNames[s]+"'!"+i;break}}return f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+i}),Re("autoFilter",null,{ref:i})}function kO(r,e,t,s){var i={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Re("sheetViews",Re("sheetView",null,i),{})}function DO(r,e,t,s){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",o=r.t,c=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=To[r.v];break;case"d":s&&s.cellDates?i=Er(r.v,-1).toISOString():(r=Br(r),r.t="n",i=""+(r.v=Ir(Er(r.v)))),typeof r.z>"u"&&(r.z=Dt[14]);break;default:i=r.v;break}var f=cr("v",ft(i)),h={r:e},m=Ja(s.cellXfs,r,s);switch(m!==0&&(h.s=m),r.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){f=cr("v",""+Gd(s.Strings,r.v,s.revStrings)),h.t="s";break}h.t="str";break}if(r.t!=o&&(r.t=o,r.v=c),typeof r.f=="string"&&r.f){var x=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;f=Re("f",ft(r.f),x)+(r.v!=null?f:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(h.cm=1),Re("c",f,h)}function FO(r,e,t,s){var i=[],o=[],c=At(r["!ref"]),f="",h,m="",x=[],v=0,_=0,y=r["!rows"],E=Array.isArray(r),w={r:m},S,k=-1;for(_=c.s.c;_<=c.e.c;++_)x[_]=gr(_);for(v=c.s.r;v<=c.e.r;++v){for(o=[],m=ur(v),_=c.s.c;_<=c.e.c;++_){h=x[_]+m;var M=E?(r[v]||[])[_]:r[h];M!==void 0&&(f=DO(M,h,r,e))!=null&&o.push(f)}(o.length>0||y&&y[v])&&(w={r:m},y&&y[v]&&(S=y[v],S.hidden&&(w.hidden=1),k=-1,S.hpx?k=Uu(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(w.ht=k,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),i[i.length]=Re("row",o.join(""),w))}if(y)for(;v<y.length;++v)y&&y[v]&&(w={r:v+1},S=y[v],S.hidden&&(w.hidden=1),k=-1,S.hpx?k=Uu(S.hpx):S.hpt&&(k=S.hpt),k>-1&&(w.ht=k,w.customHeight=1),S.level&&(w.outlineLevel=S.level),i[i.length]=Re("row","",w));return i.join("")}function u2(r,e,t,s){var i=[Vt,Re("worksheet",null,{xmlns:Ki[0],"xmlns:r":Yt.r})],o=t.SheetNames[r],c=0,f="",h=t.Sheets[o];h==null&&(h={});var m=h["!ref"]||"A1",x=At(m);if(x.e.c>16383||x.e.r>1048575){if(e.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),m=Gt(x)}s||(s={}),h["!comments"]=[];var v=[];TO(h,t,r,e,i),i[i.length]=Re("dimension",null,{ref:m}),i[i.length]=kO(h,e,r,t),e.sheetFormat&&(i[i.length]=Re("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(i[i.length]=RO(h,h["!cols"])),i[c=i.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(f=FO(h,e),f.length>0&&(i[i.length]=f)),i.length>c+1&&(i[i.length]="</sheetData>",i[c]=i[c].replace("/>",">")),h["!protect"]&&(i[i.length]=OO(h["!protect"])),h["!autofilter"]!=null&&(i[i.length]=jO(h["!autofilter"],h,t,r)),h["!merges"]!=null&&h["!merges"].length>0&&(i[i.length]=EO(h["!merges"]));var _=-1,y,E=-1;return h["!links"].length>0&&(i[i.length]="<hyperlinks>",h["!links"].forEach(function(w){w[1].Target&&(y={ref:w[0]},w[1].Target.charAt(0)!="#"&&(E=ut(s,-1,ft(w[1].Target).replace(/#.*$/,""),at.HLINK),y["r:id"]="rId"+E),(_=w[1].Target.indexOf("#"))>-1&&(y.location=ft(w[1].Target.slice(_+1))),w[1].Tooltip&&(y.tooltip=ft(w[1].Tooltip)),i[i.length]=Re("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(i[i.length]=CO(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=cr("ignoredErrors",Re("ignoredError",null,{numberStoredAsText:1,sqref:m}))),v.length>0&&(E=ut(s,-1,"../drawings/drawing"+(r+1)+".xml",at.DRAW),i[i.length]=Re("drawing",null,{"r:id":"rId"+E}),h["!drawing"]=v),h["!comments"].length>0&&(E=ut(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",at.VML),i[i.length]=Re("legacyDrawing",null,{"r:id":"rId"+E}),h["!legacy"]=E),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function LO(r,e){var t={},s=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var o=r.read_shift(1);return r.l=s,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=i/20),t}function IO(r,e,t){var s=he(145),i=(t["!rows"]||[])[r]||{};s.write_shift(4,r),s.write_shift(4,0);var o=320;i.hpx?o=Uu(i.hpx)*20:i.hpt&&(o=i.hpt*20),s.write_shift(2,o),s.write_shift(1,0);var c=0;i.level&&(c|=i.level),i.hidden&&(c|=16),(i.hpx||i.hpt)&&(c|=32),s.write_shift(1,c),s.write_shift(1,0);var f=0,h=s.l;s.l+=4;for(var m={r,c:0},x=0;x<16;++x)if(!(e.s.c>x+1<<10||e.e.c<x<<10)){for(var v=-1,_=-1,y=x<<10;y<x+1<<10;++y){m.c=y;var E=Array.isArray(t)?(t[m.r]||[])[m.c]:t[ht(m)];E&&(v<0&&(v=y),_=y)}v<0||(++f,s.write_shift(4,v),s.write_shift(4,_))}var w=s.l;return s.l=h,s.write_shift(4,f),s.l=w,s.length>s.l?s.slice(0,s.l):s}function BO(r,e,t,s){var i=IO(s,t,e);(i.length>17||(e["!rows"]||[])[s])&&_e(r,0,i)}var MO=Bs,UO=Xi;function PO(){}function zO(r,e){var t={},s=r[r.l];return++r.l,t.above=!(s&64),t.left=!(s&128),r.l+=18,t.name=J4(r),t}function HO(r,e,t){t==null&&(t=he(84+4*r.length));var s=192;e&&(e.above&&(s&=-65),e.left&&(s&=-129)),t.write_shift(1,s);for(var i=1;i<3;++i)t.write_shift(1,0);return Lu({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Ty(r,t),t.slice(0,t.l)}function $O(r){var e=mn(r);return[e]}function GO(r,e,t){return t==null&&(t=he(8)),Fs(e,t)}function VO(r){var e=Ls(r);return[e]}function qO(r,e,t){return t==null&&(t=he(4)),Is(e,t)}function KO(r){var e=mn(r),t=r.read_shift(1);return[e,t,"b"]}function WO(r,e,t){return t==null&&(t=he(9)),Fs(e,t),t.write_shift(1,r.v?1:0),t}function XO(r){var e=Ls(r),t=r.read_shift(1);return[e,t,"b"]}function YO(r,e,t){return t==null&&(t=he(5)),Is(e,t),t.write_shift(1,r.v?1:0),t}function JO(r){var e=mn(r),t=r.read_shift(1);return[e,t,"e"]}function QO(r,e,t){return t==null&&(t=he(9)),Fs(e,t),t.write_shift(1,r.v),t}function ZO(r){var e=Ls(r),t=r.read_shift(1);return[e,t,"e"]}function eC(r,e,t){return t==null&&(t=he(8)),Is(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function tC(r){var e=mn(r),t=r.read_shift(4);return[e,t,"s"]}function rC(r,e,t){return t==null&&(t=he(12)),Fs(e,t),t.write_shift(4,e.v),t}function nC(r){var e=Ls(r),t=r.read_shift(4);return[e,t,"s"]}function aC(r,e,t){return t==null&&(t=he(8)),Is(e,t),t.write_shift(4,e.v),t}function sC(r){var e=mn(r),t=Yi(r);return[e,t,"n"]}function iC(r,e,t){return t==null&&(t=he(16)),Fs(e,t),js(r.v,t),t}function lC(r){var e=Ls(r),t=Yi(r);return[e,t,"n"]}function oC(r,e,t){return t==null&&(t=he(12)),Is(e,t),js(r.v,t),t}function cC(r){var e=mn(r),t=Ay(r);return[e,t,"n"]}function uC(r,e,t){return t==null&&(t=he(12)),Fs(e,t),Ny(r.v,t),t}function fC(r){var e=Ls(r),t=Ay(r);return[e,t,"n"]}function hC(r,e,t){return t==null&&(t=he(8)),Is(e,t),Ny(r.v,t),t}function dC(r){var e=mn(r),t=Id(r);return[e,t,"is"]}function mC(r){var e=mn(r),t=pr(r);return[e,t,"str"]}function gC(r,e,t){return t==null&&(t=he(12+4*r.v.length)),Fs(e,t),Qt(r.v,t),t.length>t.l?t.slice(0,t.l):t}function pC(r){var e=Ls(r),t=pr(r);return[e,t,"str"]}function xC(r,e,t){return t==null&&(t=he(8+4*r.v.length)),Is(e,t),Qt(r.v,t),t.length>t.l?t.slice(0,t.l):t}function vC(r,e,t){var s=r.l+e,i=mn(r);i.r=t["!row"];var o=r.read_shift(1),c=[i,o,"b"];if(t.cellFormula){r.l+=2;var f=t0(r,s-r.l,t);c[3]=Gi(f,null,i,t.supbooks,t)}else r.l=s;return c}function _C(r,e,t){var s=r.l+e,i=mn(r);i.r=t["!row"];var o=r.read_shift(1),c=[i,o,"e"];if(t.cellFormula){r.l+=2;var f=t0(r,s-r.l,t);c[3]=Gi(f,null,i,t.supbooks,t)}else r.l=s;return c}function yC(r,e,t){var s=r.l+e,i=mn(r);i.r=t["!row"];var o=Yi(r),c=[i,o,"n"];if(t.cellFormula){r.l+=2;var f=t0(r,s-r.l,t);c[3]=Gi(f,null,i,t.supbooks,t)}else r.l=s;return c}function wC(r,e,t){var s=r.l+e,i=mn(r);i.r=t["!row"];var o=pr(r),c=[i,o,"str"];if(t.cellFormula){r.l+=2;var f=t0(r,s-r.l,t);c[3]=Gi(f,null,i,t.supbooks,t)}else r.l=s;return c}var bC=Bs,SC=Xi;function EC(r,e){return e==null&&(e=he(4)),e.write_shift(4,r),e}function TC(r,e){var t=r.l+e,s=Bs(r),i=Bd(r),o=pr(r),c=pr(r),f=pr(r);r.l=t;var h={rfx:s,relId:i,loc:o,display:f};return c&&(h.Tooltip=c),h}function AC(r,e){var t=he(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Xi({s:Jt(r[0]),e:Jt(r[0])},t),Md("rId"+e,t);var s=r[1].Target.indexOf("#"),i=s==-1?"":r[1].Target.slice(s+1);return Qt(i||"",t),Qt(r[1].Tooltip||"",t),Qt("",t),t.slice(0,t.l)}function NC(){}function OC(r,e,t){var s=r.l+e,i=Oy(r),o=r.read_shift(1),c=[i];if(c[2]=o,t.cellFormula){var f=pO(r,s-r.l,t);c[1]=f}else r.l=s;return c}function CC(r,e,t){var s=r.l+e,i=Bs(r),o=[i];if(t.cellFormula){var c=vO(r,s-r.l,t);o[1]=c,r.l=s}else r.l=s;return o}function RC(r,e,t){t==null&&(t=he(18));var s=r0(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(s.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof s.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var f2=["left","right","top","bottom","header","footer"];function jC(r){var e={};return f2.forEach(function(t){e[t]=Yi(r)}),e}function kC(r,e){return e==null&&(e=he(48)),c2(r),f2.forEach(function(t){js(r[t],e)}),e}function DC(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function FC(r,e,t){t==null&&(t=he(30));var s=924;return(((e||{}).Views||[])[0]||{}).RTL&&(s|=32),t.write_shift(2,s),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function LC(r){var e=he(24);return e.write_shift(4,4),e.write_shift(4,1),Xi(r,e),e}function IC(r,e){return e==null&&(e=he(66)),e.write_shift(2,r.password?qy(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function BC(){}function MC(){}function UC(r,e,t,s,i,o,c){if(e.v===void 0)return!1;var f="";switch(e.t){case"b":f=e.v?"1":"0";break;case"d":e=Br(e),e.z=e.z||Dt[14],e.v=Ir(Er(e.v)),e.t="n";break;case"n":case"e":f=""+e.v;break;default:f=e.v;break}var h={r:t,c:s};switch(h.s=Ja(i.cellXfs,e,i),e.l&&o["!links"].push([ht(h),e.l]),e.c&&o["!comments"].push([ht(h),e.c]),e.t){case"s":case"str":return i.bookSST?(f=Gd(i.Strings,e.v,i.revStrings),h.t="s",h.v=f,c?_e(r,18,aC(e,h)):_e(r,7,rC(e,h))):(h.t="str",c?_e(r,17,xC(e,h)):_e(r,6,gC(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?c?_e(r,13,hC(e,h)):_e(r,2,uC(e,h)):c?_e(r,16,oC(e,h)):_e(r,5,iC(e,h)),!0;case"b":return h.t="b",c?_e(r,15,YO(e,h)):_e(r,4,WO(e,h)),!0;case"e":return h.t="e",c?_e(r,14,eC(e,h)):_e(r,3,QO(e,h)),!0}return c?_e(r,12,qO(e,h)):_e(r,1,GO(e,h)),!0}function PC(r,e,t,s){var i=At(e["!ref"]||"A1"),o,c="",f=[];_e(r,145);var h=Array.isArray(e),m=i.e.r;e["!rows"]&&(m=Math.max(i.e.r,e["!rows"].length-1));for(var x=i.s.r;x<=m;++x){c=ur(x),BO(r,e,i,x);var v=!1;if(x<=i.e.r)for(var _=i.s.c;_<=i.e.c;++_){x===i.s.r&&(f[_]=gr(_)),o=f[_]+c;var y=h?(e[x]||[])[_]:e[o];if(!y){v=!1;continue}v=UC(r,y,x,_,s,e,v)}}_e(r,146)}function zC(r,e){!e||!e["!merges"]||(_e(r,177,EC(e["!merges"].length)),e["!merges"].forEach(function(t){_e(r,176,SC(t))}),_e(r,178))}function HC(r,e){!e||!e["!cols"]||(_e(r,390),e["!cols"].forEach(function(t,s){t&&_e(r,60,RC(s,t))}),_e(r,391))}function $C(r,e){!e||!e["!ref"]||(_e(r,648),_e(r,649,LC(At(e["!ref"]))),_e(r,650))}function GC(r,e,t){e["!links"].forEach(function(s){if(s[1].Target){var i=ut(t,-1,s[1].Target.replace(/#.*$/,""),at.HLINK);_e(r,494,AC(s,i))}}),delete e["!links"]}function VC(r,e,t,s){if(e["!comments"].length>0){var i=ut(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",at.VML);_e(r,551,Md("rId"+i)),e["!legacy"]=i}}function qC(r,e,t,s){if(e["!autofilter"]){var i=e["!autofilter"],o=typeof i.ref=="string"?i.ref:Gt(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,f=Jr(o);f.s.r==f.e.r&&(f.e.r=Jr(e["!ref"]).e.r,o=Gt(f));for(var h=0;h<c.length;++h){var m=c[h];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==s){m.Ref="'"+t.SheetNames[s]+"'!"+o;break}}h==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+o}),_e(r,161,Xi(At(o))),_e(r,162)}}function KC(r,e,t){_e(r,133),_e(r,137,FC(e,t)),_e(r,138),_e(r,134)}function WC(r,e){e["!protect"]&&_e(r,535,IC(e["!protect"]))}function XC(r,e,t,s){var i=Lr(),o=t.SheetNames[r],c=t.Sheets[o]||{},f=o;try{t&&t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}var h=At(c["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],_e(i,129),(t.vbaraw||c["!outline"])&&_e(i,147,HO(f,c["!outline"])),_e(i,148,UO(h)),KC(i,c,t.Workbook),HC(i,c),PC(i,c,r,e),WC(i,c),qC(i,c,t,r),zC(i,c),GC(i,c,s),c["!margins"]&&_e(i,476,kC(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&$C(i,c),VC(i,c,r,s),_e(i,130),i.end()}function YC(r,e){r.l+=10;var t=pr(r);return{name:t}}var JC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function QC(r){return!r.Workbook||!r.Workbook.WBProps?"false":C4(r.Workbook.WBProps.date1904)?"true":"false"}var ZC="][*?/\\".split("");function h2(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return ZC.forEach(function(s){if(r.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function eR(r,e,t){r.forEach(function(s,i){h2(s);for(var o=0;o<i;++o)if(s==r[o])throw new Error("Duplicate Sheet Name: "+s);if(t){var c=e&&e[i]&&e[i].CodeName||s;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function tR(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];eR(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)SO(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}function d2(r){var e=[Vt];e[e.length]=Re("workbook",null,{xmlns:Ki[0],"xmlns:r":Yt.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(JC.forEach(function(f){r.Workbook.WBProps[f[0]]!=null&&r.Workbook.WBProps[f[0]]!=f[1]&&(s[f[0]]=r.Workbook.WBProps[f[0]])}),r.Workbook.WBProps.CodeName&&(s.codeName=r.Workbook.WBProps.CodeName,delete s.CodeName)),e[e.length]=Re("workbookPr",null,s);var i=r.Workbook&&r.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=r.SheetNames.length&&!(!i[o]||!i[o].Hidden);++o);o==r.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=r.SheetNames.length;++o){var c={name:ft(r.SheetNames[o].slice(0,31))};if(c.sheetId=""+(o+1),c["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}e[e.length]=Re("sheet",null,c)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(f){var h={name:f.Name};f.Comment&&(h.comment=f.Comment),f.Sheet!=null&&(h.localSheetId=""+f.Sheet),f.Hidden&&(h.hidden="1"),f.Ref&&(e[e.length]=Re("definedName",ft(f.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function rR(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=ud(r),t.name=pr(r),t}function nR(r,e){return e||(e=he(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Md(r.strRelID,e),Qt(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function aR(r,e){var t={},s=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?pr(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(s&65536),t.backupFile=!!(s&64),t.checkCompatibility=!!(s&4096),t.date1904=!!(s&1),t.filterPrivacy=!!(s&8),t.hidePivotFieldList=!!(s&1024),t.promptedSolutions=!!(s&16),t.publishItems=!!(s&2048),t.refreshAllConnections=!!(s&262144),t.saveExternalLinkValues=!!(s&128),t.showBorderUnselectedTables=!!(s&4),t.showInkAnnotation=!!(s&32),t.showObjects=["all","placeholders","none"][s>>13&3],t.showPivotChartFilter=!!(s&32768),t.updateLinks=["userSet","never","always"][s>>8&3],t}function sR(r,e){e||(e=he(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),Ty(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function iR(r,e,t){var s=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),o=Q4(r),c=xO(r,0,t),f=Bd(r);r.l=s;var h={Name:o,Ptg:c};return i<268435455&&(h.Sheet=i),f&&(h.Comment=f),h}function lR(r,e){_e(r,143);for(var t=0;t!=e.SheetNames.length;++t){var s=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:s,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};_e(r,156,nR(i))}_e(r,144)}function oR(r,e){e||(e=he(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Qt("SheetJS",e),Qt(Nu.version,e),Qt(Nu.version,e),Qt("7262",e),e.length>e.l?e.slice(0,e.l):e}function cR(r,e){e||(e=he(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function uR(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,s=0,i=-1,o=-1;s<t.length;++s)!t[s]||!t[s].Hidden&&i==-1?i=s:t[s].Hidden==1&&o==-1&&(o=s);o>i||(_e(r,135),_e(r,158,cR(i)),_e(r,136))}}function fR(r,e){var t=Lr();return _e(t,131),_e(t,128,oR()),_e(t,153,sR(r.Workbook&&r.Workbook.WBProps||null)),uR(t,r),lR(t,r),_e(t,132),t.end()}function hR(r,e,t){return(e.slice(-4)===".bin"?fR:d2)(r)}function dR(r,e,t,s,i){return(e.slice(-4)===".bin"?XC:u2)(r,t,s,i)}function mR(r,e,t){return(e.slice(-4)===".bin"?k3:Xy)(r,t)}function gR(r,e,t){return(e.slice(-4)===".bin"?s3:Vy)(r,t)}function pR(r,e,t){return(e.slice(-4)===".bin"?W3:e2)(r)}function xR(r){return(r.slice(-4)===".bin"?P3:Qy)()}function vR(r,e){var t=[];return r.Props&&t.push(mA(r.Props,e)),r.Custprops&&t.push(gA(r.Props,r.Custprops)),t.join("")}function _R(){return""}function yR(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(s,i){var o=[];o.push(Re("NumberFormat",null,{"ss:Format":ft(Dt[s.numFmtId])}));var c={"ss:ID":"s"+(21+i)};t.push(Re("Style",o.join(""),c))}),Re("Styles",t.join(""))}function m2(r){return Re("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+Hd(r.Ref,{r:0,c:0})})}function wR(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],s=0;s<e.length;++s){var i=e[s];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(m2(i)))}return Re("Names",t.join(""))}function bR(r,e,t,s){if(!r||!((s||{}).Workbook||{}).Names)return"";for(var i=s.Workbook.Names,o=[],c=0;c<i.length;++c){var f=i[c];f.Sheet==t&&(f.Name.match(/^_xlfn\./)||o.push(m2(f)))}return o.join("")}function SR(r,e,t,s){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push(Re("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push(Re("Footer",null,{"x:Margin":r["!margins"].footer})),i.push(Re("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[t])if(s.Workbook.Sheets[t].Hidden)i.push(Re("Visible",s.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(s.Workbook.Sheets[o]&&!s.Workbook.Sheets[o].Hidden);++o);o==t&&i.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(cr("ProtectContents","True")),r["!protect"].objects&&i.push(cr("ProtectObjects","True")),r["!protect"].scenarios&&i.push(cr("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(cr("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(cr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){r["!protect"][c[0]]&&i.push("<"+c[1]+"/>")})),i.length==0?"":Re("WorksheetOptions",i.join(""),{xmlns:Wr.x})}function ER(r){return r.map(function(e){var t=O4(e.t||""),s=Re("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Re("Comment",s,{"ss:Author":e.a})}).join("")}function TR(r,e,t,s,i,o,c){if(!r||r.v==null&&r.f==null)return"";var f={};if(r.f&&(f["ss:Formula"]="="+ft(Hd(r.f,c))),r.F&&r.F.slice(0,e.length)==e){var h=Jt(r.F.slice(e.length+1));f["ss:ArrayRange"]="RC:R"+(h.r==c.r?"":"["+(h.r-c.r)+"]")+"C"+(h.c==c.c?"":"["+(h.c-c.c)+"]")}if(r.l&&r.l.Target&&(f["ss:HRef"]=ft(r.l.Target),r.l.Tooltip&&(f["x:HRefScreenTip"]=ft(r.l.Tooltip))),t["!merges"])for(var m=t["!merges"],x=0;x!=m.length;++x)m[x].s.c!=c.c||m[x].s.r!=c.r||(m[x].e.c>m[x].s.c&&(f["ss:MergeAcross"]=m[x].e.c-m[x].s.c),m[x].e.r>m[x].s.r&&(f["ss:MergeDown"]=m[x].e.r-m[x].s.r));var v="",_="";switch(r.t){case"z":if(!s.sheetStubs)return"";break;case"n":v="Number",_=String(r.v);break;case"b":v="Boolean",_=r.v?"1":"0";break;case"e":v="Error",_=To[r.v];break;case"d":v="DateTime",_=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||Dt[14]);break;case"s":v="String",_=N4(r.v||"");break}var y=Ja(s.cellXfs,r,s);f["ss:StyleID"]="s"+(21+y),f["ss:Index"]=c.c+1;var E=r.v!=null?_:"",w=r.t=="z"?"":'<Data ss:Type="'+v+'">'+E+"</Data>";return(r.c||[]).length>0&&(w+=ER(r.c)),Re("Cell",w,f)}function AR(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Wy(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function NR(r,e,t,s){if(!r["!ref"])return"";var i=At(r["!ref"]),o=r["!merges"]||[],c=0,f=[];r["!cols"]&&r["!cols"].forEach(function(S,k){Pd(S);var M=!!S.width,O=r0(k,S),G={"ss:Index":k+1};M&&(G["ss:Width"]=Bu(O.width)),S.hidden&&(G["ss:Hidden"]="1"),f.push(Re("Column",null,G))});for(var h=Array.isArray(r),m=i.s.r;m<=i.e.r;++m){for(var x=[AR(m,(r["!rows"]||[])[m])],v=i.s.c;v<=i.e.c;++v){var _=!1;for(c=0;c!=o.length;++c)if(!(o[c].s.c>v)&&!(o[c].s.r>m)&&!(o[c].e.c<v)&&!(o[c].e.r<m)){(o[c].s.c!=v||o[c].s.r!=m)&&(_=!0);break}if(!_){var y={r:m,c:v},E=ht(y),w=h?(r[m]||[])[v]:r[E];x.push(TR(w,E,r,e,t,s,y))}}x.push("</Row>"),x.length>2&&f.push(x.join(""))}return f.join("")}function OR(r,e,t){var s=[],i=t.SheetNames[r],o=t.Sheets[i],c=o?bR(o,e,r,t):"";return c.length>0&&s.push("<Names>"+c+"</Names>"),c=o?NR(o,e,r,t):"",c.length>0&&s.push("<Table>"+c+"</Table>"),s.push(SR(o,e,r,t)),s.join("")}function CR(r,e){e||(e={}),r.SSF||(r.SSF=Br(Dt)),r.SSF&&(Ju(),Yu(r.SSF),e.revssf=Qu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],Ja(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(vR(r,e)),t.push(_R()),t.push(""),t.push("");for(var s=0;s<r.SheetNames.length;++s)t.push(Re("Worksheet",OR(s,e,r),{"ss:Name":ft(r.SheetNames[s])}));return t[2]=yR(r,e),t[3]=wR(r),Vt+Re("Workbook",t.join(""),{xmlns:Wr.ss,"xmlns:o":Wr.o,"xmlns:x":Wr.x,"xmlns:ss":Wr.ss,"xmlns:dt":Wr.dt,"xmlns:html":Wr.html})}var Bh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function RR(r,e){var t=[],s=[],i=[],o=0,c,f=Px(Zx,"n"),h=Px(ev,"n");if(r.Props)for(c=fr(r.Props),o=0;o<c.length;++o)(Object.prototype.hasOwnProperty.call(f,c[o])?t:Object.prototype.hasOwnProperty.call(h,c[o])?s:i).push([c[o],r.Props[c[o]]]);if(r.Custprops)for(c=fr(r.Custprops),o=0;o<c.length;++o)Object.prototype.hasOwnProperty.call(r.Props||{},c[o])||(Object.prototype.hasOwnProperty.call(f,c[o])?t:Object.prototype.hasOwnProperty.call(h,c[o])?s:i).push([c[o],r.Custprops[c[o]]]);var m=[];for(o=0;o<i.length;++o)My.indexOf(i[o][0])>-1||Ly.indexOf(i[o][0])>-1||i[o][1]!=null&&m.push(i[o]);s.length&&xt.utils.cfb_add(e,"/SummaryInformation",sv(s,Bh.SI,h,ev)),(t.length||m.length)&&xt.utils.cfb_add(e,"/DocumentSummaryInformation",sv(t,Bh.DSI,f,Zx,m.length?m:null,Bh.UDI))}function jR(r,e){var t=e||{},s=xt.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return xt.utils.cfb_add(s,i,g2(r,t)),t.biff==8&&(r.Props||r.Custprops)&&RR(r,s),t.biff==8&&r.vbaraw&&X3(s,xt.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),s}var kR={0:{f:LO},1:{f:$O},2:{f:cC},3:{f:JO},4:{f:KO},5:{f:sC},6:{f:mC},7:{f:tC},8:{f:wC},9:{f:yC},10:{f:vC},11:{f:_C},12:{f:VO},13:{f:fC},14:{f:ZO},15:{f:XO},16:{f:lC},17:{f:pC},18:{f:nC},19:{f:Id},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:iR},40:{},42:{},43:{f:m3},44:{f:h3},45:{f:x3},46:{f:_3},47:{f:v3},48:{},49:{f:V4},50:{},51:{f:L3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qA},62:{f:dC},63:{f:z3},64:{f:BC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:DC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:zO},148:{f:MO,p:16},151:{f:NC},152:{},153:{f:aR},154:{},155:{},156:{f:rR},157:{},158:{},159:{T:1,f:r3},160:{T:-1},161:{T:1,f:Bs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:D3},336:{T:-1},337:{f:M3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ud},357:{},358:{},359:{},360:{T:1},361:{},362:{f:PA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:OC},427:{f:CC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:jC},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:PO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:TC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ud},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:q3},633:{T:1},634:{T:-1},635:{T:1,f:G3},636:{T:-1},637:{f:X4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:YC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:MC},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function je(r,e,t,s){var i=e;if(!isNaN(i)){var o=s||(t||[]).length||0,c=r.next(4);c.write_shift(2,i),c.write_shift(2,o),o>0&&Dd(t)&&r.push(t)}}function DR(r,e,t,s){var i=(t||[]).length||0;if(i<=8224)return je(r,e,t,i);var o=e;if(!isNaN(o)){for(var c=t.parts||[],f=0,h=0,m=0;m+(c[f]||8224)<=8224;)m+=c[f]||8224,f++;var x=r.next(4);for(x.write_shift(2,o),x.write_shift(2,m),r.push(t.slice(h,h+m)),h+=m;h<i;){for(x=r.next(4),x.write_shift(2,60),m=0;m+(c[f]||8224)<=8224;)m+=c[f]||8224,f++;x.write_shift(2,m),r.push(t.slice(h,h+m)),h+=m}}}function No(r,e,t){return r||(r=he(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function FR(r,e,t,s){var i=he(9);return No(i,r,e),Py(t,s||"b",i),i}function LR(r,e,t){var s=he(8+2*t.length);return No(s,r,e),s.write_shift(1,t.length),s.write_shift(t.length,t,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function IR(r,e,t,s){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ir(Er(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?je(r,2,YA(t,s,i)):je(r,3,XA(t,s,i));return;case"b":case"e":je(r,5,FR(t,s,e.v,e.t));return;case"s":case"str":je(r,4,LR(t,s,(e.v||"").slice(0,255)));return}je(r,1,No(null,t,s))}function BR(r,e,t,s){var i=Array.isArray(e),o=At(e["!ref"]||"A1"),c,f="",h=[];if(o.e.c>255||o.e.r>16383){if(s.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),c=Gt(o)}for(var m=o.s.r;m<=o.e.r;++m){f=ur(m);for(var x=o.s.c;x<=o.e.c;++x){m===o.s.r&&(h[x]=gr(x)),c=h[x]+f;var v=i?(e[m]||[])[x]:e[c];v&&IR(r,v,m,x)}}}function MR(r,e){for(var t=e||{},s=Lr(),i=0,o=0;o<r.SheetNames.length;++o)r.SheetNames[o]==t.sheet&&(i=o);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return je(s,t.biff==4?1033:t.biff==3?521:9,Ud(r,16,t)),BR(s,r.Sheets[r.SheetNames[i]],i,t),je(s,10),s.end()}function UR(r,e,t){je(r,49,kA({sz:12,name:"Arial"},t))}function PR(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var i=s[0];i<=s[1];++i)e[i]!=null&&je(r,1054,LA(i,e[i],t))})}function zR(r,e){var t=he(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),je(r,2151,t),t=he(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),$y(At(e["!ref"]||"A1"),t),t.write_shift(4,4),je(r,2152,t)}function HR(r,e){for(var t=0;t<16;++t)je(r,224,lv({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(s){je(r,224,lv(s,0,e))})}function $R(r,e){for(var t=0;t<e["!links"].length;++t){var s=e["!links"][t];je(r,440,$A(s)),s[1].Tooltip&&je(r,2048,GA(s))}delete e["!links"]}function GR(r,e){if(e){var t=0;e.forEach(function(s,i){++t<=256&&s&&je(r,125,KA(r0(i,s),i))})}}function VR(r,e,t,s,i){var o=16+Ja(i.cellXfs,e,i);if(e.v==null&&!e.bf){je(r,513,ks(t,s,o));return}if(e.bf)je(r,6,gO(e,t,s,i,o));else switch(e.t){case"d":case"n":var c=e.t=="d"?Ir(Er(e.v)):e.v;je(r,515,UA(t,s,c,o));break;case"b":case"e":je(r,517,MA(t,s,e.v,o,i,e.t));break;case"s":case"str":if(i.bookSST){var f=Gd(i.Strings,e.v,i.revStrings);je(r,253,DA(t,s,f,o))}else je(r,516,FA(t,s,(e.v||"").slice(0,255),o,i));break;default:je(r,513,ks(t,s,o))}}function qR(r,e,t){var s=Lr(),i=t.SheetNames[r],o=t.Sheets[i]||{},c=(t||{}).Workbook||{},f=(c.Sheets||[])[r]||{},h=Array.isArray(o),m=e.biff==8,x,v="",_=[],y=At(o["!ref"]||"A1"),E=m?65536:16384;if(y.e.c>255||y.e.r>=E){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,E-1)}je(s,2057,Ud(t,16,e)),je(s,13,dn(1)),je(s,12,dn(100)),je(s,15,br(!0)),je(s,17,br(!1)),je(s,16,js(.001)),je(s,95,br(!0)),je(s,42,br(!1)),je(s,43,br(!1)),je(s,130,dn(1)),je(s,128,BA()),je(s,131,br(!1)),je(s,132,br(!1)),m&&GR(s,o["!cols"]),je(s,512,IA(y,e)),m&&(o["!links"]=[]);for(var w=y.s.r;w<=y.e.r;++w){v=ur(w);for(var S=y.s.c;S<=y.e.c;++S){w===y.s.r&&(_[S]=gr(S)),x=_[S]+v;var k=h?(o[w]||[])[S]:o[x];k&&(VR(s,k,w,S,e),m&&k.l&&o["!links"].push([x,k.l]))}}var M=f.CodeName||f.name||i;return m&&je(s,574,jA((c.Views||[])[0])),m&&(o["!merges"]||[]).length&&je(s,229,HA(o["!merges"])),m&&$R(s,o),je(s,442,Hy(M)),m&&zR(s,o),je(s,10),s.end()}function KR(r,e,t){var s=Lr(),i=(r||{}).Workbook||{},o=i.Sheets||[],c=i.WBProps||{},f=t.biff==8,h=t.biff==5;if(je(s,2057,Ud(r,5,t)),t.bookType=="xla"&&je(s,135),je(s,225,f?dn(1200):null),je(s,193,vA(2)),h&&je(s,191),h&&je(s,192),je(s,226),je(s,92,NA("SheetJS",t)),je(s,66,dn(f?1200:1252)),f&&je(s,353,dn(0)),f&&je(s,448),je(s,317,WA(r.SheetNames.length)),f&&r.vbaraw&&je(s,211),f&&r.vbaraw){var m=c.CodeName||"ThisWorkbook";je(s,442,Hy(m))}je(s,156,dn(17)),je(s,25,br(!1)),je(s,18,br(!1)),je(s,19,dn(0)),f&&je(s,431,br(!1)),f&&je(s,444,dn(0)),je(s,61,RA()),je(s,64,br(!1)),je(s,141,dn(0)),je(s,34,br(QC(r)=="true")),je(s,14,br(!0)),f&&je(s,439,br(!1)),je(s,218,dn(0)),UR(s,r,t),PR(s,r.SSF,t),HR(s,t),f&&je(s,352,br(!1));var x=s.end(),v=Lr();f&&je(v,140,VA()),f&&t.Strings&&DR(v,252,CA(t.Strings)),je(v,10);var _=v.end(),y=Lr(),E=0,w=0;for(w=0;w<r.SheetNames.length;++w)E+=(f?12:11)+(f?2:1)*r.SheetNames[w].length;var S=x.length+E+_.length;for(w=0;w<r.SheetNames.length;++w){var k=o[w]||{};je(y,133,OA({pos:S,hs:k.Hidden||0,dt:0,name:r.SheetNames[w]},t)),S+=e[w].length}var M=y.end();if(E!=M.length)throw new Error("BS8 "+E+" != "+M.length);var O=[];return x.length&&O.push(x),M.length&&O.push(M),_.length&&O.push(_),or(O)}function WR(r,e){var t=e||{},s=[];r&&!r.SSF&&(r.SSF=Br(Dt)),r&&r.SSF&&(Ju(),Yu(r.SSF),t.revssf=Qu(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vd(t),t.cellXfs=[],Ja(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)s[s.length]=qR(i,t,r);return s.unshift(KR(r,s,t)),or(s)}function g2(r,e){for(var t=0;t<=r.SheetNames.length;++t){var s=r.Sheets[r.SheetNames[t]];if(!(!s||!s["!ref"])){var i=Jr(s["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return WR(r,e);case 4:case 3:case 2:return MR(r,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function XR(r,e,t,s){for(var i=r["!merges"]||[],o=[],c=e.s.c;c<=e.e.c;++c){for(var f=0,h=0,m=0;m<i.length;++m)if(!(i[m].s.r>t||i[m].s.c>c)&&!(i[m].e.r<t||i[m].e.c<c)){if(i[m].s.r<t||i[m].s.c<c){f=-1;break}f=i[m].e.r-i[m].s.r+1,h=i[m].e.c-i[m].s.c+1;break}if(!(f<0)){var x=ht({r:t,c}),v=s.dense?(r[t]||[])[c]:r[x],_=v&&v.v!=null&&(v.h||A4(v.w||(da(v),v.w)||""))||"",y={};f>1&&(y.rowspan=f),h>1&&(y.colspan=h),s.editable?_='<span contenteditable="true">'+_+"</span>":v&&(y["data-t"]=v&&v.t||"z",v.v!=null&&(y["data-v"]=v.v),v.z!=null&&(y["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),y.id=(s.id||"sjs")+"-"+x,o.push(Re("td",_,y))}}var E="<tr>";return E+o.join("")+"</tr>"}var YR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',JR="</body></html>";function QR(r,e,t){var s=[];return s.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function p2(r,e){var t=e||{},s=t.header!=null?t.header:YR,i=t.footer!=null?t.footer:JR,o=[s],c=Jr(r["!ref"]);t.dense=Array.isArray(r),o.push(QR(r,c,t));for(var f=c.s.r;f<=c.e.r;++f)o.push(XR(r,c,f,t));return o.push("</table>"+i),o.join("")}function x2(r,e,t){var s=t||{},i=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?Jt(s.origin):s.origin;i=c.r,o=c.c}var f=e.getElementsByTagName("tr"),h=Math.min(s.sheetRows||1e7,f.length),m={s:{r:0,c:0},e:{r:i,c:o}};if(r["!ref"]){var x=Jr(r["!ref"]);m.s.r=Math.min(m.s.r,x.s.r),m.s.c=Math.min(m.s.c,x.s.c),m.e.r=Math.max(m.e.r,x.e.r),m.e.c=Math.max(m.e.c,x.e.c),i==-1&&(m.e.r=i=x.e.r+1)}var v=[],_=0,y=r["!rows"]||(r["!rows"]=[]),E=0,w=0,S=0,k=0,M=0,O=0;for(r["!cols"]||(r["!cols"]=[]);E<f.length&&w<h;++E){var G=f[E];if(mv(G)){if(s.display)continue;y[w]={hidden:!0}}var q=G.children;for(S=k=0;S<q.length;++S){var K=q[S];if(!(s.display&&mv(K))){var F=K.hasAttribute("data-v")?K.getAttribute("data-v"):K.hasAttribute("v")?K.getAttribute("v"):R4(K.innerHTML),X=K.getAttribute("data-z")||K.getAttribute("z");for(_=0;_<v.length;++_){var z=v[_];z.s.c==k+o&&z.s.r<w+i&&w+i<=z.e.r&&(k=z.e.c+1-o,_=-1)}O=+K.getAttribute("colspan")||1,((M=+K.getAttribute("rowspan")||1)>1||O>1)&&v.push({s:{r:w+i,c:k+o},e:{r:w+i+(M||1)-1,c:k+o+(O||1)-1}});var ne={t:"s",v:F},oe=K.getAttribute("data-t")||K.getAttribute("t")||"";F!=null&&(F.length==0?ne.t=oe||"z":s.raw||F.trim().length==0||oe=="s"||(F==="TRUE"?ne={t:"b",v:!0}:F==="FALSE"?ne={t:"b",v:!1}:isNaN(ua(F))?isNaN(ho(F).getDate())||(ne={t:"d",v:Er(F)},s.cellDates||(ne={t:"n",v:Ir(ne.v)}),ne.z=s.dateNF||Dt[14]):ne={t:"n",v:ua(F)})),ne.z===void 0&&X!=null&&(ne.z=X);var fe="",W=K.getElementsByTagName("A");if(W&&W.length)for(var be=0;be<W.length&&!(W[be].hasAttribute("href")&&(fe=W[be].getAttribute("href"),fe.charAt(0)!="#"));++be);fe&&fe.charAt(0)!="#"&&(ne.l={Target:fe}),s.dense?(r[w+i]||(r[w+i]=[]),r[w+i][k+o]=ne):r[ht({c:k+o,r:w+i})]=ne,m.e.c<k+o&&(m.e.c=k+o),k+=O}}++w}return v.length&&(r["!merges"]=(r["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,w-1+i),r["!ref"]=Gt(m),w>=h&&(r["!fullref"]=Gt((m.e.r=f.length-E+w-1+i,m))),r}function v2(r,e){var t=e||{},s=t.dense?[]:{};return x2(s,r,e)}function ZR(r,e){return Ds(v2(r,e),e)}function mv(r){var e="",t=e6(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function e6(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var t6=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+go({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Vt+e}})(),gv=(function(){var r=function(o){return ft(o).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,s=function(o,c,f){var h=[];h.push('      <table:table table:name="'+ft(c.SheetNames[f])+`" table:style-name="ta1">
`);var m=0,x=0,v=Jr(o["!ref"]||"A1"),_=o["!merges"]||[],y=0,E=Array.isArray(o);if(o["!cols"])for(x=0;x<=v.e.c;++x)h.push("        <table:table-column"+(o["!cols"][x]?' table:style-name="co'+o["!cols"][x].ods+'"':"")+`></table:table-column>
`);var w="",S=o["!rows"]||[];for(m=0;m<v.s.r;++m)w=S[m]?' table:style-name="ro'+S[m].ods+'"':"",h.push("        <table:table-row"+w+`></table:table-row>
`);for(;m<=v.e.r;++m){for(w=S[m]?' table:style-name="ro'+S[m].ods+'"':"",h.push("        <table:table-row"+w+`>
`),x=0;x<v.s.c;++x)h.push(e);for(;x<=v.e.c;++x){var k=!1,M={},O="";for(y=0;y!=_.length;++y)if(!(_[y].s.c>x)&&!(_[y].s.r>m)&&!(_[y].e.c<x)&&!(_[y].e.r<m)){(_[y].s.c!=x||_[y].s.r!=m)&&(k=!0),M["table:number-columns-spanned"]=_[y].e.c-_[y].s.c+1,M["table:number-rows-spanned"]=_[y].e.r-_[y].s.r+1;break}if(k){h.push(t);continue}var G=ht({r:m,c:x}),q=E?(o[m]||[])[x]:o[G];if(q&&q.f&&(M["table:formula"]=ft(wO(q.f)),q.F&&q.F.slice(0,G.length)==G)){var K=Jr(q.F);M["table:number-matrix-columns-spanned"]=K.e.c-K.s.c+1,M["table:number-matrix-rows-spanned"]=K.e.r-K.s.r+1}if(!q){h.push(e);continue}switch(q.t){case"b":O=q.v?"TRUE":"FALSE",M["office:value-type"]="boolean",M["office:boolean-value"]=q.v?"true":"false";break;case"n":O=q.w||String(q.v||0),M["office:value-type"]="float",M["office:value"]=q.v||0;break;case"s":case"str":O=q.v==null?"":q.v,M["office:value-type"]="string";break;case"d":O=q.w||Er(q.v).toISOString(),M["office:value-type"]="date",M["office:date-value"]=Er(q.v).toISOString(),M["table:style-name"]="ce1";break;default:h.push(e);continue}var F=r(O);if(q.l&&q.l.Target){var X=q.l.Target;X=X.charAt(0)=="#"?"#"+bO(X.slice(1)):X,X.charAt(0)!="#"&&!X.match(/^\w+:/)&&(X="../"+X),F=Re("text:a",F,{"xlink:href":X.replace(/&/g,"&amp;")})}h.push("          "+Re("table:table-cell",Re("text:p",F,{}),M)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},i=function(o,c){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var f=0;c.SheetNames.map(function(m){return c.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var x=0;x<m["!cols"].length;++x)if(m["!cols"][x]){var v=m["!cols"][x];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Pd(v),v.ods=f;var _=m["!cols"][x].wpx+"px";o.push('  <style:style style:name="co'+f+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),o.push(`  </style:style>
`),++f}}});var h=0;c.SheetNames.map(function(m){return c.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var x=0;x<m["!rows"].length;++x)if(m["!rows"][x]){m["!rows"][x].ods=h;var v=m["!rows"][x].hpx+"px";o.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++h}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(c,f){var h=[Vt],m=go({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=go({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(h.push("<office:document"+m+x+`>
`),h.push(Dy().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+m+`>
`),i(h,c),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var v=0;v!=c.SheetNames.length;++v)h.push(s(c.Sheets[c.SheetNames[v]],c,v));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),f.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function _2(r,e){if(e.bookType=="fods")return gv(r,e);var t=Cd(),s="",i=[],o=[];return s="mimetype",Ye(t,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Ye(t,s,gv(r,e)),i.push([s,"text/xml"]),o.push([s,"ContentFile"]),s="styles.xml",Ye(t,s,t6(r,e)),i.push([s,"text/xml"]),o.push([s,"StylesFile"]),s="meta.xml",Ye(t,s,Vt+Dy()),i.push([s,"text/xml"]),o.push([s,"MetadataFile"]),s="manifest.rdf",Ye(t,s,dA(o)),i.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Ye(t,s,fA(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Pu(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function r6(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):An(mo(r))}function n6(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var s=0;s<e.length;++s)if(r[t+s]!=e[s])continue e;return!0}return!1}function Ya(r){var e=r.reduce(function(i,o){return i+o.length},0),t=new Uint8Array(e),s=0;return r.forEach(function(i){t.set(i,s),s+=i.length}),t}function a6(r,e,t){var s=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,s-6176);r[e+15]|=s>>7,r[e+14]|=(s&127)<<1;for(var o=0;i>=1;++o,i/=256)r[e+o]=i&255;r[e+15]|=t>=0?0:128}function po(r,e){var t=e?e[0]:0,s=r[t]&127;e:if(r[t++]>=128&&(s|=(r[t]&127)<<7,r[t++]<128||(s|=(r[t]&127)<<14,r[t++]<128)||(s|=(r[t]&127)<<21,r[t++]<128)||(s+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(s+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(s+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),s}function ct(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Mi(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Kt(r){for(var e=[],t=[0];t[0]<r.length;){var s=t[0],i=po(r,t),o=i&7;i=Math.floor(i/8);var c=0,f;if(i==0)break;switch(o){case 0:{for(var h=t[0];r[t[0]++]>=128;);f=r.slice(h,t[0])}break;case 5:c=4,f=r.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,f=r.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=po(r,t),f=r.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(s))}var m={data:f,type:o};e[i]==null?e[i]=[m]:e[i].push(m)}return e}function ir(r){var e=[];return r.forEach(function(t,s){t.forEach(function(i){i.data&&(e.push(ct(s*8+i.type)),i.type==2&&e.push(ct(i.data.length)),e.push(i.data))})}),Ya(e)}function _n(r){for(var e,t=[],s=[0];s[0]<r.length;){var i=po(r,s),o=Kt(r.slice(s[0],s[0]+i));s[0]+=i;var c={id:Mi(o[1][0].data),messages:[]};o[2].forEach(function(f){var h=Kt(f.data),m=Mi(h[3][0].data);c.messages.push({meta:h,data:r.slice(s[0],s[0]+m)}),s[0]+=m}),(e=o[3])!=null&&e[0]&&(c.merge=Mi(o[3][0].data)>>>0>0),t.push(c)}return t}function Ai(r){var e=[];return r.forEach(function(t){var s=[];s[1]=[{data:ct(t.id),type:0}],s[2]=[],t.merge!=null&&(s[3]=[{data:ct(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(c){i.push(c.data),c.meta[3]=[{type:0,data:ct(c.data.length)}],s[2].push({data:ir(c.meta),type:2})});var o=ir(s);e.push(ct(o.length)),e.push(o),i.forEach(function(c){return e.push(c)})}),Ya(e)}function s6(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],s=po(e,t),i=[];t[0]<e.length;){var o=e[t[0]]&3;if(o==0){var c=e[t[0]++]>>2;if(c<60)++c;else{var f=c-59;c=e[t[0]],f>1&&(c|=e[t[0]+1]<<8),f>2&&(c|=e[t[0]+2]<<16),f>3&&(c|=e[t[0]+3]<<24),c>>>=0,c++,t[0]+=f}i.push(e.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var h=0,m=0;if(o==1?(m=(e[t[0]]>>2&7)+4,h=(e[t[0]++]&224)<<3,h|=e[t[0]++]):(m=(e[t[0]++]>>2)+1,o==2?(h=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(h=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Ya(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(m>=h)for(i.push(i[0].slice(-h)),m-=h;m>=i[i.length-1].length;)i.push(i[i.length-1]),m-=i[i.length-1].length;i.push(i[0].slice(-h,-h+m))}}var x=Ya(i);if(x.length!=s)throw new Error("Unexpected length: ".concat(x.length," != ").concat(s));return x}function yn(r){for(var e=[],t=0;t<r.length;){var s=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(s6(s,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return Ya(e)}function Ni(r){for(var e=[],t=0;t<r.length;){var s=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var o=ct(s),c=o.length;e.push(o),s<=60?(c++,e.push(new Uint8Array([s-1<<2]))):s<=256?(c+=2,e.push(new Uint8Array([240,s-1&255]))):s<=65536?(c+=3,e.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(c+=4,e.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(c+=5,e.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),e.push(r.slice(t,t+s)),c+=s,i[0]=0,i[1]=c&255,i[2]=c>>8&255,i[3]=c>>16&255,t+=s}return Ya(e)}function Mh(r,e){var t=new Uint8Array(32),s=Pu(t),i=12,o=0;switch(t[0]=5,r.t){case"n":t[1]=2,a6(t,i,r.v),o|=1,i+=16;break;case"b":t[1]=6,s.setFloat64(i,r.v?1:0,!0),o|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,s.setUint32(i,e.indexOf(r.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return s.setUint32(8,o,!0),t.slice(0,i)}function Uh(r,e){var t=new Uint8Array(32),s=Pu(t),i=12,o=0;switch(t[0]=3,r.t){case"n":t[2]=2,s.setFloat64(i,r.v,!0),o|=32,i+=8;break;case"b":t[2]=6,s.setFloat64(i,r.v?1:0,!0),o|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,s.setUint32(i,e.indexOf(r.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return s.setUint32(4,o,!0),t.slice(0,i)}function Ha(r){var e=Kt(r);return po(e[1][0].data)}function i6(r,e,t){var s,i,o,c;if(!((s=r[6])!=null&&s[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var f=((c=(o=r[8])==null?void 0:o[0])==null?void 0:c.data)&&Mi(r[8][0].data)>0||!1;if(f)throw"Math only works with normal offsets";for(var h=0,m=Pu(r[7][0].data),x=0,v=[],_=Pu(r[4][0].data),y=0,E=[],w=0;w<e.length;++w){if(e[w]==null){m.setUint16(w*2,65535,!0),_.setUint16(w*2,65535);continue}m.setUint16(w*2,x,!0),_.setUint16(w*2,y,!0);var S,k;switch(typeof e[w]){case"string":S=Mh({t:"s",v:e[w]},t),k=Uh({t:"s",v:e[w]},t);break;case"number":S=Mh({t:"n",v:e[w]},t),k=Uh({t:"n",v:e[w]},t);break;case"boolean":S=Mh({t:"b",v:e[w]},t),k=Uh({t:"b",v:e[w]},t);break;default:throw new Error("Unsupported value "+e[w])}v.push(S),x+=S.length,E.push(k),y+=k.length,++h}for(r[2][0].data=ct(h);w<r[7][0].data.length/2;++w)m.setUint16(w*2,65535,!0),_.setUint16(w*2,65535,!0);return r[6][0].data=Ya(v),r[3][0].data=Ya(E),h}function l6(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Jr(t["!ref"]);s.s.r=s.s.c=0;var i=!1;s.e.c>9&&(i=!0,s.e.c=9),s.e.r>49&&(i=!0,s.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Gt(s)));var o=zu(t,{range:s,header:1}),c=["~Sh33tJ5~"];o.forEach(function(P){return P.forEach(function(C){typeof C=="string"&&c.push(C)})});var f={},h=[],m=xt.read(e.numbers,{type:"base64"});m.FileIndex.map(function(P,C){return[P,m.FullPaths[C]]}).forEach(function(P){var C=P[0],I=P[1];if(C.type==2&&C.name.match(/\.iwa/)){var Z=C.content,ye=yn(Z),De=_n(ye);De.forEach(function(Ae){h.push(Ae.id),f[Ae.id]={deps:[],location:I,type:Mi(Ae.messages[0].meta[1][0].data)}})}}),h.sort(function(P,C){return P-C});var x=h.filter(function(P){return P>1}).map(function(P){return[P,ct(P)]});m.FileIndex.map(function(P,C){return[P,m.FullPaths[C]]}).forEach(function(P){var C=P[0];if(P[1],!!C.name.match(/\.iwa/)){var I=_n(yn(C.content));I.forEach(function(Z){Z.messages.forEach(function(ye){x.forEach(function(De){Z.messages.some(function(Ae){return Mi(Ae.meta[1][0].data)!=11006&&n6(Ae.data,De[1])})&&f[De[0]].deps.push(Z.id)})})})}});for(var v=xt.find(m,f[1].location),_=_n(yn(v.content)),y,E=0;E<_.length;++E){var w=_[E];w.id==1&&(y=w)}var S=Ha(Kt(y.messages[0].data)[1][0].data);for(v=xt.find(m,f[S].location),_=_n(yn(v.content)),E=0;E<_.length;++E)w=_[E],w.id==S&&(y=w);for(S=Ha(Kt(y.messages[0].data)[2][0].data),v=xt.find(m,f[S].location),_=_n(yn(v.content)),E=0;E<_.length;++E)w=_[E],w.id==S&&(y=w);for(S=Ha(Kt(y.messages[0].data)[2][0].data),v=xt.find(m,f[S].location),_=_n(yn(v.content)),E=0;E<_.length;++E)w=_[E],w.id==S&&(y=w);var k=Kt(y.messages[0].data);{k[6][0].data=ct(s.e.r+1),k[7][0].data=ct(s.e.c+1);var M=Ha(k[46][0].data),O=xt.find(m,f[M].location),G=_n(yn(O.content));{for(var q=0;q<G.length&&G[q].id!=M;++q);if(G[q].id!=M)throw"Bad ColumnRowUIDMapArchive";var K=Kt(G[q].messages[0].data);K[1]=[],K[2]=[],K[3]=[];for(var F=0;F<=s.e.c;++F){var X=[];X[1]=X[2]=[{type:0,data:ct(F+420690)}],K[1].push({type:2,data:ir(X)}),K[2].push({type:0,data:ct(F)}),K[3].push({type:0,data:ct(F)})}K[4]=[],K[5]=[],K[6]=[];for(var z=0;z<=s.e.r;++z)X=[],X[1]=X[2]=[{type:0,data:ct(z+726270)}],K[4].push({type:2,data:ir(X)}),K[5].push({type:0,data:ct(z)}),K[6].push({type:0,data:ct(z)});G[q].messages[0].data=ir(K)}O.content=Ni(Ai(G)),O.size=O.content.length,delete k[46];var ne=Kt(k[4][0].data);{ne[7][0].data=ct(s.e.r+1);var oe=Kt(ne[1][0].data),fe=Ha(oe[2][0].data);O=xt.find(m,f[fe].location),G=_n(yn(O.content));{if(G[0].id!=fe)throw"Bad HeaderStorageBucket";var W=Kt(G[0].messages[0].data);for(z=0;z<o.length;++z){var be=Kt(W[2][0].data);be[1][0].data=ct(z),be[4][0].data=ct(o[z].length),W[2][z]={type:W[2][0].type,data:ir(be)}}G[0].messages[0].data=ir(W)}O.content=Ni(Ai(G)),O.size=O.content.length;var Ee=Ha(ne[2][0].data);O=xt.find(m,f[Ee].location),G=_n(yn(O.content));{if(G[0].id!=Ee)throw"Bad HeaderStorageBucket";for(W=Kt(G[0].messages[0].data),F=0;F<=s.e.c;++F)be=Kt(W[2][0].data),be[1][0].data=ct(F),be[4][0].data=ct(s.e.r+1),W[2][F]={type:W[2][0].type,data:ir(be)};G[0].messages[0].data=ir(W)}O.content=Ni(Ai(G)),O.size=O.content.length;var J=Ha(ne[4][0].data);(function(){for(var P=xt.find(m,f[J].location),C=_n(yn(P.content)),I,Z=0;Z<C.length;++Z){var ye=C[Z];ye.id==J&&(I=ye)}var De=Kt(I.messages[0].data);{De[3]=[];var Ae=[];c.forEach(function(we,Ve){Ae[1]=[{type:0,data:ct(Ve)}],Ae[2]=[{type:0,data:ct(1)}],Ae[3]=[{type:2,data:r6(we)}],De[3].push({type:2,data:ir(Ae)})})}I.messages[0].data=ir(De);var Oe=Ai(C),qe=Ni(Oe);P.content=qe,P.size=P.content.length})();var ve=Kt(ne[3][0].data);{var le=ve[1][0];delete ve[2];var Ne=Kt(le.data);{var ce=Ha(Ne[2][0].data);(function(){for(var P=xt.find(m,f[ce].location),C=_n(yn(P.content)),I,Z=0;Z<C.length;++Z){var ye=C[Z];ye.id==ce&&(I=ye)}var De=Kt(I.messages[0].data);{delete De[6],delete ve[7];var Ae=new Uint8Array(De[5][0].data);De[5]=[];for(var Oe=0,qe=0;qe<=s.e.r;++qe){var we=Kt(Ae);Oe+=i6(we,o[qe],c),we[1][0].data=ct(qe),De[5].push({data:ir(we),type:2})}De[1]=[{type:0,data:ct(s.e.c+1)}],De[2]=[{type:0,data:ct(s.e.r+1)}],De[3]=[{type:0,data:ct(Oe)}],De[4]=[{type:0,data:ct(s.e.r+1)}]}I.messages[0].data=ir(De);var Ve=Ai(C),He=Ni(Ve);P.content=He,P.size=P.content.length})()}le.data=ir(Ne)}ne[3][0].data=ir(ve)}k[4][0].data=ir(ne)}y.messages[0].data=ir(k);var U=Ai(_),N=Ni(U);return v.content=N,v.size=v.content.length,m}function o6(r){return function(t){for(var s=0;s!=r.length;++s){var i=r[s];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Vd(r){o6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function c6(r,e){return e.bookType=="ods"?_2(r,e):e.bookType=="numbers"?l6(r,e):e.bookType=="xlsb"?u6(r,e):f6(r,e)}function u6(r,e){ki=1024,r&&!r.SSF&&(r.SSF=Br(Dt)),r&&r.SSF&&(Ju(),Yu(r.SSF),e.revssf=Qu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,so?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",s=t2.indexOf(e.bookType)>-1,i=Ry();Vd(e=e||{});var o=Cd(),c="",f=0;if(e.cellXfs=[],Ja(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),c="docProps/core.xml",Ye(o,c,Fy(r.Props,e)),i.coreprops.push(c),ut(e.rels,2,c,at.CORE_PROPS),c="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var h=[],m=0;m<r.SheetNames.length;++m)(r.Workbook.Sheets[m]||{}).Hidden!=2&&h.push(r.SheetNames[m]);r.Props.SheetNames=h}for(r.Props.Worksheets=r.Props.SheetNames.length,Ye(o,c,Iy(r.Props)),i.extprops.push(c),ut(e.rels,3,c,at.EXT_PROPS),r.Custprops!==r.Props&&fr(r.Custprops||{}).length>0&&(c="docProps/custom.xml",Ye(o,c,By(r.Custprops)),i.custprops.push(c),ut(e.rels,4,c,at.CUST_PROPS)),f=1;f<=r.SheetNames.length;++f){var x={"!id":{}},v=r.Sheets[r.SheetNames[f-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:c="xl/worksheets/sheet"+f+"."+t,Ye(o,c,dR(f-1,c,e,r,x)),i.sheets.push(c),ut(e.wbrels,-1,"worksheets/sheet"+f+"."+t,at.WS[0])}if(v){var y=v["!comments"],E=!1,w="";y&&y.length>0&&(w="xl/comments"+f+"."+t,Ye(o,w,pR(y,w)),i.comments.push(w),ut(x,-1,"../comments"+f+"."+t,at.CMNT),E=!0),v["!legacy"]&&E&&Ye(o,"xl/drawings/vmlDrawing"+f+".vml",Zy(f,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&Ye(o,ky(c),Ii(x))}return e.Strings!=null&&e.Strings.length>0&&(c="xl/sharedStrings."+t,Ye(o,c,gR(e.Strings,c,e)),i.strs.push(c),ut(e.wbrels,-1,"sharedStrings."+t,at.SST)),c="xl/workbook."+t,Ye(o,c,hR(r,c)),i.workbooks.push(c),ut(e.rels,1,c,at.WB),c="xl/theme/theme1.xml",Ye(o,c,Jy(r.Themes,e)),i.themes.push(c),ut(e.wbrels,-1,"theme/theme1.xml",at.THEME),c="xl/styles."+t,Ye(o,c,mR(r,c,e)),i.styles.push(c),ut(e.wbrels,-1,"styles."+t,at.STY),r.vbaraw&&s&&(c="xl/vbaProject.bin",Ye(o,c,r.vbaraw),i.vba.push(c),ut(e.wbrels,-1,"vbaProject.bin",at.VBA)),c="xl/metadata."+t,Ye(o,c,xR(c)),i.metadata.push(c),ut(e.wbrels,-1,"metadata."+t,at.XLMETA),Ye(o,"[Content_Types].xml",jy(i,e)),Ye(o,"_rels/.rels",Ii(e.rels)),Ye(o,"xl/_rels/workbook."+t+".rels",Ii(e.wbrels)),delete e.revssf,delete e.ssf,o}function f6(r,e){ki=1024,r&&!r.SSF&&(r.SSF=Br(Dt)),r&&r.SSF&&(Ju(),Yu(r.SSF),e.revssf=Qu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,so?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",s=t2.indexOf(e.bookType)>-1,i=Ry();Vd(e=e||{});var o=Cd(),c="",f=0;if(e.cellXfs=[],Ja(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),c="docProps/core.xml",Ye(o,c,Fy(r.Props,e)),i.coreprops.push(c),ut(e.rels,2,c,at.CORE_PROPS),c="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var h=[],m=0;m<r.SheetNames.length;++m)(r.Workbook.Sheets[m]||{}).Hidden!=2&&h.push(r.SheetNames[m]);r.Props.SheetNames=h}r.Props.Worksheets=r.Props.SheetNames.length,Ye(o,c,Iy(r.Props)),i.extprops.push(c),ut(e.rels,3,c,at.EXT_PROPS),r.Custprops!==r.Props&&fr(r.Custprops||{}).length>0&&(c="docProps/custom.xml",Ye(o,c,By(r.Custprops)),i.custprops.push(c),ut(e.rels,4,c,at.CUST_PROPS));var x=["SheetJ5"];for(e.tcid=0,f=1;f<=r.SheetNames.length;++f){var v={"!id":{}},_=r.Sheets[r.SheetNames[f-1]],y=(_||{})["!type"]||"sheet";switch(y){case"chart":default:c="xl/worksheets/sheet"+f+"."+t,Ye(o,c,u2(f-1,e,r,v)),i.sheets.push(c),ut(e.wbrels,-1,"worksheets/sheet"+f+"."+t,at.WS[0])}if(_){var E=_["!comments"],w=!1,S="";if(E&&E.length>0){var k=!1;E.forEach(function(M){M[1].forEach(function(O){O.T==!0&&(k=!0)})}),k&&(S="xl/threadedComments/threadedComment"+f+"."+t,Ye(o,S,H3(E,x,e)),i.threadedcomments.push(S),ut(v,-1,"../threadedComments/threadedComment"+f+"."+t,at.TCMNT)),S="xl/comments"+f+"."+t,Ye(o,S,e2(E)),i.comments.push(S),ut(v,-1,"../comments"+f+"."+t,at.CMNT),w=!0}_["!legacy"]&&w&&Ye(o,"xl/drawings/vmlDrawing"+f+".vml",Zy(f,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&Ye(o,ky(c),Ii(v))}return e.Strings!=null&&e.Strings.length>0&&(c="xl/sharedStrings."+t,Ye(o,c,Vy(e.Strings,e)),i.strs.push(c),ut(e.wbrels,-1,"sharedStrings."+t,at.SST)),c="xl/workbook."+t,Ye(o,c,d2(r)),i.workbooks.push(c),ut(e.rels,1,c,at.WB),c="xl/theme/theme1.xml",Ye(o,c,Jy(r.Themes,e)),i.themes.push(c),ut(e.wbrels,-1,"theme/theme1.xml",at.THEME),c="xl/styles."+t,Ye(o,c,Xy(r,e)),i.styles.push(c),ut(e.wbrels,-1,"styles."+t,at.STY),r.vbaraw&&s&&(c="xl/vbaProject.bin",Ye(o,c,r.vbaraw),i.vba.push(c),ut(e.wbrels,-1,"vbaProject.bin",at.VBA)),c="xl/metadata."+t,Ye(o,c,Qy()),i.metadata.push(c),ut(e.wbrels,-1,"metadata."+t,at.XLMETA),x.length>1&&(c="xl/persons/person.xml",Ye(o,c,$3(x)),i.people.push(c),ut(e.wbrels,-1,"persons/person.xml",at.PEOPLE)),Ye(o,"[Content_Types].xml",jy(i,e)),Ye(o,"_rels/.rels",Ii(e.rels)),Ye(o,"xl/_rels/workbook."+t+".rels",Ii(e.wbrels)),delete e.revssf,delete e.ssf,o}function h6(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=ha(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function y2(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return So(e.file,xt.write(r,{type:it?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return xt.write(r,e)}function d6(r,e){var t=Br(e||{}),s=c6(r,t);return m6(s,t)}function m6(r,e){var t={},s=it?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=s;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=s;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?xt.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Xu(i))}return e.password&&typeof encrypt_agile<"u"?y2(encrypt_agile(i,e.password),e):e.type==="file"?So(e.file,i):e.type=="string"?to(i):i}function g6(r,e){var t=e||{},s=jR(r,t);return y2(s,t)}function Ln(r,e,t){t||(t="");var s=t+r;switch(e.type){case"base64":return fo(mo(s));case"binary":return mo(s);case"string":return r;case"file":return So(e.file,s,"utf8");case"buffer":return it?ga(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Ln(s,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function p6(r,e){switch(e.type){case"base64":return fo(r);case"binary":return r;case"string":return r;case"file":return So(e.file,r,"binary");case"buffer":return it?ga(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function uu(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",s=0;s<r.length;++s)t+=String.fromCharCode(r[s]);return e.type=="base64"?fo(t):e.type=="string"?to(t):t;case"file":return So(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function Ui(r,e){GT(),tR(r);var t=Br(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var s=Ui(r,t);return t.type="array",Xu(s)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ln(CR(r,t),t);case"slk":case"sylk":return Ln(QA.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return Ln(p2(r.Sheets[r.SheetNames[i]],t),t);case"txt":return p6(w2(r.Sheets[r.SheetNames[i]],t),t);case"csv":return Ln(qd(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return Ln(ZA.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return uu(JA.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return Ln(e3.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return Ln(l3.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return Ln(Gy.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return Ln(_2(r,t),t);case"wk1":return uu(ov.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return uu(ov.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),uu(g2(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),g6(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return d6(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function x6(r,e,t,s,i,o,c,f){var h=ur(t),m=f.defval,x=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),v=!0,_=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:t,enumerable:!1})}catch{_.__rowNum__=t}else _.__rowNum__=t;if(!c||r[t])for(var y=e.s.c;y<=e.e.c;++y){var E=c?r[t][y]:r[s[y]+h];if(E===void 0||E.t===void 0){if(m===void 0)continue;o[y]!=null&&(_[o[y]]=m);continue}var w=E.v;switch(E.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(o[y]!=null){if(w==null)if(E.t=="e"&&w===null)_[o[y]]=null;else if(m!==void 0)_[o[y]]=m;else if(x&&w===null)_[o[y]]=null;else continue;else _[o[y]]=x&&(E.t!=="n"||E.t==="n"&&f.rawNumbers!==!1)?w:da(E,w,f);w!=null&&(v=!1)}}return{row:_,isempty:v}}function zu(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},s=0,i=1,o=[],c=0,f="",h={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},x=m.range!=null?m.range:r["!ref"];switch(m.header===1?s=1:m.header==="A"?s=2:Array.isArray(m.header)?s=3:m.header==null&&(s=0),typeof x){case"string":h=At(x);break;case"number":h=At(r["!ref"]),h.s.r=x;break;default:h=x}s>0&&(i=0);var v=ur(h.s.r),_=[],y=[],E=0,w=0,S=Array.isArray(r),k=h.s.r,M=0,O={};S&&!r[k]&&(r[k]=[]);var G=m.skipHidden&&r["!cols"]||[],q=m.skipHidden&&r["!rows"]||[];for(M=h.s.c;M<=h.e.c;++M)if(!(G[M]||{}).hidden)switch(_[M]=gr(M),t=S?r[k][M]:r[_[M]+v],s){case 1:o[M]=M-h.s.c;break;case 2:o[M]=_[M];break;case 3:o[M]=m.header[M-h.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),f=c=da(t,null,m),w=O[c]||0,!w)O[c]=1;else{do f=c+"_"+w++;while(O[f]);O[c]=w,O[f]=1}o[M]=f}for(k=h.s.r+i;k<=h.e.r;++k)if(!(q[k]||{}).hidden){var K=x6(r,h,k,_,s,o,S,m);(K.isempty===!1||(s===1?m.blankrows!==!1:m.blankrows))&&(y[E++]=K.row)}return y.length=E,y}var pv=/"/g;function v6(r,e,t,s,i,o,c,f){for(var h=!0,m=[],x="",v=ur(t),_=e.s.c;_<=e.e.c;++_)if(s[_]){var y=f.dense?(r[t]||[])[_]:r[s[_]+v];if(y==null)x="";else if(y.v!=null){h=!1,x=""+(f.rawNumbers&&y.t=="n"?y.v:da(y,null,f));for(var E=0,w=0;E!==x.length;++E)if((w=x.charCodeAt(E))===i||w===o||w===34||f.forceQuotes){x='"'+x.replace(pv,'""')+'"';break}x=="ID"&&(x='"ID"')}else y.f!=null&&!y.F?(h=!1,x="="+y.f,x.indexOf(",")>=0&&(x='"'+x.replace(pv,'""')+'"')):x="";m.push(x)}return f.blankrows===!1&&h?null:m.join(c)}function qd(r,e){var t=[],s=e??{};if(r==null||r["!ref"]==null)return"";var i=At(r["!ref"]),o=s.FS!==void 0?s.FS:",",c=o.charCodeAt(0),f=s.RS!==void 0?s.RS:`
`,h=f.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),x="",v=[];s.dense=Array.isArray(r);for(var _=s.skipHidden&&r["!cols"]||[],y=s.skipHidden&&r["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(_[E]||{}).hidden||(v[E]=gr(E));for(var w=0,S=i.s.r;S<=i.e.r;++S)(y[S]||{}).hidden||(x=v6(r,i,S,v,c,h,o,s),x!=null&&(s.strip&&(x=x.replace(m,"")),(x||s.blankrows!==!1)&&t.push((w++?f:"")+x)));return delete s.dense,t.join("")}function w2(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=qd(r,e);return t}function _6(r){var e="",t,s="";if(r==null||r["!ref"]==null)return[];var i=At(r["!ref"]),o="",c=[],f,h=[],m=Array.isArray(r);for(f=i.s.c;f<=i.e.c;++f)c[f]=gr(f);for(var x=i.s.r;x<=i.e.r;++x)for(o=ur(x),f=i.s.c;f<=i.e.c;++f)if(e=c[f]+o,t=m?(r[x]||[])[f]:r[e],s="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;s=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)s=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)s=""+t.v;else if(t.t=="b")s=t.v?"TRUE":"FALSE";else if(t.w!==void 0)s="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?s="'"+t.v:s=""+t.v}}h[h.length]=e+"="+s}return h}function b2(r,e,t){var s=t||{},i=+!s.skipHeader,o=r||{},c=0,f=0;if(o&&s.origin!=null)if(typeof s.origin=="number")c=s.origin;else{var h=typeof s.origin=="string"?Jt(s.origin):s.origin;c=h.r,f=h.c}var m,x={s:{c:0,r:0},e:{c:f,r:c+e.length-1+i}};if(o["!ref"]){var v=At(o["!ref"]);x.e.c=Math.max(x.e.c,v.e.c),x.e.r=Math.max(x.e.r,v.e.r),c==-1&&(c=v.e.r+1,x.e.r=c+e.length-1+i)}else c==-1&&(c=0,x.e.r=e.length-1+i);var _=s.header||[],y=0;e.forEach(function(w,S){fr(w).forEach(function(k){(y=_.indexOf(k))==-1&&(_[y=_.length]=k);var M=w[k],O="z",G="",q=ht({c:f+y,r:c+S+i});m=xo(o,q),M&&typeof M=="object"&&!(M instanceof Date)?o[q]=M:(typeof M=="number"?O="n":typeof M=="boolean"?O="b":typeof M=="string"?O="s":M instanceof Date?(O="d",s.cellDates||(O="n",M=Ir(M)),G=s.dateNF||Dt[14]):M===null&&s.nullError&&(O="e",M=0),m?(m.t=O,m.v=M,delete m.w,delete m.R,G&&(m.z=G)):o[q]=m={t:O,v:M},G&&(m.z=G))})}),x.e.c=Math.max(x.e.c,f+_.length-1);var E=ur(c);if(i)for(y=0;y<_.length;++y)o[gr(y+f)+E]={t:"s",v:_[y]};return o["!ref"]=Gt(x),o}function y6(r,e){return b2(null,r,e)}function xo(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var s=Jt(e);return r[s.r]||(r[s.r]=[]),r[s.r][s.c]||(r[s.r][s.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?xo(r,ht(e)):xo(r,ht({r:e,c:t||0}))}function w6(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function b6(){return{SheetNames:[],Sheets:{}}}function S6(r,e,t,s){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&r.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var c=o&&o[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=c+i)!=-1;++i);}if(h2(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function E6(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var s=w6(r,e);switch(r.Workbook.Sheets[s]||(r.Workbook.Sheets[s]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[s].Hidden=t}function T6(r,e){return r.z=e,r}function S2(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function A6(r,e,t){return S2(r,"#"+e,t)}function N6(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function O6(r,e,t,s){for(var i=typeof e!="string"?e:At(e),o=typeof e=="string"?e:Gt(e),c=i.s.r;c<=i.e.r;++c)for(var f=i.s.c;f<=i.e.c;++f){var h=xo(r,c,f);h.t="n",h.F=o,delete h.v,c==i.s.r&&f==i.s.c&&(h.f=t,s&&(h.D=!0))}return r}var Dr={encode_col:gr,encode_row:ur,encode_cell:ht,encode_range:Gt,decode_col:Ld,decode_row:Fd,split_cell:G4,decode_cell:Jt,decode_range:Jr,format_cell:da,sheet_add_aoa:Ey,sheet_add_json:b2,sheet_add_dom:x2,aoa_to_sheet:Wi,json_to_sheet:y6,table_to_sheet:v2,table_to_book:ZR,sheet_to_csv:qd,sheet_to_txt:w2,sheet_to_json:zu,sheet_to_html:p2,sheet_to_formulae:_6,sheet_to_row_object_array:zu,sheet_get_cell:xo,book_new:b6,book_append_sheet:S6,book_set_sheet_visibility:E6,cell_set_number_format:T6,cell_set_hyperlink:S2,cell_set_internal_link:A6,cell_add_comment:N6,sheet_set_array_formula:O6,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ph="zebra_print_history_v1";function E2(){const[r,e]=pe.useState([]);pe.useEffect(()=>{(async()=>{try{const F=await Tn.getService().getHistory();if(F.length>0){e(F);return}}catch(K){console.error("History Load Error",K)}try{const K=localStorage.getItem(Ph);K&&e(JSON.parse(K))}catch(K){console.error("Failed to load history",K)}})()},[]);const t=async q=>{const K=[q,...r].slice(0,100);e(K),localStorage.setItem(Ph,JSON.stringify(K));try{await Tn.getService().addToHistory(q)}catch(F){console.error("Failed to save to DataService",F)}},s=()=>{window.confirm(" ,    ?")&&(e([]),localStorage.removeItem(Ph))},[i,o]=pe.useState({count:0,totalWeight:0}),[c,f]=pe.useState([]),h=q=>{if(!q)return new Date;if(q.includes("T")||q.includes("-"))return new Date(q);const K=q.split(".");return K.length===3?new Date(parseInt(K[2]),parseInt(K[1])-1,parseInt(K[0])):new Date(q)};async function m(q,K){let F=[];try{F=await Tn.getService().getReportData(q,K)}catch(z){console.warn("DataManager report generation failed, falling back to local state",z)}F.length===0&&r.length>0&&(console.log("Using local history state for report generation"),F=r.filter(z=>{const ne=h(z.date);return ne>=q&&ne<=K}));try{const z=localStorage.getItem("zebra_deferred_queue_v1");if(z){const oe=JSON.parse(z).filter(fe=>{const W=fe.timestamp||fe.date,be=W.includes("T")?new Date(W):h(fe.date);return be>=q&&be<=K});F=[...F,...oe],F.sort((fe,W)=>{const be=new Date(fe.timestamp||h(fe.date)).getTime();return new Date(W.timestamp||h(W.date)).getTime()-be})}}catch(z){console.error("Failed to merge deferred queue into report",z)}f(F);const X=F.reduce((z,ne)=>z+(parseFloat(ne.weight)||0),0);return o({count:F.length,totalWeight:parseFloat(X.toFixed(3))}),F}const x=q=>q.map(K=>{var ne,oe;let F=h(K.date);K.timestamp&&(F=new Date(K.timestamp));const z={ok:"",error:"",cancelled:"",deferred:""}[K.status||"ok"]||K.status||"OK";return{:F.toLocaleDateString("uk-UA"),:F.toLocaleTimeString("uk-UA"),:((ne=K.product)==null?void 0:ne.name)||"",SKU:((oe=K.product)==null?void 0:oe.sku)||"","":K.serialNumber,"/":K.sortValue||""," ()":Number(K.weight),"-":K.barcode||"",:z}}),v=q=>{const K=x(q),F=Dr.json_to_sheet(K),X=Dr.book_new();Dr.book_append_sheet(X,F,"Report");const z=Ui(X,{bookType:"xlsx",type:"array"}),ne=new Blob([z],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),oe=`Report_${new Date().toISOString().split("T")[0]}.xlsx`;return new File([ne],oe,{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})},_=(q=r)=>{const F=["","","","SKU","","/"," ()",""],X=x(q).map(z=>[z.,z.,z.,z.SKU,z[""],z["/"],z[" ()"],z.].map(ne=>`"${(ne||"").toString().replace(/"/g,'""')}"`).join(","));return"\uFEFF"+F.join(",")+`
`+X.join(`
`)},y=async(q=r)=>{if(q.length===0){alert("   ");return}if(Ka.isNativePlatform())try{const K=_(q),F=`ZebraReport_${Date.now()}.csv`;await Hh.writeFile({path:F,data:K,directory:io.Documents,encoding:pu.UTF8}),alert(` CSV : ${F}`)}catch(K){alert(" Error: "+K)}else{const K=_(q),F=new Blob([K],{type:"text/csv;charset=utf-8;"}),X=URL.createObjectURL(F),z=document.createElement("a");z.href=X,z.download="report.csv",z.click()}},E=async(q=r)=>{if(q.length===0){alert("   ");return}const K=`ZebraReport_${new Date().toISOString().split("T")[0]}_${Date.now()}.xlsx`,F=x(q),X=Dr.json_to_sheet(F),z=Dr.book_new();if(Dr.book_append_sheet(z,X,"Report"),Ka.isNativePlatform()){const ne=Ui(z,{bookType:"xlsx",type:"base64"});try{await Hh.writeFile({path:K,data:ne,directory:io.Documents}),alert(` Excel   Documents:
${K}`)}catch(oe){alert(" Excel save failed: "+oe)}}else{const ne=Ui(z,{bookType:"xlsx",type:"array"}),oe=new Blob([ne],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),fe=URL.createObjectURL(oe),W=document.createElement("a");W.href=fe,W.download=K,W.click()}},[w,S]=pe.useState("");return pe.useEffect(()=>{const q=localStorage.getItem("zebra_report_email_v1");q&&S(q)},[]),{history:r,checkDuplicate:(q,K)=>r.some(F=>{var X;return((X=F.product)==null?void 0:X.id)===q&&F.serialNumber===K}),addToHistory:t,addDummyData:async()=>{const q=[{id:"marijany_b8_hemp",name:"Marijany B8 Hemp",sku:"MJ-B8-HMP",category:"shiv"},{id:"marijany_classic",name:"Marijany Classic",sku:"MJ-CLS",category:"fiber"},{id:"marijany_gold",name:"Marijany Gold",sku:"MJ-GLD",category:"dust"}];for(let K=0;K<5;K++){const F=q[Math.floor(Math.random()*q.length)],X={id:crypto.randomUUID(),date:new Date().toISOString(),product:F,weight:(Math.random()*2+.5).toFixed(3),serialNumber:Math.floor(Math.random()*1e3)+1e3,sortLabel:Math.random()>.5?"1 ":"2 ",sortValue:"1",status:"ok"};await t(X)}alert(" 5    !")},clearHistory:s,exportCsv:y,exportXlsx:E,sendEmail:async(q=r)=>{if(q.length===0){alert("   ");return}const K=new Date().toLocaleDateString("uk-UA"),F=q.length,X=q.reduce((W,be)=>W+(parseFloat(be.weight)||0),0).toFixed(3),z=`  ${K}`,ne=`  ${K}
: ${F} 
: ${X} 

 .xlsx .`,oe=v(q),{EmailService:fe}=await Gu(async()=>{const{EmailService:W}=await import("./email-r0tL12qV.js");return{EmailService:W}},[],import.meta.url);if(fe.isConfigured()){const W=w||"";if(W)try{await fe.sendReport(q,W),alert(`  ( )   ${W}`);return}catch(be){if(console.error("EmailJS sending failed",be),!confirm("EmailJS .    ( )?"))return}}if(navigator.share&&navigator.canShare&&navigator.canShare({files:[oe]}))try{await navigator.share({title:z,text:ne,files:[oe]});return}catch(W){console.warn("Share failed",W)}await E(q),setTimeout(()=>{const be=`mailto:${w||""}?subject=${encodeURIComponent(z)}&body=${encodeURIComponent(ne+`

(   .  ,   .)`)}`;window.location.href=be},1e3)},reportEmail:w,setReportEmail:q=>{S(q),localStorage.setItem("zebra_report_email_v1",q)},generateReport:m,reportSummary:i,reportData:c}}const xv="zebra_deferred_queue_v1";function C6(){const[r,e]=pe.useState([]);pe.useEffect(()=>{try{const f=localStorage.getItem(xv);f&&e(JSON.parse(f))}catch(f){console.error("Failed to load deferred queue",f)}},[]);const t=f=>{e(f),localStorage.setItem(xv,JSON.stringify(f))};return{queue:r,addToQueue:f=>{const h=[...r,{...f,timestamp:new Date().toISOString(),status:"deferred"}];t(h)},removeFromQueue:f=>{const h=r.filter((m,x)=>x!==f);t(h)},clearQueue:()=>{window.confirm("   ?")&&t([])},clearQueueForce:()=>{t([])}}}const zh="zebra_product_counters_v1";function R6(){const{currentUser:r,login:e,logout:t,isAdmin:s}=wo(),[i,o]=pe.useState(null),[c,f]=pe.useState(""),[h,m]=pe.useState({}),[x,v]=pe.useState(!1),[_,y]=pe.useState(""),[E,w]=pe.useState(wv[0]),[S,k]=pe.useState(!1),[M,O]=pe.useState(!1),[G,q]=pe.useState(()=>{try{return localStorage.getItem("zebra_barcode_pattern_v1")||"{date}-{sku}-{serialNumber}-{weight}"}catch(we){return console.error("LocalStorage error:",we),"{date}-{sku}-{serialNumber}-{weight}"}}),K=Td(),F=E2(),X=C6(),{products:z}=H_();pe.useRef(0);const ne=pe.useRef(0),oe=pe.useRef(null),fe=new Date().toLocaleDateString("uk-UA"),[W,be]=pe.useState(""),[Ee,J]=pe.useState(""),[ve,le]=pe.useState("");pe.useEffect(()=>{(async()=>{try{const Ve="./logo_bw.png",He=await oa.convertImageToZPL(Ve,{width:80,height:80});J(He);const It=await oa.convertImageToZPL(Ve,{width:200,height:200});le(It),console.log("Logos converted to ZPL successfully")}catch(Ve){console.error("Failed to convert logos:",Ve)}})()},[]),pe.useEffect(()=>{i!=null&&i.sorts&&i.sorts.length>0?be(i.sorts[0]):be("")},[i]),pe.useEffect(()=>{try{const we=localStorage.getItem(zh);if(we)m(JSON.parse(we));else{const Ve={};(z.length>0?z:lo).forEach(It=>Ve[It.id]=Vl),m(Ve)}}catch(we){console.error("Failed to load counters",we)}},[z]),pe.useEffect(()=>{const we=Ve=>{Ve.key===zh&&Ve.newValue&&m(JSON.parse(Ve.newValue))};return window.addEventListener("storage",we),()=>window.removeEventListener("storage",we)},[]),pe.useEffect(()=>{try{localStorage.setItem(zh,JSON.stringify(h))}catch(we){console.error(we)}},[h]);const Ne=i?h[i.id]??Vl:Vl;let ce="Sort",U="____";const N=(r==null?void 0:r.role)==="operator",P=(i==null?void 0:i.category)==="shiv",C=(i==null?void 0:i.id)==="3";if(i){P&&(ce="Fract");let we=!1;N?C&&(we=!0):we=!0,we&&W&&(U=W)}const I={product:i,weight:c,serialNumber:Ne,date:fe,sortLabel:ce,sortValue:U},Z=we=>{we==="."&&c.includes(".")||c.length>6||f(Ve=>Ve+we)},ye=async(we,Ve)=>{var Qa,pa,vt,Un,Pn,zn,xr;const He=E.id==="100x100"?ve:Ee;let It=E.template;(((Qa=we.product)==null?void 0:Qa.id)==="2"||((pa=we.product)==null?void 0:pa.id)==="3")&&E.id==="100x100"&&(It=lS);const dt=oa.formatBarcode(G,{date:we.date,sku:((vt=we.product)==null?void 0:vt.sku)||"",serialNumber:we.serialNumber.toString(),weight:we.weight,productName:((Un=we.product)==null?void 0:Un.name)||"Unknown"}),Le={...we,barcode:dt},Zt=oa.generateZPL(It,{date:we.date,productName:((Pn=we.product)==null?void 0:Pn.name)||"Unknown",productNameEn:((zn=we.product)==null?void 0:zn.name_en)||"",sku:((xr=we.product)==null?void 0:xr.sku)||"",weight:we.weight,serialNumber:we.serialNumber.toString(),sortLabel:we.sortLabel||"",sortValue:we.sortValue||"",quantity:Ve,logoZpl:He,barcodePattern:G});let Wt=!1;K.printer?Wt=await oa.print(K.printer,Zt):(console.log(`--- MOCK PRINTING ZPL (${E.name}) - Copies: ${Ve} ---`),Wt=!0);let Mr=Wt?"ok":"error";const Qr=new Date().toISOString();return K.printer,F.addToHistory({...Le,timestamp:Qr,status:Mr}),Wt},De=async we=>{await ye(I,we)?(m(He=>({...He,[i.id]:(He[i.id]??Vl)+1})),f("")):alert(" .")},Ae=()=>{if(!i||!c){alert(" ,     .");return}ne.current+=1,oe.current||(oe.current=setTimeout(()=>{const we=ne.current,Ve=we>=2?2:1;console.log(`Print Timer Executed. Clicks: ${we}, Copies: ${Ve}`),De(Ve),ne.current=0,oe.current=null},1e3))},Oe=we=>{if(we.product){const Ve=z.find(He=>He.id===we.product.id)||we.product;o(Ve),m(He=>({...He,[Ve.id]:we.serialNumber}))}f(we.weight),k(!1)},qe=!i||!c;return g.jsxs("div",{className:"app-container",children:[g.jsx(PT,{isOpen:S,onClose:()=>k(!1),printerData:K,isAdmin:(r==null?void 0:r.role)==="admin",currentUser:r,selectedLabelSize:E,onLabelSizeChange:w,dataSource:Tn.getDataSource(),onChangeDataSource:we=>Tn.setDataSource(we),barcodePattern:G,onBarcodePatternChange:we=>{q(we),localStorage.setItem("zebra_barcode_pattern_v1",we)},historyData:F,reportEmail:F.reportEmail,onReportEmailChange:F.setReportEmail,onReprint:Oe}),g.jsx(zT,{isOpen:M,onClose:()=>O(!1),queue:X.queue,onRemove:X.removeFromQueue,onPrintItem:(we,Ve)=>ye(we,Ve),onClear:X.clearQueue,loading:!1}),g.jsx(UT,{currentUser:r,onLogout:t,onSettingsClick:()=>k(!0),onQueueClick:()=>O(!0),printerData:K}),g.jsx("main",{className:"app-main px-3 md:px-8 pb-32 md:pb-8 pt-4",children:g.jsx("div",{className:"max-w-7xl mx-auto",children:g.jsx("div",{className:"max-w-xl mx-auto space-y-6",children:g.jsxs("div",{className:"space-y-4 md:space-y-6",children:[g.jsxs("section",{className:"bg-white p-3 md:p-6 rounded-xl md:rounded-2xl shadow-sm border border-slate-200",children:[g.jsxs("div",{className:"flex justify-between items-center mb-3 md:mb-4",children:[g.jsx("h2",{className:"text-lg md:text-xl font-bold text-slate-800",children:i?g.jsxs("span",{className:"text-[#115740]",children:[i.name," ",g.jsxs("span",{className:"text-slate-400 font-normal text-sm ml-1",children:["/ ",i.name_en]})]}):" "}),g.jsxs("span",{className:"text-xs md:text-sm font-medium text-slate-400",children:[z.length," "]})]}),g.jsx(IT,{products:z,selected:i,onSelect:o}),g.jsxs("div",{className:"flex gap-3 md:gap-4 md:flex-col",children:[i&&g.jsxs("div",{className:`mt-0 pt-0 border-t-0 flex-1 animate-fade-in ${(r==null?void 0:r.role)==="operator"&&i.id!=="3"?"w-full":""}`,children:[g.jsxs("div",{className:"flex justify-between items-center mb-2 md:mb-3",children:[g.jsx("label",{className:"text-xs md:text-sm font-bold text-slate-600 uppercase tracking-wide",children:" "}),g.jsx("span",{className:"text-[10px] md:text-xs font-medium text-slate-400 truncate max-w-[80px]",children:(r==null?void 0:r.role)==="operator"?" ":"."})]}),g.jsxs("div",{className:"flex gap-1 md:gap-2 items-center",children:[g.jsx("button",{onClick:()=>{m(we=>({...we,[i.id]:Math.max(1,Ne-1)}))},className:"w-10 h-10 md:w-12 md:h-12 flex items-center justify-center bg-red-50 hover:bg-red-100 border border-red-200 rounded-lg text-lg md:text-xl font-bold text-red-600 transition-colors",children:"-"}),g.jsx("input",{type:"number",inputMode:"numeric",pattern:"[0-9]*",value:Ne,readOnly:(r==null?void 0:r.role)==="operator",onChange:we=>{const Ve=parseInt(we.target.value);!isNaN(Ve)&&Ve>=1&&m(He=>({...He,[i.id]:Ve}))},className:`flex-1 w-full min-w-[60px] bg-white border-2 border-slate-200 rounded-lg text-center text-lg md:text-xl font-mono font-bold text-slate-800 focus:border-[#115740] focus:outline-none transition-colors h-10 md:h-12 ${(r==null?void 0:r.role)==="operator"?"bg-slate-50 text-slate-500":""}`}),g.jsx("button",{onClick:()=>{m(we=>({...we,[i.id]:Ne+1}))},className:"w-10 h-10 md:w-12 md:h-12 flex items-center justify-center bg-green-50 hover:bg-green-100 border border-green-200 rounded-lg text-lg md:text-xl font-bold text-[#115740] transition-colors",children:"+"})]})]}),i&&i.sorts&&i.sorts.length>0&&((r==null?void 0:r.role)!=="operator"||i.id==="3")&&g.jsx("div",{className:"mt-0 pt-0 border-t-0 flex-1 animate-fade-in",children:g.jsx(MT,{sorts:i.sorts,selectedSort:W,onSelect:be})})]})]}),g.jsxs("section",{className:"bg-white p-3 md:p-6 rounded-xl md:rounded-2xl shadow-sm border border-slate-200",children:[g.jsxs("div",{className:"flex justify-between items-center mb-3 md:mb-4",children:[g.jsx("h2",{className:"text-lg md:text-xl font-bold text-slate-800",children:" "}),g.jsx("span",{className:"text-xs md:text-sm font-medium text-slate-400",children:""})]}),g.jsx("div",{className:"bg-slate-100 rounded-xl p-2 md:p-4 mb-3 md:mb-4 text-center border-2 border-slate-200 focus-within:border-blue-500 focus-within:bg-white transition-colors",children:g.jsx("input",{type:"text",readOnly:!0,value:c,placeholder:"0.00",className:"w-full bg-transparent text-center text-4xl md:text-5xl font-mono font-bold text-slate-800 focus:outline-none placeholder-slate-300"})}),g.jsx(G_,{onKeyPress:Z,onClear:()=>f(""),onBackspace:()=>f(we=>we.slice(0,-1))})]})]})})})}),g.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 z-50 pb-[max(1.5rem,env(safe-area-inset-bottom))] shadow-[0_-4px_12px_-4px_rgba(0,0,0,0.15)]",children:g.jsxs("div",{className:"p-4 flex gap-3 md:gap-4 max-w-7xl mx-auto md:px-8",children:[g.jsxs("button",{onClick:()=>{X.addToQueue(I),f(""),m(we=>({...we,[i.id]:(we[i.id]??Vl)+1})),alert("  !")},disabled:qe,className:`flex-1 py-3 md:py-4 rounded-xl font-bold text-lg md:text-xl border-2 flex items-center justify-center gap-2 group transition-colors ${qe?"border-slate-200 text-slate-300 cursor-not-allowed":"border-[#115740] text-[#115740] hover:bg-green-50 active:bg-green-100"}`,children:[g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 md:h-7 md:w-7 transition-transform ${!qe&&"group-active:scale-90"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),g.jsx("span",{className:"hidden md:inline",children:" "}),g.jsx("span",{className:"md:hidden",children:""})]}),g.jsxs("button",{onClick:Ae,disabled:qe,className:`flex-[3] py-3 md:py-4 rounded-xl font-bold text-xl md:text-2xl shadow-lg transition-all transform active:scale-[0.98] flex items-center justify-center gap-3 ${qe?"bg-slate-300 text-slate-500 cursor-not-allowed shadow-none":"bg-[#115740] hover:bg-[#0d4633] text-white shadow-green-900/30 ring-0 hover:ring-4 hover:ring-[#115740]/20"}`,children:[g.jsx(Os,{}),i&&c?"":" "]})]})})]})}const vv="zebra_batches_v1",fu="zebra_batch_seq_v1",In={getBatches(){try{const r=localStorage.getItem(vv);return r?JSON.parse(r):[]}catch(r){return console.error("Failed to load batches",r),[]}},saveBatches(r){localStorage.setItem(vv,JSON.stringify(r))},getNextBatchNumber(){return parseInt(localStorage.getItem(fu)||"0")+1},createBatch(r,e){const t=this.getBatches();let s=e;if(!s){let o=this.getNextBatchNumber();localStorage.setItem(fu,o.toString()),s=o.toString()}const i={id:s,date:new Date().toISOString(),items:[],totalWeight:0,sort:r,status:"open"};return t.push(i),this.saveBatches(t),i},updateBatchId(r,e){const t=this.getBatches(),s=t.findIndex(o=>o.id===r);if(s===-1)throw new Error("Batch not found");if(t.some(o=>o.id===e&&o.id!==r))throw new Error(`Batch #${e} already exists!`);t[s].id=e,this.saveBatches(t);const i=parseInt(e);if(!isNaN(i)){const o=parseInt(localStorage.getItem(fu)||"0");i>o&&localStorage.setItem(fu,i.toString())}return t[s]},addItemToBatch(r,e){const t=this.getBatches(),s=t.findIndex(i=>i.id===r);if(s===-1)throw new Error("Batch not found");if(t[s].items.find(i=>i.serialNumber===e.serialNumber))throw new Error("      .");return t[s].items.push(e),t[s].totalWeight=t[s].items.reduce((i,o)=>i+o.weight,0),this.saveBatches(t),t[s]},removeItemFromBatch(r,e){const t=this.getBatches(),s=t.findIndex(i=>i.id===r);if(s===-1)throw new Error("Batch not found");return t[s].items=t[s].items.filter(i=>i.serialNumber!==e),t[s].totalWeight=t[s].items.reduce((i,o)=>i+o.weight,0),this.saveBatches(t),t[s]},closeBatch(r){const e=this.getBatches(),t=e.findIndex(s=>s.id===r);if(t===-1)throw new Error("Batch not found");return e[t].status="closed",this.saveBatches(e),e[t]},disbandBatch(r){const e=this.getBatches(),t=e.findIndex(i=>i.id===r);if(t===-1)throw new Error("Batch not found");const s=[...e[t].items];return e.splice(t,1),this.saveBatches(e),s},parseBarcode(r){try{const e=r.split("-");if(e.length<4)return null;const[t,s,i,o]=e;return{serialNumber:parseInt(i),weight:parseFloat(o),productName:s,sort:"Unknown",date:t}}catch(e){return console.error("Parse error",e),null}}},_v="zebra_production_db_v1",j6="http://localhost:3000/api",k6=!1,Sr={async fetchItems(){return this.getItemsLocal()},getItemsLocal(){let r=[];try{const e=localStorage.getItem(_v);e&&(r=JSON.parse(e))}catch(e){console.error("Error loading production db",e)}return this.syncHistoryToLocal(r),r.length===0?this.generateMockData():r.sort((e,t)=>t.serialNumber-e.serialNumber)},syncHistoryToLocal(r){try{const e=localStorage.getItem("zebra_print_history_v1");if(e){const t=JSON.parse(e);let s=!1;t.forEach(i=>{var f,h,m,x;const o=i.id||`auto-${i.serialNumber}-${((f=i.product)==null?void 0:f.id)||i.productName}`;if(!r.some(v=>{var _;return v.id===o||v.serialNumber===i.serialNumber&&v.productName===(((_=i.product)==null?void 0:_.name)||i.productName)})){const v={id:o,barcode:i.barcode||`${i.date}-${((h=i.product)==null?void 0:h.id)||"UNK"}-${i.serialNumber}-${i.weight}`,date:i.date,productName:((m=i.product)==null?void 0:m.name)||i.productName||"Unknown",productNameEn:(x=i.product)==null?void 0:x.name_en,serialNumber:parseInt(i.serialNumber),weight:parseFloat(i.weight),status:"created",createdAt:i.timestamp};r.push(v),s=!0}}),s&&(console.log("Synced new items from Operator History to Production DB"),this.saveItemsLocal(r))}}catch(e){console.error(e)}},async postItemToApi(r){try{await fetch(`${j6}/items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(e){console.error("Failed to POST item to API",e)}},saveItemsLocal(r){localStorage.setItem(_v,JSON.stringify(r))},async getPendingItems(){const r=await this.fetchItems(),e=[" ","Long Fiber"," ","Short Fiber"];return r.filter(t=>t.status==="created"&&e.some(s=>t.productName.includes(s)))},async getGradedItems(){return(await this.fetchItems()).filter(e=>e.status==="graded")},async getItemsByBatchId(r){return(await this.fetchItems()).filter(t=>t.batchId===r)},async palletizeItems(r,e){const t=this.getItemsLocal();let s=!1;r.forEach(i=>{const o=t.findIndex(c=>c.id===i);o!==-1&&(t[o]={...t[o],status:"palletized",batchId:e,palletizedAt:new Date().toISOString()},s=!0)}),s&&this.saveItemsLocal(t)},async unpalletizeItems(r){const e=this.getItemsLocal();let t=!1;r.forEach(s=>{const i=e.findIndex(o=>o.id===s);i!==-1&&(e[i]={...e[i],status:"graded",batchId:void 0,palletizedAt:void 0},t=!0)}),t&&this.saveItemsLocal(e)},async shipItems(r){const e=this.getItemsLocal();let t=!1;r.forEach(s=>{const i=e.findIndex(o=>o.id===s);i!==-1&&(e[i]={...e[i],status:"shipped",shippedAt:new Date().toISOString()},t=!0)}),t&&this.saveItemsLocal(e)},async gradeItem(r,e,t){const s=this.getItemsLocal(),i=s.findIndex(c=>c.id===r);if(i===-1)throw new Error("Item not found");const o={...s[i],status:"graded",sort:e,gradedAt:new Date().toISOString(),labUserId:t};return s[i]=o,this.saveItemsLocal(s),o},async revertGrade(r){const e=this.getItemsLocal(),t=e.findIndex(s=>s.id===r);t!==-1&&(e[t]={...e[t],status:"created",sort:void 0,gradedAt:void 0,labUserId:void 0},this.saveItemsLocal(e))},async getAllItems(){return await this.fetchItems()},async createItem(r){const e=this.getItemsLocal();return e.push(r),this.saveItemsLocal(e),r},async updateItem(r){const e=this.getItemsLocal(),t=e.findIndex(s=>s.id===r.id);t!==-1&&(e[t]=r,this.saveItemsLocal(e))},async deleteItem(r){const t=this.getItemsLocal().filter(s=>s.id!==r);this.saveItemsLocal(t)},generateMockData(){const r=[],e=["LF","SF","HC"],t=new Date().toISOString().slice(0,10).split("-").reverse().join(".");for(let s=1;s<=20;s++){const i=e[Math.floor(Math.random()*e.length)],o=(Math.random()*5+20).toFixed(1),c=1e3+s;r.push({id:crypto.randomUUID(),barcode:`${t}-${i}-${c}-${o}`,date:t,productName:i,serialNumber:c,weight:parseFloat(o),status:s<=5?"graded":"created",sort:s<=5?"1 ":void 0,gradedAt:s<=5?new Date().toISOString():void 0})}return this.saveItemsLocal(r),r}};function D6({onClose:r}){const[e,t]=pe.useState(null),[s,i]=pe.useState(""),[o,c]=pe.useState(""),[f,h]=pe.useState([]),[m,x]=pe.useState(!1),[v,_]=pe.useState(""),[y,E]=pe.useState(""),[w,S]=pe.useState(""),k=pe.useRef(null),M=Td();pe.useEffect(()=>{O()},[]);const O=async()=>{try{const le=await Sr.getGradedItems();h(le)}catch(le){console.error("Failed to load items",le)}};pe.useEffect(()=>{e&&k.current&&k.current.focus()},[e]);const G=()=>{const le=In.createBatch(w||"Auto");t(le),c("")},q=le=>{if(!e)return;const Ne=20;if(e.items.length>=Ne){c(` ${Ne}   !`);return}try{if(e.items.some(N=>N.serialNumber===le.serialNumber))return;const ce={serialNumber:le.serialNumber,weight:le.weight,productName:le.productName,sort:le.sort||"Unknown",date:le.date,productionItemId:le.id},U=In.addItemToBatch(e.id,ce);t({...U}),h(N=>N.filter(P=>P.id!==le.id))}catch(ce){c(ce.message)}},K=(le,Ne)=>{le.dataTransfer.setData("application/json",JSON.stringify(Ne)),le.dataTransfer.effectAllowed="move"},F=le=>{le.preventDefault(),le.dataTransfer.dropEffect="move"},X=le=>{le.preventDefault();const Ne=le.dataTransfer.getData("application/json");if(Ne)try{const ce=JSON.parse(Ne);q(ce)}catch(ce){console.error("Drop Error",ce)}},z=le=>{if(le.preventDefault(),!s||!e)return;const Ne=s.trim(),ce=In.parseBarcode(Ne);if(!ce){c("  -. : DATE-SKU-SERIAL-WEIGHT"),i("");return}try{const U=In.addItemToBatch(e.id,ce);t({...U}),c("")}catch(U){c(U.message||" .")}i("")},ne=le=>{if(e)try{const Ne=In.removeItemFromBatch(e.id,le);t({...Ne}),O()}catch(Ne){console.error(Ne)}},oe=()=>{e&&(_(e.id),x(!0))},fe=le=>{_(Ne=>Ne+le)},W=()=>{_(le=>le.slice(0,-1))},be=()=>{_("")},Ee=()=>{if(!(!v||!e))try{const le=In.updateBatchId(e.id,v);t(le),x(!1)}catch(le){alert(le.message)}},J=async()=>{if(!e)return;if(e.items.length===0){confirm(" . ?")&&r();return}const le=e.items.map(ce=>ce.productionItemId).filter(ce=>!!ce);le.length>0&&await Sr.palletizeItems(le,e.id),In.closeBatch(e.id);const Ne=ve(e);M.printer?await oa.print(M.printer,Ne):(console.log("--- PALLET MOCK PRINT ---"),console.log(Ne),alert(` ${e.id} ! ...`)),r()},ve=le=>`
^XA
^FO50,50^ADN,36,20^FDMARIJANY HEMP^FS
^FO50,100^ADN,36,20^FDPALLET ID: ${le.id}^FS
^FO50,150^ADN,36,20^FDSORT: ${le.sort}^FS
^FO50,200^ADN,36,20^FDDate: ${le.date.slice(0,10)}^FS
^FO50,300^GB700,3,3^FS
^FO50,350^ADN,36,20^FDITEMS: ${le.items.length}^FS
^FO400,350^ADN,36,20^FDTOTAL WEIGHT: ${le.totalWeight.toFixed(2)} kg^FS
^FO50,450^BCN,100,Y,N,N
^FD${le.id}^FS
^XZ
        `;if(m)return g.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl max-w-sm w-full mx-auto animate-fade-in flex flex-col items-center",children:[g.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"  "}),g.jsx("div",{className:"w-full bg-slate-100 p-4 rounded-xl text-center text-4xl font-mono font-bold text-blue-800 mb-4 h-20 flex items-center justify-center border-2 border-blue-200",children:v||g.jsx("span",{className:"opacity-30",children:"..."})}),g.jsx("div",{className:"w-full",children:g.jsx(G_,{onKeyPress:fe,onBackspace:W,onClear:be})}),g.jsxs("div",{className:"flex w-full gap-3 mt-6",children:[g.jsx("button",{onClick:()=>x(!1),className:"flex-1 py-3 text-slate-500 font-bold hover:bg-slate-50 rounded-lg",children:""}),g.jsx("button",{onClick:Ee,className:"flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-bold shadow-lg",children:""})]})]});if(!e){const le=In.getNextBatchNumber(),Ne=12,ce=20,U=[...new Set(f.map(I=>I.productName))],N=[...new Set(f.map(I=>I.sort).filter(Boolean))],P=f.filter(I=>!(y&&I.productName!==y||w&&I.sort!==w)),C=y&&w&&P.length>=Ne&&P.length<=ce;return g.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl max-w-2xl w-full mx-auto space-y-6 animate-fade-in max-h-[80vh] flex flex-col overflow-auto",children:[g.jsxs("div",{className:"flex justify-between items-center border-b pb-4",children:[g.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:" "}),g.jsxs("div",{className:"flex flex-col items-end",children:[g.jsx("span",{className:"text-xs text-slate-500 uppercase",children:" "}),g.jsxs("span",{className:"text-4xl font-mono font-bold text-blue-600",children:["#",le]})]})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"block text-sm font-bold text-slate-700",children:"1.  "}),g.jsx("div",{className:"grid grid-cols-3 gap-2",children:U.map(I=>g.jsx("button",{onClick:()=>E(I),className:`py-3 px-4 rounded-xl text-sm font-medium transition-all ${y===I?"bg-blue-600 text-white shadow-lg":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:I},I))})]}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("label",{className:"block text-sm font-bold text-slate-700",children:"2.  "}),g.jsx("div",{className:"grid grid-cols-3 gap-2",children:N.map(I=>g.jsx("button",{onClick:()=>S(I||""),className:`py-3 px-4 rounded-xl text-sm font-medium transition-all ${w===I?"bg-purple-600 text-white shadow-lg":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:I},I))})]}),g.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm text-slate-500",children:":"}),g.jsxs("p",{className:"font-bold text-slate-800",children:[y||""," / ",w||""]})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("p",{className:"text-sm text-slate-500",children:" :"}),g.jsx("p",{className:`text-2xl font-bold ${P.length>=Ne&&P.length<=ce?"text-green-600":"text-orange-500"}`,children:P.length})]})]}),y&&w&&(P.length<Ne||P.length>ce)&&g.jsxs("p",{className:"text-xs text-orange-500 mt-2",children:["   ",Ne,"  ",ce,"  (",P.length," )"]})]}),o&&g.jsx("div",{className:"p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:o}),g.jsxs("div",{className:"flex gap-3 pt-4",children:[g.jsx("button",{onClick:r,className:"flex-1 py-3 text-slate-500 font-medium",children:""}),g.jsx("button",{onClick:G,disabled:!C,className:`flex-2 w-2/3 py-3 rounded-xl font-bold shadow-lg text-xl transition-all ${C?"bg-blue-700 hover:bg-blue-800 text-white shadow-blue-900/20":"bg-slate-300 text-slate-500 cursor-not-allowed shadow-none"}`,children:""})]})]})}return g.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-[95vw] w-full mx-auto flex flex-col h-[90vh] animate-fade-in overflow-hidden border border-slate-200",children:[g.jsxs("div",{className:"bg-slate-800 text-white p-4 flex justify-between items-center shrink-0",children:[g.jsxs("div",{onClick:oe,className:"cursor-pointer group relative pl-3 border-l-4 border-blue-500 hover:bg-slate-700 rounded-r pr-3 py-1 transition-all",children:[g.jsx("div",{className:"text-xs opacity-50 uppercase tracking-widest group-hover:text-blue-200",children:"Pallet ID (Edit)"}),g.jsxs("div",{className:"text-3xl font-mono font-bold text-white group-hover:text-blue-300",children:["#",e.id]}),g.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 text-xs",children:""})]}),g.jsx("div",{className:"text-center flex-1",children:g.jsx("span",{className:"text-sm opacity-50 block",children:"DRAG & DROP  "})}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"text-xs opacity-50 uppercase tracking-widest",children:""}),g.jsx("div",{className:"font-bold text-green-400",children:"OPEN"})]})]}),g.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[g.jsxs("div",{className:"w-1/4 bg-slate-50 p-4 border-r border-slate-200 flex flex-col gap-4 z-10 shadow-lg",children:[g.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-blue-200",children:[g.jsx("label",{className:"text-xs font-bold text-blue-800 uppercase mb-2 block",children:""}),g.jsx("form",{onSubmit:z,children:g.jsx("input",{ref:k,value:s,onChange:le=>i(le.target.value),placeholder:"Scan...",className:"w-full bg-slate-100 border-2 border-slate-300 focus:border-blue-500 rounded-lg p-2 font-mono text-lg",autoFocus:!0})})]}),o&&g.jsxs("div",{className:"p-3 bg-red-100 text-red-800 rounded-xl text-xs border border-red-200 animate-pulse",children:[" ",o]}),g.jsxs("div",{className:"mt-auto space-y-4",children:[g.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200",children:[g.jsx("div",{className:"text-sm text-slate-500",children:""}),g.jsx("div",{className:"text-3xl font-bold text-slate-800",children:e.items.length})]}),g.jsxs("div",{className:"bg-blue-600 p-4 rounded-xl text-white shadow-lg",children:[g.jsx("div",{className:"text-sm opacity-80",children:" ()"}),g.jsx("div",{className:"text-4xl font-bold",children:e.totalWeight.toFixed(2)})]})]})]}),g.jsxs("div",{className:"flex-1 flex flex-col bg-white overflow-hidden relative",onDragOver:F,onDrop:X,children:[g.jsxs("div",{className:"p-3 bg-slate-100 border-b border-slate-200 text-xs font-bold text-slate-500 uppercase flex justify-between shadow-sm z-10",children:[g.jsxs("span",{children:[" ",e.id]}),g.jsxs("span",{children:[e.items.length," "]})]}),e.items.length===0&&g.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none opacity-50",children:[g.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:""}),g.jsx("div",{className:"text-slate-400 font-bold text-xl border-dashed border-4 border-slate-200 p-8 rounded-3xl",children:"  "})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:e.items.map((le,Ne)=>g.jsxs("div",{className:"flex items-center p-2 bg-blue-50 border border-blue-100 rounded-lg shadow-sm hover:border-blue-300 transition-all animate-fade-in group",children:[g.jsx("div",{className:"w-8 font-mono text-blue-400 text-sm font-bold",children:Ne+1}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"font-bold text-slate-800 text-sm",children:[" ",le.serialNumber]}),g.jsx("div",{className:"text-[10px] text-slate-500",children:le.productName}),g.jsx("div",{className:"text-[9px] font-mono text-slate-400",children:le.barcode})]}),g.jsx("div",{className:"text-right font-mono font-bold text-slate-700 text-sm",children:le.weight.toFixed(1)}),g.jsx("button",{onClick:()=>ne(le.serialNumber),className:"ml-2 p-1 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity",children:""})]},Ne))})]}),g.jsxs("div",{className:"w-1/3 bg-slate-50 flex flex-col border-l border-slate-200",children:[g.jsxs("div",{className:"p-3 bg-slate-200 border-b border-slate-300 text-xs font-bold text-slate-700 uppercase flex justify-between items-center shadow-sm z-10",children:[g.jsxs("span",{children:[y," / ",w]}),g.jsx("span",{className:"bg-slate-300 px-2 py-0.5 rounded-full text-[10px]",children:f.filter(le=>(!y||le.productName===y)&&(!w||le.sort===w)).length})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:[f.filter(le=>(!y||le.productName===y)&&(!w||le.sort===w)).map(le=>g.jsxs("div",{draggable:!0,onDragStart:Ne=>K(Ne,le),className:"w-full text-left bg-white p-2 rounded-lg border border-slate-200 hover:border-blue-400 hover:shadow-md cursor-grab active:cursor-grabbing transition-all flex justify-between items-center group select-none",children:[g.jsxs("div",{className:"pointer-events-none",children:[g.jsxs("div",{className:"font-bold text-xs text-slate-700",children:[" ",le.serialNumber]}),g.jsxs("div",{className:"text-[10px] text-slate-500",children:[le.productName," (",le.sort,")"]}),g.jsx("div",{className:"text-[9px] font-mono text-slate-400",children:le.barcode})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"font-mono text-xs font-bold pointer-events-none",children:le.weight}),g.jsx("button",{onClick:()=>q(le),className:"bg-green-100 hover:bg-green-200 text-green-700 p-1.5 rounded-md transition-colors",title:"  ",children:""})]})]},le.id)),f.filter(le=>(!y||le.productName===y)&&(!w||le.sort===w)).length===0&&g.jsx("div",{className:"text-center p-4 text-xs text-slate-400",children:"  "})]})]})]}),g.jsxs("div",{className:"bg-white border-t border-slate-200 p-4 flex justify-between items-center shrink-0 z-20 shadow-[-10px_0_20px_rgba(0,0,0,0.1)]",children:[g.jsx("button",{onClick:r,className:"px-6 py-3 text-slate-500 font-bold hover:text-slate-800 transition-colors",children:""}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("div",{className:"text-right text-xs text-slate-500 mr-4 hidden md:block",children:["    ",g.jsx("br",{}),"  "]}),g.jsxs("button",{onClick:J,disabled:e.items.length===0,className:`px-8 py-3 rounded-xl font-bold flex items-center gap-3 transition-all ${e.items.length===0?"bg-slate-200 text-slate-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white shadow-xl shadow-green-900/20 active:scale-95"}`,children:[g.jsx("span",{children:"  "}),g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})})]})]})]})]})}function F6({onClose:r}){const[e,t]=pe.useState([]),[s,i]=pe.useState(""),[o,c]=pe.useState(!1),[f,h]=pe.useState(null),[m,x]=pe.useState(!1),[v,_]=pe.useState({});pe.useEffect(()=>{y()},[]);const y=async()=>{c(!0);try{const k=(await Sr.getAllItems()).filter(M=>M.sort&&M.sort.trim()!=="");t(k.sort((M,O)=>O.serialNumber-M.serialNumber))}finally{c(!1)}},E=e.filter(S=>S.serialNumber.toString().includes(s)||S.barcode.toLowerCase().includes(s.toLowerCase())||S.productName.toLowerCase().includes(s.toLowerCase())),w=async()=>{if(!f)return;const S={...f,...v,barcode:`${v.date}-${v.productName===" "?"LF":v.productName===" "?"SF":"HC"}-${v.serialNumber}-${v.weight}`};try{m?await Sr.createItem(S):await Sr.updateItem(S),h(null),y()}catch(k){console.error(k),alert("Error saving item")}};return g.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/95 backdrop-blur flex flex-col pt-16 pb-4 px-4 overflow-hidden",children:g.jsxs("div",{className:"max-w-6xl w-full mx-auto bg-white rounded-xl shadow-2xl flex flex-col h-full overflow-hidden",children:[g.jsxs("div",{className:"p-4 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[g.jsxs("div",{children:[g.jsx("h2",{className:"text-xl font-bold text-slate-800",children:" "}),g.jsx("p",{className:"text-xs text-slate-500",children:"   ( )"})]}),g.jsx("div",{className:"flex gap-2",children:g.jsx("button",{onClick:r,className:"bg-slate-200 hover:bg-slate-300 text-slate-700 px-4 py-2 rounded-lg text-sm font-bold",children:""})})]}),g.jsx("div",{className:"p-4 border-b border-slate-200 bg-white",children:g.jsx("input",{type:"text",placeholder:"  , ...",className:"w-full md:w-96 px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-blue-500 outline-none",value:s,onChange:S=>i(S.target.value)})}),g.jsx("div",{className:"flex-1 overflow-auto bg-slate-50",children:g.jsxs("table",{className:"w-full text-left border-collapse",children:[g.jsx("thead",{className:"bg-slate-100 text-slate-600 text-xs uppercase font-bold sticky top-0 z-10 shadow-sm",children:g.jsxs("tr",{children:[g.jsx("th",{className:"p-4 border-b",children:""}),g.jsx("th",{className:"p-4 border-b",children:""}),g.jsx("th",{className:"p-4 border-b",children:""}),g.jsx("th",{className:"p-4 border-b text-right",children:""}),g.jsx("th",{className:"p-4 border-b text-center",children:""}),g.jsx("th",{className:"p-4 border-b text-center",children:""}),g.jsx("th",{className:"p-4 border-b text-right",children:""})]})}),g.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:E.map(S=>g.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[g.jsxs("td",{className:"p-4 font-mono font-bold text-slate-700",children:["#",S.serialNumber]}),g.jsx("td",{className:"p-4 text-sm text-slate-600",children:S.date}),g.jsx("td",{className:"p-4 text-sm font-medium",children:S.productName}),g.jsxs("td",{className:"p-4 text-sm text-right font-mono",children:[S.weight," "]}),g.jsx("td",{className:"p-4 text-center",children:S.sort?g.jsx("span",{className:"bg-purple-100 text-purple-700 px-2 py-0.5 rounded text-xs font-bold border border-purple-200",children:S.sort}):g.jsx("span",{className:"text-slate-300",children:"-"})}),g.jsx("td",{className:"p-4 text-center",children:g.jsx(L6,{status:S.status})}),g.jsx("td",{className:"p-4 text-right text-xs text-slate-400",children:S.batchId?` #${S.batchId}`:"-"})]},S.id))})]})}),f&&g.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",children:[g.jsxs("div",{className:"bg-slate-100 p-4 border-b border-slate-200 flex justify-between items-center",children:[g.jsx("h3",{className:"font-bold text-lg",children:m?" ":""}),g.jsx("button",{onClick:()=>h(null),className:"text-slate-400 hover:text-slate-600",children:""})]}),g.jsxs("div",{className:"p-6 space-y-4",children:[g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:" "}),g.jsx("input",{type:"number",className:"w-full border rounded p-2 text-lg font-mono",value:v.serialNumber,onChange:S=>_({...v,serialNumber:parseInt(S.target.value)})})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:" ()"}),g.jsx("input",{type:"number",step:"0.1",className:"w-full border rounded p-2 text-lg font-mono",value:v.weight,onChange:S=>_({...v,weight:parseFloat(S.target.value)})})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:""}),g.jsxs("select",{className:"w-full border rounded p-2",value:v.productName,onChange:S=>_({...v,productName:S.target.value}),children:[g.jsx("option",{value:" ",children:" "}),g.jsx("option",{value:" ",children:" "}),g.jsx("option",{value:"",children:""})]})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:""}),g.jsxs("select",{className:"w-full border rounded p-2",value:v.status,onChange:S=>_({...v,status:S.target.value}),children:[g.jsx("option",{value:"created",children:""}),g.jsx("option",{value:"graded",children:""}),g.jsx("option",{value:"palletized",children:" "}),g.jsx("option",{value:"shipped",children:""})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:""}),g.jsx("div",{className:"w-full border rounded p-2 bg-slate-50 text-slate-500",children:v.sort||"-   -"})]})]}),g.jsxs("div",{className:"text-xs text-slate-400 mt-4 bg-slate-50 p-2 rounded",children:["ID: ",f.id]})]}),g.jsxs("div",{className:"p-4 bg-slate-50 border-t flex justify-end gap-2",children:[g.jsx("button",{onClick:()=>h(null),className:"px-4 py-2 text-slate-600 font-bold",children:""}),g.jsx("button",{onClick:w,className:"px-6 py-2 bg-blue-600 text-white rounded font-bold hover:bg-blue-700",children:""})]})]})})]})})}const L6=({status:r})=>{const e={created:"bg-slate-100 text-slate-600",graded:"bg-blue-100 text-blue-700",palletized:"bg-purple-100 text-purple-700",shipped:"bg-green-100 text-green-700"},t={created:"",graded:"",palletized:"",shipped:""};return g.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold border border-transparent ${e[r]||e.created}`,children:t[r]||r})};function I6({onClose:r}){const[e,t]=pe.useState([]),[s,i]=pe.useState(null),[o,c]=pe.useState([]),[f,h]=pe.useState(!1),[m,x]=pe.useState(null),[v,_]=pe.useState(""),[y,E]=pe.useState(""),[w,S]=pe.useState(""),[k,M]=pe.useState("");pe.useEffect(()=>{O()},[]);const O=()=>{const W=In.getBatches();t(W.filter(be=>be.status==="closed"))},G=e.filter(W=>!(v&&!W.items.some(be=>be.productName===v)||y&&W.sort!==y||w&&W.closedAt&&new Date(W.closedAt).toISOString().split("T")[0]<w||k&&W.closedAt&&new Date(W.closedAt).toISOString().split("T")[0]>k)),q=[...new Set(e.flatMap(W=>W.items.map(be=>be.productName)))],K=[...new Set(e.map(W=>W.sort).filter(Boolean))],F=async W=>{if(s===W){i(null),c([]);return}h(!0),i(W);try{const be=await Sr.getItemsByBatchId(W);c(be)}catch(be){console.error("Failed to load pallet items",be),c([])}h(!1)},X=W=>{x(W)},z=async()=>{const W=m;if(!W)return;const be=e.find(Ee=>Ee.id===W);if(be){x(null);try{const Ee=be.items.map(J=>J.productionItemId).filter(J=>!!J);In.disbandBatch(W),Ee.length>0&&await Sr.unpalletizeItems(Ee),O(),i(null)}catch(Ee){console.error("Disband error:",Ee)}}},ne=()=>{if(e.length===0)return;let W=` ,,, (),,
`;e.forEach(J=>{const ve=J.items.map(le=>`#${le.serialNumber}`).join("; ");W+=`${J.id},${J.date.slice(0,10)},${J.items.length},${J.totalWeight.toFixed(2)},${J.sort},"${ve}"
`});const be=new Blob([W],{type:"text/csv;charset=utf-8;"}),Ee=document.createElement("a");Ee.href=URL.createObjectURL(be),Ee.download=`pallets_report_${new Date().toISOString().slice(0,10)}.csv`,Ee.click()},oe=()=>{if(e.length===0)return;const W=e.map(U=>({" ":U.id,:U.date.slice(0,10),:U.items.length," ()":U.totalWeight.toFixed(2),:U.sort,:U.items.map(N=>`#${N.serialNumber}`).join("; ")})),be=[];e.forEach(U=>{U.items.forEach(N=>{be.push({" ":U.id," ":U.date.slice(0,10)," ":N.serialNumber,:N.productName,:N.sort," ()":N.weight})})});const Ee=Dr.book_new(),J=Dr.json_to_sheet(W),ve=Dr.json_to_sheet(be);Dr.book_append_sheet(Ee,J,""),Dr.book_append_sheet(Ee,ve,"");const le=Ui(Ee,{bookType:"xlsx",type:"array"}),Ne=new Blob([le],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ce=document.createElement("a");ce.href=URL.createObjectURL(Ne),ce.download=`pallets_report_${new Date().toISOString().slice(0,10)}.xlsx`,ce.click()},fe=()=>{const W=`
            <html>
            <head>
                <title>  </title>
                <style>
                    body { font-family: Arial, sans-serif; padding: 20px; }
                    h1 { text-align: center; color: #333; }
                    .summary { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 8px; }
                    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                    th { background-color: #6366f1; color: white; }
                    tr:nth-child(even) { background-color: #f9f9f9; }
                    .pallet-header { background: #e0e7ff; font-weight: bold; }
                    @media print { body { -webkit-print-color-adjust: exact; } }
                </style>
            </head>
            <body>
                <h1>  </h1>
                <div class="summary">
                    <strong> :</strong> ${new Date().toLocaleDateString("uk-UA")} |
                    <strong>:</strong> ${e.length} |
                    <strong>:</strong> ${e.reduce((Ee,J)=>Ee+J.items.length,0)} |
                    <strong> :</strong> ${e.reduce((Ee,J)=>Ee+J.totalWeight,0).toFixed(1)} 
                </div>
                <table>
                    <tr>
                        <th> </th>
                        <th></th>
                        <th> </th>
                        <th></th>
                        <th></th>
                        <th> ()</th>
                    </tr>
                    ${e.map(Ee=>Ee.items.map((J,ve)=>`
                            <tr ${ve===0?'class="pallet-header"':""}>
                                <td>${ve===0?Ee.id:""}</td>
                                <td>${ve===0?Ee.date.slice(0,10):""}</td>
                                <td>#${J.serialNumber}</td>
                                <td>${J.productName}</td>
                                <td>${J.sort}</td>
                                <td>${J.weight}</td>
                            </tr>
                        `).join("")).join("")}
                </table>
            </body>
            </html>
        `,be=window.open("","_blank");be&&(be.document.write(W),be.document.close(),be.print())};return g.jsxs("div",{className:"fixed inset-0 z-50 bg-slate-900/80 backdrop-blur-sm flex items-center justify-center p-4",children:[m&&g.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"  "}),g.jsxs("p",{className:"text-slate-600 mb-6",children:[" ,     ",g.jsxs("strong",{children:["",m]}),"?",g.jsx("br",{}),"    ."]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{onClick:()=>x(null),className:"flex-1 py-3 bg-slate-200 hover:bg-slate-300 rounded-lg font-medium transition-colors",children:""}),g.jsx("button",{onClick:z,className:"flex-1 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-bold transition-colors",children:", "})]})]})}),g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6 flex justify-between items-center shrink-0",children:[g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold",children:"  "}),g.jsx("p",{className:"text-sm opacity-80",children:"     "})]}),g.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[g.jsx("button",{onClick:fe,className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-sm font-medium transition-colors",children:" "}),g.jsx("button",{onClick:oe,className:"px-4 py-2 bg-green-500 hover:bg-green-600 rounded-lg text-sm font-medium transition-colors",children:" Excel (XLSX)"}),g.jsx("button",{onClick:ne,className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-sm font-medium transition-colors",children:" CSV"})]})]}),g.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200 flex flex-wrap gap-3",children:[g.jsxs("select",{value:v,onChange:W=>_(W.target.value),className:"px-3 py-2 rounded-lg border border-slate-300 text-sm bg-white",children:[g.jsx("option",{value:"",children:" "}),q.map(W=>g.jsx("option",{value:W,children:W},W))]}),g.jsxs("select",{value:y,onChange:W=>E(W.target.value),className:"px-3 py-2 rounded-lg border border-slate-300 text-sm bg-white",children:[g.jsx("option",{value:"",children:" "}),K.map(W=>g.jsx("option",{value:W,children:W},W))]}),g.jsx("input",{type:"date",value:w,onChange:W=>S(W.target.value),className:"px-3 py-2 rounded-lg border border-slate-300 text-sm bg-white",placeholder:""}),g.jsx("input",{type:"date",value:k,onChange:W=>M(W.target.value),className:"px-3 py-2 rounded-lg border border-slate-300 text-sm bg-white",placeholder:""}),(v||y||w||k)&&g.jsx("button",{onClick:()=>{_(""),E(""),S(""),M("")},className:"px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg",children:" "})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:G.length===0?g.jsxs("div",{className:"text-center py-16 text-slate-400",children:[g.jsx("div",{className:"text-6xl mb-4",children:""}),g.jsx("p",{className:"text-lg",children:"  "})]}):g.jsx("div",{className:"space-y-4",children:G.map(W=>g.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden",children:[g.jsxs("div",{className:"p-4 bg-slate-50 hover:bg-slate-100 transition-colors flex justify-between items-center",children:[g.jsxs("div",{onClick:()=>F(W.id),className:"flex items-center gap-4 cursor-pointer flex-1",children:[g.jsxs("div",{className:"w-12 h-12 bg-indigo-100 text-indigo-600 rounded-xl flex items-center justify-center font-bold text-lg",children:["#",W.id]}),g.jsxs("div",{children:[g.jsxs("div",{className:"font-bold text-slate-800",children:[" ",W.id]}),g.jsxs("div",{className:"text-sm text-slate-500",children:[W.date.slice(0,10),"  ",W.items.length,"   ",W.totalWeight.toFixed(1)," "]})]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-bold",children:W.sort}),g.jsx("button",{onClick:()=>X(W.id),className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded-full text-xs font-bold transition-colors",title:" ",children:" "}),g.jsx("span",{onClick:()=>F(W.id),className:`transform transition-transform cursor-pointer ${s===W.id?"rotate-180":""}`,children:""})]})]}),s===W.id&&g.jsx("div",{className:"p-4 bg-white border-t border-slate-200",children:f?g.jsx("div",{className:"text-center py-4 text-slate-400",children:"..."}):g.jsxs("table",{className:"w-full text-sm",children:[g.jsx("thead",{children:g.jsxs("tr",{className:"text-left text-slate-500 border-b",children:[g.jsx("th",{className:"pb-2 font-medium",children:" "}),g.jsx("th",{className:"pb-2 font-medium",children:""}),g.jsx("th",{className:"pb-2 font-medium",children:""}),g.jsx("th",{className:"pb-2 font-medium text-right",children:""}),g.jsx("th",{className:"pb-2 font-medium",children:""}),g.jsx("th",{className:"pb-2 font-medium",children:"-"})]})}),g.jsx("tbody",{children:W.items.map((be,Ee)=>g.jsxs("tr",{className:"border-b border-slate-100 last:border-0",children:[g.jsxs("td",{className:"py-2 font-mono font-bold text-slate-700",children:["#",be.serialNumber]}),g.jsx("td",{className:"py-2",children:be.productName}),g.jsx("td",{className:"py-2",children:g.jsx("span",{className:"px-2 py-0.5 bg-slate-100 rounded text-xs",children:be.sort})}),g.jsxs("td",{className:"py-2 text-right font-medium",children:[be.weight," "]}),g.jsx("td",{className:"py-2 text-slate-500",children:be.date}),g.jsx("td",{className:"py-2 font-mono text-xs text-slate-400",children:be.barcode})]},Ee))})]})})]},W.id))})}),g.jsxs("div",{className:"p-4 border-t border-slate-200 bg-slate-50 flex justify-between items-center shrink-0",children:[g.jsxs("div",{className:"text-sm text-slate-500",children:[" : ",g.jsx("strong",{children:e.length}),"  : ",g.jsx("strong",{children:e.reduce((W,be)=>W+be.items.length,0)}),"  : ",g.jsxs("strong",{children:[e.reduce((W,be)=>W+be.totalWeight,0).toFixed(1)," "]})]}),g.jsx("button",{onClick:r,className:"px-6 py-2 bg-slate-200 hover:bg-slate-300 rounded-lg font-medium transition-colors",children:""})]})]})]})}function B6(){const{logout:r,currentUser:e}=wo(),[t,s]=pe.useState("dashboard"),[i,o]=pe.useState([]);pe.useEffect(()=>{(async()=>{const M=await Sr.getGradedItems();o(M)})()},[t]);const[c,f]=pe.useState(!1),[h,m]=pe.useState(!1),x=()=>{c?r():(f(!0),setTimeout(()=>f(!1),3e3))},[v,_]=pe.useState(new Set),y=()=>{v.size===i.length?_(new Set):_(new Set(i.map(k=>k.id)))},E=k=>{const M=new Set(v);M.has(k)?M.delete(k):M.add(k),_(M)},w=()=>{v.size!==0&&m(!0)},S=async()=>{m(!1);try{await Sr.shipItems(Array.from(v));const k=await Sr.getGradedItems();o(k),_(new Set)}catch(k){console.error(k)}};return g.jsxs("div",{className:"flex flex-col h-screen bg-slate-100 font-sans",children:[h&&g.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[g.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"  "}),g.jsxs("p",{className:"text-slate-600 mb-6",children:[" ,    ",g.jsx("strong",{children:v.size})," ?",g.jsx("br",{}),'     "".']}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{onClick:()=>m(!1),className:"flex-1 py-3 bg-slate-200 hover:bg-slate-300 rounded-lg font-medium transition-colors",children:""}),g.jsx("button",{onClick:S,className:"flex-1 py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-bold transition-colors",children:", "})]})]})}),g.jsxs("div",{className:"bg-[#1e293b] text-white p-4 flex justify-between items-center shadow-md shrink-0 z-10",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center font-bold text-white",children:"A"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-bold text-lg leading-tight",children:""}),g.jsx("div",{className:"text-[10px] text-blue-300 tracking-wider",children:"HeMP SYSTEM"})]})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("span",{className:"opacity-70 text-sm hidden md:inline",children:e==null?void 0:e.name}),g.jsx("button",{onClick:x,className:`px-4 py-2 rounded text-sm transition-all font-bold border ${c?"bg-red-500 text-white border-red-400 animate-pulse":"bg-slate-700 hover:bg-slate-600 border-slate-600"}`,children:c?"?":""})]})]}),t==="palletizing"&&g.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/80 backdrop-blur-sm flex items-center justify-center p-4",children:g.jsx(D6,{onClose:()=>s("dashboard")})}),t==="journal"&&g.jsx(F6,{onClose:()=>s("dashboard")}),t==="reports"&&g.jsx(I6,{onClose:()=>s("dashboard")}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:g.jsxs("div",{className:"max-w-6xl mx-auto",children:[g.jsxs("div",{className:"mb-8",children:[g.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:" "}),g.jsx("p",{className:"text-slate-500",children:"     ."})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:[g.jsxs("button",{onClick:()=>s("palletizing"),className:"bg-white p-8 rounded-2xl shadow-sm border border-slate-200 hover:shadow-xl hover:border-blue-400 transition-all text-left group",children:[g.jsx("div",{className:"w-14 h-14 bg-blue-50 text-blue-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})}),g.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2 group-hover:text-blue-700",children:" "}),g.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:"  ,       ."})]}),g.jsxs("button",{onClick:()=>s("journal"),className:"bg-purple-50 p-8 rounded-2xl shadow-sm border border-purple-200 hover:shadow-xl hover:border-purple-400 transition-all text-left group",children:[g.jsx("div",{className:"w-14 h-14 bg-purple-100 text-purple-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),g.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2 group-hover:text-purple-700",children:" "}),g.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:"   , ,   ."})]}),g.jsxs("button",{onClick:()=>s("reports"),className:"bg-indigo-50 p-8 rounded-2xl shadow-sm border border-indigo-200 hover:shadow-xl hover:border-indigo-400 transition-all text-left group",children:[g.jsx("div",{className:"w-14 h-14 bg-indigo-100 text-indigo-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),g.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2 group-hover:text-indigo-700",children:"  "}),g.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:"  ,   ."})]})]}),g.jsxs("div",{children:[g.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-4 flex justify-between items-center",children:[g.jsx("span",{children:"  ( )"}),g.jsxs("div",{className:"flex items-center gap-3",children:[v.size>0&&g.jsxs("button",{onClick:w,className:"bg-red-50 text-red-600 border border-red-200 hover:bg-red-100 px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 transition-all",children:[g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"}),g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})]})," (",v.size,")"]}),g.jsxs("span",{className:"text-sm font-normal text-slate-500 bg-white px-3 py-1 rounded-full border",children:[": ",i.length]})]})]}),g.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:g.jsx("div",{className:"overflow-x-auto",children:g.jsxs("table",{className:"w-full text-left text-sm text-slate-600",children:[g.jsx("thead",{className:"bg-slate-50 text-slate-800 font-bold uppercase text-xs border-b border-slate-200",children:g.jsxs("tr",{children:[g.jsx("th",{className:"p-4 w-10",children:g.jsx("input",{type:"checkbox",checked:i.length>0&&v.size===i.length,onChange:y,className:"rounded border-slate-300 text-blue-600 focus:ring-blue-500 w-4 h-4"})}),g.jsx("th",{className:"p-4",children:""}),g.jsx("th",{className:"p-4",children:""}),g.jsx("th",{className:"p-4",children:" "}),g.jsx("th",{className:"p-4",children:""}),g.jsx("th",{className:"p-4",children:""}),g.jsx("th",{className:"p-4 text-right",children:""}),g.jsx("th",{className:"p-4 text-center",children:""})]})}),g.jsx("tbody",{className:"divide-y divide-slate-100",children:i.length===0?g.jsx("tr",{children:g.jsx("td",{colSpan:8,className:"p-8 text-center text-slate-400",children:"     ."})}):i.map(k=>g.jsxs("tr",{className:`hover:bg-blue-50 transition-colors ${v.has(k.id)?"bg-blue-50/50":""}`,children:[g.jsx("td",{className:"p-4",children:g.jsx("input",{type:"checkbox",checked:v.has(k.id),onChange:()=>E(k.id),className:"rounded border-slate-300 text-blue-600 focus:ring-blue-500 w-4 h-4"})}),g.jsxs("td",{className:"p-4 font-mono font-bold",children:["#",k.serialNumber]}),g.jsx("td",{className:"p-4",children:k.date}),g.jsx("td",{className:"p-4",children:k.batchId?g.jsx("span",{className:"font-mono font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-100",children:k.batchId}):g.jsx("span",{className:"text-slate-300",children:""})}),g.jsx("td",{className:"p-4",children:k.productName}),g.jsx("td",{className:"p-4",children:g.jsx("span",{className:"bg-purple-100 text-purple-700 px-2 py-1 rounded text-xs font-bold",children:k.sort})}),g.jsxs("td",{className:"p-4 text-right font-bold",children:[k.weight," "]}),g.jsx("td",{className:"p-4 text-center",children:g.jsx("span",{className:"text-green-600 font-bold text-xs bg-green-50 px-2 py-1 rounded-full border border-green-200",children:""})})]},k.id))})]})})})]})]})})]})}function M6(){const{logout:r,currentUser:e}=wo(),[t,s]=pe.useState([]),[i,o]=pe.useState([]),[c,f]=pe.useState(null),[h,m]=pe.useState(""),[x,v]=pe.useState(""),_=pe.useDeferredValue(x),[y,E]=pe.useState(new Set),[w,S]=pe.useState(!1),[k,M]=pe.useState(!1),[O,G]=pe.useState(()=>localStorage.getItem("lab_report_email")||""),[q,K]=pe.useState(!1),X=c?(C=>C.includes(" ")||C.includes("Hurds Calibrated")?["-5.0 +1.5","-5.0 +0.8","-1.5 +1.0","-1.5 +0.8","-0.8 +0.25","-1.0","-0.8","-0.25",""]:C.includes("")||C.includes("Fiber")?["1","2","3","4",""]:["1","2","3",""])(c.productName):[],z=async()=>{try{const C=await Sr.getPendingItems();s(C),c&&!C.find(I=>I.id===c.id)&&(f(null),m(""))}catch(C){console.error("Failed to load lab items",C)}},ne=async()=>{try{const C=await Sr.getGradedItems();o(C)}catch(C){console.error("Failed to load graded items",C)}};pe.useEffect(()=>{z()},[]);const oe=()=>{ne(),M(!0)},fe=()=>{const C=i.map(qe=>({"":qe.serialNumber,:qe.productName,:qe.sort||"",:qe.weight,:qe.date,"-":qe.barcode})),I=Dr.json_to_sheet(C),Z=Dr.book_new();Dr.book_append_sheet(Z,I,"");const ye=Ui(Z,{type:"array",bookType:"xlsx"}),De=new Blob([ye],{type:"application/octet-stream"}),Ae=URL.createObjectURL(De),Oe=document.createElement("a");Oe.href=Ae,Oe.download=`__${new Date().toLocaleDateString("uk-UA")}.xlsx`,Oe.click(),URL.revokeObjectURL(Ae)},W=()=>{const C={};i.forEach(Z=>{const ye=Z.sort||" ";C[ye]||(C[ye]={count:0,weight:0}),C[ye].count++,C[ye].weight+=Z.weight});let I=`   ${new Date().toLocaleDateString("uk-UA")}

`;return I+=` : ${i.length} 

`,I+=` :
`,Object.entries(C).forEach(([Z,ye])=>{I+=`  ${Z}: ${ye.count} . (${ye.weight.toFixed(1)} )
`}),I+=`
 : ${i.reduce((Z,ye)=>Z+ye.weight,0).toFixed(1)} `,I},be=async()=>{if(O){K(!0),localStorage.setItem("lab_report_email",O);try{const C=`  ${new Date().toLocaleDateString("uk-UA")}`,I=W();window.location.href=`mailto:${O}?subject=${encodeURIComponent(C)}&body=${encodeURIComponent(I)}`}catch(C){console.error(C)}K(!1)}},Ee=async C=>{if(window.confirm(`  ${C.serialNumber}  ?`))try{await Sr.revertGrade(C.id),ne(),z()}catch(I){console.error("Failed to revert grade",I)}},J=async()=>{if(!(!c||!h))try{await Sr.gradeItem(c.id,h,(e==null?void 0:e.id)||"unknown"),z(),m("")}catch(C){console.error(C)}},ve=C=>{const I=new Set(y);I.has(C)?I.delete(C):I.add(C),E(I)},le=()=>{y.size===ce.length?E(new Set):E(new Set(ce.map(C=>C.id)))},Ne=async()=>{if(!(y.size===0||!h))try{await Promise.all(Array.from(y).map(C=>Sr.gradeItem(C,h,(e==null?void 0:e.id)||"unknown"))),z(),E(new Set),m(""),S(!1)}catch(C){console.error(C)}},ce=t.filter(C=>C.serialNumber.toString().includes(_)||C.barcode.includes(_)),[U,N]=pe.useState(!1),P=()=>{U?r():(N(!0),setTimeout(()=>N(!1),3e3))};return g.jsxs("div",{className:"flex flex-col h-screen bg-slate-100 font-sans",children:[g.jsxs("div",{className:"bg-purple-900 text-white p-3 md:p-4 flex justify-between items-center shadow-lg shrink-0 z-10",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center font-bold text-white shadow-inner",children:"L"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-bold text-lg leading-tight",children:""}),g.jsx("div",{className:"text-[10px] text-purple-200 tracking-wider",children:"HeMP QC"})]})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("span",{className:"opacity-80 text-sm hidden md:inline",children:e==null?void 0:e.name}),g.jsx("button",{onClick:oe,className:"px-4 py-2 rounded text-sm font-bold bg-purple-600 hover:bg-purple-500 border border-purple-400 transition-all",children:" "}),g.jsx("button",{onClick:P,className:`px-4 py-2 rounded text-sm transition-all font-bold border ${U?"bg-red-500 text-white border-red-400 animate-pulse":"bg-purple-800 hover:bg-purple-700 border-purple-600"}`,children:U?"?":""})]})]}),g.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[g.jsxs("div",{className:"w-full md:w-1/3 bg-white border-r border-slate-200 flex flex-col",children:[g.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50",children:[g.jsxs("div",{className:"flex justify-between items-center mb-2",children:[g.jsxs("h2",{className:"text-lg font-bold text-slate-800",children:["  ",g.jsxs("span",{className:"text-purple-600",children:["(",t.length,")"]})]}),g.jsx("button",{onClick:()=>{S(!w),w?E(new Set):f(null)},className:`px-3 py-1 rounded-lg text-xs font-bold transition-all ${w?"bg-purple-600 text-white":"bg-slate-200 text-slate-600 hover:bg-purple-100"}`,children:w?" ":" "})]}),g.jsx("input",{value:x,onChange:C=>v(C.target.value),placeholder:"  ...",className:"w-full p-2 rounded-lg border border-slate-300 focus:border-purple-500 text-sm"}),w&&ce.length>0&&g.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[g.jsx("input",{type:"checkbox",checked:y.size===ce.length&&ce.length>0,onChange:le,className:"w-7 h-7 accent-purple-600 cursor-pointer"}),g.jsxs("span",{className:"text-sm text-slate-600",children:["  (",y.size," / ",ce.length,")"]})]})]}),g.jsx("div",{className:"flex-1 overflow-y-auto",children:ce.length===0?g.jsx("div",{className:"p-8 text-center text-slate-400 text-sm",children:" "}):ce.map(C=>g.jsxs("div",{onClick:()=>w?ve(C.id):f(C),className:`p-4 border-b border-slate-100 cursor-pointer transition-colors hover:bg-slate-50 flex items-center gap-3 ${w?y.has(C.id)?"bg-purple-50 border-l-4 border-l-purple-600":"":(c==null?void 0:c.id)===C.id?"bg-purple-50 border-l-4 border-l-purple-600":""}`,children:[w&&g.jsx("input",{type:"checkbox",checked:y.has(C.id),onChange:()=>ve(C.id),onClick:I=>I.stopPropagation(),className:"w-7 h-7 accent-purple-600 shrink-0 cursor-pointer"}),g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex justify-between items-center mb-1",children:[g.jsxs("div",{className:"font-bold text-slate-800",children:[" ",C.serialNumber]}),g.jsxs("div",{className:"text-xs font-mono text-slate-500 bg-slate-100 px-2 rounded",children:[C.weight," "]})]}),g.jsxs("div",{className:"flex justify-between items-end",children:[g.jsxs("div",{className:"text-xs text-slate-500",children:[C.productName," | ",C.date]}),g.jsx("div",{className:"text-[10px] uppercase text-purple-400 font-bold tracking-wider",children:"Pending"})]})]})]},C.id))})]}),g.jsx("div",{className:"flex-1 bg-slate-50 flex flex-col items-center justify-center p-6",children:w?g.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-2xl shadow-xl overflow-hidden animate-fade-in",children:[g.jsxs("div",{className:"bg-purple-50 p-6 border-b border-purple-100",children:[g.jsx("div",{className:"text-xs font-bold text-purple-600 uppercase mb-1",children:" "}),g.jsxs("div",{className:"text-3xl font-bold text-slate-800",children:[": ",y.size," "]})]}),y.size===0?g.jsxs("div",{className:"p-8 text-center text-slate-400",children:[g.jsx("div",{className:"text-6xl mb-4",children:""}),g.jsx("p",{children:"       "})]}):g.jsxs("div",{className:"p-8",children:[g.jsx("label",{className:"block text-center text-sm font-bold text-slate-500 mb-4 uppercase tracking-widest",children:"    "}),g.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-8",children:["1","2","3","4",""].map(C=>g.jsx("button",{onClick:()=>m(C),className:`p-4 rounded-xl font-bold transition-all text-sm md:text-base ${h===C?"bg-purple-600 text-white shadow-lg scale-105":"bg-white border-2 border-slate-100 text-slate-600 hover:border-purple-300"}`,children:C},C))}),g.jsxs("button",{onClick:Ne,disabled:!h,className:`w-full py-4 rounded-xl font-bold text-xl shadow-xl transition-all flex items-center justify-center gap-3 ${h?"bg-green-600 hover:bg-green-700 text-white shadow-green-900/20 active:scale-95":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[g.jsxs("span",{children:[" ",y.size," "]}),g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]})]})]}):c?g.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-2xl shadow-xl overflow-hidden animate-fade-in",children:[g.jsxs("div",{className:"bg-purple-50 p-6 border-b border-purple-100",children:[g.jsxs("div",{className:"flex justify-between items-start",children:[g.jsxs("div",{children:[g.jsx("div",{className:"text-xs font-bold text-purple-600 uppercase mb-1",children:" "}),g.jsxs("div",{className:"text-3xl font-bold text-slate-800",children:[" ",c.serialNumber]})]}),g.jsx("div",{className:"text-right",children:g.jsxs("div",{className:"text-4xl font-bold text-slate-800",children:[c.weight," ",g.jsx("span",{className:"text-lg text-slate-400 font-normal",children:""})]})})]}),g.jsxs("div",{className:"mt-4 bg-white p-3 rounded-xl border border-purple-100 shadow-sm",children:[g.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-widest font-bold mb-1",children:""}),g.jsx("div",{className:"text-xl font-bold text-slate-800 leading-none",children:c.productName})]}),g.jsx("div",{className:"mt-2 text-[10px] font-mono text-slate-400 text-center",children:c.barcode})]}),g.jsxs("div",{className:"p-8",children:[g.jsx("label",{className:"block text-center text-sm font-bold text-slate-500 mb-4 uppercase tracking-widest",children:" "}),g.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-8",children:X.map(C=>g.jsx("button",{onClick:()=>m(C),className:`p-4 rounded-xl font-bold transition-all text-sm md:text-base ${h===C?"bg-purple-600 text-white shadow-lg scale-105":"bg-white border-2 border-slate-100 text-slate-600 hover:border-purple-300"}`,children:C},C))}),g.jsxs("button",{onClick:J,disabled:!h,className:`w-full py-4 rounded-xl font-bold text-xl shadow-xl transition-all flex items-center justify-center gap-3 ${h?"bg-green-600 hover:bg-green-700 text-white shadow-green-900/20 active:scale-95":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[g.jsx("span",{children:""}),g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]})]})]}):g.jsxs("div",{className:"text-center text-slate-400 max-w-sm",children:[g.jsx("div",{className:"text-6xl mb-4",children:""}),g.jsx("h3",{className:"text-xl font-bold mb-2",children:"   "}),g.jsx("p",{children:"   ,      ."})]})})]}),k&&g.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col overflow-hidden",children:[g.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 flex justify-between items-center shrink-0",children:[g.jsxs("div",{children:[g.jsx("h2",{className:"text-2xl font-bold",children:" "}),g.jsx("p",{className:"text-sm opacity-80",children:"   "})]}),g.jsx("button",{onClick:()=>M(!1),className:"text-white/70 hover:text-white text-3xl",children:""})]}),g.jsxs("div",{className:"p-4 bg-purple-50 border-b border-purple-100 grid grid-cols-2 md:grid-cols-4 gap-4",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-3xl font-bold text-purple-700",children:i.length}),g.jsx("div",{className:"text-xs text-purple-500",children:" "})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-3xl font-bold text-green-600",children:i.reduce((C,I)=>C+I.weight,0).toFixed(1)}),g.jsx("div",{className:"text-xs text-green-500",children:" ()"})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-3xl font-bold text-blue-600",children:[...new Set(i.map(C=>C.sort))].length}),g.jsx("div",{className:"text-xs text-blue-500",children:""})]}),g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"text-3xl font-bold text-orange-600",children:[...new Set(i.map(C=>C.productName))].length}),g.jsx("div",{className:"text-xs text-orange-500",children:""})]})]}),g.jsxs("div",{className:"p-4 bg-white border-b border-slate-200 flex gap-3 items-center",children:[g.jsx("input",{type:"email",value:O,onChange:C=>G(C.target.value),placeholder:"Email  ...",className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg"}),g.jsx("button",{onClick:be,disabled:!O||q,className:"px-4 py-2 bg-purple-600 text-white rounded-lg font-bold hover:bg-purple-700 disabled:bg-slate-300",children:" "}),g.jsx("button",{onClick:fe,className:"px-4 py-2 bg-green-600 text-white rounded-lg font-bold hover:bg-green-700",children:" XLSX"})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.length===0?g.jsxs("div",{className:"text-center py-16 text-slate-400",children:[g.jsx("div",{className:"text-6xl mb-4",children:""}),g.jsx("p",{children:"  "})]}):g.jsxs("table",{className:"w-full text-sm",children:[g.jsx("thead",{className:"bg-slate-100 sticky top-0",children:g.jsxs("tr",{children:[g.jsx("th",{className:"p-2 text-left",children:""}),g.jsx("th",{className:"p-2 text-left",children:""}),g.jsx("th",{className:"p-2 text-left",children:""}),g.jsx("th",{className:"p-2 text-right",children:""}),g.jsx("th",{className:"p-2 text-left",children:""}),g.jsx("th",{className:"p-2 text-left",children:"-"}),g.jsx("th",{className:"p-2 text-right",children:""})]})}),g.jsx("tbody",{className:"divide-y divide-slate-100",children:i.map(C=>g.jsxs("tr",{className:"hover:bg-slate-50",children:[g.jsx("td",{className:"p-2 font-mono font-bold",children:C.serialNumber}),g.jsx("td",{className:"p-2",children:C.productName}),g.jsx("td",{className:"p-2",children:g.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-bold",children:C.sort})}),g.jsxs("td",{className:"p-2 text-right font-mono",children:[C.weight," "]}),g.jsx("td",{className:"p-2 text-slate-500",children:C.date}),g.jsx("td",{className:"p-2 font-mono text-xs text-slate-400",children:C.barcode}),g.jsx("td",{className:"p-2 text-right",children:g.jsxs("button",{onClick:()=>Ee(C),className:"px-3 py-1 bg-slate-200 hover:bg-red-100 text-slate-700 hover:text-red-600 rounded-lg text-xs font-bold transition-colors flex items-center gap-1 ml-auto",title:"  ",children:[g.jsx("span",{children:""})," "]})})]},C.id))})]})})]})})]})}const yv="zebra_users_v1",ji={getUsers(){try{const r=localStorage.getItem(yv);if(r)return JSON.parse(r)}catch(r){console.error("Failed to load users",r)}return this.saveUsers(zi),zi},saveUsers(r){try{localStorage.setItem(yv,JSON.stringify(r))}catch(e){console.error("Failed to save users",e)}},addUser(r){const e=this.getUsers();if(e.some(s=>s.id===r.id||s.name===r.name))throw new Error("User with this ID or Name already exists");const t=[...e,r];return this.saveUsers(t),t},updateUser(r){const e=this.getUsers(),t=e.findIndex(i=>i.id===r.id);if(t===-1)throw new Error("User not found");const s=[...e];return s[t]=r,this.saveUsers(s),s},deleteUser(r){const t=this.getUsers().filter(s=>s.id!==r);return this.saveUsers(t),t},getRoles(){return[{id:"operator",name:""},{id:"lab",name:""},{id:"accountant",name:""},{id:"admin",name:""},{id:"agro",name:""}]}};function U6(){const{logout:r,currentUser:e}=wo(),t=Td(),s=E2(),[i,o]=pe.useState("printer"),[c,f]=pe.useState(()=>ji.getUsers()),[h,m]=pe.useState({id:"",name:"",role:"operator",pin:""}),[x,v]=pe.useState(Tn.getDataSource()),[_,y]=pe.useState(()=>localStorage.getItem("zebra_supabase_url")||""),[E,w]=pe.useState(()=>localStorage.getItem("zebra_supabase_key")||""),[S,k]=pe.useState(()=>localStorage.getItem("zebra_barcode_pattern_v1")||"{date}-{sku}-{serialNumber}-{weight}"),{selectPrinter:M,discoveredPrinters:O,searchPrinters:G,isSearchingPrinters:q,agentIp:K,setAgentIp:F}=t,[X,z]=pe.useState(new Date().toISOString().split("T")[0]),[ne,oe]=pe.useState(new Date().toISOString().split("T")[0]),[fe,W]=pe.useState(!1),[be,Ee]=pe.useState(!1),J=()=>{be?r():(Ee(!0),setTimeout(()=>Ee(!1),3e3))},ve=()=>{z_.updateCredentials(_,E),Tn.setDataSource("supabase"),v("supabase"),alert(" Supabase !")},le=async()=>{try{const ce=await $h.backupDatabase();alert(`    !
 : ${ce}
 : Documents`)}catch{alert("   .")}},Ne=async()=>{W(!0);const ce=new Date(X);ce.setHours(0,0,0,0);const U=new Date(ne);U.setHours(23,59,59,999),await s.generateReport(ce,U),W(!1)};return g.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[g.jsxs("header",{className:"bg-[#115740] text-white p-4 shadow-md flex justify-between items-center sticky top-0 z-50",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"p-2 bg-white/10 rounded-lg",children:g.jsx(Au,{})}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-xl font-bold leading-none",children:""}),g.jsx("p",{className:"text-xs text-emerald-200 opacity-80",children:" "})]})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsxs("div",{className:"text-right hidden sm:block",children:[g.jsx("div",{className:"text-sm font-bold",children:e==null?void 0:e.name}),g.jsxs("div",{className:"text-xs text-emerald-200",children:["Role: ",e==null?void 0:e.role]})]}),g.jsx("button",{onClick:J,className:`transition-all px-4 py-2 rounded-lg text-sm font-bold ${be?"bg-red-600 text-white animate-pulse ring-2 ring-red-300":"bg-red-500 hover:bg-red-600 text-white"}`,children:be?"?":""})]})]}),g.jsxs("div",{className:"flex flex-1 overflow-hidden max-w-7xl mx-auto w-full p-4 gap-6",children:[g.jsxs("aside",{className:"w-64 bg-white rounded-2xl shadow-sm flex flex-col overflow-hidden shrink-0",children:[g.jsxs("nav",{className:"flex-1 p-4 space-y-2",children:[g.jsx(Xl,{active:i==="printer",onClick:()=>o("printer"),label:"",icon:g.jsx(Os,{})}),g.jsx(Xl,{active:i==="database",onClick:()=>o("database"),label:" ",icon:g.jsx("div",{className:"w-6 h-6 flex items-center justify-center font-bold",children:"DB"})}),g.jsx(Xl,{active:i==="reports",onClick:()=>o("reports"),label:" & ",icon:g.jsx("div",{className:"w-6 h-6 flex items-center justify-center font-bold",children:""})}),g.jsx(Xl,{active:i==="users",onClick:()=>o("users"),label:"",icon:g.jsx("div",{className:"w-6 h-6 flex items-center justify-center font-bold",children:""})}),g.jsx(Xl,{active:i==="system",onClick:()=>o("system"),label:"",icon:g.jsx(Au,{})})]}),g.jsx("div",{className:"p-4 bg-slate-50 border-t text-xs text-slate-400 text-center",children:"v0.9 beta"})]}),g.jsxs("main",{className:"flex-1 bg-white rounded-2xl shadow-sm overflow-y-auto p-6 relative",children:[i==="printer"&&g.jsxs("div",{className:"space-y-6 max-w-3xl",children:[g.jsx("h2",{className:"text-2xl font-bold text-slate-800 border-b pb-4 mb-6",children:" "}),g.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[g.jsx("div",{className:"text-sm text-slate-500 uppercase font-bold mb-2",children:" "}),t!=null&&t.printer?g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500 animate-pulse"}),g.jsxs("div",{children:[g.jsx("div",{className:"font-bold text-lg text-slate-800",children:t.printer.name}),g.jsxs("div",{className:"text-sm text-slate-500 font-mono",children:[t.printer.uid," (",t.printer.connection,")"]})]})]}):g.jsxs("div",{className:"flex items-center gap-3 text-slate-400",children:[g.jsx("div",{className:"w-4 h-4 rounded-full bg-slate-300"}),g.jsx("span",{className:"font-medium",children:"  "})]})]}),g.jsxs("section",{children:[g.jsxs("h3",{className:"font-bold text-slate-700 mb-3 flex items-center gap-2",children:[g.jsx(TT,{}),"   (Browser Print)"]}),g.jsxs("div",{className:"flex gap-2 mb-4",children:[g.jsx("input",{className:"border-2 border-slate-200 rounded-lg px-3 py-2 text-sm flex-1 focus:border-blue-500 outline-none",value:K||"127.0.0.1",onChange:ce=>F(ce.target.value),placeholder:"IP  (127.0.0.1)"}),g.jsx("button",{onClick:G,disabled:q,className:"bg-blue-600 text-white px-6 rounded-lg hover:bg-blue-700 font-bold text-sm transition-colors",children:q?"...":""})]}),g.jsxs("div",{className:"space-y-2",children:[O.map(ce=>g.jsxs("div",{onClick:()=>M(ce),className:"bg-white p-3 border border-slate-200 rounded-xl flex justify-between items-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all shadow-sm",children:[g.jsxs("div",{children:[g.jsx("div",{className:"font-bold text-slate-800",children:ce.name}),g.jsx("div",{className:"text-xs text-slate-500 font-mono",children:ce.uid})]}),g.jsx("div",{className:"bg-blue-100 text-blue-700 text-xs font-bold px-3 py-1 rounded-full uppercase",children:""})]},ce.uid)),O.length===0&&!q&&g.jsx("div",{className:"text-slate-400 text-center py-4 border-2 border-dashed border-slate-200 rounded-xl",children:"  .  Zebra Browser Print."})]})]}),g.jsxs("section",{className:"pt-6 border-t border-slate-100",children:[g.jsxs("h3",{className:"font-bold text-slate-700 mb-3 flex items-center gap-2",children:[g.jsx(AT,{}),"   (LAN Direct)"]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{type:"text",id:"manual-ip-input",className:"border-2 border-slate-200 rounded-lg px-3 py-2 text-sm flex-1 font-mono focus:border-slate-500 outline-none",placeholder:"192.168.1.xxx",defaultValue:"10.10.10.163"}),g.jsx("button",{onClick:()=>{const U=document.getElementById("manual-ip-input").value.trim();if(!U)return;const N={uid:U,name:`LAN Printer (${U})`,connection:"net",deviceType:"printer",manufacturer:"Zebra",provider:"Manual",version:"1.0"};M(N),alert(` ${U} !`)},className:"bg-slate-700 text-white px-6 py-2 rounded-lg hover:bg-slate-800 font-bold transition-colors",children:""})]})]})]}),i==="database"&&g.jsxs("div",{className:"space-y-8 max-w-3xl",children:[g.jsx("h2",{className:"text-2xl font-bold text-slate-800 border-b pb-4 mb-6",children:" "}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[g.jsxs("div",{onClick:()=>{Tn.setDataSource("sqlite"),v("sqlite")},className:`p-6 rounded-2xl border-2 cursor-pointer transition-all ${x==="sqlite"?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-slate-200 hover:border-slate-300"}`,children:[g.jsx("div",{className:"text-xl font-bold mb-2",children:"Local SQLite"}),g.jsx("p",{className:"text-sm text-slate-500",children:"    .  ."})]}),g.jsxs("div",{onClick:()=>{Tn.setDataSource("supabase"),v("supabase")},className:`p-6 rounded-2xl border-2 cursor-pointer transition-all ${x==="supabase"?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-slate-200 hover:border-slate-300"}`,children:[g.jsx("div",{className:"text-xl font-bold mb-2",children:"Cloud Supabase"}),g.jsx("p",{className:"text-sm text-slate-500",children:" .  ."})]}),g.jsxs("div",{onClick:()=>{Tn.setDataSource("postgres"),v("postgres")},className:`p-6 rounded-2xl border-2 cursor-pointer transition-all ${x==="postgres"?"border-indigo-500 bg-indigo-50 ring-2 ring-indigo-200":"border-slate-200 hover:border-slate-300"}`,children:[g.jsx("div",{className:"text-xl font-bold mb-2",children:"PostgreSQL (API)"}),g.jsx("p",{className:"text-sm text-slate-500",children:"  API  (Node.js)."})]})]}),x==="supabase"&&g.jsxs("div",{className:"bg-green-50 p-6 rounded-2xl border border-green-200 space-y-4",children:[g.jsx("h3",{className:"font-bold text-green-800",children:" Supabase"}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-green-700 uppercase mb-1",children:"Project URL"}),g.jsx("input",{value:_,onChange:ce=>y(ce.target.value),className:"w-full border border-green-300 rounded px-3 py-2 text-sm"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-green-700 uppercase mb-1",children:"Anon Key"}),g.jsx("input",{type:"password",value:E,onChange:ce=>w(ce.target.value),className:"w-full border border-green-300 rounded px-3 py-2 text-sm"})]}),g.jsx("button",{onClick:ve,className:"bg-green-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-green-700",children:""})]}),x==="postgres"&&g.jsxs("div",{className:"bg-indigo-50 p-6 rounded-2xl border border-indigo-200 space-y-4",children:[g.jsx("h3",{className:"font-bold text-indigo-800",children:" PostgreSQL API"}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-indigo-700 uppercase mb-1",children:"Server API URL"}),g.jsx("input",{defaultValue:localStorage.getItem("zebra_api_url")||"http://localhost:3000",onChange:ce=>localStorage.setItem("zebra_api_url",ce.target.value),className:"w-full border border-indigo-300 rounded px-3 py-2 text-sm font-mono",placeholder:"http://localhost:3000"})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{onClick:()=>window.location.reload(),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700",children:"  "}),g.jsx("button",{onClick:async()=>{const ce=localStorage.getItem("zebra_api_url")||"http://localhost:3000";try{const N=await(await fetch(`${ce}/api/health`)).json();N.status==="ok"?alert(` ! DB Connected.
Time: ${N.timestamp}`):alert(`  API: ${N.error}`)}catch(U){alert(`  ': ${U}`)}},className:"bg-white text-indigo-700 border border-indigo-300 px-6 py-2 rounded-lg font-bold hover:bg-indigo-50",children:"Test Connection"})]})]}),x==="sqlite"&&g.jsxs("div",{className:"bg-slate-50 p-6 rounded-2xl border border-slate-200",children:[g.jsx("h3",{className:"font-bold text-slate-700 mb-4",children:"   "}),g.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[g.jsxs("button",{onClick:le,className:"flex-1 bg-[#115740] text-white px-6 py-4 rounded-xl font-bold hover:bg-[#0d4633] flex items-center justify-center gap-2 shadow-lg shadow-emerald-900/10 active:scale-95 transition-all",children:[g.jsx("div",{className:"bg-white/20 p-2 rounded-lg",children:g.jsx(Ax,{})}),g.jsxs("div",{className:"text-left",children:[g.jsx("div",{className:"text-sm opacity-80 font-normal",children:""}),g.jsx("div",{children:" Backup"})]})]}),g.jsxs("div",{className:"flex-1 relative",children:[g.jsx("input",{type:"file",accept:".json",id:"import-db-file",className:"hidden",onChange:async ce=>{var P;const U=(P=ce.target.files)==null?void 0:P[0];if(!U)return;if(!window.confirm(` !

    (, )   .

?`)){ce.target.value="";return}const N=new FileReader;N.onload=async C=>{var I;try{const Z=(I=C.target)==null?void 0:I.result;await $h.importDatabase(Z),alert("    !"),window.location.reload()}catch(Z){alert("  : "+Z)}},N.readAsText(U)}}),g.jsxs("label",{htmlFor:"import-db-file",className:"w-full bg-blue-600 text-white px-6 py-4 rounded-xl font-bold hover:bg-blue-700 flex items-center justify-center gap-2 shadow-lg shadow-blue-900/10 active:scale-95 transition-all cursor-pointer",children:[g.jsx("div",{className:"bg-white/20 p-2 rounded-lg",children:g.jsx("div",{className:"w-6 h-6 flex items-center justify-center font-bold text-xl",children:""})}),g.jsxs("div",{className:"text-left",children:[g.jsx("div",{className:"text-sm opacity-80 font-normal",children:""}),g.jsx("div",{children:"  "})]})]})]})]}),g.jsx("p",{className:"text-xs text-slate-400 mt-4 text-center",children:" : JSON.    ."})]})]}),i==="reports"&&g.jsxs("div",{className:"space-y-6 max-w-4xl",children:[g.jsx("h2",{className:"text-2xl font-bold text-slate-800 border-b pb-4 mb-6",children:"  "}),g.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 flex flex-wrap gap-4 items-end",children:[g.jsxs("div",{className:"flex gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:""}),g.jsx("input",{type:"date",value:X,onChange:ce=>z(ce.target.value),className:"border border-slate-300 rounded px-3 py-2 text-sm"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:""}),g.jsx("input",{type:"date",value:ne,onChange:ce=>oe(ce.target.value),className:"border border-slate-300 rounded px-3 py-2 text-sm"})]})]}),g.jsx("button",{onClick:Ne,disabled:fe,className:"bg-[#115740] text-white px-6 py-2 rounded-lg font-bold hover:bg-[#0d4633] mb-[1px]",children:fe?"...":""})]}),s.reportData.length>0&&g.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[g.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100",children:[g.jsx("div",{className:"text-xs text-blue-600 font-bold uppercase",children:" "}),g.jsx("div",{className:"text-3xl font-bold text-blue-900",children:s.reportSummary.count})]}),g.jsxs("div",{className:"bg-emerald-50 p-4 rounded-xl border border-emerald-100",children:[g.jsx("div",{className:"text-xs text-emerald-600 font-bold uppercase",children:" "}),g.jsxs("div",{className:"text-3xl font-bold text-emerald-900",children:[s.reportSummary.totalWeight.toFixed(2)," ",g.jsx("span",{className:"text-sm font-normal text-emerald-700",children:""})]})]})]}),g.jsxs("div",{className:"flex gap-4 pt-4",children:[g.jsxs("button",{onClick:()=>s.exportCsv(s.reportData),disabled:s.reportData.length===0,className:"flex items-center gap-2 px-4 py-2 border border-slate-300 rounded-lg hover:bg-slate-50 disabled:opacity-50",children:[g.jsx(Ax,{})," CSV"]}),g.jsx("button",{onClick:()=>s.exportXlsx(s.reportData),disabled:s.reportData.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 border border-green-200 rounded-lg hover:bg-green-100 disabled:opacity-50 font-bold",children:" Excel (XLSX)"}),g.jsxs("button",{onClick:()=>s.sendEmail(s.reportData),disabled:s.reportData.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-100 disabled:opacity-50 font-bold",children:[g.jsx(ET,{})," Send Email"]})]}),g.jsxs("div",{className:"pt-8 border-t",children:[g.jsx("h3",{className:"font-bold text-slate-700 mb-4",children:"EmailJS Configuration"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Service ID"}),g.jsx("input",{className:"w-full border border-slate-300 rounded px-3 py-2 text-sm mt-1",defaultValue:localStorage.getItem("emailjs_service_id")||"",onChange:ce=>localStorage.setItem("emailjs_service_id",ce.target.value)})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Template ID"}),g.jsx("input",{className:"w-full border border-slate-300 rounded px-3 py-2 text-sm mt-1",defaultValue:localStorage.getItem("emailjs_template_id")||"",onChange:ce=>localStorage.setItem("emailjs_template_id",ce.target.value)})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Public Key"}),g.jsx("input",{className:"w-full border border-slate-300 rounded px-3 py-2 text-sm mt-1",defaultValue:localStorage.getItem("emailjs_public_key")||"",onChange:ce=>localStorage.setItem("emailjs_public_key",ce.target.value)})]})]})]})]}),i==="users"&&g.jsxs("div",{className:"space-y-6 max-w-3xl",children:[g.jsx("h2",{className:"text-2xl font-bold text-slate-800 border-b pb-4 mb-6",children:""}),g.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:g.jsxs("table",{className:"w-full text-left border-collapse",children:[g.jsx("thead",{className:"bg-slate-50 text-slate-500 text-xs uppercase font-bold",children:g.jsxs("tr",{children:[g.jsx("th",{className:"p-4",children:"'"}),g.jsx("th",{className:"p-4",children:""}),g.jsx("th",{className:"p-4",children:"PIN"}),g.jsx("th",{className:"p-4 text-right",children:""})]})}),g.jsx("tbody",{className:"divide-y divide-slate-100",children:c.map(ce=>g.jsxs("tr",{className:"hover:bg-slate-50",children:[g.jsx("td",{className:"p-4 font-bold text-slate-800",children:ce.name}),g.jsx("td",{className:"p-4",children:g.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${ce.role==="admin"?"bg-purple-100 text-purple-700":ce.role==="operator"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-600"}`,children:ce.role})}),g.jsx("td",{className:"p-4 font-mono text-slate-500",children:"****"}),g.jsx("td",{className:"p-4 text-right",children:g.jsxs("div",{className:"flex justify-end gap-2",children:[g.jsx("button",{onClick:()=>{m(ce),window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},className:"text-blue-500 hover:text-blue-700 font-bold text-sm bg-blue-50 px-3 py-1 rounded hover:bg-blue-100 transition-colors",children:" ."}),g.jsx("button",{onClick:()=>{window.confirm(`  ${ce.name}?`)&&(f(ji.deleteUser(ce.id)),h.id===ce.id&&m({id:"",name:"",role:"operator",pin:""}))},disabled:ce.role==="admin"&&c.filter(U=>U.role==="admin").length===1,className:"text-red-500 hover:text-red-700 font-bold text-sm bg-red-50 px-3 py-1 rounded hover:bg-red-100 transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:""})]})})]},ce.id))})]})}),g.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:[g.jsx("h3",{className:"font-bold text-slate-700 mb-4",children:h.id?" ":" "}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"'"}),g.jsx("input",{value:h.name,onChange:ce=>m({...h,name:ce.target.value}),className:"w-full border border-slate-300 rounded px-3 py-2 text-sm",placeholder:"ex.  "})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:""}),g.jsx("select",{value:h.role,onChange:ce=>m({...h,role:ce.target.value}),className:"w-full border border-slate-300 rounded px-3 py-2 text-sm",children:ji.getRoles().map(ce=>g.jsx("option",{value:ce.id,children:ce.name},ce.id))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"PIN (4 )"}),g.jsx("input",{value:h.pin,maxLength:4,onChange:ce=>m({...h,pin:ce.target.value.replace(/\D/g,"")}),className:"w-full border border-slate-300 rounded px-3 py-2 text-sm font-mono",placeholder:"0000"})]})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx("button",{onClick:()=>{if(h.name&&h.pin.length===4)try{if(h.id)f(ji.updateUser(h)),alert(" !");else{const ce={...h,id:Date.now().toString()};f(ji.addUser(ce)),alert(" !")}m({id:"",name:"",role:"operator",pin:""})}catch(ce){alert(ce.message)}else alert("    (PIN   4 )")},className:`px-6 py-2 rounded-lg font-bold text-white transition-colors ${h.id?"bg-blue-600 hover:bg-blue-700":"bg-[#115740] hover:bg-[#0d4633]"}`,children:h.id?"  ":"+ "}),h.id&&g.jsx("button",{onClick:()=>m({id:"",name:"",role:"operator",pin:""}),className:"px-6 py-2 rounded-lg font-bold text-slate-600 hover:bg-slate-200 bg-slate-100 transition-colors",children:""})]})]})]}),i==="system"&&g.jsxs("div",{className:"space-y-6 max-w-3xl",children:[g.jsx("h2",{className:"text-2xl font-bold text-slate-800 border-b pb-4 mb-6",children:" "}),g.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-dashed border-slate-300",children:[g.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:" Barcode Template"}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"block text-xs font-bold text-slate-700 uppercase",children:"Pattern / "}),g.jsx("input",{value:S,onChange:ce=>{k(ce.target.value),localStorage.setItem("zebra_barcode_pattern_v1",ce.target.value)},className:"w-full border border-slate-300 rounded px-3 py-2 text-sm font-mono"}),g.jsxs("p",{className:"text-xs text-slate-400",children:["Available: ","{sku}, {date}, {weight}, {serialNumber}"]})]})]}),g.jsx("div",{className:"pt-4",children:g.jsx("button",{onClick:()=>{var ce;return(ce=s.addDummyData)==null?void 0:ce.call(s)},className:"w-full py-3 bg-red-50 hover:bg-red-100 text-red-700 font-bold rounded-lg border border-red-200 transition-colors text-sm dashed",children:"+ Generate Dummy Data (Test)"})})]})]})]})]})}function Xl({active:r,onClick:e,label:t,icon:s}){return g.jsxs("button",{onClick:e,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-bold ${r?"bg-[#115740] text-white shadow-lg shadow-emerald-900/20":"text-slate-500 hover:bg-slate-50 hover:text-slate-800"}`,children:[g.jsx("div",{className:`w-6 h-6 ${r?"text-emerald-200":"text-slate-400"}`,children:s}),g.jsx("span",{children:t})]})}function P6(){const{currentUser:r,login:e}=wo(),[t]=Hu.useState(()=>ji.getUsers());return r?r.role==="admin"?g.jsx(U6,{}):r.role==="postgres_user"||r.role==="accountant"?g.jsx(B6,{}):r.role==="lab"?g.jsx(M6,{}):g.jsx(R6,{}):g.jsx(jT,{onLogin:e,users:t})}class z6 extends Hu.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){console.error("Uncaught error:",e,t),this.setState({errorInfo:t})}render(){var e,t;return this.state.hasError?g.jsxs("div",{className:"p-8 bg-red-50 h-screen flex flex-col items-center justify-center text-red-900 overflow-auto",style:{padding:"2rem",backgroundColor:"#fef2f2",height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#7f1d1d",overflow:"auto"},children:[g.jsx("h1",{className:"text-2xl font-bold mb-4",style:{fontSize:"1.5rem",fontWeight:"bold",marginBottom:"1rem"},children:"Something went wrong"}),g.jsxs("div",{className:"bg-white p-4 rounded shadow-lg max-w-full w-full overflow-auto border border-red-200",style:{backgroundColor:"white",padding:"1rem",borderRadius:"0.25rem",border:"1px solid #fecaca",width:"100%"},children:[g.jsx("h2",{className:"text-lg font-semibold mb-2",style:{fontWeight:"600",marginBottom:"0.5rem"},children:(e=this.state.error)==null?void 0:e.toString()}),g.jsxs("details",{className:"text-xs font-mono whitespace-pre-wrap text-slate-600",style:{fontSize:"0.75rem",fontFamily:"monospace",whiteSpace:"pre-wrap",color:"#475569"},children:[g.jsx("summary",{className:"cursor-pointer text-blue-600 mb-2",style:{cursor:"pointer",color:"#2563eb",marginBottom:"0.5rem"},children:"View Stack Trace"}),(t=this.state.errorInfo)==null?void 0:t.componentStack]})]}),g.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 font-bold",style:{marginTop:"1.5rem",padding:"0.5rem 1rem",backgroundColor:"#dc2626",color:"white",borderRadius:"0.25rem",fontWeight:"bold",cursor:"pointer"},children:"Reload App"})]}):this.props.children}}const T2=document.getElementById("root");if(!T2)throw new Error("Could not find root element to mount to");const H6=Gb.createRoot(T2);window.addEventListener("error",r=>{var e;document.body.innerHTML=`
    <div style="padding: 20px; color: red; font-family: sans-serif;">
      <h1>Application Error</h1>
      <p>${r.message}</p>
      <pre>${((e=r.error)==null?void 0:e.stack)||""}</pre>
    </div>
  `});window.addEventListener("unhandledrejection",r=>{document.body.innerHTML=`
    <div style="padding: 20px; color: red; font-family: sans-serif;">
      <h1>Unhandled Promise Rejection</h1>
      <p>${r.reason}</p>
    </div>
  `});{const r=document.createElement("div");r.style.cssText=`
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 200px;
    background: rgba(0,0,0,0.8);
    color: #0f0;
    font-family: monospace;
    font-size: 10px;
    overflow: auto;
    z-index: 10000;
    padding: 10px;
    pointer-events: none;
  `,document.body.appendChild(r);const e=console.log,t=console.error,s=console.warn,i=(o,c)=>{const f=c.map(m=>{try{return typeof m=="object"?JSON.stringify(m):String(m)}catch{return String(m)}}).join(" "),h=document.createElement("div");h.textContent=`[${o}] ${f}`,h.style.borderBottom="1px solid #333",o==="ERROR"&&(h.style.color="#ff6b6b"),o==="WARN"&&(h.style.color="#feca57"),r.appendChild(h),r.scrollTop=r.scrollHeight};console.log=(...o)=>{e(...o),i("LOG",o)},console.error=(...o)=>{t(...o),i("ERROR",o)},console.warn=(...o)=>{s(...o),i("WARN",o)}}console.log("Sticker Print App Starting...");try{H6.render(g.jsx(Hu.StrictMode,{children:g.jsx(z6,{children:g.jsx(wT,{children:g.jsx(P6,{})})})}))}catch(r){console.error("Render Error:",r)}export{pu as E,md as W,Gu as _,Qb as b,$u as r};
